/*
   YARA Rule Set
   Author: Grim
   Date: 2024-08-04
   Identifier: samples
   Reference: @grimbinary
*/

/* Rule Set ----------------------------------------------------------------- */

rule db6a0025a6b9a255427019326c28540193c00d671e7120473913bfc88650a614 {
   meta:
      description = "samples - file db6a0025a6b9a255427019326c28540193c00d671e7120473913bfc88650a614.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "db6a0025a6b9a255427019326c28540193c00d671e7120473913bfc88650a614"
   strings:
      $x1 = "=ShadowSpoofer.DEPENDENCIES.AMIDEWIN+<ExecuteCommandAsync>d__5" fullword ascii
      $s2 = "costura.system.runtime.compilerservices.unsafe.dll.compressed" fullword wide
      $s3 = "BShadowSpoofer.DEPENDENCIES.AMIDEWIN+Downloader+<DownloadAsync>d__0" fullword ascii
      $s4 = "SpooferAtualizado.Login.resources" fullword ascii
      $s5 = "0SpooferAtualizado.Login+<guna2Button1_Click>d__6" fullword ascii
      $s6 = "ExecuteCommandAsync" fullword ascii
      $s7 = "<ExecuteCommandAsync>d__5" fullword ascii
      $s8 = "costura.system.numerics.vectors.dll.compressed" fullword wide
      $s9 = "costura.system.diagnostics.diagnosticsource.dll.compressed" fullword wide
      $s10 = "costura.system.memory.dll.compressed" fullword wide
      $s11 = "costura.system.threading.tasks.extensions.dll.compressed" fullword wide
      $s12 = "costura.system.buffers.dll.compressed" fullword wide
      $s13 = "%SpooferAtualizado.Login+<DISCORD>d__9" fullword ascii
      $s14 = "(SpooferAtualizado.Main+<Downloader>d__34" fullword ascii
      $s15 = "XRayCore.dll" fullword ascii
      $s16 = "costura.newtonsoft.json.dll.compressed" fullword wide
      $s17 = "costura.costura.dll.compressed" fullword wide
      $s18 = "costura.icsharpcode.sharpziplib.dll.compressed" fullword wide
      $s19 = "SPOOOFER.exe" fullword wide
      $s20 = "costura.guna.ui2.dll.compressed" fullword wide
   condition:
      uint16(0) == 0x5a4d and filesize < 15000KB and
      1 of ($x*) and 4 of them
}

rule sig_8ee90a49d860205395973a7810661081a76a3a120962375e6a67d39a1e669429 {
   meta:
      description = "samples - file 8ee90a49d860205395973a7810661081a76a3a120962375e6a67d39a1e669429.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "8ee90a49d860205395973a7810661081a76a3a120962375e6a67d39a1e669429"
   strings:
      $s1 = "lSystem.Resources.ResourceReader, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089#System.Resources.R" ascii
      $s2 = "System.Diagnostics.Tracing.EventLevel, System.Diagnostics.Tracing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d5" ascii
      $s3 = "System.Diagnostics.Tracing.EventLevel, System.Diagnostics.Tracing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d5" ascii
      $s4 = "Grator.exe" fullword wide
      $s5 = "get_InvalidOperation_MessageNotReservedByTarget" fullword ascii
      $s6 = "get_InvalidOperation_FailedToConsumeReservedMessage" fullword ascii
      $s7 = "<CompleteTargetIfPossible>b__e" fullword ascii
      $s8 = "<CompleteTargetIfPossible>b__12" fullword ascii
      $s9 = "get_ConcurrentCollection_SyncRoot_NotSupported" fullword ascii
      $s10 = "System.Threading.Tasks.Dataflow.ISourceBlock<System.Tuple<System.Collections.Generic.IList<T1>,System.Collections.Generic.IList<" ascii
      $s11 = " Source {0} linked to target {1}." fullword ascii
      $s12 = "<OfferToTargetAsync>b__11" fullword ascii
      $s13 = "get_InvalidOperation_DataNotAvailableForReceive" fullword ascii
      $s14 = "System.Threading.Tasks.Dataflow.Internal.Threading" fullword ascii
      $s15 = "System.Threading.Tasks.Dataflow.Resource.resources" fullword ascii
      $s16 = "NVtZPyBGO" fullword ascii /* base64 encoded string '5[Y? F' */
      $s17 = "System.Threading.Tasks.Dataflow.Resource" fullword wide
      $s18 = "get_event_DataflowBlockCompleted" fullword ascii
      $s19 = "get_NotSupported_MemberNotNeeded" fullword ascii
      $s20 = "get_Argument_NonGreedyNotSupported" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 1000KB and
      8 of them
}

rule sig_7388c664fecd46ba3176b1e55a873b5aff6d0713144ee3431f2269af4bb1868e {
   meta:
      description = "samples - file 7388c664fecd46ba3176b1e55a873b5aff6d0713144ee3431f2269af4bb1868e.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "7388c664fecd46ba3176b1e55a873b5aff6d0713144ee3431f2269af4bb1868e"
   strings:
      $x1 = "https://raw.githubusercontent.com/moom825/Discord-RAT-2.0/master/Discord%20rat/Resources/PasswordStealer.dll" fullword wide
      $x2 = "https://raw.githubusercontent.com/moom825/Discord-RAT-2.0/master/Discord%20rat/Resources/rootkit.dll" fullword wide
      $x3 = "https://raw.githubusercontent.com/moom825/Discord-RAT-2.0/master/Discord%20rat/Resources/unrootkit.dll" fullword wide
      $x4 = "https://raw.githubusercontent.com/moom825/Discord-RAT-2.0/master/Discord%20rat/Resources/Token%20grabber.dll" fullword wide
      $x5 = "--> !shell = Execute a shell command /Syntax  = \"!shell whoami\"" fullword wide
      $x6 = "https://raw.githubusercontent.com/moom825/Discord-RAT-2.0/master/Discord%20rat/Resources/Webcam.dll" fullword wide
      $s7 = "--> !uacbypass = attempt to bypass uac to gain admin by using windir and slui" fullword wide
      $s8 = "-Command Add-MpPreference -ExclusionPath \"C:\\\"" fullword wide
      $s9 = "SCHTASKS.exe" fullword wide
      $s10 = "--> !idletime = Get the idle time of user's on target computer" fullword wide
      $s11 = "--> !listprocess = Get all process's" fullword wide
      $s12 = "Discord rat.exe" fullword wide
      $s13 = "--> !website = open a website on the infected computer / syntax = \"!website www.google.com\"" fullword wide
      $s14 = "--> !rootkit = Launch a rootkit (the process will be hidden from taskmgr and you wont be able to see the file)(Admin rights are " wide
      $s15 = "--> !download = Download a file from infected computer" fullword wide
      $s16 = "'Discord_rat.Program+<ShellCommand>d__34" fullword ascii
      $s17 = "Command executed!" fullword wide
      $s18 = "NetSh.exe" fullword wide
      $s19 = "password.txt" fullword wide
      $s20 = "--> !upload = Upload file to the infected computer / Syntax = \"!upload file.png\" (with attachment)" fullword wide
   condition:
      uint16(0) == 0x5a4d and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule sig_36e6a3dd4bfc86c4e707f43cd9515707442d6c424b7661cb41766cfdca322522 {
   meta:
      description = "samples - file 36e6a3dd4bfc86c4e707f43cd9515707442d6c424b7661cb41766cfdca322522.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "36e6a3dd4bfc86c4e707f43cd9515707442d6c424b7661cb41766cfdca322522"
   strings:
      $x1 = "PGma.System.MouseKeyHook, Version=5.6.130.0, Culture=neutral, PublicKeyToken=null" fullword ascii
      $x2 = "DQuasar.Common, Version=1.4.1.0, Culture=neutral, PublicKeyToken=null" fullword ascii
      $s3 = "lSystem.Resources.ResourceReader, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089#System.Resources.R" ascii
      $s4 = "Process already elevated." fullword wide
      $s5 = "get_PotentiallyVulnerablePasswords" fullword ascii
      $s6 = "error processing extended key usage extension" fullword wide
      $s7 = "Private key passed - public key expected." fullword wide
      $s8 = "Public key passed - private key expected" fullword wide
      $s9 = "attempt to process message to long for cipher" fullword wide
      $s10 = "Key length invalid. Key needs to be 32 byte - 256 bit!!!" fullword wide
      $s11 = "PublicKeyEncryptedSession" fullword ascii
      $s12 = "unable to process key - " fullword wide
      $s13 = "PKCS12 key store MAC invalid - wrong password or corrupted file." fullword wide
      $s14 = "Validation already attempted for round 1 payload for " fullword wide
      $s15 = "Validation already attempted for round 2 payload for " fullword wide
      $s16 = "Validation already attempted for round 3 payload for " fullword wide
      $s17 = "System.Collections.Generic.IEnumerator<Gma.System.MouseKeyHook.KeyPressEventArgsExt>.get_Current" fullword ascii
      $s18 = "GetKeyloggerLogsDirectoryResponse" fullword ascii
      $s19 = "System.Collections.Generic.IEnumerable<Gma.System.MouseKeyHook.KeyPressEventArgsExt>.GetEnumerator" fullword ascii
      $s20 = "get_KeyEncryptionAlgParams" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 10000KB and
      1 of ($x*) and 4 of them
}

rule sig_6ea0f794612002992d031fdec0e12d70df57ae9077ad3bcb817bb9e4115b2d40 {
   meta:
      description = "samples - file 6ea0f794612002992d031fdec0e12d70df57ae9077ad3bcb817bb9e4115b2d40.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "6ea0f794612002992d031fdec0e12d70df57ae9077ad3bcb817bb9e4115b2d40"
   strings:
      $x1 = "RSCP.Desktop.Components.Core, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null" fullword ascii
      $s2 = "lSystem.Resources.ResourceReader, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089#System.Resources.R" ascii
      $s3 = "\" id=\"W5M0MpCehiHzreSzNTczkc9d\"?> <x:xmpmeta xmlns:x=\"adobe:ns:meta/\" x:xmptk=\"Adobe XMP Core 6.0-c006 79.dabacbb, 2021/04" ascii
      $s4 = "\" id=\"W5M0MpCehiHzreSzNTczkc9d\"?> <x:xmpmeta xmlns:x=\"adobe:ns:meta/\" x:xmptk=\"Adobe XMP Core 5.6-c145 79.163499, 2018/08/" ascii
      $s5 = "\" id=\"W5M0MpCehiHzreSzNTczkc9d\"?> <x:xmpmeta xmlns:x=\"adobe:ns:meta/\" x:xmptk=\"Adobe XMP Core 5.6-c145 79.163499, 2018/08/" ascii
      $s6 = "\" id=\"W5M0MpCehiHzreSzNTczkc9d\"?> <x:xmpmeta xmlns:x=\"adobe:ns:meta/\" x:xmptk=\"Adobe XMP Core 6.0-c006 79.dabacbb, 2021/04" ascii
      $s7 = "\" id=\"W5M0MpCehiHzreSzNTczkc9d\"?> <x:xmpmeta xmlns:x=\"adobe:ns:meta/\" x:xmptk=\"Adobe XMP Core 6.0-c006 79.dabacbb, 2021/04" ascii
      $s8 = "\" id=\"W5M0MpCehiHzreSzNTczkc9d\"?> <x:xmpmeta xmlns:x=\"adobe:ns:meta/\" x:xmptk=\"Adobe XMP Core 6.0-c006 79.dabacbb, 2021/04" ascii
      $s9 = "\" id=\"W5M0MpCehiHzreSzNTczkc9d\"?> <x:xmpmeta xmlns:x=\"adobe:ns:meta/\" x:xmptk=\"Adobe XMP Core 5.6-c145 79.163499, 2018/08/" ascii
      $s10 = "\" id=\"W5M0MpCehiHzreSzNTczkc9d\"?> <x:xmpmeta xmlns:x=\"adobe:ns:meta/\" x:xmptk=\"Adobe XMP Core 5.6-c145 79.163499, 2018/08/" ascii
      $s11 = "\" id=\"W5M0MpCehiHzreSzNTczkc9d\"?> <x:xmpmeta xmlns:x=\"adobe:ns:meta/\" x:xmptk=\"Adobe XMP Core 6.0-c006 79.dabacbb, 2021/04" ascii
      $s12 = "\" id=\"W5M0MpCehiHzreSzNTczkc9d\"?> <x:xmpmeta xmlns:x=\"adobe:ns:meta/\" x:xmptk=\"Adobe XMP Core 5.6-c145 79.163499, 2018/08/" ascii
      $s13 = "\" id=\"W5M0MpCehiHzreSzNTczkc9d\"?> <x:xmpmeta xmlns:x=\"adobe:ns:meta/\" x:xmptk=\"Adobe XMP Core 6.0-c006 79.dabacbb, 2021/04" ascii
      $s14 = "\" id=\"W5M0MpCehiHzreSzNTczkc9d\"?> <x:xmpmeta xmlns:x=\"adobe:ns:meta/\" x:xmptk=\"Adobe XMP Core 5.6-c145 79.163499, 2018/08/" ascii
      $s15 = "hSystem.Drawing.Bitmap, System.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3aPADPADaoY" fullword ascii
      $s16 = "SCP.Desktop.Client.Operation.exe" fullword wide
      $s17 = "VVVVVVVVVVVVT" fullword ascii /* base64 encoded string 'UUUUUUUUU' */
      $s18 = "CopyCommand_Executed" fullword ascii
      $s19 = "SSCP.Desktop.Client.IssueView, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null" fullword ascii
      $s20 = "sSCP.Desktop.Core.TimeZoneTransferConverter, SCP.Desktop.Core, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 2000KB and
      1 of ($x*) and 4 of them
}

rule ea520d8e6ca1d44593f26ceea349d55709ebd61565f67368947d38e484f5846f {
   meta:
      description = "samples - file ea520d8e6ca1d44593f26ceea349d55709ebd61565f67368947d38e484f5846f.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "ea520d8e6ca1d44593f26ceea349d55709ebd61565f67368947d38e484f5846f"
   strings:
      $x1 = "https://raw.githubusercontent.com/LimerBoy/StormKitty/master/StormKitty/stub/packages/DotNetZip.1.13.8/lib/net40/DotNetZip.dll" fullword wide
      $x2 = "Client.Modules.Passwords.Targets.System" fullword ascii
      $s3 = "Client.Modules.Passwords.Targets.VPN" fullword ascii
      $s4 = "cmdvrt32.dll" fullword wide
      $s5 = "Client.Modules.Passwords.Targets.Browsers.Chromium" fullword ascii
      $s6 = "Client.Modules.Passwords.Targets.Messengers" fullword ascii
      $s7 = "Client.Modules.Passwords.Targets.Gaming" fullword ascii
      $s8 = "Client.Modules.Passwords.Targets" fullword ascii
      $s9 = "Client.Modules.Passwords.Targets.Browsers" fullword ascii
      $s10 = "Client.Modules.Passwords.Targets.Browsers.Firefox" fullword ascii
      $s11 = "Client.Modules.Passwords.Targets.Browsers.Internet_Explorer" fullword ascii
      $s12 = "Client.Modules.Passwords.Targets.Browsers.Edge" fullword ascii
      $s13 = "processhacker" fullword wide
      $s14 = "ProcessExecutablePath" fullword ascii
      $s15 = "SELECT ExecutablePath, ProcessID FROM Win32_Process" fullword wide
      $s16 = "\\Process.txt" fullword wide
      $s17 = "SxIn.dll" fullword wide
      $s18 = "DotNetZip.dll" fullword wide
      $s19 = "Client.exe" fullword wide
      $s20 = "WorldWindClient.exe" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 500KB and
      1 of ($x*) and 4 of them
}

rule sig_521d404952876e51d0cf3a4d0d69e30566406a3a129343d5e53d5d7274f4d3dc {
   meta:
      description = "samples - file 521d404952876e51d0cf3a4d0d69e30566406a3a129343d5e53d5d7274f4d3dc.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "521d404952876e51d0cf3a4d0d69e30566406a3a129343d5e53d5d7274f4d3dc"
   strings:
      $x1 = "fSystem.Drawing.Icon, System.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3ajSystem.CodeDom.MemberAtt" ascii
      $x2 = "fSystem.Drawing.Icon, System.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3ajSystem.CodeDom.MemberAtt" ascii
      $s3 = "lSystem.Resources.ResourceReader, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089#System.Resources.R" ascii
      $s4 = "vJiGl01UUJfXfNWas3.DyyVDbaRvM1YfIq9il+AXBrnIFfMAfABnJrF9+z0oyxsqySXMDuI4ZyY`1[[System.Object, mscorlib, Version=4.0.0.0, Culture" ascii
      $s5 = "hSystem.Drawing.Bitmap, System.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3aPADPADZ" fullword ascii
      $s6 = "ExecuteActivityWorkItemPool" fullword ascii
      $s7 = "ExecuteSynchronousExpressionWorkItemPool" fullword ascii
      $s8 = "ersion=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089fSystem.Drawing.Size, System.Drawing, Version=4.0.0.0, Culture=n" ascii
      $s9 = "ributes, System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089mSystem.Globalization.CultureInfo, mscorlib, V" ascii
      $s10 = "simplemusic.exe" fullword wide
      $s11 = "AsyncCodeActivity.BeginExecute must return an IAsyncResult where IAsyncResult.AsyncState is the state object provided by the run" ascii
      $s12 = "OnExecuteComplete" fullword ascii
      $s13 = "'s metadata cannot be manipulated.  This error might also indicate that you are attempting to execute a workflow whose root acti" ascii
      $s14 = "An error occurred while attempting to extract the target object of type '{0}' from the method call expression '{1}'.  Note that " ascii
      $s15 = "4System.Web.Services.Protocols.SoapHttpClientProtocol" fullword ascii
      $s16 = "The Variable bound to the 'Target' InArgument has a null value. The 'Target' InArgument should be set using a valid Compensation" ascii
      $s17 = "HasNotExecuted" fullword ascii
      $s18 = "ExecuteInResolutionContextUntyped" fullword ascii
      $s19 = "ExecuteActionBookmark" fullword ascii
      $s20 = "\\System.Activities.Hosting.WorkflowInstanceExtensionCollection+<GetInstanceExtensions>d__26`1" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 14000KB and
      1 of ($x*) and 4 of them
}

rule sig_0843b763880a4e1b559d29140afff5cd867bcada20eda6db2524d4e5045af114 {
   meta:
      description = "samples - file 0843b763880a4e1b559d29140afff5cd867bcada20eda6db2524d4e5045af114.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "0843b763880a4e1b559d29140afff5cd867bcada20eda6db2524d4e5045af114"
   strings:
      $x1 = "fSystem.Drawing.Icon, System.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3ajSystem.CodeDom.MemberAtt" ascii
      $x2 = "fSystem.Drawing.Icon, System.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3ajSystem.CodeDom.MemberAtt" ascii
      $s3 = "lSystem.Resources.ResourceReader, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089#System.Resources.R" ascii
      $s4 = "vJiGl01UUJfXfNWas3.DyyVDbaRvM1YfIq9il+AXBrnIFfMAfABnJrF9+z0oyxsqySXMDuI4ZyY`1[[System.Object, mscorlib, Version=4.0.0.0, Culture" ascii
      $s5 = "hSystem.Drawing.Bitmap, System.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3aPADPADZ" fullword ascii
      $s6 = "ExecuteActivityWorkItemPool" fullword ascii
      $s7 = "ExecuteSynchronousExpressionWorkItemPool" fullword ascii
      $s8 = "ersion=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089fSystem.Drawing.Size, System.Drawing, Version=4.0.0.0, Culture=n" ascii
      $s9 = "ributes, System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089mSystem.Globalization.CultureInfo, mscorlib, V" ascii
      $s10 = "tashkentsoft.exe" fullword wide
      $s11 = "AsyncCodeActivity.BeginExecute must return an IAsyncResult where IAsyncResult.AsyncState is the state object provided by the run" ascii
      $s12 = "OnExecuteComplete" fullword ascii
      $s13 = "'s metadata cannot be manipulated.  This error might also indicate that you are attempting to execute a workflow whose root acti" ascii
      $s14 = "An error occurred while attempting to extract the target object of type '{0}' from the method call expression '{1}'.  Note that " ascii
      $s15 = "4System.Web.Services.Protocols.SoapHttpClientProtocol" fullword ascii
      $s16 = "The Variable bound to the 'Target' InArgument has a null value. The 'Target' InArgument should be set using a valid Compensation" ascii
      $s17 = "HasNotExecuted" fullword ascii
      $s18 = "ExecuteInResolutionContextUntyped" fullword ascii
      $s19 = "ExecuteActionBookmark" fullword ascii
      $s20 = "\\System.Activities.Hosting.WorkflowInstanceExtensionCollection+<GetInstanceExtensions>d__26`1" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 14000KB and
      1 of ($x*) and 4 of them
}

rule sig_19e14e5ffefce00e9a96101005e11ce743f039f102dadc668827ea6a444de691 {
   meta:
      description = "samples - file 19e14e5ffefce00e9a96101005e11ce743f039f102dadc668827ea6a444de691.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "19e14e5ffefce00e9a96101005e11ce743f039f102dadc668827ea6a444de691"
   strings:
      $x1 = "user.config{0}\\FileZilla\\sitemanager.xmlcookies.sqlite\\Program Files (x86)\\configRoninWalletdisplayNamehost_key\\Electrum\\w" wide
      $x2 = "[^\\u0020-\\u007F]ProcessIdname_on_cardencrypted_valuehttps://ipinfo.io/ip%appdata%\\logins{0}\\FileZilla\\recentservers.xml%app" wide
      $s3 = "Happy.exe" fullword ascii
      $s4 = "DownloadAndExecuteUpdate" fullword ascii
      $s5 = "egram.exe" fullword wide
      $s6 = "Implosions.exe" fullword wide
      $s7 = "System.Collections.Generic.IEnumerable<ScannedFile>.GetEnumerator" fullword ascii
      $s8 = "System.Collections.Generic.IEnumerator<ScannedFile>.get_Current" fullword ascii
      $s9 = "get_TaskProcessors" fullword ascii
      $s10 = "*autofillexpiraas21tion_yas21earffnbelfdoeiohenkjibnmadjiehjhajbProfilesTotal of RAMhttps://api.ip.sb/geoip%USERPEnvironmentROFI" wide
      $s11 = "get_encrypted_key" fullword ascii
      $s12 = "<Logins>k__BackingField" fullword ascii
      $s13 = "set_Processes" fullword ascii
      $s14 = "<Processes>k__BackingField" fullword ascii
      $s15 = "BCrypt.BCryptGetProperty() (get size) failed with status code:{0}" fullword wide
      $s16 = "BCrypt.BCryptGetProperty() failed with status code:{0}" fullword wide
      $s17 = "ITaskProcessor" fullword ascii
      $s18 = "get_ScanGeckoBrowsersPaths" fullword ascii
      $s19 = "System.Collections.Generic.IEnumerator<ScannedFile>.Current" fullword ascii
      $s20 = "ListOfProcesses" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 300KB and
      1 of ($x*) and 4 of them
}

rule e4d67649c7704c50925bcd3fe6ac345cba54d118407f28f6550b398671b0284e {
   meta:
      description = "samples - file e4d67649c7704c50925bcd3fe6ac345cba54d118407f28f6550b398671b0284e.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "e4d67649c7704c50925bcd3fe6ac345cba54d118407f28f6550b398671b0284e"
   strings:
      $x1 = "user.config{0}\\FileZilla\\sitemanager.xmlcookies.sqlite\\Program Files (x86)\\configRoninWalletdisplayNamehost_key\\Electrum\\w" wide
      $x2 = "[^\\u0020-\\u007F]ProcessIdname_on_cardencrypted_valuehttps://ipinfo.io/ip%appdata%\\logins{0}\\FileZilla\\recentservers.xml%app" wide
      $s3 = "Happy.exe" fullword ascii
      $s4 = "DownloadAndExecuteUpdate" fullword ascii
      $s5 = "egram.exe" fullword wide
      $s6 = "Implosions.exe" fullword wide
      $s7 = "System.Collections.Generic.IEnumerable<ScannedFile>.GetEnumerator" fullword ascii
      $s8 = "System.Collections.Generic.IEnumerator<ScannedFile>.get_Current" fullword ascii
      $s9 = "get_TaskProcessors" fullword ascii
      $s10 = "*autofillexpiraas21tion_yas21earffnbelfdoeiohenkjibnmadjiehjhajbProfilesTotal of RAMhttps://api.ip.sb/geoip%USERPEnvironmentROFI" wide
      $s11 = "get_encrypted_key" fullword ascii
      $s12 = "blackhatrussia.com clean" fullword wide
      $s13 = "<Logins>k__BackingField" fullword ascii
      $s14 = "set_Processes" fullword ascii
      $s15 = "<Processes>k__BackingField" fullword ascii
      $s16 = "BCrypt.BCryptGetProperty() (get size) failed with status code:{0}" fullword wide
      $s17 = "BCrypt.BCryptGetProperty() failed with status code:{0}" fullword wide
      $s18 = "ITaskProcessor" fullword ascii
      $s19 = "get_ScanGeckoBrowsersPaths" fullword ascii
      $s20 = "System.Collections.Generic.IEnumerator<ScannedFile>.Current" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 300KB and
      1 of ($x*) and 4 of them
}

rule sig_6b2b45511ae0d69b6b56f7ef9250154eef125db09138d5eef1a50312fc7ae438 {
   meta:
      description = "samples - file 6b2b45511ae0d69b6b56f7ef9250154eef125db09138d5eef1a50312fc7ae438.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "6b2b45511ae0d69b6b56f7ef9250154eef125db09138d5eef1a50312fc7ae438"
   strings:
      $s1 = "lSystem.Resources.ResourceReader, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089#System.Resources.R" ascii
      $s2 = "vzjv.exe" fullword wide
      $s3 = "circleProgressBar_Target" fullword wide
      $s4 = "vzjv.pdb" fullword ascii
      $s5 = "GetRotorConnections" fullword ascii
      $s6 = "KeyStroke" fullword ascii
      $s7 = "GetReverseConnections" fullword ascii
      $s8 = "GetConnectionCount" fullword ascii
      $s9 = "EnigmaEncrypt" fullword ascii
      $s10 = "GetRotorChars" fullword ascii
      $s11 = "get_TextRight" fullword ascii
      $s12 = "<GetFontString>b__24_1" fullword ascii
      $s13 = "<GetFontString>b__24_0" fullword ascii
      $s14 = "get_TextTop" fullword ascii
      $s15 = "GetXorByte" fullword ascii
      $s16 = "GetGValue" fullword ascii
      $s17 = "GetSizeHorizontal" fullword ascii
      $s18 = "get_TextBottom" fullword ascii
      $s19 = "GetFontString" fullword ascii
      $s20 = "CircleProgressBar" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 2000KB and
      8 of them
}

rule sig_6659e8c041d7b2bf5ca0756ea730d0f8cfb7a81da170c1e4c4210df200b0dee2 {
   meta:
      description = "samples - file 6659e8c041d7b2bf5ca0756ea730d0f8cfb7a81da170c1e4c4210df200b0dee2.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "6659e8c041d7b2bf5ca0756ea730d0f8cfb7a81da170c1e4c4210df200b0dee2"
   strings:
      $s1 = "lSystem.Resources.ResourceReader, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089#System.Resources.R" ascii
      $s2 = "fSystem.Drawing.Icon, System.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3agSystem.Drawing.Point, Sy" ascii
      $s3 = "fSystem.Drawing.Icon, System.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3agSystem.Drawing.Point, Sy" ascii
      $s4 = "stem.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3aBj" fullword ascii
      $s5 = "JoQF.exe" fullword wide
      $s6 = "openFileDialog1" fullword wide
      $s7 = "colorDialog1" fullword ascii
      $s8 = "OpenFileDialog1" fullword ascii
      $s9 = "SaveFileDialog1" fullword ascii
      $s10 = "GetXorByte" fullword ascii
      $s11 = "GetGValue" fullword ascii
      $s12 = "DialogToolStripMenuItem" fullword wide
      $s13 = "48586A6B+746475" fullword wide /* hex encoded string 'HXjktdu' */
      $s14 = "colorDialog1.TrayLocation" fullword wide
      $s15 = "openFileDialog1.TrayLocation" fullword wide
      $s16 = "<n:\"`Xm" fullword ascii
      $s17 = "PictureViewer.Properties.Resources.resources" fullword ascii
      $s18 = "SW:\"Dn" fullword ascii
      $s19 = "PictureViewer.Properties" fullword ascii
      $s20 = "Lab4CSharp.Form1.resources" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 2000KB and
      8 of them
}

rule f745359274019b502bda094e4c58c5e553e32cd56dcd72fb7984ad2e706a8eb6 {
   meta:
      description = "samples - file f745359274019b502bda094e4c58c5e553e32cd56dcd72fb7984ad2e706a8eb6.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "f745359274019b502bda094e4c58c5e553e32cd56dcd72fb7984ad2e706a8eb6"
   strings:
      $s1 = "s1YpHdcyGt5VbxyZmrI.kofkmecnTCltcsKhFis+f6h2i4P6EQDvxcWiKH4+zYFf18PbBswpuTCN2a3`1[[System.Object, mscorlib, Version=4.0.0.0, Cul" ascii
      $s2 = "KernelBase.dll" fullword ascii
      $s3 = "SpotifyStartupTask.exe" fullword wide
      $s4 = "s1YpHdcyGt5VbxyZmrI.kofkmecnTCltcsKhFis+f6h2i4P6EQDvxcWiKH4+zYFf18PbBswpuTCN2a3`1[[System.Object, mscorlib, Version=4.0.0.0, Cul" ascii
      $s5 = "System.Collections.Generic.ICollection<H37.o75>.get_Count" fullword ascii
      $s6 = "System.Collections.Generic.IEnumerable<ns64.B45>.GetEnumerator" fullword ascii
      $s7 = "System.Collections.Generic.IEnumerator<ns64.B45>.get_Current" fullword ascii
      $s8 = "System.Collections.Generic.IList<H37.o75>.get_Item" fullword ascii
      $s9 = "System.Collections.Generic.ICollection<H37.o75>.get_IsReadOnly" fullword ascii
      $s10 = "System.Collections.Generic.IEnumerable<H37.o75>.GetEnumerator" fullword ascii
      $s11 = "Process " fullword wide
      $s12 = "jDSPyJofTpWNeOtoChEC" fullword ascii
      $s13 = "fDNpbyRWSs" fullword ascii /* base64 encoded string '|3io$VJ' */
      $s14 = "RVNuQ1E7PT" fullword ascii /* base64 encoded string 'ESnCQ;=' */
      $s15 = "XVIlO0xYWC" fullword ascii /* base64 encoded string ']R%;LXX' */
      $s16 = "ture=neutral, PublicKeyToken=b77a5c561934e089]][]" fullword ascii
      $s17 = "System.IO.Stream.get_Length" fullword ascii
      $s18 = "System.IO.Stream.get_Position" fullword ascii
      $s19 = "OnJ8VGFsUU" fullword ascii /* base64 encoded string ':r|TalQ' */
      $s20 = "bVp3fGk7K3" fullword ascii /* base64 encoded string 'mZw|i;+' */
   condition:
      uint16(0) == 0x5a4d and filesize < 6000KB and
      8 of them
}

rule sig_17e36536f236d0effd2850906ccd9972beb6f73a994fe8c1bb03c2a850f453bb {
   meta:
      description = "samples - file 17e36536f236d0effd2850906ccd9972beb6f73a994fe8c1bb03c2a850f453bb.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "17e36536f236d0effd2850906ccd9972beb6f73a994fe8c1bb03c2a850f453bb"
   strings:
      $x1 = "srvcli.dll" fullword wide /* reversed goodware string 'lld.ilcvrs' */
      $x2 = "devrtl.dll" fullword wide /* reversed goodware string 'lld.ltrved' */
      $x3 = "dfscli.dll" fullword wide /* reversed goodware string 'lld.ilcsfd' */
      $x4 = "browcli.dll" fullword wide /* reversed goodware string 'lld.ilcworb' */
      $x5 = "linkinfo.dll" fullword wide /* reversed goodware string 'lld.ofniknil' */
      $s6 = "atl.dll" fullword wide /* reversed goodware string 'lld.lta' */
      $s7 = "\"C:\\comContainerdllDhcpCommon\\winruntime.exe\">" fullword ascii
      $s8 = "QrVwlRyEP5Ji9ADflis.SoFFUvypL3hjEKB0ave+UtAH7dyNQcH8awgTxON+aKRnVtyLyXedaj0k9St`1[[System.Object, mscorlib, Version=4.0.0.0, Cul" ascii
      $s9 = "winruntime.exe" fullword ascii
      $s10 = "SSPICLI.DLL" fullword wide
      $s11 = "UXTheme.dll" fullword wide
      $s12 = "oleaccrc.dll" fullword wide
      $s13 = "dnsapi.DLL" fullword wide
      $s14 = "iphlpapi.DLL" fullword wide
      $s15 = "WINNSI.DLL" fullword wide
      $s16 = "sfxrar.exe" fullword ascii
      $s17 = "Cannot create folder %sHChecksum error in the encrypted file %s. Corrupt file or wrong password." fullword wide
      $s18 = "D:\\Projects\\WinRAR\\sfx\\build\\sfxrar32\\Release\\sfxrar.pdb" fullword ascii
      $s19 = "QrVwlRyEP5Ji9ADflis.SoFFUvypL3hjEKB0ave+UtAH7dyNQcH8awgTxON+aKRnVtyLyXedaj0k9St`1[[System.Object, mscorlib, Version=4.0.0.0, Cul" ascii
      $s20 = "OyhRJIDeovjV4e36nZsMtGedO.bat" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 4000KB and
      1 of ($x*) and 4 of them
}

rule b3fe1e7404ddef2f09b8f51c5c2010e799ebf69f647e7e519a4305dc2b3a5695 {
   meta:
      description = "samples - file b3fe1e7404ddef2f09b8f51c5c2010e799ebf69f647e7e519a4305dc2b3a5695.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "b3fe1e7404ddef2f09b8f51c5c2010e799ebf69f647e7e519a4305dc2b3a5695"
   strings:
      $x1 = "srvcli.dll" fullword wide /* reversed goodware string 'lld.ilcvrs' */
      $x2 = "devrtl.dll" fullword wide /* reversed goodware string 'lld.ltrved' */
      $x3 = "dfscli.dll" fullword wide /* reversed goodware string 'lld.ilcsfd' */
      $x4 = "browcli.dll" fullword wide /* reversed goodware string 'lld.ilcworb' */
      $x5 = "linkinfo.dll" fullword wide /* reversed goodware string 'lld.ofniknil' */
      $x6 = "VisualStudio.Shell.Framework.dll" fullword wide
      $s7 = "atl.dll" fullword wide /* reversed goodware string 'lld.lta' */
      $s8 = "%cyrr%\"%AppData%\\YandexBrowser/data/Runtimeperfdhcp.exe\"%vXwQvgFFM%[$" fullword ascii
      $s9 = "H4fOkMVHt5Dn4jka3Qc.DsTmQwVp2TOXZMIl1js+qH9xgbIT73sDPFHIyWN+cwpImZIZ7QwKeVCTnid`1[[System.Object, mscorlib, Version=4.0.0.0, Cul" ascii
      $s10 = "Runtimeperfdhcp.exe" fullword ascii
      $s11 = "KernelBase.dll" fullword ascii
      $s12 = "SSPICLI.DLL" fullword wide
      $s13 = "UXTheme.dll" fullword wide
      $s14 = "oleaccrc.dll" fullword wide
      $s15 = "dnsapi.DLL" fullword wide
      $s16 = "iphlpapi.DLL" fullword wide
      $s17 = "WINNSI.DLL" fullword wide
      $s18 = "sfxrar.exe" fullword ascii
      $s19 = "%lEmRkiMQuTOcRma%reg add HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System /v DisableTaskMgr /t REG_DWORD /d " ascii
      $s20 = "%lEmRkiMQuTOcRma%reg add HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System /v DisableTaskMgr /t REG_DWORD /d " ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 13000KB and
      1 of ($x*) and 4 of them
}

rule f139a9c30967f1e0edaa605531560bf18ee4f190ab3b01b3540f1aefd20adcdb {
   meta:
      description = "samples - file f139a9c30967f1e0edaa605531560bf18ee4f190ab3b01b3540f1aefd20adcdb.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "f139a9c30967f1e0edaa605531560bf18ee4f190ab3b01b3540f1aefd20adcdb"
   strings:
      $s1 = "OmikKTMGGMjuEqFfVLj.IcQrX4M8DtvgLxfZU8m+JOgWHdAuJH7sUeVRaMl+TetQP4AD2WDFsj6VNRt`1[[System.Object, mscorlib, Version=4.0.0.0, Cul" ascii
      $s2 = "KernelBase.dll" fullword ascii
      $s3 = "SpotifyStartupTask.exe" fullword wide
      $s4 = "OmikKTMGGMjuEqFfVLj.IcQrX4M8DtvgLxfZU8m+JOgWHdAuJH7sUeVRaMl+TetQP4AD2WDFsj6VNRt`1[[System.Object, mscorlib, Version=4.0.0.0, Cul" ascii
      $s5 = "System.Collections.Generic.ICollection<H37.o75>.get_Count" fullword ascii
      $s6 = "System.Collections.Generic.IEnumerable<ns64.B45>.GetEnumerator" fullword ascii
      $s7 = "System.Collections.Generic.IEnumerator<ns64.B45>.get_Current" fullword ascii
      $s8 = "System.Collections.Generic.IList<H37.o75>.get_Item" fullword ascii
      $s9 = "System.Collections.Generic.ICollection<H37.o75>.get_IsReadOnly" fullword ascii
      $s10 = "System.Collections.Generic.IEnumerable<H37.o75>.GetEnumerator" fullword ascii
      $s11 = "Process " fullword wide
      $s12 = "dCEhd2M1Tq" fullword ascii /* base64 encoded string 't!!wc5N' */
      $s13 = "d1xGSn1fcf" fullword ascii /* base64 encoded string 'w\FJ}_q' */
      $s14 = "ture=neutral, PublicKeyToken=b77a5c561934e089]][]" fullword ascii
      $s15 = "System.IO.Stream.get_Length" fullword ascii
      $s16 = "System.IO.Stream.get_Position" fullword ascii
      $s17 = "w1L1O76mIRcIOQ9JmN.OUJYeIxknRKs9ZGMwX" fullword wide
      $s18 = "RMf9xxH26aIs2k8uki.dLZlGVep0cEpfRL6I7" fullword wide
      $s19 = "System.Collections.Generic.IEnumerable<ns89.Class64>.GetEnumerator" fullword ascii
      $s20 = "System.Collections.Generic.IEnumerator<ns89.Class64>.get_Current" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 6000KB and
      8 of them
}

rule sig_00ac7453507e85b001b89a7f20524ff12798d195c87189278d21eaad01582a20 {
   meta:
      description = "samples - file 00ac7453507e85b001b89a7f20524ff12798d195c87189278d21eaad01582a20.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "00ac7453507e85b001b89a7f20524ff12798d195c87189278d21eaad01582a20"
   strings:
      $s1 = "AMD Processor.exe" fullword wide
      $s2 = "lSystem.Resources.ResourceReader, mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089#System.Resources.R" ascii
      $s3 = "hSystem.Drawing.Bitmap, System.Drawing, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3aPADPAD_" fullword ascii
      $s4 = "DecData.dll" fullword wide
      $s5 = "AMD Processor$" fullword ascii
      $s6 = "AMD Processor" fullword wide
      $s7 = "QU1EIFByb2Nlc3NvciQ=" fullword wide /* base64 encoded string 'AMD Processor$' */
      $s8 = "QU1EIFByb2Nlc3Nvcio=" fullword wide /* base64 encoded string 'AMD Processor*' */
      $s9 = "B.NET Runtime Optimization Servic" fullword wide
      $s10 = " 2002-2017 by Company & Sons" fullword wide
      $s11 = " Microsoft Operations Puerto Rico1" fullword ascii
      $s12 = "_Encrypted$" fullword wide
      $s13 = "dynamic method does not support fault clause" fullword wide
      $s14 = "unexpected OperandType " fullword wide
      $s15 = "Company & Sons" fullword wide
      $s16 = "0fad3ec3.Resources.resources" fullword ascii
      $s17 = "DINGXXPADDINGPADDINGXXPAD" fullword ascii
      $s18 = "DINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPAD" ascii
      $s19 = "Taewexulyruqiraevy" fullword ascii
      $s20 = "Ximagurizhenukaloseluka" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 6000KB and
      8 of them
}

rule sig_8601904fb878151c3dfa821f653e529747f50a961854bec78014e9e2ed44b9cc {
   meta:
      description = "samples - file 8601904fb878151c3dfa821f653e529747f50a961854bec78014e9e2ed44b9cc.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "8601904fb878151c3dfa821f653e529747f50a961854bec78014e9e2ed44b9cc"
   strings:
      $x1 = "cmd.exe /c ping 0 -n 2 & del \"" fullword wide
      $s2 = "Execute ERROR" fullword wide
      $s3 = "WindowsServices.exe" fullword wide
      $s4 = "processhacker" fullword wide
      $s5 = "Stub.exe" fullword ascii
      $s6 = "Tools.exe" fullword wide
      $s7 = "Execute ERROR " fullword wide
      $s8 = "4System.Web.Services.Protocols.SoapHttpClientProtocol" fullword ascii
      $s9 = "winmgmts:\\\\.\\root\\SecurityCenter2" fullword wide
      $s10 = "Download ERROR" fullword wide
      $s11 = "Executed As " fullword wide
      $s12 = "processInformationLength" fullword ascii
      $s13 = "CsAntiProcess" fullword ascii
      $s14 = "SpyTheSpy" fullword wide
      $s15 = "procexp" fullword wide
      $s16 = "wireshark" fullword wide
      $s17 = "smsniff" fullword wide
      $s18 = "getvalue" fullword wide
      $s19 = "Update ERROR" fullword wide
      $s20 = "processInformationClass" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 90KB and
      1 of ($x*) and 4 of them
}

rule sig_753d66621ae168b5968406b8c2ad1845f1c9bf42f47556e7646d14e8484adeb8 {
   meta:
      description = "samples - file 753d66621ae168b5968406b8c2ad1845f1c9bf42f47556e7646d14e8484adeb8.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "753d66621ae168b5968406b8c2ad1845f1c9bf42f47556e7646d14e8484adeb8"
   strings:
      $s1 = "windowsecurityhealth.exe" fullword wide
      $s2 = "Windows Defender.exe" fullword ascii
      $s3 = "<StartAsBypass>b__10_0" fullword ascii
      $s4 = "aRSNoRmBGYmi" fullword ascii /* base64 encoded string 'E#hF`Fbh' */
      $s5 = "PmtkLEVmSl" fullword ascii /* base64 encoded string '>kd,EfJ' */
      $s6 = "NcFUyfkVh" fullword ascii /* base64 encoded string 'pU2~Ea' */
      $s7 = "fHdLeWFlREn" fullword ascii /* base64 encoded string '|wKyaeDI' */
      $s8 = "bSZUQkguI" fullword ascii /* base64 encoded string 'm&TBH.' */
      $s9 = "YQjJHYzci" fullword ascii /* base64 encoded string 'B2Gc7"' */
      $s10 = "SaDlYQEknazX" fullword ascii /* base64 encoded string 'h9X@I'k5' */
      $s11 = "blUzVABnz" fullword ascii /* base64 encoded string 'nU3T g' */
      $s12 = "NVAxKio6O" fullword wide /* base64 encoded string '5P1**:' */
      $s13 = "fX1bbDtM2" fullword wide /* base64 encoded string '}}[l;L' */
      $s14 = "xaObSPyZg" fullword ascii
      $s15 = "kKRwEyeUmk" fullword ascii
      $s16 = "pIuJehUfTPuITMi" fullword ascii
      $s17 = "mFLaaIRCuHaOsJ" fullword ascii
      $s18 = "qqMzEamySPyvdG" fullword ascii
      $s19 = "DoFtPeUzDNNbHBV" fullword ascii
      $s20 = "eZydLLQB" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 1000KB and
      8 of them
}

rule ec180bdb56a4f587fd198e4bb4d20f488a0124228bfed11ff62f2a20d0d9e618 {
   meta:
      description = "samples - file ec180bdb56a4f587fd198e4bb4d20f488a0124228bfed11ff62f2a20d0d9e618.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "ec180bdb56a4f587fd198e4bb4d20f488a0124228bfed11ff62f2a20d0d9e618"
   strings:
      $x1 = "C:\\Users\\ADMIN\\source\\repos\\FUDE\\FUDE\\obj\\Release\\FUDE.pdb" fullword ascii
      $s2 = "http://s355vlx.storage.yandex.net/rdisk/a2dca1babaa95e6be61bb81085ada861493d1dda8cfacd1d9055fd0be821e96b/66af8c32/AiwRdOOLiCrkwW" wide
      $s3 = "Failed to inject file into explorer.exe." fullword wide
      $s4 = "Failed to get handle to kernel32.dll." fullword wide
      $s5 = "Failed to get address of CreateProcessW." fullword wide
      $s6 = "FUDE.exe" fullword wide
      $s7 = "file.exe" fullword wide
      $s8 = "File injected into explorer.exe successfully." fullword wide
      $s9 = "Error injecting file: " fullword wide
      $s10 = "File downloaded, started, and injected successfully." fullword wide
      $s11 = "Failed to start process." fullword wide
      $s12 = "Error starting process: " fullword wide
      $s13 = "Failed to open explorer process." fullword wide
      $s14 = "Failed to write file path to explorer process memory." fullword wide
      $s15 = "Failed to create remote thread in explorer process." fullword wide
      $s16 = "StartProcessHidden" fullword ascii
      $s17 = "processAccess" fullword ascii
      $s18 = "Process started successfully." fullword wide
      $s19 = "Explorer process not found." fullword wide
      $s20 = "InjectFileIntoExplorer" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 30KB and
      1 of ($x*) and 4 of them
}

rule aed40572bcca2051adca7ab4e50bde872343503b340ceeec3a4719ab39e518ea {
   meta:
      description = "samples - file aed40572bcca2051adca7ab4e50bde872343503b340ceeec3a4719ab39e518ea.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "aed40572bcca2051adca7ab4e50bde872343503b340ceeec3a4719ab39e518ea"
   strings:
      $x1 = "blyIdentity type=\"win32\" name=\"Microsoft.Windows.Common-Controls\" version=\"6.0.0.0\" processorArchitecture=\"x86\" publicKe" ascii
      $x2 = "C:\\Documents and Settings\\All Users\\Start Menu\\Programs\\Startup\\SVCHOST.SCR" fullword ascii
      $x3 = "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?><assembly xmlns=\"urn:schemas-microsoft-com:asm.v1\" manifestVersio" ascii
      $x4 = "C:\\WINDOWS\\temp\\svchost.exe" fullword ascii
      $x5 = "FBrowserCEF3Subprocess.exe" fullword ascii
      $x6 = "taskkill /f /im KSafeTray.exe" fullword ascii
      $s7 = "C:\\WINDOWS\\system32\\ctfmon1.exe" fullword ascii
      $s8 = "C:\\WINDOWS\\temp\\2011.exe" fullword ascii
      $s9 = "FBroBrowserFrame_ExecuteJavaScriptToHasReturn" fullword ascii
      $s10 = "C:\\Users\\Administrator\\Documents\\" fullword ascii
      $s11 = "C:\\Documents and Settings\\All Users\\" fullword ascii
      $s12 = "FBroBrowserFrame_ExecuteJavaScript" fullword ascii
      $s13 = "https://wenku.baidu.com/gdoc/download/down" fullword ascii
      $s14 = "Host: wenku.baidu.com" fullword ascii
      $s15 = "FBroBrowserHost_ExecuteDevToolsMethod" fullword ascii
      $s16 = "recycle.{645FF040-5081-101B-9F08-00AA002F954E}\\GHOSTBAK.exe" fullword ascii
      $s17 = "FBrowserCEF3lib.dll" fullword ascii
      $s18 = "hjcvmk.dll" fullword ascii
      $s19 = "E2EECore.%s.dll" fullword ascii
      $s20 = "FBroBrowserHost_ExecuteDevToolsMethod_Syn" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 15000KB and
      1 of ($x*) and 4 of them
}

rule a8fcd268b48c903e21500439d6754500d59d12d7d5d4e2c7ea737661fa8fe230 {
   meta:
      description = "samples - file a8fcd268b48c903e21500439d6754500d59d12d7d5d4e2c7ea737661fa8fe230.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "a8fcd268b48c903e21500439d6754500d59d12d7d5d4e2c7ea737661fa8fe230"
   strings:
      $s1 = "Client.exe" fullword wide
      $s2 = "ys0GCX4g8wKAXE3KbUudpLsthpnJx0g4j4RuJvvpF1G+SOoLTEloIRpX5zFGbeDyKv6eIwK2r8FX4Hht9VkeDQEt9b5yOruahOVfPNnoKVfGXCDBLCwLuLK0DOW4tuEv" wide
      $s3 = "eGt6NTBkekxJMkJUTTJTcENiQmJYZ1g2eFA3VmNSTGU=" fullword wide /* base64 encoded string 'xkz50dzLI2BTM2SpCbBbXgX6xP7VcRLe' */
      $s4 = "QW1zaVNjYW5CdWZmZXI=" fullword wide /* base64 encoded string 'AmsiScanBuffer' */
      $s5 = "VmlydHVhbFByb3RlY3Q=" fullword wide /* base64 encoded string 'VirtualProtect' */
      $s6 = "U09GVFdBUkVcTWljcm9zb2Z0XFdpbmRvd3NcQ3VycmVudFZlcnNpb25cUnVuXA==" fullword wide /* base64 encoded string 'SOFTWARE\Microsoft\Windows\CurrentVersion\Run\' */
      $s7 = "NeSHR7qaMreL/vr6Is3S8avMDBuedKZqS8+hTe/t0EwThiV8bJVAlUwyDJtQe5/5P8Kw8c1iUPXO/q0bjV1uc/xDBkdA/Ea94Mkf5TSqgeOfEMGRsKViLRwMOLnbUOVH" wide
      $s8 = "L2Mgc2NodGFza3MgL2NyZWF0ZSAvZiAvc2Mgb25sb2dvbiAvcmwgaGlnaGVzdCAvdG4g" fullword wide /* base64 encoded string '/c schtasks /create /f /sc onlogon /rl highest /tn ' */
      $s9 = "lpAddress" fullword ascii /* Goodware String - occured 17 times */
      $s10 = "lpflOldProtect" fullword ascii /* Goodware String - occured 1 times */
      $s11 = "flNewProtect" fullword ascii /* Goodware String - occured 1 times */
      $s12 = "CreateApi" fullword ascii
      $s13 = "DelegateVirtualProtect" fullword ascii
      $s14 = "LoadApi" fullword ascii
      $s15 = "Bzi0OKUZ2T6BbODZxPGx+mfJBcgxKQVWqWzR0vJgepzIQOQU7XyKZjguwsxPbc++JtQkk5fyhynGiJMJrm8X8g==" fullword wide
      $s16 = "ZRr+1qkasBH+wo3FUdWEjNuRKmNMJgFGPinv9WqzeLMwb60fVjVeqmtNANGFGCGexFWYDmnBhTbhuavN35OVtjgZXhSf+kUW5rxqtQnKjJE=" fullword wide
      $s17 = "vqdQXsVIWKEJCti2HNuDdr2ZOWDoos5UBNoOQ9kThuv2f/Tg/mnAq0u890v6aOtu6DsmdZx7ox333fqaYN5eEQ==" fullword wide
      $s18 = "jBY54ugpd/hjNnmmJZCdBvQACT1G26kLau5nFEF3pOl7Pmp8ciJYt0XHDlO9xbsPWB4UJK495MaT1nvmKTomJA==" fullword wide
      $s19 = "x0YuuR34Rh5yl/YCIs6c1k3tNK64mG3f8tuRTby2I0N0YPEdwgWhKaRPvETyLkeslFS+xDKoF0RqTNiC0w7Q7lPtokacGwhRIBNPkjZslPY=" fullword wide
      $s20 = "t7yEqr39gukpafWADvxY0iPTzk1SzeYL/qNN/fjLCFZjKTTaY1NY/y+W2P2Pr0WRMh6RKIP1v7/4VjM09oer9g==" fullword wide
   condition:
      uint16(0) == 0x5a4d and filesize < 100KB and
      8 of them
}

rule c3c657fa980e2ddcd6fc94d3464fea9816a4d5803c6ec80dee6a8b11fed28d36 {
   meta:
      description = "samples - file c3c657fa980e2ddcd6fc94d3464fea9816a4d5803c6ec80dee6a8b11fed28d36.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "c3c657fa980e2ddcd6fc94d3464fea9816a4d5803c6ec80dee6a8b11fed28d36"
   strings:
      $x1 = "GoneopenStat.com.bat.cmdnullbooljson'\\''quit3125Atoiint8uintchanfunccallkind != ermssse3avx2bmi1bmi2bitsNameTypeFrom.css.gif.ht" ascii
      $x2 = "9] (types from different scopes)notetsleep - waitm out of syncfailed to get system page sizeassignment to entry in nil map/cpu/c" ascii
      $x3 = "ysweepWaiterstraceStringsspanSetSpinemspanSpecialgcBitsArenasmheapSpecialgcpacertracemadvdontneedharddecommitdumping heapchan re" ascii
      $x4 = "goroutine profileAllThreadsSyscallGC assist markingselect (no cases)sync.RWMutex.Lockwait for GC cycletrace proc status: missing" ascii
      $x5 = "runtime: unable to acquire - semaphore out of syncmallocgc called with gcphase == _GCmarkterminationrecursive call during initia" ascii
      $x6 = "lization - linker skewattempt to execute system stack code on user stackcompileCallback: function argument frame too largeFWb" fullword ascii
      $s7 = "floating point errorGC sweep terminationResetDebugLog (test)chan send (nil chan)flushing proc cachesmalloc during signalclose of" ascii
      $s8 = "read on pipeunixIdleOpenDATAPINGHost&lt;&gt;1080POSTEtag0x%xdateetagfromhostlinkvarypathDategzip%x" fullword ascii
      $s9 = "of activeSweepmheap.freeSpanLocked - invalid freeattempt to clear non-empty span setruntime: close polldesc w/o unblockruntime: " ascii
      $s10 = "LmJinteger divide by zeroCountPagesInUse (test)ReadMetricsSlow (test)trace reader (blocked)trace goroutine statussend on closed " ascii
      $s11 = "truntime: typeBitsBulkBarrier without type/memory/classes/metadata/mspan/free:bytesruntime.SetFinalizer: second argument is gcSw" ascii
      $s12 = "mheap.freeSpanLocked - invalid free of user arena chunkcasfrom_Gscanstatus:top gp->status is not in scan state is currently not " ascii
      $s13 = "eSpanLocked - invalid span stateattempted to add zero-sized address rangeruntime: blocked read on closing polldescstopTheWorld: " ascii
      $s14 = "ysweepWaiterstraceStringsspanSetSpinemspanSpecialgcBitsArenasmheapSpecialgcpacertracemadvdontneedharddecommitdumping heapchan re" ascii
      $s15 = "EDactiveclosedsocks5Basic CookiecookieexpectoriginserverExpectPragmasocks Lockedrenameexec: remotehangup Value390625uint16uint32" ascii
      $s16 = "9] (types from different scopes)notetsleep - waitm out of syncfailed to get system page sizeassignment to entry in nil map/cpu/c" ascii
      $s17 = "0*persistentalloc: align is too large/memory/classes/heap/released:bytesgreyobject: obj not pointer-alignedmismatched begin/end " ascii
      $s18 = "notesleep - waitm out of sync/cpu/classes/idle:cpu-seconds/cpu/classes/user:cpu-seconds/gc/heap/allocs-by-size:bytes/gc/stack/st" ascii
      $s19 = "unlock: lock countprogToPointerMask: overflow/gc/cycles/forced:gc-cycles/memory/classes/other:bytes/memory/classes/total:bytesfa" ascii
      $s20 = "allocmRInternalwrite heap dumpasyncpreemptoffforce gc (idle)sync.Mutex.Lockmalloc deadlockruntime error: scan missed a gmisalign" ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 21000KB and
      1 of ($x*) and 4 of them
}

rule sig_7df44db488eeb747b7875331dfc29481aaf77789fe909f8dbf5d84abf072e2b2 {
   meta:
      description = "samples - file 7df44db488eeb747b7875331dfc29481aaf77789fe909f8dbf5d84abf072e2b2.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "7df44db488eeb747b7875331dfc29481aaf77789fe909f8dbf5d84abf072e2b2"
   strings:
      $x1 = "C:\\Users\\Private\\Downloads\\DragonBurn-stable\\DragonBurn-stable\\built\\DragonBurn.pdb" fullword ascii
      $x2 = "C:\\Users\\Private\\Downloads\\DragonBurn-stable\\DragonBurn-stable\\DragonBurn\\OS-ImGui\\imgui\\imgui_demo.cpp" fullword ascii
      $s3 = "\" id=\"W5M0MpCehiHzreSzNTczkc9d\"?> <x:xmpmeta xmlns:x=\"adobe:ns:meta/\" x:xmptk=\"Adobe XMP Core 6.0-c002 79.164460, 2020/05/" ascii
      $s4 = "schannel: Failed to import cert file %s, password is bad" fullword ascii
      $s5 = "VCRUNTIME140_1.dll" fullword ascii
      $s6 = "client.dll" fullword ascii
      $s7 = "server.dll" fullword ascii
      $s8 = "SEC_E_ILLEGAL_MESSAGE (0x%08X) - This error usually occurs when a fatal SSL/TLS alert is received (e.g. handshake failed). More " ascii
      $s9 = "Failed reading the chunked-encoded stream" fullword ascii
      $s10 = "[+] Thread Created Sucessfully - Private Store!" fullword ascii
      $s11 = "Negotiate: noauthpersist -> %d, header part: %s" fullword ascii
      $s12 = "\" id=\"W5M0MpCehiHzreSzNTczkc9d\"?> <x:xmpmeta xmlns:x=\"adobe:ns:meta/\" x:xmptk=\"Adobe XMP Core 6.0-c002 79.164460, 2020/05/" ascii
      $s13 = "\" id=\"W5M0MpCehiHzreSzNTczkc9d\"?> <x:xmpmeta xmlns:x=\"adobe:ns:meta/\" x:xmptk=\"Adobe XMP Core 6.0-c002 79.164460, 2020/05/" ascii
      $s14 = "\" id=\"W5M0MpCehiHzreSzNTczkc9d\"?> <x:xmpmeta xmlns:x=\"adobe:ns:meta/\" x:xmptk=\"Adobe XMP Core 6.0-c002 79.164460, 2020/05/" ascii
      $s15 = "\" id=\"W5M0MpCehiHzreSzNTczkc9d\"?> <x:xmpmeta xmlns:x=\"adobe:ns:meta/\" x:xmptk=\"Adobe XMP Core 6.0-c002 79.164460, 2020/05/" ascii
      $s16 = "\" id=\"W5M0MpCehiHzreSzNTczkc9d\"?> <x:xmpmeta xmlns:x=\"adobe:ns:meta/\" x:xmptk=\"Adobe XMP Core 6.0-c002 79.164460, 2020/05/" ascii
      $s17 = "\" id=\"W5M0MpCehiHzreSzNTczkc9d\"?> <x:xmpmeta xmlns:x=\"adobe:ns:meta/\" x:xmptk=\"Adobe XMP Core 6.0-c002 79.164460, 2020/05/" ascii
      $s18 = "\" id=\"W5M0MpCehiHzreSzNTczkc9d\"?> <x:xmpmeta xmlns:x=\"adobe:ns:meta/\" x:xmptk=\"Adobe XMP Core 6.0-c002 79.164460, 2020/05/" ascii
      $s19 = "\" id=\"W5M0MpCehiHzreSzNTczkc9d\"?> <x:xmpmeta xmlns:x=\"adobe:ns:meta/\" x:xmptk=\"Adobe XMP Core 6.0-c002 79.164460, 2020/05/" ascii
      $s20 = "DragDrop: %d, SourceId = 0x%08X, Payload \"%s\" (%d bytes)" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 7000KB and
      1 of ($x*) and 4 of them
}

rule dbfd6c69423e517932f611242d5c6a287d7dd8512e947283eded1b0e0223e461 {
   meta:
      description = "samples - file dbfd6c69423e517932f611242d5c6a287d7dd8512e947283eded1b0e0223e461.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "dbfd6c69423e517932f611242d5c6a287d7dd8512e947283eded1b0e0223e461"
   strings:
      $x1 = "http://185.101.104.92/fuck.sys" fullword ascii
      $s2 = "start C:\\Windows\\System\\mapp.exe C:\\Windows\\System\\fuck.sys" fullword ascii
      $s3 = "C:\\Windows\\System\\fuck.sys" fullword ascii
      $s4 = "http://185.101.104.92/mapp.exe" fullword ascii
      $s5 = "C:\\Windows\\System\\mapp.exe" fullword ascii
      $s6 = "schannel: Failed to import cert file %s, password is bad" fullword ascii
      $s7 = "VCRUNTIME140_1.dll" fullword ascii
      $s8 = "SEC_E_ILLEGAL_MESSAGE (0x%08X) - This error usually occurs when a fatal SSL/TLS alert is received (e.g. handshake failed). More " ascii
      $s9 = "Failed reading the chunked-encoded stream" fullword ascii
      $s10 = "Negotiate: noauthpersist -> %d, header part: %s" fullword ascii
      $s11 = "failed to load WS2_32.DLL (%u)" fullword ascii
      $s12 = "lastlogin" fullword ascii
      $s13 = "schannel: CertGetNameString() failed to match connection hostname (%s) against server certificate names" fullword ascii
      $s14 = "start cmd /C \"color b && title Error && echo " fullword ascii
      $s15 = "FortniteClient-Win64-Shipping.exe" fullword ascii
      $s16 = "LOGINDISL" fullword ascii
      $s17 = "No more connections allowed to host %s: %zu" fullword ascii
      $s18 = "RESOLVE %s:%d is - old addresses discarded!" fullword ascii
      $s19 = "Content-Disposition: %s%s%s%s%s%s%s" fullword ascii
      $s20 = "Content-Type: %s%s%s" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 3000KB and
      1 of ($x*) and 4 of them
}

rule sig_837dc4e83fcefc8334384c88d672eb2dee31bceb64657ca7bb4322536a810192 {
   meta:
      description = "samples - file 837dc4e83fcefc8334384c88d672eb2dee31bceb64657ca7bb4322536a810192.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "837dc4e83fcefc8334384c88d672eb2dee31bceb64657ca7bb4322536a810192"
   strings:
      $x1 = "C:\\Users\\Admin\\Desktop\\masscan-master\\bin\\masscan.pdb" fullword ascii
      $x2 = "User-Agent: masscan/1.0 (https://github.com/robertdavidgraham/masscan)" fullword ascii
      $s3 = "Usage: masscan [Options] -p{Target-Ports} {Target-IP-Ranges}" fullword ascii
      $s4 = "GetProcessAffinityMask() returned error %u" fullword ascii
      $s5 = "Via: HTTP/1.1 ir14.fp.bf1.yahoo.com (YahooTrafficServer/1.2.0.13 [c s f ])" fullword ascii
      $s6 = "urchin.com" fullword ascii
      $s7 = "youtube.com" fullword ascii
      $s8 = "googlecommerce.com" fullword ascii
      $s9 = "*.youtube-nocookie.com" fullword ascii
      $s10 = "# TARGET SELECTION (IP, PORTS, EXCLUDES)" fullword ascii
      $s11 = " -- forced options: -sS -Pn -n --randomize-hosts -v --send-eth" fullword ascii
      $s12 = "android.com" fullword ascii
      $s13 = "FAIL: target IP address list empty" fullword ascii
      $s14 = "http-user-agent = %.*s" fullword ascii
      $s15 = "payloads:'%s': imported %u unique payloads" fullword ascii
      $s16 = "# Ports scanned: TCP(%u;" fullword ascii
      $s17 = "*.urchin.com" fullword ascii
      $s18 = "*.android.com" fullword ascii
      $s19 = "google-analytics.com" fullword ascii
      $s20 = "*.youtube.com" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 600KB and
      1 of ($x*) and 4 of them
}

rule eb7aa3469a93e430a4954aaab1520f3b7ebb66055e621a27e79842f4c8db6ea8 {
   meta:
      description = "samples - file eb7aa3469a93e430a4954aaab1520f3b7ebb66055e621a27e79842f4c8db6ea8.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "eb7aa3469a93e430a4954aaab1520f3b7ebb66055e621a27e79842f4c8db6ea8"
   strings:
      $x1 = "<file name=\"winhttp.dll\" loadFrom=\"%SystemRoot%\\system32\\\" />" fullword ascii
      $x2 = "<file name=\"version.dll\" loadFrom=\"%SystemRoot%\\system32\\\" />" fullword ascii
      $x3 = "<file name=\"comctl32.dll\" loadFrom=\"%SystemRoot%\\system32\\\" />" fullword ascii
      $s4 = "<file name=\"textshaping.dll\" loadFrom=\"%SystemRoot%\\system32\\\" />" fullword ascii
      $s5 = "<file name=\"mpr.dll\" loadFrom=\"%SystemRoot%\\system32\\\" />" fullword ascii
      $s6 = "<file name=\"netutils.dll\" loadFrom=\"%SystemRoot%\\system32\\\" />" fullword ascii
      $s7 = "<file name=\"netapi32.dll\" loadFrom=\"%SystemRoot%\\system32\\\" />" fullword ascii
      $s8 = "SystemphH" fullword ascii /* base64 encoded string 'K+-zja' */
      $s9 = "SetupLdr.exe" fullword ascii
      $s10 = "FHeaderProcessed" fullword ascii
      $s11 = "For more detailed information, please visit https://jrsoftware.org/ishelp/index.php?topic=setupcmdline" fullword wide
      $s12 = "SystemlQC" fullword ascii /* base64 encoded string 'K+-ziP' */
      $s13 = "SystemtNH" fullword ascii /* base64 encoded string 'K+-zkM' */
      $s14 = ":http://secure.globalsign.com/cacert/codesigningrootr45.crt0A" fullword ascii
      $s15 = "7http://cacerts.digicert.com/DigiCertAssuredIDRootCA.crt0E" fullword ascii
      $s16 = "5http://cacerts.digicert.com/DigiCertTrustedRootG4.crt0C" fullword ascii
      $s17 = "-http://ocsp.globalsign.com/codesigningrootr450F" fullword ascii
      $s18 = "2http://crl3.digicert.com/DigiCertTrustedRootG4.crl0 " fullword ascii
      $s19 = "4http://crl3.digicert.com/DigiCertAssuredIDRootCA.crl0" fullword ascii
      $s20 = "0http://crl.globalsign.com/codesigningrootr45.crl0V" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 6000KB and
      1 of ($x*) and 4 of them
}

rule e583a74eee0a4dca05e41b16b1d384302c7130f2c88e3e9fd6602901f6afdb9a {
   meta:
      description = "samples - file e583a74eee0a4dca05e41b16b1d384302c7130f2c88e3e9fd6602901f6afdb9a.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "e583a74eee0a4dca05e41b16b1d384302c7130f2c88e3e9fd6602901f6afdb9a"
   strings:
      $x1 = "<file name=\"winhttp.dll\" loadFrom=\"%SystemRoot%\\system32\\\" />" fullword ascii
      $x2 = "<file name=\"version.dll\" loadFrom=\"%SystemRoot%\\system32\\\" />" fullword ascii
      $x3 = "<file name=\"comctl32.dll\" loadFrom=\"%SystemRoot%\\system32\\\" />" fullword ascii
      $s4 = "<file name=\"textshaping.dll\" loadFrom=\"%SystemRoot%\\system32\\\" />" fullword ascii
      $s5 = "<file name=\"mpr.dll\" loadFrom=\"%SystemRoot%\\system32\\\" />" fullword ascii
      $s6 = "<file name=\"netutils.dll\" loadFrom=\"%SystemRoot%\\system32\\\" />" fullword ascii
      $s7 = "<file name=\"netapi32.dll\" loadFrom=\"%SystemRoot%\\system32\\\" />" fullword ascii
      $s8 = "SystemphH" fullword ascii /* base64 encoded string 'K+-zja' */
      $s9 = "SetupLdr.exe" fullword ascii
      $s10 = "FHeaderProcessed" fullword ascii
      $s11 = "For more detailed information, please visit https://jrsoftware.org/ishelp/index.php?topic=setupcmdline" fullword wide
      $s12 = "SystemlQC" fullword ascii /* base64 encoded string 'K+-ziP' */
      $s13 = "SystemtNH" fullword ascii /* base64 encoded string 'K+-zkM' */
      $s14 = ":http://secure.globalsign.com/cacert/codesigningrootr45.crt0A" fullword ascii
      $s15 = "7http://cacerts.digicert.com/DigiCertAssuredIDRootCA.crt0E" fullword ascii
      $s16 = "5http://cacerts.digicert.com/DigiCertTrustedRootG4.crt0C" fullword ascii
      $s17 = "-http://ocsp.globalsign.com/codesigningrootr450F" fullword ascii
      $s18 = "2http://crl3.digicert.com/DigiCertTrustedRootG4.crl0 " fullword ascii
      $s19 = "4http://crl3.digicert.com/DigiCertAssuredIDRootCA.crl0" fullword ascii
      $s20 = "0http://crl.globalsign.com/codesigningrootr45.crl0V" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 6000KB and
      1 of ($x*) and 4 of them
}

rule sig_49dc64191a08c389e43a7b765975fe2119b0b5228172fbf5e76d5cabd9afc80e {
   meta:
      description = "samples - file 49dc64191a08c389e43a7b765975fe2119b0b5228172fbf5e76d5cabd9afc80e.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "49dc64191a08c389e43a7b765975fe2119b0b5228172fbf5e76d5cabd9afc80e"
   strings:
      $s1 = "failed to to lock creation mutex" fullword ascii
      $s2 = "failed to to lock cleanup mutex" fullword ascii
      $s3 = "C:\\crossdev\\gccmaster\\build-tdm64\\runtime\\mingw-w64-crt" fullword ascii
      $s4 = "mutex_name" fullword ascii
      $s5 = "        <requestedExecutionLevel level=\"asInvoker\"/>" fullword ascii
      $s6 = "mutex.c" fullword ascii
      $s7 = "mutex_impl_init" fullword ascii
      $s8 = "processthreadsapi.h" fullword ascii
      $s9 = ".reloc_target" fullword ascii
      $s10 = "failed to get string from atom" fullword ascii
      $s11 = "  VirtualQuery failed for %d bytes at address %p" fullword ascii
      $s12 = "C:\\crossdev\\gccmaster\\build-tdm64\\gcc-seh\\x86_64-w64-mingw32\\libgcc" fullword ascii
      $s13 = "/__mingw_winmain_lpCmdLine" fullword ascii
      $s14 = "GNU C17 10.3.0 -mtune=generic -march=x86-64 -g -O2 -O2 -O2 -fbuilding-libgcc -fno-stack-protector" fullword ascii
      $s15 = "__pthread_get_pointer" fullword ascii
      $s16 = "__mingw_winmain_lpCmdLine" fullword ascii
      $s17 = "__shmem_get_error" fullword ascii
      $s18 = "GNU C99 10.3.0 -m64 -mtune=generic -march=x86-64 -g -O2 -std=gnu99" fullword ascii
      $s19 = ">lpszCommandLine" fullword ascii
      $s20 = "_pthread_get_tick_count" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 2000KB and
      8 of them
}

rule sig_4f30db298f99fc45d153f6568529228c98e1ad173249c1f76424977bd0b373c2 {
   meta:
      description = "samples - file 4f30db298f99fc45d153f6568529228c98e1ad173249c1f76424977bd0b373c2.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "4f30db298f99fc45d153f6568529228c98e1ad173249c1f76424977bd0b373c2"
   strings:
      $s1 = "failed to to lock creation mutex" fullword ascii
      $s2 = "failed to to lock cleanup mutex" fullword ascii
      $s3 = "C:\\crossdev\\gccmaster\\build-tdm64\\runtime\\mingw-w64-crt" fullword ascii
      $s4 = "mutex_name" fullword ascii
      $s5 = "        <requestedExecutionLevel level=\"asInvoker\"/>" fullword ascii
      $s6 = "mutex.c" fullword ascii
      $s7 = "mutex_impl_init" fullword ascii
      $s8 = "processthreadsapi.h" fullword ascii
      $s9 = ".reloc_target" fullword ascii
      $s10 = "failed to get string from atom" fullword ascii
      $s11 = "  VirtualQuery failed for %d bytes at address %p" fullword ascii
      $s12 = "C:\\crossdev\\gccmaster\\build-tdm64\\gcc-seh\\x86_64-w64-mingw32\\libgcc" fullword ascii
      $s13 = "/__mingw_winmain_lpCmdLine" fullword ascii
      $s14 = "GNU C17 10.3.0 -mtune=generic -march=x86-64 -g -O2 -O2 -O2 -fbuilding-libgcc -fno-stack-protector" fullword ascii
      $s15 = "__pthread_get_pointer" fullword ascii
      $s16 = "__mingw_winmain_lpCmdLine" fullword ascii
      $s17 = "__shmem_get_error" fullword ascii
      $s18 = "GNU C99 10.3.0 -m64 -mtune=generic -march=x86-64 -g -O2 -std=gnu99" fullword ascii
      $s19 = ">lpszCommandLine" fullword ascii
      $s20 = "_pthread_get_tick_count" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 2000KB and
      8 of them
}

rule a37770babd802e2e67c301280ab05dd85859827ab81b8053b32fecabd34eee32 {
   meta:
      description = "samples - file a37770babd802e2e67c301280ab05dd85859827ab81b8053b32fecabd34eee32.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "a37770babd802e2e67c301280ab05dd85859827ab81b8053b32fecabd34eee32"
   strings:
      $s1 = "Failed to get address for PyImport_ExecCodeModule" fullword ascii
      $s2 = "Failed to get address for Py_NoUserSiteDirectory" fullword ascii
      $s3 = "Failed to execute script %s" fullword ascii
      $s4 = "Failed to get executable path." fullword ascii
      $s5 = "  <assemblyIdentity name=\"rev_special\" processorArchitecture=\"amd64\" type=\"win32\" version=\"1.0.0.0\"/>" fullword ascii
      $s6 = "      <assemblyIdentity name=\"Microsoft.VC90.CRT\" processorArchitecture=\"amd64\" publicKeyToken=\"1fc8b3b9a1e18e3b\" type=\"w" ascii
      $s7 = "Failed to get address for PyRun_SimpleString" fullword ascii
      $s8 = "Failed to get address for Py_FileSystemDefaultEncoding" fullword ascii
      $s9 = "Failed to get address for PyMarshal_ReadObjectFromString" fullword ascii
      $s10 = "Failed to get address for PyUnicode_Decode" fullword ascii
      $s11 = "Failed to get address for PyUnicode_DecodeFSDefault" fullword ascii
      $s12 = "Failed to get address for PyList_Append" fullword ascii
      $s13 = "Failed to get address for PyErr_Print" fullword ascii
      $s14 = "Failed to get address for PyErr_Clear" fullword ascii
      $s15 = "Failed to get address for _Py_char2wchar" fullword ascii
      $s16 = "Error loading Python DLL '%s'." fullword ascii
      $s17 = "Failed to get address for Py_Initialize" fullword ascii
      $s18 = "Failed to get address for PyImport_AddModule" fullword ascii
      $s19 = "Failed to get address for PyUnicode_FromFormat" fullword ascii
      $s20 = "Failed to get address for Py_SetPythonHome" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 29000KB and
      8 of them
}

rule sig_54fc0c13fb380fae11507d3f853c1ef4818b8f87169e6912ad56dbaaf520512d {
   meta:
      description = "samples - file 54fc0c13fb380fae11507d3f853c1ef4818b8f87169e6912ad56dbaaf520512d.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "54fc0c13fb380fae11507d3f853c1ef4818b8f87169e6912ad56dbaaf520512d"
   strings:
      $s1 = "Otipxcw.exe" fullword wide
      $s2 = "* ^IT~" fullword ascii
      $s3 = "dqN:\\2f" fullword ascii
      $s4 = "Otipxcw.Properties" fullword ascii
      $s5 = "pF-->y" fullword ascii
      $s6 = "Otipxcw" fullword ascii
      $s7 = "qL;%!." fullword ascii
      $s8 = "`z5/C+ " fullword ascii
      $s9 = "+ zwz," fullword ascii
      $s10 = "t//.rGK" fullword ascii
      $s11 = "qUxgX!" fullword ascii
      $s12 = "QVeK+~_" fullword ascii
      $s13 = "V)GcRsG P^6" fullword ascii
      $s14 = "ekGA){b" fullword ascii
      $s15 = "QVGm-v\\" fullword ascii
      $s16 = "HWeB\\c" fullword ascii
      $s17 = "OPvwQy}" fullword ascii
      $s18 = "Ytgcrn,}" fullword ascii
      $s19 = "z7ulRf!i" fullword ascii
      $s20 = "QNxh94L" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 2000KB and
      8 of them
}

rule sig_014d6c58dd7459c1664196ccd49b796f861d7d7e7e6c573bbb9cdc7cadc21450 {
   meta:
      description = "samples - file 014d6c58dd7459c1664196ccd49b796f861d7d7e7e6c573bbb9cdc7cadc21450.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "014d6c58dd7459c1664196ccd49b796f861d7d7e7e6c573bbb9cdc7cadc21450"
   strings:
      $s1 = "Kvrpgr.exe" fullword wide
      $s2 = "cyehrmo" fullword ascii
      $s3 = "J:\"}yM" fullword ascii
      $s4 = "Kvrpgr.Properties" fullword ascii
      $s5 = "91A1F6C5D4F595D33EFC7FB6987D7A6238B8992EC1C61D8505CFFAA6374F44E3" ascii
      $s6 = "_eYE1zjQ" fullword ascii
      $s7 = "$K^ -BW" fullword ascii
      $s8 = " -9D#PS" fullword ascii
      $s9 = "EQ6a%y%" fullword ascii
      $s10 = "*-9* >" fullword ascii
      $s11 = " -jaWH" fullword ascii
      $s12 = "`- Eg\"" fullword ascii
      $s13 = "EHLR?G" fullword ascii
      $s14 = ",jVXZc?" fullword ascii
      $s15 = "yZDK@ Bq" fullword ascii
      $s16 = "apXN}g#?V+" fullword ascii
      $s17 = "=~lWfG_Di" fullword ascii
      $s18 = ")zVnj0}w" fullword ascii
      $s19 = "GpOuf\"" fullword ascii
      $s20 = "uglz#gT/" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 2000KB and
      8 of them
}

rule sig_2449fe334bbf8f09ff80422578a6c6961d20a0a456b214f6490c5ed1ae859c9e {
   meta:
      description = "samples - file 2449fe334bbf8f09ff80422578a6c6961d20a0a456b214f6490c5ed1ae859c9e.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "2449fe334bbf8f09ff80422578a6c6961d20a0a456b214f6490c5ed1ae859c9e"
   strings:
      $x1 = "C:\\Users\\vvv\\Pictures\\SC\\Maj\\DROPPER V2\\Release\\Dropper.pdb" fullword ascii
      $x2 = "C:\\Windows\\System32\\ntdll.dll" fullword ascii
      $s3 = "D:\\a\\_work\\1\\s\\src\\vctools\\crt\\github\\stl\\src\\mutex.cpp(151): unlock of unowned mutex" fullword ascii
      $s4 = "UnRAR.dll" fullword ascii
      $s5 = "Password for encrypted file or header is not specified" fullword ascii
      $s6 = "Bminkernel\\crts\\ucrt\\src\\appcrt\\internal\\report_runtime_error.cpp" fullword wide
      $s7 = "AppPolicyGetProcessTerminationMethod" fullword ascii
      $s8 = "http://185.196.9.187/em_TaWHWZA1_installer_Win7-Win11_x86_x64.msi" fullword ascii
      $s9 = "Error loading UnRAR.dll from %s" fullword ascii
      $s10 = "GetTempPath2W" fullword ascii
      $s11 = "D:\\a\\_work\\1\\s\\src\\vctools\\crt\\vcruntime\\src\\internal\\per_thread_data.cpp" fullword ascii
      $s12 = "D:\\a\\_work\\1\\s\\src\\vctools\\crt\\vcruntime\\src\\eh\\std_exception.cpp" fullword wide
      $s13 = "D:\\a\\_work\\1\\s\\src\\vctools\\crt\\vcruntime\\src\\internal\\winapi_downlevel.cpp" fullword wide
      $s14 = "UTF-8 isn't supported in this _mbtowc_l function yet!!!" fullword wide
      $s15 = "        <requestedExecutionLevel level='asInvoker' uiAccess='false' />" fullword ascii
      $s16 = "D:\\a\\_work\\1\\s\\src\\vctools\\crt\\github\\stl\\src\\StlLCMapStringA.cpp" fullword ascii
      $s17 = "C:\\Program Files\\Microsoft Visual Studio\\2022\\Community\\VC\\Tools\\MSVC\\14.40.33807\\include\\xutility" fullword wide
      $s18 = "C:\\Program Files\\Microsoft Visual Studio\\2022\\Community\\VC\\Tools\\MSVC\\14.40.33807\\include\\xstring" fullword wide
      $s19 = "C:\\Program Files\\Microsoft Visual Studio\\2022\\Community\\VC\\Tools\\MSVC\\14.40.33807\\include\\xmemory" fullword wide
      $s20 = "D:\\a\\_work\\1\\s\\src\\vctools\\crt\\github\\stl\\src\\_tolower.cpp" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 1000KB and
      1 of ($x*) and 4 of them
}

rule sig_2f502689b799fd964bced77e57edf4206809bb11da16cf4f7895df1df54cdc97 {
   meta:
      description = "samples - file 2f502689b799fd964bced77e57edf4206809bb11da16cf4f7895df1df54cdc97.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "2f502689b799fd964bced77e57edf4206809bb11da16cf4f7895df1df54cdc97"
   strings:
      $s1 = "AppPolicyGetProcessTerminationMethod" fullword ascii
      $s2 = "GetTempPath2W" fullword ascii
      $s3 = "operator<=>" fullword ascii
      $s4 = "operator co_await" fullword ascii
      $s5 = ".data$rs" fullword ascii
      $s6 = "api-ms-win-appmodel-runtime-l1-1-2" fullword wide
      $s7 = "PVSRSQV" fullword ascii
      $s8 = "Own head" fullword ascii
      $s9 = "vector too long" fullword ascii
      $s10 = "# y5U>" fullword ascii
      $s11 = "wrong protocol type" fullword ascii /* Goodware String - occured 567 times */
      $s12 = "network reset" fullword ascii /* Goodware String - occured 567 times */
      $s13 = "connection already in progress" fullword ascii /* Goodware String - occured 567 times */
      $s14 = "owner dead" fullword ascii /* Goodware String - occured 567 times */
      $s15 = "network down" fullword ascii /* Goodware String - occured 567 times */
      $s16 = "protocol not supported" fullword ascii /* Goodware String - occured 568 times */
      $s17 = "connection aborted" fullword ascii /* Goodware String - occured 568 times */
      $s18 = "network unreachable" fullword ascii /* Goodware String - occured 569 times */
      $s19 = "host unreachable" fullword ascii /* Goodware String - occured 571 times */
      $s20 = "protocol error" fullword ascii /* Goodware String - occured 588 times */
   condition:
      uint16(0) == 0x5a4d and filesize < 900KB and
      8 of them
}

rule ddeb365475b677380faf477533c9a6319f4f466b7d4be97c350dfd058966f308 {
   meta:
      description = "samples - file ddeb365475b677380faf477533c9a6319f4f466b7d4be97c350dfd058966f308.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "ddeb365475b677380faf477533c9a6319f4f466b7d4be97c350dfd058966f308"
   strings:
      $s1 = "relog.exe" fullword wide
      $s2 = "%SystemRoot%\\system32\\relog.exe" fullword wide
      $s3 = "SystemUpdate.exe" fullword wide
      $s4 = "Services.exe" fullword wide
      $s5 = "msedge.exe" fullword wide
      $s6 = "\\psvhost.exe" fullword wide
      $s7 = "www.malwarebytes.com" fullword wide
      $s8 = "www.avast.com" fullword wide
      $s9 = "www.bitdefender.com" fullword wide
      $s10 = "www.eset.com" fullword wide
      $s11 = "www.norton.com" fullword wide
      $s12 = "wdcp.microsoft.com" fullword wide
      $s13 = "wdcpalt.microsoft.com" fullword wide
      $s14 = "wdprod.microsoft.com" fullword wide
      $s15 = "wdcpes.microsoft.com" fullword wide
      $s16 = "www.comodo.com" fullword wide
      $s17 = "user_pref(\"network.http.max_response_headers_kb\", -1);" fullword wide
      $s18 = "user_pref(\"browser.safebrowsing.downloads.remote.url\", \"\");" fullword wide
      $s19 = "en.malwarebytes.com" fullword wide
      $s20 = "fr.malwarebytes.com" fullword wide
   condition:
      uint16(0) == 0x5a4d and filesize < 6000KB and
      8 of them
}

rule sig_3e9b442995fc472566f6689c275b24bb9d2a0244bd002671d471654d0b0893b0 {
   meta:
      description = "samples - file 3e9b442995fc472566f6689c275b24bb9d2a0244bd002671d471654d0b0893b0.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "3e9b442995fc472566f6689c275b24bb9d2a0244bd002671d471654d0b0893b0"
   strings:
      $s1 = "\" id=\"W5M0MpCehiHzreSzNTczkc9d\"?> <x:xmpmeta xmlns:x=\"adobe:ns:meta/\" x:xmptk=\"Adobe XMP Core 5.6-c138 79.159824, 2016/09/" ascii
      $s2 = "\" id=\"W5M0MpCehiHzreSzNTczkc9d\"?> <x:xmpmeta xmlns:x=\"adobe:ns:meta/\" x:xmptk=\"Adobe XMP Core 5.6-c138 79.159824, 2016/09/" ascii
      $s3 = "\" id=\"W5M0MpCehiHzreSzNTczkc9d\"?> <x:xmpmeta xmlns:x=\"adobe:ns:meta/\" x:xmptk=\"Adobe XMP Core 5.6-c138 79.159824, 2016/09/" ascii
      $s4 = "\" id=\"W5M0MpCehiHzreSzNTczkc9d\"?> <x:xmpmeta xmlns:x=\"adobe:ns:meta/\" x:xmptk=\"Adobe XMP Core 5.6-c138 79.159824, 2016/09/" ascii
      $s5 = "\" id=\"W5M0MpCehiHzreSzNTczkc9d\"?> <x:xmpmeta xmlns:x=\"adobe:ns:meta/\" x:xmptk=\"Adobe XMP Core 5.6-c138 79.159824, 2016/09/" ascii
      $s6 = "    <ExplainGraphNodeContent>result-set-explainviewer-show-operation-data-command</ExplainGraphNodeContent>" fullword ascii
      $s7 = "          <Path>#ExecDir#\\jdbc\\postgresql\\postgresql.jar</Path>" fullword ascii
      $s8 = "    <SQLCommanderProcessParameterMarkers>false</SQLCommanderProcessParameterMarkers>" fullword ascii
      $s9 = "    <SQLCommanderProcessVariables>true</SQLCommanderProcessVariables>" fullword ascii
      $s10 = "//ns.adobe.com/xap/1.0/\" xmlns:xmpMM=\"http://ns.adobe.com/xap/1.0/mm/\" xmlns:stRef=\"http://ns.adobe.com/xap/1.0/sType/Resour" ascii
      $s11 = "https://www.bilibili.com/" fullword ascii
      $s12 = "https://fanyi.baidu.com/" fullword ascii
      $s13 = "avi33.tmp.avi Video #1" fullword ascii
      $s14 = "github: https://github.com/" fullword ascii
      $s15 = "    <ConnectAndExecuteDefaultKey />" fullword ascii
      $s16 = "    <SQLCommanderDropObjectAction>LaunchScriptor</SQLCommanderDropObjectAction>" fullword ascii
      $s17 = "LOGIN_ANIMATION_F1" fullword wide
      $s18 = "LOGIN_ANIMATION_F2" fullword wide
      $s19 = "LOGIN_ANIMATION_F3" fullword wide
      $s20 = "LOGIN_ANIMATION_F4" fullword wide
   condition:
      uint16(0) == 0x5a4d and filesize < 2000KB and
      8 of them
}

rule d4b8014a57142265ac47b3e29f68de51eb145b62ae613f7efb8ff1fe4fb22c8c {
   meta:
      description = "samples - file d4b8014a57142265ac47b3e29f68de51eb145b62ae613f7efb8ff1fe4fb22c8c.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "d4b8014a57142265ac47b3e29f68de51eb145b62ae613f7efb8ff1fe4fb22c8c"
   strings:
      $s1 = "CreateObject(\"WScript.Shell\").Run \"cmd /c \"\"" fullword wide
      $s2 = "\\AppData\\Roaming\\Mozilla\\Firefox\\Profiles\\" fullword ascii
      $s3 = "\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\Login Data" fullword ascii
      $s4 = "fso.DeleteFile(Wscript.ScriptFullName)" fullword wide
      $s5 = "\\logins.json" fullword ascii
      $s6 = "Executing file: " fullword ascii
      $s7 = "[Firefox StoredLogins not found]" fullword ascii
      $s8 = "[Chrome StoredLogins found, cleared!]" fullword ascii
      $s9 = "[Cleared browsers logins and cookies.]" fullword ascii
      $s10 = "Cleared browsers logins and cookies." fullword ascii
      $s11 = "[Firefox StoredLogins Cleared!]" fullword ascii
      $s12 = "[Chrome StoredLogins not found]" fullword ascii
      $s13 = "\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\Cookies" fullword ascii
      $s14 = "CreateObject(\"Scripting.FileSystemObject\").DeleteFile(Wscript.ScriptFullName)" fullword wide
      $s15 = "GetDirectListeningPort" fullword ascii
      $s16 = "Connection Refused" fullword ascii
      $s17 = "\\update.vbs" fullword wide
      $s18 = "\\sysinfo.txt" fullword wide
      $s19 = "C6858E06B70404E9CD9E3ECB662395B4429C648139053FB521F828AF606B4D3DBAA14B5E77EFE75928FE1DC127A2FFA8DE3348B3C1856A429BF97E7E31C2E5BD" ascii
      $s20 = "license_code.txt" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 1000KB and
      8 of them
}

rule sig_1314eb993b4effdda7e10527b7fd8996f94c7c5cf817f23ce340647728f0e57a {
   meta:
      description = "samples - file 1314eb993b4effdda7e10527b7fd8996f94c7c5cf817f23ce340647728f0e57a.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "1314eb993b4effdda7e10527b7fd8996f94c7c5cf817f23ce340647728f0e57a"
   strings:
      $s1 = "api-ms-win-core-synch-l1-2-0.dll" fullword wide /* reversed goodware string 'lld.0-2-1l-hcnys-eroc-niw-sm-ipa' */
      $s2 = "VComdlg32.dll" fullword wide
      $s3 = "C:\\Users\\Administrator\\Documents\\Tencent Files\\295589399\\FileRecv\\" fullword ascii
      $s4 = "VKernel32.dll" fullword wide
      $s5 = "Vkernel32.dll" fullword wide
      $s6 = "euxtheme.dll" fullword wide
      $s7 = "AppPolicyGetProcessTerminationMethod" fullword ascii
      $s8 = "HP_Loder.exe" fullword ascii
      $s9 = "7http://cacerts.digicert.com/DigiCertAssuredIDRootCA.crt0E" fullword ascii
      $s10 = "5http://cacerts.digicert.com/DigiCertTrustedRootG4.crt0C" fullword ascii
      $s11 = "2http://crl3.digicert.com/DigiCertTrustedRootG4.crl0 " fullword ascii
      $s12 = "4http://crl3.digicert.com/DigiCertAssuredIDRootCA.crl0" fullword ascii
      $s13 = "D:\\a\\_work\\1\\s\\src\\vctools\\VC7Libs\\Ship\\ATLMFC\\Src\\MFC\\oledrop2.cpp" fullword ascii
      $s14 = "%s%s%X.tmp" fullword ascii
      $s15 = "http://ocsp.digicert.com0X" fullword ascii
      $s16 = "http://tsa.starfieldtech.com0" fullword ascii
      $s17 = "Lhttp://cacerts.digicert.com/DigiCertTrustedG4RSA4096SHA256TimeStampingCA.crt0" fullword ascii
      $s18 = "Ihttp://crl3.digicert.com/DigiCertTrustedG4RSA4096SHA256TimeStampingCA.crl0" fullword ascii
      $s19 = "D:\\a\\_work\\1\\s\\src\\vctools\\VC7Libs\\Ship\\ATLMFC\\Src\\MFC\\oleipfrm.cpp" fullword ascii
      $s20 = ")\\HP Loder\\Release\\HP Loder.pdb" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 15000KB and
      8 of them
}

rule sig_71af9ae73d69eff082dd445af8d96351cd106afd0ca27824d35a8a667f7ef38b {
   meta:
      description = "samples - file 71af9ae73d69eff082dd445af8d96351cd106afd0ca27824d35a8a667f7ef38b.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "71af9ae73d69eff082dd445af8d96351cd106afd0ca27824d35a8a667f7ef38b"
   strings:
      $s1 = "api-ms-win-core-synch-l1-2-0.dll" fullword wide /* reversed goodware string 'lld.0-2-1l-hcnys-eroc-niw-sm-ipa' */
      $s2 = "VComdlg32.dll" fullword wide
      $s3 = "C:\\Users\\Administrator\\Documents\\Tencent Files\\295589399\\FileRecv\\" fullword ascii
      $s4 = "VKernel32.dll" fullword wide
      $s5 = "Vkernel32.dll" fullword wide
      $s6 = "euxtheme.dll" fullword wide
      $s7 = "AppPolicyGetProcessTerminationMethod" fullword ascii
      $s8 = "HP_Loder.exe" fullword ascii
      $s9 = "7http://cacerts.digicert.com/DigiCertAssuredIDRootCA.crt0E" fullword ascii
      $s10 = "5http://cacerts.digicert.com/DigiCertTrustedRootG4.crt0C" fullword ascii
      $s11 = "2http://crl3.digicert.com/DigiCertTrustedRootG4.crl0 " fullword ascii
      $s12 = "4http://crl3.digicert.com/DigiCertAssuredIDRootCA.crl0" fullword ascii
      $s13 = "D:\\a\\_work\\1\\s\\src\\vctools\\VC7Libs\\Ship\\ATLMFC\\Src\\MFC\\oledrop2.cpp" fullword ascii
      $s14 = "%s%s%X.tmp" fullword ascii
      $s15 = "http://ocsp.digicert.com0X" fullword ascii
      $s16 = "http://tsa.starfieldtech.com0" fullword ascii
      $s17 = "Lhttp://cacerts.digicert.com/DigiCertTrustedG4RSA4096SHA256TimeStampingCA.crt0" fullword ascii
      $s18 = "Ihttp://crl3.digicert.com/DigiCertTrustedG4RSA4096SHA256TimeStampingCA.crl0" fullword ascii
      $s19 = "D:\\a\\_work\\1\\s\\src\\vctools\\VC7Libs\\Ship\\ATLMFC\\Src\\MFC\\oleipfrm.cpp" fullword ascii
      $s20 = ")\\HP Loder\\Release\\HP Loder.pdb" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 15000KB and
      8 of them
}

rule sig_4a33dd36f9cd9bdf25e3d0207a3c8ad7c04f61178ef0fe62e5c054c1f311e9a9 {
   meta:
      description = "samples - file 4a33dd36f9cd9bdf25e3d0207a3c8ad7c04f61178ef0fe62e5c054c1f311e9a9.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "4a33dd36f9cd9bdf25e3d0207a3c8ad7c04f61178ef0fe62e5c054c1f311e9a9"
   strings:
      $x1 = "\"%s\\cmd.exe\" /C start %s:" fullword wide
      $s2 = "E:\\BuildAgent\\work\\652325c68c8b38d0\\bin\\Release\\LittleInstaller.pdb" fullword ascii
      $s3 = "      <assemblyIdentity type=\"win32\" name=\"Microsoft.Windows.Common-Controls\" version=\"6.0.0.0\" processorArchitecture=\"*" ascii
      $s4 = "%LOCALAPPDATA%\\Google\\Chrome\\Application\\chrome.exe" fullword wide
      $s5 = "Diese Vereinbarung bezieht sich auf Ihre Nutzung bestimmter Software (\\'84\\i Software\\i0\\ldblquote ), Dienste oder Hardware " ascii
      $s6 = "      <assemblyIdentity type=\"win32\" name=\"Microsoft.Windows.Common-Controls\" version=\"6.0.0.0\" processorArchitecture=\"*" ascii
      $s7 = "%USERPROFILE%\\Local Settings\\Application Data\\Google\\Chrome\\Application\\chrome.exe" fullword wide
      $s8 = "%ProgramFiles%\\Mozilla Firefox\\firefox.exe" fullword wide
      $s9 = "%ProgramFiles%\\Opera\\Launcher.exe" fullword wide
      $s10 = "Foledlg.dll" fullword ascii
      $s11 = "BCRYPT.DLL" fullword wide
      $s12 = "RSAENH.DLL" fullword wide
      $s13 = "MSASN1.DLL" fullword wide
      $s14 = "GDIPLUS.DLL" fullword wide
      $s15 = "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\App Paths\\opera.exe" fullword wide
      $s16 = "Avast Driver Updater-setup.exe" fullword wide
      $s17 = ".?AVCMsiExecutor@@" fullword ascii
      $s18 = "CMsiExecutor" fullword ascii
      $s19 = "CPayloadExecutor" fullword ascii
      $s20 = ".?AVCPayloadExecutor@@" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 2000KB and
      1 of ($x*) and 4 of them
}

rule sig_3f0dea5783c2deb7a9686accab4b1e17953f4babefbcc2668428a9fc00a1c4ea {
   meta:
      description = "samples - file 3f0dea5783c2deb7a9686accab4b1e17953f4babefbcc2668428a9fc00a1c4ea.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "3f0dea5783c2deb7a9686accab4b1e17953f4babefbcc2668428a9fc00a1c4ea"
   strings:
      $s1 = "      <assemblyIdentity type=\"win32\" name=\"Microsoft.Windows.Common-Controls\" version=\"6.0.0.0\" processorArchitecture=\"*" ascii
      $s2 = "bVCRUNTIME140.dll" fullword ascii
      $s3 = "      <assemblyIdentity type=\"win32\" name=\"Microsoft.Windows.Common-Controls\" version=\"6.0.0.0\" processorArchitecture=\"*" ascii
      $s4 = "4python38.dll" fullword ascii
      $s5 = "Failed to execute script '%s' due to unhandled exception!" fullword ascii
      $s6 = "bpython38.dll" fullword ascii
      $s7 = "Failed to extract %s: failed to open target file!" fullword ascii
      $s8 = "LOADER: failed to convert runtime-tmpdir to a wide string." fullword wide
      $s9 = "LOADER: failed to expand environment variables in the runtime-tmpdir." fullword wide
      $s10 = "LOADER: runtime-tmpdir points to non-existent drive %ls (type: %d)!" fullword wide
      $s11 = "LOADER: failed to obtain the absolute path of the runtime-tmpdir." fullword wide
      $s12 = "LOADER: failed to create runtime-tmpdir path %ls!" fullword wide
      $s13 = "AppPolicyGetProcessTerminationMethod" fullword ascii
      $s14 = "blibssl-1_1.dll" fullword ascii
      $s15 = "Failed to initialize security descriptor for temporary directory!" fullword ascii
      $s16 = "blibffi-7.dll" fullword ascii
      $s17 = "blibcrypto-1_1.dll" fullword ascii
      $s18 = "%s%c%s.exe" fullword ascii
      $s19 = "Path of ucrtbase.dll (%s) and its name exceed buffer size (%d)" fullword ascii
      $s20 = "LOADER: failed to set the TMP environment variable." fullword wide
   condition:
      uint16(0) == 0x5a4d and filesize < 16000KB and
      8 of them
}

rule sig_7c49a3acfcee53e48a30f09b00ae72f0a9889b6c4d479dacff1a0ae2ae6e7258 {
   meta:
      description = "samples - file 7c49a3acfcee53e48a30f09b00ae72f0a9889b6c4d479dacff1a0ae2ae6e7258.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "7c49a3acfcee53e48a30f09b00ae72f0a9889b6c4d479dacff1a0ae2ae6e7258"
   strings:
      $s1 = "7zS.sfx.exe" fullword wide
      $s2 = "Can not find setup.exe" fullword wide
      $s3 = "RunProgram=\"Install.exe\"" fullword ascii
      $s4 = "Config failed" fullword wide
      $s5 = "# /w_J" fullword ascii
      $s6 = "* IkcO" fullword ascii
      $s7 = "2:!8`%>?)" fullword ascii /* hex encoded string '(' */
      $s8 = "u:\"?S]" fullword ascii
      $s9 = "7\"H:\\C" fullword ascii
      $s10 = "E:\\wVY" fullword ascii
      $s11 = "c:\"ZM\\4" fullword ascii
      $s12 = "eDLlz8" fullword ascii
      $s13 = "-uf:\\2" fullword ascii
      $s14 = "VyN:\"+" fullword ascii
      $s15 = "Can not create temp folder archive" fullword wide
      $s16 = "BUnsupported Method" fullword wide
      $s17 = "7zS.sfx" fullword wide
      $s18 = "!#%s,ZJ" fullword ascii
      $s19 = "WY\\%d,G`" fullword ascii
      $s20 = "\\%BL%G" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 22000KB and
      8 of them
}

rule d7db753381fdd9779be8db851e3f7a015a6f584ae4a15b546f6bac80ccfe01d7 {
   meta:
      description = "samples - file d7db753381fdd9779be8db851e3f7a015a6f584ae4a15b546f6bac80ccfe01d7.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "d7db753381fdd9779be8db851e3f7a015a6f584ae4a15b546f6bac80ccfe01d7"
   strings:
      $s1 = "gumumateseyewemisisapef" fullword wide
      $s2 = "YYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYY" ascii
      $s3 = " constructor or from DllMain." fullword ascii
      $s4 = "emuritowuwep" fullword ascii
      $s5 = "{q{YYYYYYYYYYYYYYYYYYYYYYYYYYY" fullword ascii
      $s6 = "{qYYYYYYYYYYq" fullword ascii
      $s7 = "q{YYYYYYYYYYYYYYY" fullword ascii
      $s8 = "O{qq{qYYYYYYYYYYYYYYYYYYYP{" fullword ascii
      $s9 = "YYYYYYYYYYYYYY{" fullword ascii
      $s10 = "YYYYYYYYYYYYYq" fullword ascii
      $s11 = "{YYYYYYYYYYYYYYYYYYYYYYYYYYYY{" fullword ascii
      $s12 = "YYYYYYYYYYq" fullword ascii
      $s13 = "YYYYYYYYYYYYYYYYq" fullword ascii
      $s14 = "{YYYYYYYYYY" fullword ascii
      $s15 = "CompanyNames" fullword wide
      $s16 = "71.40.94.63" fullword wide
      $s17 = "100.51.38.61" fullword wide
      $s18 = "Jiwojayemowesi" fullword wide
      $s19 = " /XunB" fullword ascii
      $s20 = "Yihoses worowopep" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 600KB and
      8 of them
}

rule sig_3ab831a2370cb682ff6ee4113a8a8985774cae1afd85196bd473423f98185e83 {
   meta:
      description = "samples - file 3ab831a2370cb682ff6ee4113a8a8985774cae1afd85196bd473423f98185e83.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "3ab831a2370cb682ff6ee4113a8a8985774cae1afd85196bd473423f98185e83"
   strings:
      $s1 = "Implosions.exe" fullword wide
      $s2 = " constructor or from DllMain." fullword ascii
      $s3 = "DINGXXPADDINGPADDINGXXPADDINGPADD" fullword ascii
      $s4 = "c*%T%%)" fullword ascii
      $s5 = "LeKZQ99" fullword ascii
      $s6 = "Broken pipe" fullword ascii /* Goodware String - occured 742 times */
      $s7 = "Permission denied" fullword ascii /* Goodware String - occured 823 times */
      $s8 = "cpes`;z96QHk" fullword ascii
      $s9 = "T$h9T$" fullword ascii /* Goodware String - occured 1 times */
      $s10 = "@RBNc_Q3b" fullword ascii
      $s11 = "{m.ypa`" fullword ascii
      $s12 = "&WVDy?J" fullword ascii
      $s13 = "o.aWe*=" fullword ascii
      $s14 = "L$PQSV" fullword ascii /* Goodware String - occured 1 times */
      $s15 = "qqiWSxT" fullword ascii
      $s16 = "7uqGE@##V" fullword ascii
      $s17 = "JYpI|M=" fullword ascii
      $s18 = "GZdr}qKEq" fullword ascii
      $s19 = "ExtqoT_" fullword ascii
      $s20 = "wERK4/YHJ" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 1000KB and
      8 of them
}

rule sig_3860e4bc7a35d52b4193b256bd76e62d98e9d05e504e4871a56585ea56295228 {
   meta:
      description = "samples - file 3860e4bc7a35d52b4193b256bd76e62d98e9d05e504e4871a56585ea56295228.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "3860e4bc7a35d52b4193b256bd76e62d98e9d05e504e4871a56585ea56295228"
   strings:
      $s1 = "dwinsvc.exe" fullword wide
      $s2 = "http://twizt.net/lbslut.exe" fullword wide
      $s3 = "%s\\%d%d.exe" fullword wide
      $s4 = "      <assemblyIdentity type=\"win32\" name=\"Microsoft.VC90.CRT\" version=\"9.0.21022.8\" processorArchitecture=\"x86\" publicK" ascii
      $s5 = "      <assemblyIdentity type=\"win32\" name=\"Microsoft.VC90.CRT\" version=\"9.0.21022.8\" processorArchitecture=\"x86\" publicK" ascii
      $s6 = "        <requestedExecutionLevel level=\"asInvoker\" uiAccess=\"false\"></requestedExecutionLevel>" fullword ascii
      $s7 = "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/110.0.0.0 Safari/537.36" fullword wide
      $s8 = "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/104.0.0.0 Safari/537.36" fullword wide
      $s9 = "http://twizt.net/vncinstall.php" fullword ascii
      $s10 = "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/93.0.4577.82 Safari/537.36" fullword ascii
      $s11 = "freeukraine" fullword ascii
      $s12 = "http://fuckput.in/" fullword ascii
      $s13 = "DINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPAD" ascii
      $s14 = "DINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDING" fullword ascii
      $s15 = "%temp%" fullword wide /* Goodware String - occured 14 times */
      $s16 = "PreLoad" fullword ascii /* Goodware String - occured 21 times */
      $s17 = "%userprofile%" fullword wide /* Goodware String - occured 25 times */
      $s18 = "_invoke_watson" fullword ascii /* Goodware String - occured 329 times */
      $s19 = "7A7N7l7" fullword ascii /* Goodware String - occured 1 times */
      $s20 = "%s\\525352353.jpg" fullword wide
   condition:
      uint16(0) == 0x5a4d and filesize < 30KB and
      8 of them
}

rule sig_4caa2065e60833f5fe97ed86c856da9ab5c48c69bafda08c75b7824d74704c18 {
   meta:
      description = "samples - file 4caa2065e60833f5fe97ed86c856da9ab5c48c69bafda08c75b7824d74704c18.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "4caa2065e60833f5fe97ed86c856da9ab5c48c69bafda08c75b7824d74704c18"
   strings:
      $s1 = "VCRUNTIME140_1.dll" fullword ascii
      $s2 = "\\p5 MSVCP140.dll" fullword ascii
      $s3 = "@GWS2_32.dll" fullword ascii
      $s4 = "        <requestedExecutionLevel level='requireAdministrator' uiAccess='false' />" fullword ascii
      $s5 = "mNQoL.AbJ" fullword ascii
      $s6 = "epOQ:\\T\"" fullword ascii
      $s7 = "* @aGa" fullword ascii
      $s8 = "a+ -U<D" fullword ascii
      $s9 = "* :>SG$" fullword ascii
      $s10 = "hbBf!." fullword ascii
      $s11 = "__CxxFrameHandler4" fullword ascii
      $s12 = "\\.\\hgG" fullword ascii
      $s13 = "X:\\m=H\\" fullword ascii
      $s14 = "6/iOi:\"9" fullword ascii
      $s15 = "dY:\"Z|" fullword ascii
      $s16 = "q:\\-Vm" fullword ascii
      $s17 = "rTy.GqT" fullword ascii
      $s18 = "APASAVH" fullword ascii
      $s19 = "Bfrhukm" fullword ascii
      $s20 = "\\ -FZ(" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 17000KB and
      8 of them
}

rule sig_24354c0c950c77d5ee246d90fffc025f457fba62ebc384c0810d1b0129b67eec {
   meta:
      description = "samples - file 24354c0c950c77d5ee246d90fffc025f457fba62ebc384c0810d1b0129b67eec.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "24354c0c950c77d5ee246d90fffc025f457fba62ebc384c0810d1b0129b67eec"
   strings:
      $s1 = "2147483648" wide /* hex encoded string '!GH6H' */
      $s2 = "  <description></description>" fullword ascii
      $s3 = "    processorArchitecture=\"X86\"" fullword ascii
      $s4 = "        processorArchitecture=\"X86\"" fullword ascii
      $s5 = "Downloads\\" fullword wide
      $s6 = "Denormal floating-point operand" fullword wide
      $s7 = "Invalid floating-point operation" fullword wide
      $s8 = "        publicKeyToken=\"6595b64144ccf1df\"" fullword ascii
      $s9 = "        version=\"6.0.0.0\"" fullword ascii
      $s10 = "    version=\"1.0.0.0\"" fullword ascii
      $s11 = "Memory page error" fullword wide
      $s12 = "        name=\"Microsoft.Windows.Common-Controls\"" fullword ascii
      $s13 = " inflate 1.2.11 Copyright 1995-2017 Mark Adler " fullword ascii
      $s14 = "3FC85DC0ED 5B408613F5E9787DE762ADB85BBDDCEB(74CB151E7FB8C350888BC77049452367F1BB1E13 B6794FF8BFA4E5777136C6621883EA36" fullword wide
      $s15 = "unknown compression method" fullword ascii /* Goodware String - occured 498 times */
      $s16 = "3D$H3D$<" fullword ascii /* Goodware String - occured 1 times */
      $s17 = "QVVh qA" fullword ascii
      $s18 = "0123456789abcdefK" fullword ascii /* Goodware String - occured 1 times */
      $s19 = "3r<3r$3r" fullword ascii /* Goodware String - occured 1 times */
      $s20 = "jPjCjnh" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 300KB and
      8 of them
}

rule sig_56e1d092c07322d9dad7d85d773953573cc3294b9e428b3bbbaf935ca4d2f7e7 {
   meta:
      description = "samples - file 56e1d092c07322d9dad7d85d773953573cc3294b9e428b3bbbaf935ca4d2f7e7.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "56e1d092c07322d9dad7d85d773953573cc3294b9e428b3bbbaf935ca4d2f7e7"
   strings:
      $x1 = "[*.exe*.EXE*.DLL*.ini*.inf*.pol*.cmd*.ps1*.vbs*.bat*.pagefile.sys*.hiberfil.sys*.drv*.msc*.dll*.lock*.sys*.msu*.lnk*.search-ms*" ascii
      $x2 = "memtasveeamsvc$backupsqlvssmsexchangesql$mysqlmysql$sophosMSExchangeMSExchange$WSBExchangePDVFSServiceBackupExecVSSProviderBacku" ascii
      $x3 = "                 `DW_CHILDREN_{yes,no}`The specified length is impossibleFound an unknown `DW_FORM_*` typeExpected a zero, found" ascii
      $x4 = "DW_AT_nullDW_AT_siblingDW_AT_locationDW_AT_nameDW_AT_orderingDW_AT_byte_sizeDW_AT_bit_offsetDW_AT_bit_sizeDW_AT_stmt_listDW_AT_l" ascii
      $x5 = "*\\autorun.inf*\\boot.ini*\\desktop.ini*\\system volume information**\\Boot**\\DumpStack.log.tmp*\\PerfLogs**\\Users\\*\\Microso" ascii
      $x6 = "C:\\Users\\Public\\ -accepteula -s -d \"\" --no_impl" fullword ascii
      $x7 = "C:\\Users\\Public\\psexec0.exe4d5a90000300000004000000ffff0000b80000000000000040000000000000000000000000000000000000000000000000" ascii
      $x8 = "C:\\Users\\Public\\psexec0.exe4d5a90000300000004000000ffff0000b80000000000000040000000000000000000000000000000000000000000000000" ascii
      $x9 = "bcryptprimitives.dll" fullword ascii /* reversed goodware string 'lld.sevitimirptpyrcb' */
      $x10 = "cmd.exe /e:ON /v:OFF /d /c \"" fullword ascii
      $x11 = "_ZN4core3ptr201drop_in_place$LT$std..sync..poison..PoisonError$LT$std..sync..mutex..MutexGuard$LT$std..sync..mpsc..Receiver$LT$a" ascii
      $s12 = "NotFoundPermissionDeniedConnectionRefusedConnectionResetHostUnreachableNetworkUnreachableConnectionAbortedNotConnectedAddrInUseA" ascii
      $s13 = "---Diskfsutil behavior set SymlinkEvaluation R2L:1fsutil behavior set SymlinkEvaluation R2R:1iisreset.exe /stopvssadmin.exe Dele" ascii
      $s14 = "OnceOnceStatepoisonedPoisonErrorlock count overflow in reentrant mutexlibrary\\std\\src\\sync\\reentrant_lock.rs" fullword ascii
      $s15 = "SetMgrSavRoamRTVscanQBFCServiceIntuit.QuickBooks.FCSzhudongfangyustc_raw_agentBackupExecManagementServiceCASAD2DWebSvcCAARCUpdat" ascii
      $s16 = "NotFoundPermissionDeniedConnectionRefusedConnectionResetHostUnreachableNetworkUnreachableConnectionAbortedNotConnectedAddrInUseA" ascii
      $s17 = "ageahexASCII_Hex_DigitalphaAlphabeticalphabeticasciihexdigitbcBidi_ClassbidicBidi_ControlbidiclassbidicontrolbidimBidi_Mirroredb" ascii
      $s18 = "NotFoundPermissionDeniedConnectionRefusedConnectionResetHostUnreachableNetworkUnreachableConnectionAbortedNotConnectedAddrInUseA" ascii
      $s19 = "NotFoundPermissionDeniedConnectionRefusedConnectionResetHostUnreachableNetworkUnreachableConnectionAbortedNotConnectedAddrInUseA" ascii
      $s20 = "entity not foundpermission deniedconnection refusedconnection resethost unreachablenetwork unreachableconnection abortednot conn" ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 22000KB and
      1 of ($x*) and all of them
}

rule sig_200134712c0a6193c847498cd63b3c0ff3800c8a685d77f1a3341d83382b58c7 {
   meta:
      description = "samples - file 200134712c0a6193c847498cd63b3c0ff3800c8a685d77f1a3341d83382b58c7.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "200134712c0a6193c847498cd63b3c0ff3800c8a685d77f1a3341d83382b58c7"
   strings:
      $s1 = "file read failed" fullword ascii
      $s2 = "decompression failed or archive is corrupted" fullword ascii
      $s3 = "compression failed" fullword ascii
      $s4 = "invalid header or archive is corrupted" fullword ascii
      $s5 = "file close failed" fullword ascii
      $s6 = "file write failed" fullword ascii
      $s7 = "validation failed" fullword ascii
      $s8 = "failed finding central directory" fullword ascii
      $s9 = "system or character via spellings glyphs a is uses that in their modified other on often reflection or resemblance on it leetspe" ascii
      $s10 = "unsupported multidisk archive" fullword ascii
      $s11 = "file create failed" fullword ascii
      $s12 = "file stat failed" fullword ascii
      $s13 = "unexpected decompressed size" fullword ascii
      $s14 = "total errors" fullword ascii
      $s15 = "undefined error" fullword ascii
      $s16 = "file open failed" fullword ascii
      $s17 = "file seek failed" fullword ascii
      $s18 = "unsupported central directory size" fullword ascii
      $s19 = "u0001020304050607080910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626" ascii
      $s20 = "404142434445464748494A4B4C4D4E4F505152535455565758595A5B5C5D5E5F606162636465666768696A6B6C6D6E6F707172737475767778797A7B7C7D7E7F" ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 900KB and
      8 of them
}

rule c9701863c3174a552ab6ff2ec367111a8d8853b57e5b093429d1c0f247e20d05 {
   meta:
      description = "samples - file c9701863c3174a552ab6ff2ec367111a8d8853b57e5b093429d1c0f247e20d05.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "c9701863c3174a552ab6ff2ec367111a8d8853b57e5b093429d1c0f247e20d05"
   strings:
      $x1 = "C:\\Users\\Administrator\\Desktop\\SSL-master\\x64\\Release\\SSL.pdb" fullword ascii
      $s2 = "[+] usage: SSL.exe url" fullword ascii
      $s3 = "        <requestedExecutionLevel level='asInvoker' uiAccess='false' />" fullword ascii
      $s4 = "http://124.220.66.44:60001/1.png" fullword wide
      $s5 = "Ready?  Go! " fullword ascii
      $s6 = "Fail! Check your input!" fullword ascii
      $s7 = "_set_app_type" fullword ascii /* Goodware String - occured 3 times */
      $s8 = "_set_new_mode" fullword ascii /* Goodware String - occured 3 times */
      $s9 = "_get_initial_narrow_environment" fullword ascii /* Goodware String - occured 3 times */
      $s10 = "_seh_filter_exe" fullword ascii /* Goodware String - occured 3 times */
      $s11 = " A_A^_^[" fullword ascii
      $s12 = " H3E H3E" fullword ascii
      $s13 = "u0HcH<H" fullword ascii
      $s14 = "4,\\Rich" fullword ascii
      $s15 = "_register_thread_local_exe_atexit_callback" fullword ascii /* Goodware String - occured 5 times */
      $s16 = "(A^A\\^[" fullword ascii /* Goodware String - occured 5 times */
   condition:
      uint16(0) == 0x5a4d and filesize < 70KB and
      1 of ($x*) and 4 of them
}

rule sig_1979b3e9366928d0774a41e8bd5e7610a0302cdf62e9a533d2ff6c5ff7c346e9 {
   meta:
      description = "samples - file 1979b3e9366928d0774a41e8bd5e7610a0302cdf62e9a533d2ff6c5ff7c346e9.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "1979b3e9366928d0774a41e8bd5e7610a0302cdf62e9a533d2ff6c5ff7c346e9"
   strings:
      $s1 = "VCRUNTIME140_1.dll" fullword ascii
      $s2 = "Executing the payload with VEH ASM decryption... This may take a while depending on the efficiency of the shellcode..." fullword ascii
      $s3 = "D:\\Pentest\\tools\\Voidgate\\voidgate-master\\x64\\Release\\Voidgate.pdb" fullword ascii
      $s4 = "[X] ERROR - " fullword ascii
      $s5 = "        <requestedExecutionLevel level='asInvoker' uiAccess='false' />" fullword ascii
      $s6 = "__CxxFrameHandler4" fullword ascii
      $s7 = " failed with error code: " fullword ascii
      $s8 = "e9ZsvXhWNhdps99nFG" fullword ascii
      $s9 = "3Nhdpsxi/" fullword ascii
      $s10 = "_set_app_type" fullword ascii /* Goodware String - occured 3 times */
      $s11 = "_set_new_mode" fullword ascii /* Goodware String - occured 3 times */
      $s12 = "_get_initial_narrow_environment" fullword ascii /* Goodware String - occured 3 times */
      $s13 = "_seh_filter_exe" fullword ascii /* Goodware String - occured 3 times */
      $s14 = " H3E H3E" fullword ascii
      $s15 = "u0HcH<H" fullword ascii
      $s16 = ")<.*cx6" fullword ascii
      $s17 = "WNh%!2ik?" fullword ascii
      $s18 = " A_A^_][" fullword ascii
      $s19 = "0iVNh=1" fullword ascii
      $s20 = "_register_thread_local_exe_atexit_callback" fullword ascii /* Goodware String - occured 5 times */
   condition:
      uint16(0) == 0x5a4d and filesize < 60KB and
      8 of them
}

rule sig_444c3fc7262ac37ab58c8e03c994e745ee23a5b37974f424012cb2117dd89d83 {
   meta:
      description = "samples - file 444c3fc7262ac37ab58c8e03c994e745ee23a5b37974f424012cb2117dd89d83.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "444c3fc7262ac37ab58c8e03c994e745ee23a5b37974f424012cb2117dd89d83"
   strings:
      $s1 = "        <requestedExecutionLevel level='asInvoker' uiAccess='false' />" fullword ascii
      $s2 = "* |'2CPz" fullword ascii
      $s3 = ";%I%!'/" fullword ascii
      $s4 = "vixdyfsl" fullword ascii
      $s5 = "inoalcvz" fullword ascii
      $s6 = "3<?xml version='1.0' encoding='UTF-8' standalone='yes'?>" fullword ascii
      $s7 = "jRHAtD2" fullword ascii
      $s8 = "CK- s7Z" fullword ascii
      $s9 = "k~9o* " fullword ascii
      $s10 = "tHbwsa4" fullword ascii
      $s11 = "%G%*c[" fullword ascii
      $s12 = "+ d>Ai" fullword ascii
      $s13 = " -+@`)" fullword ascii
      $s14 = "+ #'XP" fullword ascii
      $s15 = "o- >7:" fullword ascii
      $s16 = "}~`%ZR%=6" fullword ascii
      $s17 = "c$|b* " fullword ascii
      $s18 = "$+X* 9" fullword ascii
      $s19 = "%eW%Y;" fullword ascii
      $s20 = "^SR -LY+nI%" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 6000KB and
      8 of them
}

rule sig_8bb7ce7b157a6282e22cbdb19616fff926cd387427f69b276dfe30a58c4ee874 {
   meta:
      description = "samples - file 8bb7ce7b157a6282e22cbdb19616fff926cd387427f69b276dfe30a58c4ee874.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "8bb7ce7b157a6282e22cbdb19616fff926cd387427f69b276dfe30a58c4ee874"
   strings:
      $s1 = "ehttp://pki-crl.symauth.com/offlineca/TheInstituteofElectricalandElectronicsEngineersIncIEEERootCA.crl0" fullword ascii
      $s2 = "Lhttp://pki-crl.symauth.com/ca_732b6ec148d290c0a071efd1dac8e288/LatestCRL.crl07" fullword ascii
      $s3 = "hSSSSSSSSSSSSSSSSSSSS" fullword ascii /* reversed goodware string 'SSSSSSSSSSSSSSSSSSSSh' */
      $s4 = "* -LHU" fullword ascii
      $s5 = "http://pki-ocsp.symauth.com0" fullword ascii
      $s6 = "YYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYY" fullword ascii
      $s7 = "YYYYYYYYYYYYYYYYYYYYYYYYYYYYY" fullword ascii
      $s8 = "YYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYY" ascii
      $s9 = "Vxuh!." fullword ascii
      $s10 = "CompanyNames" fullword wide
      $s11 = "}Qh:\\Z" fullword ascii
      $s12 = "04Q.hIm," fullword ascii
      $s13 = "g8U:\\|X" fullword ascii
      $s14 = " T:\\NWw" fullword ascii
      $s15 = "aZ1.oyM" fullword ascii
      $s16 = "BS\\3AU:\"" fullword ascii
      $s17 = "Y+%i:g" fullword ascii
      $s18 = "SSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSS" fullword ascii
      $s19 = "SSSSSSSSSSY" fullword ascii
      $s20 = "SSSSSSSSSSX" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 8000KB and
      8 of them
}

rule a045aae04ded2c18b1ab1e206c18bf954844afd6b9c6e9efcecc4cc05dae71da {
   meta:
      description = "samples - file a045aae04ded2c18b1ab1e206c18bf954844afd6b9c6e9efcecc4cc05dae71da.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "a045aae04ded2c18b1ab1e206c18bf954844afd6b9c6e9efcecc4cc05dae71da"
   strings:
      $s1 = "            <requestedExecutionLevel level=\"asInvoker\"            uiAccess=\"false\"/>" fullword ascii
      $s2 = "        <dpiAware xmlns=\"http://schemas.microsoft.com/SMI/2005/WindowsSettings\">true</dpiAware>" fullword ascii
      $s3 = "    processorArchitecture=\"x86\"" fullword ascii
      $s4 = "iirczu" fullword ascii
      $s5 = "            processorArchitecture=\"x86\"" fullword ascii
      $s6 = "* llWyf~" fullword ascii
      $s7 = ",I(* -)|" fullword ascii
      $s8 = "R- -%E" fullword ascii
      $s9 = "p4)iVLn?- $" fullword ascii
      $s10 = "            publicKeyToken=\"6595b64144ccf1df\"" fullword ascii
      $s11 = "    version=\"1.0.0.0\"" fullword ascii
      $s12 = "APu.UZd]" fullword ascii
      $s13 = "            version=\"6.0.0.0\"" fullword ascii
      $s14 = "pvFL.sHeD" fullword ascii
      $s15 = "qxc:\\~ " fullword ascii
      $s16 = "e7JI.MmA" fullword ascii
      $s17 = "ngrUn{\\}" fullword ascii
      $s18 = "TKQOAPJ" fullword ascii
      $s19 = "SREVNKJ" fullword ascii
      $s20 = "jIRcg=" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 13000KB and
      8 of them
}

rule sig_8ed24ddbcd88141fb1934ea20761b97d7cbdcb4e5042f6e1d893ed817a5b4a89 {
   meta:
      description = "samples - file 8ed24ddbcd88141fb1934ea20761b97d7cbdcb4e5042f6e1d893ed817a5b4a89.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "8ed24ddbcd88141fb1934ea20761b97d7cbdcb4e5042f6e1d893ed817a5b4a89"
   strings:
      $x1 = " (types from different scopes)notetsleep - waitm out of syncfailed to get system page sizeassignment to entry in nil mapruntime:" ascii
      $x2 = "goroutine profileAllThreadsSyscallGC assist markingselect (no cases)sync.RWMutex.Lockwait for GC cycletrace proc status: missing" ascii
      $x3 = "lization - linker skewattempt to execute system stack code on user stackcompileCallback: function argument frame too large" fullword ascii
      $x4 = "runtime: unable to acquire - semaphore out of syncmallocgc called with gcphase == _GCmarkterminationrecursive call during initia" ascii
      $s5 = "runtime: bad notifyList size - sync=accessed data from freed user arena runtime: wrong goroutine in newstackruntime: invalid pc-" ascii
      $s6 = "Nexecuting on Go runtime stacknotesleep - waitm out of sync/cpu/classes/idle:cpu-seconds/cpu/classes/user:cpu-seconds/gc/heap/al" ascii
      $s7 = "integer divide by zeroCountPagesInUse (test)ReadMetricsSlow (test)trace reader (blocked)trace goroutine statussend on closed cha" ascii
      $s8 = " activeSweepmheap.freeSpanLocked - invalid freeattempt to clear non-empty span setruntime: close polldesc w/o unblockfindrunnabl" ascii
      $s9 = "comparing uncomparable type runtime: bad lfnode address region exceeds uintptr range/gc/heap/frees-by-size:bytes/gc/heap/tiny/al" ascii
      $s10 = "persistentalloc: align is too large/memory/classes/heap/released:bytesgreyobject: obj not pointer-alignedmismatched begin/end of" ascii
      $s11 = " max=scav  ptr ] = (usagefalseinit  ms, fault and  tab= top=[...], fp:MarchApril+0530+0430+0545+0630+0330+0845+1030+1245+1345-09" ascii
      $s12 = "^runtime: typeBitsBulkBarrier without type/memory/classes/metadata/mspan/free:bytesruntime.SetFinalizer: second argument is gcSw" ascii
      $s13 = "mheap.freeSpanLocked - invalid free of user arena chunkcasfrom_Gscanstatus:top gp->status is not in scan state is currently not " ascii
      $s14 = "eSpanLocked - invalid span stateattempted to add zero-sized address rangeruntime: blocked read on closing polldescstopTheWorld: " ascii
      $s15 = "slice bounds out of range [%x:%y]base outside usable address spaceruntime: memory allocated by OS [misrounded allocation in sysA" ascii
      $s16 = "sweepWaiterstraceStringsspanSetSpinemspanSpecialgcBitsArenasmheapSpecialgcpacertracemadvdontneedharddecommitdumping heapchan rec" ascii
      $s17 = "n1float64nan2float64nan3float32nan2GOTRACEBACK) at entry+ (targetpc= , plugin: runtime: g : frame.sp=created by " fullword ascii
      $s18 = "all goroutines stack tracecall from unknown functionnotewakeup - double wakeuppersistentalloc: size == 0/gc/cycles/total:gc-cycl" ascii
      $s19 = "sweepWaiterstraceStringsspanSetSpinemspanSpecialgcBitsArenasmheapSpecialgcpacertracemadvdontneedharddecommitdumping heapchan rec" ascii
      $s20 = "tal/gc:seconds/sync/mutex/wait/total:seconds/godebug/non-default-behavior/bcryptprimitives.dll not foundpanic called with nil ar" ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 11000KB and
      1 of ($x*) and 4 of them
}

rule sig_283ece83572923032a368088751b611aee0d866be61d048935d9b5ca3d344a70 {
   meta:
      description = "samples - file 283ece83572923032a368088751b611aee0d866be61d048935d9b5ca3d344a70.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "283ece83572923032a368088751b611aee0d866be61d048935d9b5ca3d344a70"
   strings:
      $s1 = "xmrig.exe" fullword wide
      $s2 = "www.xmrig.com" fullword wide
      $s3 = "Copyright (C) 2016-2023 xmrig.com" fullword wide
      $s4 = "        <requestedExecutionLevel level=\"asInvoker\"/>" fullword ascii
      $s5 = "KJIHGF" fullword ascii /* reversed goodware string 'FGHIJK' */
      $s6 = "=PASSWORD" fullword ascii
      $s7 = "+5m - RESULTS" fullword ascii
      $s8 = "amdhsa.kernels" fullword ascii
      $s9 = "<44444" fullword ascii /* reversed goodware string '44444<' */
      $s10 = "~}|{zyxw" fullword ascii /* reversed goodware string 'wxyz{|}~' */
      $s11 = "-,+*)(" fullword ascii /* reversed goodware string '()*+,-' */
      $s12 = "$$$$$U" fullword ascii /* reversed goodware string 'U$$$$$' */
      $s13 = "\\2723\\." fullword ascii /* hex encoded string ''#' */
      $s14 = "QE- -r" fullword ascii
      $s15 = "7+#\\$9\"" fullword ascii /* hex encoded string 'y' */
      $s16 = "* [zN:" fullword ascii
      $s17 = "6^6//*\\28" fullword ascii /* hex encoded string 'f(' */
      $s18 = "$[33554`4" fullword ascii /* hex encoded string '3UD' */
      $s19 = "\"$/\"5c7d" fullword ascii /* hex encoded string '\}' */
      $s20 = "CTLOG74wJ" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 9000KB and
      8 of them
}

rule sig_6b28f747f2c23c959950851728a8e6e3aac110c42913977cd34ae513627a7bd6 {
   meta:
      description = "samples - file 6b28f747f2c23c959950851728a8e6e3aac110c42913977cd34ae513627a7bd6.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "6b28f747f2c23c959950851728a8e6e3aac110c42913977cd34ae513627a7bd6"
   strings:
      $s1 = "C:\\Users\\liuzihan.pudaocredit\\Desktop\\mar\\common.cpp" fullword ascii
      $s2 = "C:\\Users\\liuzihan.pudaocredit\\Desktop\\mar" fullword ascii
      $s3 = " GUID_PROCESSOR_PARKING_CORE_OVERRIDE" fullword ascii
      $s4 = " GUID_PROCESSOR_PARKING_HEADROOM_THRESHOLD" fullword ascii
      $s5 = " IID_IDropTarget" fullword ascii
      $s6 = "processthreadsapi.h" fullword ascii
      $s7 = " GUID_PROCESSOR_PERF_DECREASE_POLICY" fullword ascii
      $s8 = " IID_IProcessInitControl" fullword ascii
      $s9 = " GUID_PROCESSOR_CORE_PARKING_OVER_UTILIZATION_HISTORY_THRESHOLD" fullword ascii
      $s10 = "PROCESSOR_KNM" fullword ascii
      $s11 = "PROCESSOR_BDVER4" fullword ascii
      $s12 = "processor_type" fullword ascii
      $s13 = " GUID_PROCESSOR_CORE_PARKING_DECREASE_THRESHOLD" fullword ascii
      $s14 = " GUID_PROCESSOR_IDLE_DISABLE" fullword ascii
      $s15 = " GUID_PROCESSOR_CORE_PARKING_INCREASE_THRESHOLD" fullword ascii
      $s16 = " GUID_PROCESSOR_PERF_BOOST_MODE" fullword ascii
      $s17 = "PROCESSOR_BTVER1" fullword ascii
      $s18 = "PROCESSOR_SANDYBRIDGE" fullword ascii
      $s19 = "PROCESSOR_SKYLAKE" fullword ascii
      $s20 = "PROCESSOR_max" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 200KB and
      8 of them
}

rule c8009295795a41ddf450d7e6fd947d17f0a344aedb28cb1f1d00d5b28d225acd {
   meta:
      description = "samples - file c8009295795a41ddf450d7e6fd947d17f0a344aedb28cb1f1d00d5b28d225acd.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "c8009295795a41ddf450d7e6fd947d17f0a344aedb28cb1f1d00d5b28d225acd"
   strings:
      $s1 = "HipsMain.exe" fullword wide
      $s2 = "3333333335" ascii /* hex encoded string '33335' */
      $s3 = "66666666666668" ascii /* hex encoded string 'ffffffh' */
      $s4 = "755555555555" ascii /* hex encoded string 'uUUUUU' */
      $s5 = "  VirtualQuery failed for %d bytes at address %p" fullword ascii
      $s6 = "%d bit pseudo relocation at %p out of range, targeting %p, yielding the value %p." fullword ascii
      $s7 = "Beijing Huorong Network Technology Co., Ltd." fullword wide
      $s8 = "755555555555]" fullword ascii /* hex encoded string 'uUUUUU' */
      $s9 = "wussssssssssssssssr" fullword ascii
      $s10 = "%c%c%c%c%c%c%c%c%c%c%c%c%cslot-%d" fullword ascii
      $s11 = "  VirtualProtect failed with code 0x%x" fullword ascii
      $s12 = "  Unknown pseudo relocation protocol version %d." fullword ascii
      $s13 = "5.0.1.1" fullword wide
      $s14 = "XUUUUUUUUUVU8" fullword ascii
      $s15 = "=UUUUw" fullword ascii /* Goodware String - occured 1 times */
      $s16 = "ATUWVSHcY" fullword ascii
      $s17 = "fCTPs<2&,2(+Z" fullword ascii
      $s18 = ":MZuYHcB<H" fullword ascii
      $s19 = "|rrrrrrrrrrrrrrrrrrr" fullword ascii
      $s20 = "|rrrrrrrrrrrrrrrrrr<" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 600KB and
      8 of them
}

rule sig_408c4cb78449baf846592637c9a8f03f47c3df6786acdce6e9ad0ef0db370068 {
   meta:
      description = "samples - file 408c4cb78449baf846592637c9a8f03f47c3df6786acdce6e9ad0ef0db370068.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "408c4cb78449baf846592637c9a8f03f47c3df6786acdce6e9ad0ef0db370068"
   strings:
      $x1 = "C:\\Temp\\client.log" fullword wide
      $x2 = "C:\\Temp\\client_ex.log" fullword wide
      $s3 = "taskhostw.exe" fullword wide
      $s4 = "GetUserProcessList" fullword ascii
      $s5 = "C://Temp//1.log" fullword wide
      $s6 = "keyLogger" fullword wide
      $s7 = "WinUpdate.exe" fullword wide
      $s8 = "KeylogMutexString" fullword ascii
      $s9 = "GetActiveProcessName" fullword ascii
      $s10 = "DataLogs_keylog_offline.txt" fullword wide
      $s11 = "DataLogs_keylog_online.txt" fullword wide
      $s12 = "Select * from Win32_Processor" fullword wide
      $s13 = "OfflineKeylogger" fullword wide
      $s14 = "11.exe" fullword ascii
      $s15 = "keylogparam" fullword ascii
      $s16 = "keylogsetting" fullword wide
      $s17 = "FilterProcessWindow" fullword ascii
      $s18 = "V290WVp5c3F6RjB6aEQ3bVR3MldhUEVBOW1aSVpHZ3M=" fullword wide /* base64 encoded string 'WotYZysqzF0zhD7mTw2WaPEA9mZIZGgs' */
      $s19 = "loadofflinelog" fullword wide
      $s20 = "offlinelog" fullword wide
   condition:
      uint16(0) == 0x5a4d and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule d61022cef95af3e20bb237b2690c817d948c3ea99a5f11153eca3bcfff034eb0 {
   meta:
      description = "samples - file d61022cef95af3e20bb237b2690c817d948c3ea99a5f11153eca3bcfff034eb0.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "d61022cef95af3e20bb237b2690c817d948c3ea99a5f11153eca3bcfff034eb0"
   strings:
      $x1 = "C:\\Temp\\client.log" fullword wide
      $x2 = "C:\\Temp\\client_ex.log" fullword wide
      $s3 = "GetUserProcessList" fullword ascii
      $s4 = "C://Temp//1.log" fullword wide
      $s5 = "keyLogger" fullword wide
      $s6 = "ClientAny.exe" fullword wide
      $s7 = "KeylogMutexString" fullword ascii
      $s8 = "GetActiveProcessName" fullword ascii
      $s9 = "DataLogs_keylog_offline.txt" fullword wide
      $s10 = "DataLogs_keylog_online.txt" fullword wide
      $s11 = "Select * from Win32_Processor" fullword wide
      $s12 = "OfflineKeylogger" fullword wide
      $s13 = "keylogparam" fullword ascii
      $s14 = "keylogsetting" fullword wide
      $s15 = "FilterProcessWindow" fullword ascii
      $s16 = "TndLOUw4UjdZQnhjcUZMS0h3UDhVNVBqUnJvUmJhYjU=" fullword wide /* base64 encoded string 'NwK9L8R7YBxcqFLKHwP8U5PjRroRbab5' */
      $s17 = "loadofflinelog" fullword wide
      $s18 = "offlinelog" fullword wide
      $s19 = "KeylogConfFile" fullword ascii
      $s20 = "KeylogParams" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule sig_1ef225d55b567e06ca8c6197aa237b76504a1a270a512b80b50280154af98146 {
   meta:
      description = "samples - file 1ef225d55b567e06ca8c6197aa237b76504a1a270a512b80b50280154af98146.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "1ef225d55b567e06ca8c6197aa237b76504a1a270a512b80b50280154af98146"
   strings:
      $x1 = "C:\\Temp\\client.log" fullword wide
      $x2 = "C:\\Temp\\client_ex.log" fullword wide
      $s3 = "taskhostw.exe" fullword wide
      $s4 = "GetUserProcessList" fullword ascii
      $s5 = "C://Temp//1.log" fullword wide
      $s6 = "keyLogger" fullword wide
      $s7 = "WinUpdate.exe" fullword wide
      $s8 = "Client.exe" fullword ascii
      $s9 = "KeylogMutexString" fullword ascii
      $s10 = "GetActiveProcessName" fullword ascii
      $s11 = "DataLogs_keylog_offline.txt" fullword wide
      $s12 = "DataLogs_keylog_online.txt" fullword wide
      $s13 = "Select * from Win32_Processor" fullword wide
      $s14 = "OfflineKeylogger" fullword wide
      $s15 = "Y1JHcEwyZndPM2F4dEV3eTFBNUpaWDVIanRaeFlrUnQ=" fullword wide /* base64 encoded string 'cRGpL2fwO3axtEwy1A5JZX5HjtZxYkRt' */
      $s16 = "keylogparam" fullword ascii
      $s17 = "keylogsetting" fullword wide
      $s18 = "FilterProcessWindow" fullword ascii
      $s19 = "loadofflinelog" fullword wide
      $s20 = "offlinelog" fullword wide
   condition:
      uint16(0) == 0x5a4d and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule df9d5a6d4edf1baf28fe59cc742cb980dfba7613a17b50c5a75f3fdd756bbc54 {
   meta:
      description = "samples - file df9d5a6d4edf1baf28fe59cc742cb980dfba7613a17b50c5a75f3fdd756bbc54.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "df9d5a6d4edf1baf28fe59cc742cb980dfba7613a17b50c5a75f3fdd756bbc54"
   strings:
      $x1 = "C:\\Temp\\client.log" fullword wide
      $x2 = "C:\\Temp\\client_ex.log" fullword wide
      $s3 = "GetUserProcessList" fullword ascii
      $s4 = "C://Temp//1.log" fullword wide
      $s5 = "keyLogger" fullword wide
      $s6 = "WinUpdate.exe" fullword wide
      $s7 = "ClientAny.exe" fullword wide
      $s8 = "KeylogMutexString" fullword ascii
      $s9 = "GetActiveProcessName" fullword ascii
      $s10 = "DataLogs_keylog_offline.txt" fullword wide
      $s11 = "DataLogs_keylog_online.txt" fullword wide
      $s12 = "Select * from Win32_Processor" fullword wide
      $s13 = "OfflineKeylogger" fullword wide
      $s14 = "keylogparam" fullword ascii
      $s15 = "keylogsetting" fullword wide
      $s16 = "FilterProcessWindow" fullword ascii
      $s17 = "ZllIS3pvd0RWMmxVUldHcnJMaTFCTGdSaGtyZFQ5Zjc=" fullword wide /* base64 encoded string 'fYHKzowDV2lURWGrrLi1BLgRhkrdT9f7' */
      $s18 = "loadofflinelog" fullword wide
      $s19 = "offlinelog" fullword wide
      $s20 = "KeylogConfFile" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule sig_3b03a24bfde864b0d8b17213f7f2deb6d7e3f5f74b34d3b601cbadd961b904fc {
   meta:
      description = "samples - file 3b03a24bfde864b0d8b17213f7f2deb6d7e3f5f74b34d3b601cbadd961b904fc.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "3b03a24bfde864b0d8b17213f7f2deb6d7e3f5f74b34d3b601cbadd961b904fc"
   strings:
      $x1 = "C:\\Temp\\client.log" fullword wide
      $x2 = "C:\\Temp\\client_ex.log" fullword wide
      $s3 = "GetUserProcessList" fullword ascii
      $s4 = "C://Temp//1.log" fullword wide
      $s5 = "keyLogger" fullword wide
      $s6 = "WinUpdate.exe" fullword wide
      $s7 = "KeylogMutexString" fullword ascii
      $s8 = "GetActiveProcessName" fullword ascii
      $s9 = "DataLogs_keylog_offline.txt" fullword wide
      $s10 = "DataLogs_keylog_online.txt" fullword wide
      $s11 = "Select * from Win32_Processor" fullword wide
      $s12 = "OfflineKeylogger" fullword wide
      $s13 = "keylogparam" fullword ascii
      $s14 = "keylogsetting" fullword wide
      $s15 = "ip.exe" fullword ascii
      $s16 = "IPxu/PCnhqwftpbJ3CmiihrOEVsfdByiuq0Kwc98NDaHJFgNR25wztmKthNXVCMEcGUaiWWF0guUvdxIBD2xperUsdbFALMnGZvLgZNPsQrwEmKgLDr74erv1z7UJGVA" wide
      $s17 = "FilterProcessWindow" fullword ascii
      $s18 = "Vm0weGY1MktRNjZOajVReElpTVE0YXlaWm1GR0FPVWo=" fullword wide /* base64 encoded string 'Vm0xf52KQ66Nj5QxIiMQ4ayZZmFGAOUj' */
      $s19 = "HDmRChXyJ9m2N3epv9MglJ/YXcwyVpMi+Ii5p1moDAhhksuyco0gx288wy/XaTHqfxdXvgFbenCJ0OKVf1P1w+2K7oTUkKg0wpcib+MntC/WTMpCzgXRAzp5p4QwFNXe" wide
      $s20 = "loadofflinelog" fullword wide
   condition:
      uint16(0) == 0x5a4d and filesize < 600KB and
      1 of ($x*) and 4 of them
}

rule cc38fb3ee3227606258b1b9ccba885393d6ed4a54a51aefef30a669cdc171e80 {
   meta:
      description = "samples - file cc38fb3ee3227606258b1b9ccba885393d6ed4a54a51aefef30a669cdc171e80.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "cc38fb3ee3227606258b1b9ccba885393d6ed4a54a51aefef30a669cdc171e80"
   strings:
      $x1 = "C:\\Temp\\client.log" fullword wide
      $x2 = "C:\\Temp\\client_ex.log" fullword wide
      $s3 = "payload_1.exe" fullword ascii
      $s4 = "hyperhostvc.exe" fullword wide
      $s5 = "GetUserProcessList" fullword ascii
      $s6 = "C://Temp//1.log" fullword wide
      $s7 = "keyLogger" fullword wide
      $s8 = "ClientAny.exe" fullword wide
      $s9 = "KeylogMutexString" fullword ascii
      $s10 = "GetActiveProcessName" fullword ascii
      $s11 = "DataLogs_keylog_offline.txt" fullword wide
      $s12 = "DataLogs_keylog_online.txt" fullword wide
      $s13 = "Select * from Win32_Processor" fullword wide
      $s14 = "OfflineKeylogger" fullword wide
      $s15 = "keylogparam" fullword ascii
      $s16 = "keylogsetting" fullword wide
      $s17 = "FilterProcessWindow" fullword ascii
      $s18 = "UkptT3M1d2tjQXpQdG5JWlNyenFoS3ZMblgzdUhNSUw=" fullword wide /* base64 encoded string 'RJmOs5wkcAzPtnIZSrzqhKvLnX3uHMIL' */
      $s19 = "loadofflinelog" fullword wide
      $s20 = "offlinelog" fullword wide
   condition:
      uint16(0) == 0x5a4d and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule sig_749911c61e23b64b45f28d453a8b70275f824092d8dab39ccc1e93464d26b450 {
   meta:
      description = "samples - file 749911c61e23b64b45f28d453a8b70275f824092d8dab39ccc1e93464d26b450.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "749911c61e23b64b45f28d453a8b70275f824092d8dab39ccc1e93464d26b450"
   strings:
      $x1 = "C:\\Temp\\client.log" fullword wide
      $x2 = "C:\\Temp\\client_ex.log" fullword wide
      $s3 = "GetUserProcessList" fullword ascii
      $s4 = "C://Temp//1.log" fullword wide
      $s5 = "keyLogger" fullword wide
      $s6 = "WinUpdate.exe" fullword wide
      $s7 = "ClientAny.exe" fullword wide
      $s8 = "KeylogMutexString" fullword ascii
      $s9 = "GetActiveProcessName" fullword ascii
      $s10 = "DataLogs_keylog_offline.txt" fullword wide
      $s11 = "DataLogs_keylog_online.txt" fullword wide
      $s12 = "Select * from Win32_Processor" fullword wide
      $s13 = "OfflineKeylogger" fullword wide
      $s14 = "keylogparam" fullword ascii
      $s15 = "keylogsetting" fullword wide
      $s16 = "FilterProcessWindow" fullword ascii
      $s17 = "azI3UjhCVmRBTW5jVDRSNWw3alEyazNVMnptTzZTdFY=" fullword wide /* base64 encoded string 'k27R8BVdAMncT4R5l7jQ2k3U2zmO6StV' */
      $s18 = "L8ZkI/hrPQHEvGjJEhVe74OQGvkzm0mz9vjD6nozsEGGkafRV6d58byZAnCkWwjqo1cIoe9BbhwDA6sWcLYVwE6QoOI6bm6JcWj6WPAKJFomuPwei9nrTHZpHG7yYe+W" wide
      $s19 = "loadofflinelog" fullword wide
      $s20 = "offlinelog" fullword wide
   condition:
      uint16(0) == 0x5a4d and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule sig_6475637fff05177a05bf6e84301c09492f21766ea3ba0068f3f70c4d0d886a9e {
   meta:
      description = "samples - file 6475637fff05177a05bf6e84301c09492f21766ea3ba0068f3f70c4d0d886a9e.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "6475637fff05177a05bf6e84301c09492f21766ea3ba0068f3f70c4d0d886a9e"
   strings:
      $x1 = "C:\\Temp\\client.log" fullword wide
      $x2 = "C:\\Temp\\client_ex.log" fullword wide
      $s3 = "GetUserProcessList" fullword ascii
      $s4 = "C://Temp//1.log" fullword wide
      $s5 = "keyLogger" fullword wide
      $s6 = "WinUpdate.exe" fullword wide
      $s7 = "KeylogMutexString" fullword ascii
      $s8 = "GetActiveProcessName" fullword ascii
      $s9 = "DataLogs_keylog_offline.txt" fullword wide
      $s10 = "DataLogs_keylog_online.txt" fullword wide
      $s11 = "Select * from Win32_Processor" fullword wide
      $s12 = "OfflineKeylogger" fullword wide
      $s13 = "keylogparam" fullword ascii
      $s14 = "keylogsetting" fullword wide
      $s15 = "FilterProcessWindow" fullword ascii
      $s16 = "bHpNbDJsUmxqeXV3aEI2UWtqT0FZczM0THlud0VQZEk=" fullword wide /* base64 encoded string 'lzMl2lRljyuwhB6QkjOAYs34LynwEPdI' */
      $s17 = "loadofflinelog" fullword wide
      $s18 = "offlinelog" fullword wide
      $s19 = "KeylogConfFile" fullword ascii
      $s20 = "KeylogParams" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 600KB and
      1 of ($x*) and 4 of them
}

rule sig_2a5dac302572ede5da5d53df170d5882937027b58290b6ea60e24478453276c9 {
   meta:
      description = "samples - file 2a5dac302572ede5da5d53df170d5882937027b58290b6ea60e24478453276c9.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "2a5dac302572ede5da5d53df170d5882937027b58290b6ea60e24478453276c9"
   strings:
      $x1 = "C:\\Temp\\client.log" fullword wide
      $x2 = "C:\\Temp\\client_ex.log" fullword wide
      $s3 = "taskhostw.exe" fullword wide
      $s4 = "GetUserProcessList" fullword ascii
      $s5 = "C://Temp//1.log" fullword wide
      $s6 = "keyLogger" fullword wide
      $s7 = "KeylogMutexString" fullword ascii
      $s8 = "GetActiveProcessName" fullword ascii
      $s9 = "DataLogs_keylog_offline.txt" fullword wide
      $s10 = "DataLogs_keylog_online.txt" fullword wide
      $s11 = "Select * from Win32_Processor" fullword wide
      $s12 = "dns.exe" fullword ascii
      $s13 = "OfflineKeylogger" fullword wide
      $s14 = "keylogparam" fullword ascii
      $s15 = "keylogsetting" fullword wide
      $s16 = "aMRFEICX3kBIi/loMisV2RbhldDHp1hY+JpS+XFhrmzwYlRJmCql8NFwTWC/mVeYXsvG3LOg0wHEH+MG6T8Qtp9DQuNhn9sGTpzLIXDqgX/6Iqmejee6+jG1m00JywNW" wide
      $s17 = "FilterProcessWindow" fullword ascii
      $s18 = "UnZFSWY4Rk9tbVd1SDZtdVFZUVdSMEpKdmVNQ1pDODg=" fullword wide /* base64 encoded string 'RvEIf8FOmmWuH6muQYQWR0JJveMCZC88' */
      $s19 = "loadofflinelog" fullword wide
      $s20 = "offlinelog" fullword wide
   condition:
      uint16(0) == 0x5a4d and filesize < 600KB and
      1 of ($x*) and 4 of them
}

rule sig_7ce2d225442252064d744be1c38e9c1572dd355bbbaf7fa411ce79e41288dfca {
   meta:
      description = "samples - file 7ce2d225442252064d744be1c38e9c1572dd355bbbaf7fa411ce79e41288dfca.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "7ce2d225442252064d744be1c38e9c1572dd355bbbaf7fa411ce79e41288dfca"
   strings:
      $x1 = "Host Process for Windows.exe" fullword wide
      $s2 = "svchost" fullword ascii
      $s3 = "sKpuFtXT9BiFtPH2wVRa4+jYLbV8E5oBWdGo8mGPZvej/qRxWfKB1ZDCruD/vpNFhdM93mthZ6VaRZnqfoDMMaLIYYsaSxarI6OUIjgs1hnM6kwMDUwB0bcDhtcka+vi" wide
      $s4 = "8XCLD/gT/e37o6iZ7TnqfjO6pU0s7E6UrzU2DW1LsxcOmAgK9dSO2zFlAOq09lwGWqTnobcBlRKpzZCbTeFDhUM/cErMAVJByMti41M7/x6nPHscJgUJQ5otpbWceIKV" wide
      $s5 = "dEVkWWM2MHNWUTRIVVpBRGxpOHlMVmxRSG5uRTRhMVM=" fullword wide /* base64 encoded string 'tEdYc60sVQ4HUZADli8yLVlQHnnE4a1S' */
      $s6 = "Venom RAT + HVNC" fullword ascii
      $s7 = "ExfIQZ4qH+YiSpx3WKp5CCdibUGLQ0UZszNx2aGQKeOOvYES5+n2btg3lg6lDm4tVw7Jk6azbJPPTjhKNAECZfTjaFjBqAgWuTCmYe5tFP+Q+KEO6t0WvnQ8BXvdIFdk" wide
      $s8 = "PADPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADD" ascii
      $s9 = "INGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADD" ascii
      $s10 = "INGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADD" fullword ascii
      $s11 = "PADPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADD" ascii
      $s12 = "1.3.135.41" fullword wide
      $s13 = "Copyright Microsoft Corporation" fullword wide
      $s14 = "xwnOiMjGlusYD9MEy8uRLF1Z3hNOpaM64XSvGIiuVexhC1Y2VEBvErj9OrVtFWep+zqwLh/yT0pYwWDvfT2lWQ==" fullword wide
      $s15 = "rAKfffxV4p2mJwLpx5sveRwPwneGaQBsvzy5BLQNHWwgJMIS0RrE/n//tx+hQnrpdh4WRha8oCggPuzvueTGbA==" fullword wide
      $s16 = "11nY73z6qZCSgk3bbv5z5Eh0q7eWCFVN5HeMYfOa7apjHxYphVL5MN27whY2fIr0qJlvXcq6TEEDGeetoMj8dA==" fullword wide
      $s17 = "BYpxBxFngiqjF/4CCwAiyJmLQNZ+BTBt5FKzf/lTliC1SDt8BRWrHoheE1TdGaa76HlnyqJkiW3Brqt5p4HAXw==" fullword wide
      $s18 = "p/fE7G+XZuADL8/CN29KePcjPrjJtO2ciBe9fz5WdgMCdi7UdWKppaTo/G40euqT4t+GcTsv4p8aOtqaIQGEOw==" fullword wide
      $s19 = "6YWQqgycp1jlCGEYjD856Gwrj7Ad/XPFcNQfSV9vnFlQ5OE8iodsGt6eN9MO7Y6t0f1cf+lXVkaey6q/UySv1aYiPMvgtHgEvkTV9IH/KKI=" fullword wide
      $s20 = "OS6r+6e51Qla8WVyCZPmsQHYHCO2yRPUCeSXxn8OxWpUSo1f6Eow6zMkOeUB4Vlulx/vgwyW1bWuXxjkQKjA0Q==" fullword wide
   condition:
      uint16(0) == 0x5a4d and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule sig_67ff6133af6e40080795a330042a914cc49db7503c264428af28b90fe1092a0f {
   meta:
      description = "samples - file 67ff6133af6e40080795a330042a914cc49db7503c264428af28b90fe1092a0f.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "67ff6133af6e40080795a330042a914cc49db7503c264428af28b90fe1092a0f"
   strings:
      $s1 = "C:\\local0\\asf\\release\\build-2.2.14\\support\\Release\\ab.pdb" fullword ascii
      $s2 = " Copyright 1996 Adam Twiss, Zeus Technology Ltd, http://www.zeustech.net/<br>" fullword ascii
      $s3 = "    -T content-type Content-type header for POSTing, eg." fullword ascii
      $s4 = "    -p postfile     File containing data to POST. Remember also to set -T" fullword ascii
      $s5 = "    -i              Use HEAD instead of GET" fullword ascii
      $s6 = "    -h              Display usage information (this message)" fullword ascii
      $s7 = "    -k              Use HTTP KeepAlive feature" fullword ascii
      $s8 = " This is ApacheBench, Version %s <i>&lt;%s&gt;</i><br>" fullword ascii
      $s9 = "    -r              Don't exit on socket receive errors." fullword ascii
      $s10 = " Licensed to The Apache Software Foundation, http://www.apache.org/<br>" fullword ascii
      $s11 = "    -X proxy:port   Proxyserver and port number to use" fullword ascii
      $s12 = "    -H attribute    Add Arbitrary header line, eg. 'Accept-Encoding: gzip'" fullword ascii
      $s13 = "  %d%%  %5I64d" fullword ascii
      $s14 = "                    are a colon separated username and password." fullword ascii
      $s15 = "    -u putfile      File containing data to PUT. Remember also to set -T" fullword ascii
      $s16 = "    -c concurrency  Number of multiple requests to make" fullword ascii
      $s17 = "    -z attributes   String to insert as td or th attributes" fullword ascii
      $s18 = "    -y attributes   String to insert as tr attributes" fullword ascii
      $s19 = "    -b windowsize   Size of TCP send/receive buffer, in bytes" fullword ascii
      $s20 = "    -t timelimit    Seconds to max. wait for responses" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 200KB and
      8 of them
}

rule sig_6dd20416e47edce7d1b4ddc9761bc52a7df7af372a66affb368dacbd2c61bb84 {
   meta:
      description = "samples - file 6dd20416e47edce7d1b4ddc9761bc52a7df7af372a66affb368dacbd2c61bb84.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "6dd20416e47edce7d1b4ddc9761bc52a7df7af372a66affb368dacbd2c61bb84"
   strings:
      $s1 = "C:\\local0\\asf\\release\\build-2.2.14\\support\\Release\\ab.pdb" fullword ascii
      $s2 = " Copyright 1996 Adam Twiss, Zeus Technology Ltd, http://www.zeustech.net/<br>" fullword ascii
      $s3 = "SSSSPSS" fullword ascii /* reversed goodware string 'SSPSSSS' */
      $s4 = "    -T content-type Content-type header for POSTing, eg." fullword ascii
      $s5 = "    -p postfile     File containing data to POST. Remember also to set -T" fullword ascii
      $s6 = "    -i              Use HEAD instead of GET" fullword ascii
      $s7 = "    -h              Display usage information (this message)" fullword ascii
      $s8 = "    -k              Use HTTP KeepAlive feature" fullword ascii
      $s9 = " This is ApacheBench, Version %s <i>&lt;%s&gt;</i><br>" fullword ascii
      $s10 = "    -r              Don't exit on socket receive errors." fullword ascii
      $s11 = " Licensed to The Apache Software Foundation, http://www.apache.org/<br>" fullword ascii
      $s12 = "    -X proxy:port   Proxyserver and port number to use" fullword ascii
      $s13 = "    -H attribute    Add Arbitrary header line, eg. 'Accept-Encoding: gzip'" fullword ascii
      $s14 = "  %d%%  %5I64d" fullword ascii
      $s15 = "                    are a colon separated username and password." fullword ascii
      $s16 = "    -u putfile      File containing data to PUT. Remember also to set -T" fullword ascii
      $s17 = "    -c concurrency  Number of multiple requests to make" fullword ascii
      $s18 = "    -z attributes   String to insert as td or th attributes" fullword ascii
      $s19 = "    -y attributes   String to insert as tr attributes" fullword ascii
      $s20 = "    -b windowsize   Size of TCP send/receive buffer, in bytes" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 200KB and
      8 of them
}

rule ccb61da22c88babe8ad01f4bea2227c0a9465cfb9866c1828ae1961c8b9a899d {
   meta:
      description = "samples - file ccb61da22c88babe8ad01f4bea2227c0a9465cfb9866c1828ae1961c8b9a899d.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "ccb61da22c88babe8ad01f4bea2227c0a9465cfb9866c1828ae1961c8b9a899d"
   strings:
      $s1 = "C:\\local0\\asf\\release\\build-2.2.14\\support\\Release\\ab.pdb" fullword ascii
      $s2 = " Copyright 1996 Adam Twiss, Zeus Technology Ltd, http://www.zeustech.net/<br>" fullword ascii
      $s3 = "    -T content-type Content-type header for POSTing, eg." fullword ascii
      $s4 = "    -p postfile     File containing data to POST. Remember also to set -T" fullword ascii
      $s5 = "    -i              Use HEAD instead of GET" fullword ascii
      $s6 = "    -h              Display usage information (this message)" fullword ascii
      $s7 = "    -k              Use HTTP KeepAlive feature" fullword ascii
      $s8 = " This is ApacheBench, Version %s <i>&lt;%s&gt;</i><br>" fullword ascii
      $s9 = "    -r              Don't exit on socket receive errors." fullword ascii
      $s10 = " Licensed to The Apache Software Foundation, http://www.apache.org/<br>" fullword ascii
      $s11 = "    -X proxy:port   Proxyserver and port number to use" fullword ascii
      $s12 = "    -H attribute    Add Arbitrary header line, eg. 'Accept-Encoding: gzip'" fullword ascii
      $s13 = "  %d%%  %5I64d" fullword ascii
      $s14 = "                    are a colon separated username and password." fullword ascii
      $s15 = "    -u putfile      File containing data to PUT. Remember also to set -T" fullword ascii
      $s16 = "    -c concurrency  Number of multiple requests to make" fullword ascii
      $s17 = "    -z attributes   String to insert as td or th attributes" fullword ascii
      $s18 = "    -y attributes   String to insert as tr attributes" fullword ascii
      $s19 = "    -b windowsize   Size of TCP send/receive buffer, in bytes" fullword ascii
      $s20 = "    -t timelimit    Seconds to max. wait for responses" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 200KB and
      8 of them
}

rule a11fbdded656bcd76edfbc2dede2cb854cdb5f5dbc688a8a9b2169f0eef273fb {
   meta:
      description = "samples - file a11fbdded656bcd76edfbc2dede2cb854cdb5f5dbc688a8a9b2169f0eef273fb.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "a11fbdded656bcd76edfbc2dede2cb854cdb5f5dbc688a8a9b2169f0eef273fb"
   strings:
      $s1 = "C:\\local0\\asf\\release\\build-2.2.14\\support\\Release\\ab.pdb" fullword ascii
      $s2 = " Copyright 1996 Adam Twiss, Zeus Technology Ltd, http://www.zeustech.net/<br>" fullword ascii
      $s3 = "    -T content-type Content-type header for POSTing, eg." fullword ascii
      $s4 = "    -p postfile     File containing data to POST. Remember also to set -T" fullword ascii
      $s5 = "    -i              Use HEAD instead of GET" fullword ascii
      $s6 = "    -h              Display usage information (this message)" fullword ascii
      $s7 = "    -k              Use HTTP KeepAlive feature" fullword ascii
      $s8 = " This is ApacheBench, Version %s <i>&lt;%s&gt;</i><br>" fullword ascii
      $s9 = "    -r              Don't exit on socket receive errors." fullword ascii
      $s10 = " Licensed to The Apache Software Foundation, http://www.apache.org/<br>" fullword ascii
      $s11 = "    -X proxy:port   Proxyserver and port number to use" fullword ascii
      $s12 = "    -H attribute    Add Arbitrary header line, eg. 'Accept-Encoding: gzip'" fullword ascii
      $s13 = "  %d%%  %5I64d" fullword ascii
      $s14 = "                    are a colon separated username and password." fullword ascii
      $s15 = "    -u putfile      File containing data to PUT. Remember also to set -T" fullword ascii
      $s16 = "    -c concurrency  Number of multiple requests to make" fullword ascii
      $s17 = "    -z attributes   String to insert as td or th attributes" fullword ascii
      $s18 = "    -y attributes   String to insert as tr attributes" fullword ascii
      $s19 = "    -b windowsize   Size of TCP send/receive buffer, in bytes" fullword ascii
      $s20 = "    -t timelimit    Seconds to max. wait for responses" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 200KB and
      8 of them
}

rule sig_14f21a1b7991bae07182b22c03f633e54e39a581e4898cb95eb5853e4359c819 {
   meta:
      description = "samples - file 14f21a1b7991bae07182b22c03f633e54e39a581e4898cb95eb5853e4359c819.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "14f21a1b7991bae07182b22c03f633e54e39a581e4898cb95eb5853e4359c819"
   strings:
      $s1 = "%c%c%c%c%c%c%c%c%cMSSE-%d-server" fullword ascii
      $s2 = "  VirtualQuery failed for %d bytes at address %p" fullword ascii
      $s3 = "6#6%2#*%2#" fullword ascii /* hex encoded string 'f"' */
      $s4 = "6#B@0#&@0#" fullword ascii /* hex encoded string 'k' */
      $s5 = "  VirtualProtect failed with code 0x%x" fullword ascii
      $s6 = "IPf.vzW#" fullword ascii
      $s7 = "gV:\"#r" fullword ascii
      $s8 = "ksQ:\"1" fullword ascii
      $s9 = "  Unknown pseudo relocation protocol version %d." fullword ascii
      $s10 = "CnrcJh3WH^=" fullword ascii
      $s11 = "jWMRiWQ" fullword ascii
      $s12 = "zOdt3Lst:" fullword ascii
      $s13 = "hWGRm[W" fullword ascii
      $s14 = "jLeb&[db%R" fullword ascii
      $s15 = "*#r[mb,[ob.Elx/" fullword ascii
      $s16 = "TgKffc}" fullword ascii
      $s17 = "eewH2l*o3VLja" fullword ascii
      $s18 = "x^FRmSPRoAF" fullword ascii
      $s19 = "zOau%[fb'[db%R" fullword ascii
      $s20 = "bOdt3Lst:" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 1000KB and
      8 of them
}

rule a9b37a8c3a1a2476a2e44d0dcba2b117bd300983b337af45de92d31881170962 {
   meta:
      description = "samples - file a9b37a8c3a1a2476a2e44d0dcba2b117bd300983b337af45de92d31881170962.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "a9b37a8c3a1a2476a2e44d0dcba2b117bd300983b337af45de92d31881170962"
   strings:
      $s1 = "%c%c%c%c%c%c%c%c%cMSSE-%d-server" fullword ascii
      $s2 = "  VirtualQuery failed for %d bytes at address %p" fullword ascii
      $s3 = "  VirtualProtect failed with code 0x%x" fullword ascii
      $s4 = "  Unknown pseudo relocation protocol version %d." fullword ascii
      $s5 = "tTIcB<L" fullword ascii
      $s6 = "tSIcK<L" fullword ascii
      $s7 = "gOLmlBEc]azIVlsGK{hU@va[" fullword ascii
      $s8 = "O9C6OYCVOyCvO" fullword ascii
      $s9 = "M9A6MYAVMyAvM" fullword ascii
      $s10 = "K&G1KFGQKVG" fullword ascii
      $s11 = "M&A1M6A!MFAQMVAAMfAqMvAaM" fullword ascii
      $s12 = "D9H6DYHVDyHvD" fullword ascii
      $s13 = "G9K6GYKVGyKvG" fullword ascii
      $s14 = "C&O1C6O!CFOQCVOACfOqCvOaC" fullword ascii
      $s15 = "I9E6IYEVIqE~I" fullword ascii
      $s16 = "VKPn CL" fullword ascii
      $s17 = "F9J6FYJVFyJvF" fullword ascii
      $s18 = "A9M6AYMVAyMvA" fullword ascii
      $s19 = "eKLcy]Vq" fullword ascii
      $s20 = "9G6KYGVKyGvK" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 1000KB and
      8 of them
}

rule ab0486b2252a7c4c577ca2d3082084418b624f6c28a5ae27aa22add6236d05ce {
   meta:
      description = "samples - file ab0486b2252a7c4c577ca2d3082084418b624f6c28a5ae27aa22add6236d05ce.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "ab0486b2252a7c4c577ca2d3082084418b624f6c28a5ae27aa22add6236d05ce"
   strings:
      $s1 = "SilverClient.exe" fullword wide
      $s2 = "t9H0tGywaq23QHywsvniYlva2DUEoHwEX4RZOKw6QYOUUUEs6+qPhkwL0ziJc2nYj2yd5E4o3kMJj8NRpRTkpZcyIg/ljsBjIY4uuTgySYNYShSJRrNgQc/XiUXjH546" wide
      $s3 = "SilverMutex_rErbtDmADp" fullword wide
      $s4 = "b0FGeVZNcFRMWVloVHR6Z0VESU5RdlpZUmxZbUFE" fullword wide /* base64 encoded string 'oAFyVMpTLYYhTtzgEDINQvZYRlYmAD' */
      $s5 = "get_ActivatePong" fullword ascii
      $s6 = "Ivan Medvedev" fullword ascii
      $s7 = "GetInformationOS" fullword ascii
      $s8 = "KeyX509" fullword ascii
      $s9 = "strToHash" fullword ascii
      $s10 = "RegistryKeyType" fullword ascii
      $s11 = "MIIE4DCCAsigAwIBAgIQAKQYOfZd86J2BfNjhG4CWTANBgkqhkiG9w0BAQ0FADARMQ8wDQYDVQQDDAZTaWx2ZXIwIBcNMjIwODI2MTkwMTA4WhgPOTk5OTEyMzEyMzU5" wide
      $s12 = "Serversignature" fullword ascii
      $s13 = "DecryptBytes" fullword ascii
      $s14 = "Nackname" fullword wide
      $s15 = "TcpClient" fullword ascii /* Goodware String - occured 30 times */
      $s16 = "Socket" fullword ascii /* Goodware String - occured 140 times */
      $s17 = "Connection" fullword ascii /* Goodware String - occured 311 times */
      $s18 = "HKEY_CURRENT_USER" fullword ascii /* Goodware String - occured 495 times */
      $s19 = "HKEY_LOCAL_MACHINE" fullword ascii /* Goodware String - occured 534 times */
      $s20 = "MsgType" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 100KB and
      8 of them
}

rule ff6cf1010d124f32125a30dac97287694ca94ca277fd2d6a78b194d55177fb20 {
   meta:
      description = "samples - file ff6cf1010d124f32125a30dac97287694ca94ca277fd2d6a78b194d55177fb20.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "ff6cf1010d124f32125a30dac97287694ca94ca277fd2d6a78b194d55177fb20"
   strings:
      $s1 = "C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\RegAsm.exe" fullword wide
      $s2 = "Project1.exe" fullword wide
      $s3 = "C:\\Program Files (x86)\\Microsoft Visual Studio\\VB98\\VB6.OLB" fullword ascii
      $s4 = "man`fbavatobkam2+\"6SWR3Eonkaman' $'$'2)(-'+'(' $'$'2)(-'+'(' $'U'2)(-'+anafbabatonkamanafbabatonkamanafbabatonkamanafbabatonkam" ascii
      $s5 = "LYBC)$*( A#!A23=9/?$M*+8KOLOLtoCFL@L+/\"B$!A$='= 9$N*#;LOLYBnkamLCLKO#'&=!N/2,A>3/4 6$T$+2L@LCLfOLOLY* /A)2/A60(4  *N $4LCLKOaba" ascii
      $s6 = "SafM4+%IonkN)\"SafbaOLYBC)$*( A%'36(2&-*5(LCLKOaOLYBC./)A-$46($(7.:.L@LCLfbaOLYBC)$*( A\"*A2 &.#.5(3=LKOLOatoCFL@L+/\"B%*A$.<*,(" ascii
      $s7 = "a5afbabatonkamanafbabatonkamanafbabatonkamanafbabatonkamanafbabatonkamanafbabatonkamanafbabatonkamanafbabatonkamanafbabatonkaman" ascii
      $s8 = "bato.kam" fullword ascii
      $s9 = "lffbaba.lik" fullword ascii
      $s10 = "[o\\r_xWFPLP1^#Z:\\" fullword ascii
      $s11 = "gea.iik%kfnI`eatgso" fullword ascii
      $s12 = "gmkaPa.afm" fullword ascii
      $s13 = "L4onkamanafbabaYB.kCh" fullword ascii
      $s14 = "FIrat:8" fullword ascii
      $s15 = "falhpsPY" fullword ascii
      $s16 = "/#%&$$&<&$ - /!170264\"862;" fullword ascii
      $s17 = "babatonkamanafbabatonkamanafbabatonkamanafbabatonkamanafbabatonkamanafbabatonkamanafbabatonkamanafbabatonkamanafbabatonkamanafba" ascii
      $s18 = "amanafbabatonkamanafbabatonkamanafbabatonkamanafbabatonkamanafbabatonkamanafbabatonkaman" fullword ascii
      $s19 = "abauonkaman" fullword ascii
      $s20 = "amanafbabatonkamanafbabatonkamanafbabatonkamanafbabatonkaman" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 2000KB and
      8 of them
}

rule sig_50ce164844684892d697f16bc194d82841e4c1b951609d12bc26cab8b028192e {
   meta:
      description = "samples - file 50ce164844684892d697f16bc194d82841e4c1b951609d12bc26cab8b028192e.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "50ce164844684892d697f16bc194d82841e4c1b951609d12bc26cab8b028192e"
   strings:
      $s1 = "AsyncClient.exe" fullword ascii
      $s2 = "Stub.exe" fullword wide
      $s3 = "jor.exe" fullword wide
      $s4 = "ShrVfK+ksTiZrt0zvY6p+De6Jy5KGGk1zHtHPNIZ/i9KnX7wJQCXpi7upaTRO/O9ojhQIcvlo4eulbLfP453n0fuiu8ddFq23Ld32p7Z68ThRsnhv42qKSOzGcwMdiGA" wide
      $s5 = "Select * from Win32_ComputerSystem" fullword wide
      $s6 = "Nk9uSmNHcFdyN2FXdlBJd253bXNsTE1vdFpuamtHYW4=" fullword wide /* base64 encoded string '6OnJcGpWr7aWvPIwnwmslLMotZnjkGan' */
      $s7 = "    <asmv3:windowsSettings xmlns=\"http://schemas.microsoft.com/SMI/2005/WindowsSettings\">" fullword ascii
      $s8 = "vmware" fullword wide
      $s9 = "Pastebin" fullword wide
      $s10 = "get_ActivatePong" fullword ascii
      $s11 = "strToHash" fullword ascii
      $s12 = "Client.Handle_Packet" fullword ascii
      $s13 = "OU673Idd1ryIDRLlDtUHg+iwpsgjrS5VDuBgI8o55cMjT/X4WddakLYWg4vjpdLRu1b12BHKIwVDm/fKA/POqYGndMv11hpRqu5gWeCuAeJ7armLhsjGWfQCHHxJR5K1" wide
      $s14 = "Serversignature" fullword ascii
      $s15 = "microsoft corporation" fullword wide
      $s16 = "\\nuR\\noisreVtnerruC\\swodniW\\tfosorciM\\erawtfoS" fullword wide
      $s17 = "VirtualBox" fullword wide /* Goodware String - occured 5 times */
      $s18 = "Sha256" fullword ascii /* Goodware String - occured 11 times */
      $s19 = "Antivirus" fullword wide /* Goodware String - occured 31 times */
      $s20 = "Manufacturer" fullword wide /* Goodware String - occured 392 times */
   condition:
      uint16(0) == 0x5a4d and filesize < 100KB and
      8 of them
}

rule sig_07d35c2c242d2c2a7bbf3d70315f7679c90b3f5a32b2ff542fdfca8a0b9cb4c8 {
   meta:
      description = "samples - file 07d35c2c242d2c2a7bbf3d70315f7679c90b3f5a32b2ff542fdfca8a0b9cb4c8.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "07d35c2c242d2c2a7bbf3d70315f7679c90b3f5a32b2ff542fdfca8a0b9cb4c8"
   strings:
      $s1 = "Stub.exe" fullword wide
      $s2 = "Select * from Win32_ComputerSystem" fullword wide
      $s3 = "NzBfbllHWVNn" fullword ascii /* base64 encoded string '70_nYGYSg' */
      $s4 = "OVdMUTlGcHZqZm5leUxqNEljZWxPMjd2QTFpb3pFZDU=" fullword wide /* base64 encoded string '9WLQ9FpvjfneyLj4IcelO27vA1iozEd5' */
      $s5 = "    <asmv3:windowsSettings xmlns=\"http://schemas.microsoft.com/SMI/2005/WindowsSettings\">" fullword ascii
      $s6 = "WylbChBKhbIcJUELRhigfS57cyinAHtc+eGhgMCBGReN/DHYP0swcuZU2bo5F1Uno6ujzb7oQTWg/EJm61frY2d2mcqcbUKZDHPTVg2n/qgByH6ZasdKvMvm6CvPX0JN" wide
      $s7 = "vmware" fullword wide
      $s8 = "get_ActivatePong" fullword ascii
      $s9 = "Pastebin" fullword wide
      $s10 = "xgSKrruncg" fullword ascii
      $s11 = "frUnnhvRIfTNT" fullword ascii
      $s12 = "ikEYIKyyovCJ" fullword ascii
      $s13 = "UcmdhaTkWEqYryrg" fullword ascii
      $s14 = "zoJnwCEkx52XfR/5AbDepq4yNrOdYY9TIBdSuizfyCAM7RAdglUPNyYYLVcl1LEPogzA2dsEeJb7sI+lKH7uValKXJ/d93Z/yreF0OTNnR42lfoywohwmENOYS9Uh9Fe" wide
      $s15 = "microsoft corporation" fullword wide
      $s16 = "\\nuR\\noisreVtnerruC\\swodniW\\tfosorciM\\erawtfoS" fullword wide
      $s17 = "VirtualBox" fullword wide /* Goodware String - occured 5 times */
      $s18 = "Antivirus" fullword wide /* Goodware String - occured 31 times */
      $s19 = "Socket" fullword ascii /* Goodware String - occured 140 times */
      $s20 = "Manufacturer" fullword wide /* Goodware String - occured 392 times */
   condition:
      uint16(0) == 0x5a4d and filesize < 100KB and
      8 of them
}

rule ef50f2acca59baa3c2565a2241fd895d535b10586beb65bd72f9e0bea6462649 {
   meta:
      description = "samples - file ef50f2acca59baa3c2565a2241fd895d535b10586beb65bd72f9e0bea6462649.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "ef50f2acca59baa3c2565a2241fd895d535b10586beb65bd72f9e0bea6462649"
   strings:
      $s1 = "  <description></description>" fullword ascii
      $s2 = "    processorArchitecture=\"X86\"" fullword ascii
      $s3 = "        processorArchitecture=\"X86\"" fullword ascii
      $s4 = "        publicKeyToken=\"6595b64144ccf1df\"" fullword ascii
      $s5 = "        version=\"6.0.0.0\"" fullword ascii
      $s6 = "    version=\"1.0.0.0\"" fullword ascii
      $s7 = "Q:\\De8A" fullword ascii
      $s8 = "        name=\"Microsoft.Windows.Common-Controls\"" fullword ascii
      $s9 = "blvDqBF" fullword ascii
      $s10 = "VOAW%E]" fullword ascii
      $s11 = "    name=\"CompanyName.ProductName.YourApp\"" fullword ascii
      $s12 = "\\=h?eD" fullword ascii
      $s13 = "@LK6}|" fullword ascii
      $s14 = "WOc%\"4" fullword ascii
      $s15 = "~A{S(%Z" fullword ascii
      $s16 = "Y|!IdQq;u" fullword ascii
      $s17 = "*3&;{(n[ 7\"" fullword ascii
      $s18 = "A(LFnO" fullword ascii
      $s19 = "t<H9-J=" fullword ascii
      $s20 = "cHz(\\R" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 90KB and
      8 of them
}

rule sig_81b7a88094afc7849af4f05d933cf46a5f8ab7ef913c74b320b5153e3cfa08b5 {
   meta:
      description = "samples - file 81b7a88094afc7849af4f05d933cf46a5f8ab7ef913c74b320b5153e3cfa08b5.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "81b7a88094afc7849af4f05d933cf46a5f8ab7ef913c74b320b5153e3cfa08b5"
   strings:
      $x1 = "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?> <assembly xmlns=\"urn:schemas-microsoft-com:asm.v1\" manifestVersi" ascii
      $s2 = " or \"requireAdministrator\" --> <v3:requestedExecutionLevel level=\"highestAvailable\" /> </v3:requestedPrivileges> </v3:securi" ascii
      $s3 = "> <dependency> <dependentAssembly> <assemblyIdentity type=\"win32\" name=\"Microsoft.Windows.Common-Controls\" version=\"6.0.0.0" ascii
      $s4 = "v3=\"urn:schemas-microsoft-com:asm.v3\"> <v3:security> <v3:requestedPrivileges> <!-- level can be \"asInvoker\", \"highestAvaila" ascii
      $s5 = "cessorArchitecture=\"*\" publicKeyToken=\"6595b64144ccf1df\" language=\"*\" /> </dependentAssembly> </dependency> <v3:trustInfo " ascii
      $s6 = "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?> <assembly xmlns=\"urn:schemas-microsoft-com:asm.v1\" manifestVersi" ascii
      $s7 = "DgzyUpD\\" fullword ascii
      $s8 = "[]A\\A]A^A_" fullword ascii /* Goodware String - occured 2 times */
      $s9 = "M4\"P@y5Xf;" fullword ascii
      $s10 = "F,JPlPo" fullword ascii
      $s11 = "~>iK7}8" fullword ascii
      $s12 = "G-w?yF" fullword ascii
      $s13 = "+2U'c]F" fullword ascii
      $s14 = "vw[8Z`" fullword ascii
      $s15 = "fS3/*u" fullword ascii
      $s16 = "IG(&E-&" fullword ascii
      $s17 = "KR/:E3" fullword ascii
      $s18 = "Jyl()#" fullword ascii
      $s19 = "05-M:k" fullword ascii
      $s20 = "qF\\PV8" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 100KB and
      1 of ($x*) and 4 of them
}

rule da7e3ec3246fde5e42f11dd557cf23af84460b5e6048f84e5db35a15c899fb2c {
   meta:
      description = "samples - file da7e3ec3246fde5e42f11dd557cf23af84460b5e6048f84e5db35a15c899fb2c.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "da7e3ec3246fde5e42f11dd557cf23af84460b5e6048f84e5db35a15c899fb2c"
   strings:
      $x1 = "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?> <assembly xmlns=\"urn:schemas-microsoft-com:asm.v1\" manifestVersi" ascii
      $s2 = " or \"requireAdministrator\" --> <v3:requestedExecutionLevel level=\"highestAvailable\" /> </v3:requestedPrivileges> </v3:securi" ascii
      $s3 = "> <dependency> <dependentAssembly> <assemblyIdentity type=\"win32\" name=\"Microsoft.Windows.Common-Controls\" version=\"6.0.0.0" ascii
      $s4 = "v3=\"urn:schemas-microsoft-com:asm.v3\"> <v3:security> <v3:requestedPrivileges> <!-- level can be \"asInvoker\", \"highestAvaila" ascii
      $s5 = "cessorArchitecture=\"*\" publicKeyToken=\"6595b64144ccf1df\" language=\"*\" /> </dependentAssembly> </dependency> <v3:trustInfo " ascii
      $s6 = "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?> <assembly xmlns=\"urn:schemas-microsoft-com:asm.v1\" manifestVersi" ascii
      $s7 = "[]A\\A]A^A_" fullword ascii /* Goodware String - occured 2 times */
      $s8 = "M4\"P@y5Xf;" fullword ascii
      $s9 = "F,JPlPo" fullword ascii
      $s10 = "~>iK7}8" fullword ascii
      $s11 = "G-w?yF" fullword ascii
      $s12 = "+2U'c]F" fullword ascii
      $s13 = "fS3/*u" fullword ascii
      $s14 = "IG(&E-&" fullword ascii
      $s15 = "KR/:E3" fullword ascii
      $s16 = "05-M:k" fullword ascii
      $s17 = "qF\\PV8" fullword ascii
      $s18 = "Dvi(KT" fullword ascii
      $s19 = "]59Ct5" fullword ascii
      $s20 = "(]_^[H" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 100KB and
      1 of ($x*) and 4 of them
}

rule sig_979af7b0ab4fd1775265bdcba58eec56485e2b727f6af8f908c6944192c2904c {
   meta:
      description = "samples - file 979af7b0ab4fd1775265bdcba58eec56485e2b727f6af8f908c6944192c2904c.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "979af7b0ab4fd1775265bdcba58eec56485e2b727f6af8f908c6944192c2904c"
   strings:
      $s1 = "PAYLOAD:" fullword ascii
      $s2 = "YZAXAYAZH" fullword ascii
      $s3 = "47.116.192.150" fullword ascii
      $s4 = "AQAPRH1" fullword ascii
      $s5 = "/vDmONOmZ/6FwornF4wNoleCR6Q9yDKwJxaaElcpANBrGjwm-WWCnAVMfyke5K9Cb2rW9ZlHxFnjJ6k3YCdt" fullword ascii
      $s6 = "SZAXM1" fullword ascii
      $s7 = "AXAX^H" fullword ascii
      $s8 = "SYj@ZI" fullword ascii
      $s9 = "Rich}E" fullword ascii
      $s10 = "@.ecyo" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 20KB and
      all of them
}

rule sig_5571da8b626b5273d42c976e57d66906060d534046b7d279edfa11b68dfe091e {
   meta:
      description = "samples - file 5571da8b626b5273d42c976e57d66906060d534046b7d279edfa11b68dfe091e.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "5571da8b626b5273d42c976e57d66906060d534046b7d279edfa11b68dfe091e"
   strings:
      $s1 = "PAYLOAD:" fullword ascii
      $s2 = "AQAPRH1" fullword ascii
      $s3 = "AXAX^YZAXAYAZH" fullword ascii
      $s4 = "Rich}E" fullword ascii
      $s5 = "}(XAWYh" fullword ascii
      $s6 = "@.jdlj" fullword ascii
      $s7 = "A^PPM1" fullword ascii
      $s8 = "R QVM1" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 20KB and
      all of them
}

rule e5bcef72212f77a5390675d5fc24433af0e682db535969894f967a409eefb8aa {
   meta:
      description = "samples - file e5bcef72212f77a5390675d5fc24433af0e682db535969894f967a409eefb8aa.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "e5bcef72212f77a5390675d5fc24433af0e682db535969894f967a409eefb8aa"
   strings:
      $s1 = "(http://www.eyuyan.com)" fullword wide
      $s2 = "aHxW!." fullword ascii
      $s3 = " -76jEiP!>" fullword ascii
      $s4 = ";eCx:\"5" fullword ascii
      $s5 = "7.31.0.0" fullword wide
      $s6 = "ctunyt" fullword ascii
      $s7 = "moH* n" fullword ascii
      $s8 = "5<+ B_G" fullword ascii
      $s9 = "%z%`!(." fullword ascii
      $s10 = "+ 3Aafg" fullword ascii
      $s11 = "SNIKSe;" fullword ascii
      $s12 = ",kNjGU6%" fullword ascii
      $s13 = "oGAs4kp" fullword ascii
      $s14 = "OExZ@M'R" fullword ascii
      $s15 = "Zyfou9p" fullword ascii
      $s16 = "fDkI08.e8" fullword ascii
      $s17 = "UWxe$X8" fullword ascii
      $s18 = "Eiwv@kZ" fullword ascii
      $s19 = "Ot.jki" fullword ascii
      $s20 = "m{.qVg" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 1000KB and
      8 of them
}

/* Super Rules ------------------------------------------------------------- */

rule _521d404952876e51d0cf3a4d0d69e30566406a3a129343d5e53d5d7274f4d3dc_0843b763880a4e1b559d29140afff5cd867bcada20eda6db2524d4e504_0 {
   meta:
      description = "samples - from files 521d404952876e51d0cf3a4d0d69e30566406a3a129343d5e53d5d7274f4d3dc.exe, 0843b763880a4e1b559d29140afff5cd867bcada20eda6db2524d4e5045af114.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "521d404952876e51d0cf3a4d0d69e30566406a3a129343d5e53d5d7274f4d3dc"
      hash2 = "0843b763880a4e1b559d29140afff5cd867bcada20eda6db2524d4e5045af114"
   strings:
      $x1 = "fSystem.Drawing.Icon, System.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3ajSystem.CodeDom.MemberAtt" ascii
      $x2 = "fSystem.Drawing.Icon, System.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3ajSystem.CodeDom.MemberAtt" ascii
      $s3 = "vJiGl01UUJfXfNWas3.DyyVDbaRvM1YfIq9il+AXBrnIFfMAfABnJrF9+z0oyxsqySXMDuI4ZyY`1[[System.Object, mscorlib, Version=4.0.0.0, Culture" ascii
      $s4 = "hSystem.Drawing.Bitmap, System.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3aPADPADZ" fullword ascii
      $s5 = "ExecuteActivityWorkItemPool" fullword ascii
      $s6 = "ExecuteSynchronousExpressionWorkItemPool" fullword ascii
      $s7 = "ersion=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089fSystem.Drawing.Size, System.Drawing, Version=4.0.0.0, Culture=n" ascii
      $s8 = "ributes, System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089mSystem.Globalization.CultureInfo, mscorlib, V" ascii
      $s9 = "AsyncCodeActivity.BeginExecute must return an IAsyncResult where IAsyncResult.AsyncState is the state object provided by the run" ascii
      $s10 = "OnExecuteComplete" fullword ascii
      $s11 = "'s metadata cannot be manipulated.  This error might also indicate that you are attempting to execute a workflow whose root acti" ascii
      $s12 = "An error occurred while attempting to extract the target object of type '{0}' from the method call expression '{1}'.  Note that " ascii
      $s13 = "The Variable bound to the 'Target' InArgument has a null value. The 'Target' InArgument should be set using a valid Compensation" ascii
      $s14 = "HasNotExecuted" fullword ascii
      $s15 = "ExecuteInResolutionContextUntyped" fullword ascii
      $s16 = "ExecuteActionBookmark" fullword ascii
      $s17 = "\\System.Activities.Hosting.WorkflowInstanceExtensionCollection+<GetInstanceExtensions>d__26`1" fullword ascii
      $s18 = "ExecuteActivityWorkItem" fullword ascii
      $s19 = "vJiGl01UUJfXfNWas3.DyyVDbaRvM1YfIq9il+AXBrnIFfMAfABnJrF9+z0oyxsqySXMDuI4ZyY`1[[System.Object, mscorlib, Version=4.0.0.0, Culture" ascii
      $s20 = "ExecuteTrack" fullword ascii
   condition:
      ( uint16(0) == 0x5a4d and filesize < 14000KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _1314eb993b4effdda7e10527b7fd8996f94c7c5cf817f23ce340647728f0e57a_71af9ae73d69eff082dd445af8d96351cd106afd0ca27824d35a8a667f_1 {
   meta:
      description = "samples - from files 1314eb993b4effdda7e10527b7fd8996f94c7c5cf817f23ce340647728f0e57a.exe, 71af9ae73d69eff082dd445af8d96351cd106afd0ca27824d35a8a667f7ef38b.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "1314eb993b4effdda7e10527b7fd8996f94c7c5cf817f23ce340647728f0e57a"
      hash2 = "71af9ae73d69eff082dd445af8d96351cd106afd0ca27824d35a8a667f7ef38b"
   strings:
      $s1 = "api-ms-win-core-synch-l1-2-0.dll" fullword wide /* reversed goodware string 'lld.0-2-1l-hcnys-eroc-niw-sm-ipa' */
      $s2 = "VComdlg32.dll" fullword wide
      $s3 = "C:\\Users\\Administrator\\Documents\\Tencent Files\\295589399\\FileRecv\\" fullword ascii
      $s4 = "VKernel32.dll" fullword wide
      $s5 = "Vkernel32.dll" fullword wide
      $s6 = "euxtheme.dll" fullword wide
      $s7 = "HP_Loder.exe" fullword ascii
      $s8 = "D:\\a\\_work\\1\\s\\src\\vctools\\VC7Libs\\Ship\\ATLMFC\\Src\\MFC\\oledrop2.cpp" fullword ascii
      $s9 = "%s%s%X.tmp" fullword ascii
      $s10 = "http://tsa.starfieldtech.com0" fullword ascii
      $s11 = "D:\\a\\_work\\1\\s\\src\\vctools\\VC7Libs\\Ship\\ATLMFC\\Src\\MFC\\oleipfrm.cpp" fullword ascii
      $s12 = ")\\HP Loder\\Release\\HP Loder.pdb" fullword ascii
      $s13 = "D:\\a\\_work\\1\\s\\src\\vctools\\VC7Libs\\Ship\\ATLMFC\\Src\\MFC\\winctrl2.cpp" fullword ascii
      $s14 = "D:\\a\\_work\\1\\s\\src\\vctools\\VC7Libs\\Ship\\ATLMFC\\Src\\MFC\\auxdata.cpp" fullword ascii
      $s15 = "D:\\a\\_work\\1\\s\\src\\vctools\\VC7Libs\\Ship\\ATLMFC\\Src\\MFC\\viewcore.cpp" fullword ascii
      $s16 = "D:\\a\\_work\\1\\s\\src\\vctools\\VC7Libs\\Ship\\ATLMFC\\Src\\MFC\\filecore.cpp" fullword ascii
      $s17 = "D:\\a\\_work\\1\\s\\src\\vctools\\VC7Libs\\Ship\\ATLMFC\\Src\\MFC\\olestrm.cpp" fullword ascii
      $s18 = "D:\\a\\_work\\1\\s\\src\\vctools\\VC7Libs\\Ship\\ATLMFC\\Src\\MFC\\array_s.cpp" fullword ascii
      $s19 = "D:\\a\\_work\\1\\s\\src\\vctools\\VC7Libs\\Ship\\ATLMFC\\Include\\afxwin2.inl" fullword ascii
      $s20 = "D:\\a\\_work\\1\\s\\src\\vctools\\VC7Libs\\Ship\\ATLMFC\\Include\\afxwin1.inl" fullword ascii
   condition:
      ( uint16(0) == 0x5a4d and filesize < 15000KB and ( 8 of them )
      ) or ( all of them )
}

rule _eb7aa3469a93e430a4954aaab1520f3b7ebb66055e621a27e79842f4c8db6ea8_e583a74eee0a4dca05e41b16b1d384302c7130f2c88e3e9fd6602901f6_2 {
   meta:
      description = "samples - from files eb7aa3469a93e430a4954aaab1520f3b7ebb66055e621a27e79842f4c8db6ea8.exe, e583a74eee0a4dca05e41b16b1d384302c7130f2c88e3e9fd6602901f6afdb9a.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "eb7aa3469a93e430a4954aaab1520f3b7ebb66055e621a27e79842f4c8db6ea8"
      hash2 = "e583a74eee0a4dca05e41b16b1d384302c7130f2c88e3e9fd6602901f6afdb9a"
   strings:
      $x1 = "<file name=\"winhttp.dll\" loadFrom=\"%SystemRoot%\\system32\\\" />" fullword ascii
      $x2 = "<file name=\"version.dll\" loadFrom=\"%SystemRoot%\\system32\\\" />" fullword ascii
      $x3 = "<file name=\"comctl32.dll\" loadFrom=\"%SystemRoot%\\system32\\\" />" fullword ascii
      $s4 = "<file name=\"textshaping.dll\" loadFrom=\"%SystemRoot%\\system32\\\" />" fullword ascii
      $s5 = "<file name=\"mpr.dll\" loadFrom=\"%SystemRoot%\\system32\\\" />" fullword ascii
      $s6 = "<file name=\"netutils.dll\" loadFrom=\"%SystemRoot%\\system32\\\" />" fullword ascii
      $s7 = "<file name=\"netapi32.dll\" loadFrom=\"%SystemRoot%\\system32\\\" />" fullword ascii
      $s8 = "SystemphH" fullword ascii /* base64 encoded string 'K+-zja' */
      $s9 = "SetupLdr.exe" fullword ascii
      $s10 = "FHeaderProcessed" fullword ascii
      $s11 = "For more detailed information, please visit https://jrsoftware.org/ishelp/index.php?topic=setupcmdline" fullword wide
      $s12 = "SystemlQC" fullword ascii /* base64 encoded string 'K+-ziP' */
      $s13 = "SystemtNH" fullword ascii /* base64 encoded string 'K+-zkM' */
      $s14 = ":http://secure.globalsign.com/cacert/codesigningrootr45.crt0A" fullword ascii
      $s15 = "-http://ocsp.globalsign.com/codesigningrootr450F" fullword ascii
      $s16 = "0http://crl.globalsign.com/codesigningrootr45.crl0V" fullword ascii
      $s17 = "TComponent.GetObservers$0$Intf" fullword ascii
      $s18 = "TComponent.GetObservers$1$Intf" fullword ascii
      $s19 = "TSetupProcessorArchitectures" fullword ascii
      $s20 = "TComponent.GetObservers$ActRecL" fullword ascii
   condition:
      ( uint16(0) == 0x5a4d and filesize < 6000KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _7df44db488eeb747b7875331dfc29481aaf77789fe909f8dbf5d84abf072e2b2_dbfd6c69423e517932f611242d5c6a287d7dd8512e947283eded1b0e02_3 {
   meta:
      description = "samples - from files 7df44db488eeb747b7875331dfc29481aaf77789fe909f8dbf5d84abf072e2b2.exe, dbfd6c69423e517932f611242d5c6a287d7dd8512e947283eded1b0e0223e461.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "7df44db488eeb747b7875331dfc29481aaf77789fe909f8dbf5d84abf072e2b2"
      hash2 = "dbfd6c69423e517932f611242d5c6a287d7dd8512e947283eded1b0e0223e461"
   strings:
      $s1 = "schannel: Failed to import cert file %s, password is bad" fullword ascii
      $s2 = "SEC_E_ILLEGAL_MESSAGE (0x%08X) - This error usually occurs when a fatal SSL/TLS alert is received (e.g. handshake failed). More " ascii
      $s3 = "Failed reading the chunked-encoded stream" fullword ascii
      $s4 = "Negotiate: noauthpersist -> %d, header part: %s" fullword ascii
      $s5 = "failed to load WS2_32.DLL (%u)" fullword ascii
      $s6 = "lastlogin" fullword ascii
      $s7 = "schannel: CertGetNameString() failed to match connection hostname (%s) against server certificate names" fullword ascii
      $s8 = "start cmd /C \"color b && title Error && echo " fullword ascii
      $s9 = "LOGINDISL" fullword ascii
      $s10 = "No more connections allowed to host %s: %zu" fullword ascii
      $s11 = "RESOLVE %s:%d is - old addresses discarded!" fullword ascii
      $s12 = "Content-Disposition: %s%s%s%s%s%s%s" fullword ascii
      $s13 = "Content-Type: %s%s%s" fullword ascii
      $s14 = "Excess found in a read: excess = %zu, size = %I64d, maxdownload = %I64d, bytecount = %I64d" fullword ascii
      $s15 = "imgui_log.txt" fullword ascii
      $s16 = "SOCKS4%s: connecting to HTTP proxy %s port %d" fullword ascii
      $s17 = "schannel: Failed to import cert file %s, last error is 0x%x" fullword ascii
      $s18 = "Excessive password length for proxy auth" fullword ascii
      $s19 = "getaddrinfo() thread failed to start" fullword ascii
      $s20 = "SEC_E_ILLEGAL_MESSAGE (0x%08X) - This error usually occurs when a fatal SSL/TLS alert is received (e.g. handshake failed). More " ascii
   condition:
      ( uint16(0) == 0x5a4d and filesize < 7000KB and ( 8 of them )
      ) or ( all of them )
}

rule _8ed24ddbcd88141fb1934ea20761b97d7cbdcb4e5042f6e1d893ed817a5b4a89_c3c657fa980e2ddcd6fc94d3464fea9816a4d5803c6ec80dee6a8b11fe_4 {
   meta:
      description = "samples - from files 8ed24ddbcd88141fb1934ea20761b97d7cbdcb4e5042f6e1d893ed817a5b4a89.exe, c3c657fa980e2ddcd6fc94d3464fea9816a4d5803c6ec80dee6a8b11fed28d36.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "8ed24ddbcd88141fb1934ea20761b97d7cbdcb4e5042f6e1d893ed817a5b4a89"
      hash2 = "c3c657fa980e2ddcd6fc94d3464fea9816a4d5803c6ec80dee6a8b11fed28d36"
   strings:
      $s1 = "mheap.freeSpanLocked - invalid free of user arena chunkcasfrom_Gscanstatus:top gp->status is not in scan state is currently not " ascii
      $s2 = "eSpanLocked - invalid span stateattempted to add zero-sized address rangeruntime: blocked read on closing polldescstopTheWorld: " ascii
      $s3 = "mheap.freeSpanLocked - invalid free of user arena chunkcasfrom_Gscanstatus:top gp->status is not in scan state is currently not " ascii
      $s4 = "ntptr; runtime.fn func(); runtime.link *runtime._defer; runtime.head *runtime/internal/atomic.Pointer[runtime._defer] }]).Compar" ascii
      $s5 = "runtime/internal/atomic.(*Pointer[go.shape.struct { runtime.heap bool; runtime.rangefunc bool; runtime.sp uintptr; runtime.pc ui" ascii
      $s6 = "runtime/rwmutex.go" fullword ascii
      $s7 = "targetpc" fullword ascii
      $s8 = "*runtime.mutex" fullword ascii
      $s9 = "runtime.errorAddressString.Error" fullword ascii
      $s10 = "runqhead" fullword ascii
      $s11 = "runtime/internal/atomic.(*Pointer[go.shape.310da7890f312c3e9e77825750bad066709f9dcd04a3cf1be91d69e56d19c9ef]).CompareAndSwapNoWB" ascii
      $s12 = "min size of malloc header is not a size class boundarygcControllerState.findRunnable: blackening not enabledno goroutines (main " ascii
      $s13 = "runtime.traceLocker.GCSweepStart" fullword ascii
      $s14 = "eep being done but phase is not GCoffobjects added out of order or overlappingmheap.freeSpanLocked - invalid stack freemheap.fre" ascii
      $s15 = "isMutexWait" fullword ascii
      $s16 = "runtime.traceLocker.GCSweepDone" fullword ascii
      $s17 = "runtime.traceLocker.GCSweepSpan" fullword ascii
      $s18 = "runtime/internal/atomic.(*Int64).CompareAndSwap" fullword ascii
      $s19 = "runtime/internal/atomic.(*Uintptr).CompareAndSwap" fullword ascii
      $s20 = "runtime/internal/atomic.(*Int32).CompareAndSwap" fullword ascii
   condition:
      ( uint16(0) == 0x5a4d and filesize < 21000KB and ( 8 of them )
      ) or ( all of them )
}

rule _49dc64191a08c389e43a7b765975fe2119b0b5228172fbf5e76d5cabd9afc80e_4f30db298f99fc45d153f6568529228c98e1ad173249c1f76424977bd0_5 {
   meta:
      description = "samples - from files 49dc64191a08c389e43a7b765975fe2119b0b5228172fbf5e76d5cabd9afc80e.exe, 4f30db298f99fc45d153f6568529228c98e1ad173249c1f76424977bd0b373c2.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "49dc64191a08c389e43a7b765975fe2119b0b5228172fbf5e76d5cabd9afc80e"
      hash2 = "4f30db298f99fc45d153f6568529228c98e1ad173249c1f76424977bd0b373c2"
   strings:
      $s1 = "failed to to lock creation mutex" fullword ascii
      $s2 = "failed to to lock cleanup mutex" fullword ascii
      $s3 = "C:\\crossdev\\gccmaster\\build-tdm64\\runtime\\mingw-w64-crt" fullword ascii
      $s4 = "mutex_name" fullword ascii
      $s5 = "mutex.c" fullword ascii
      $s6 = "mutex_impl_init" fullword ascii
      $s7 = ".reloc_target" fullword ascii
      $s8 = "failed to get string from atom" fullword ascii
      $s9 = "C:\\crossdev\\gccmaster\\build-tdm64\\gcc-seh\\x86_64-w64-mingw32\\libgcc" fullword ascii
      $s10 = "/__mingw_winmain_lpCmdLine" fullword ascii
      $s11 = "GNU C17 10.3.0 -mtune=generic -march=x86-64 -g -O2 -O2 -O2 -fbuilding-libgcc -fno-stack-protector" fullword ascii
      $s12 = "__pthread_get_pointer" fullword ascii
      $s13 = "__shmem_get_error" fullword ascii
      $s14 = "GNU C99 10.3.0 -m64 -mtune=generic -march=x86-64 -g -O2 -std=gnu99" fullword ascii
      $s15 = ">lpszCommandLine" fullword ascii
      $s16 = "_pthread_get_tick_count" fullword ascii
      $s17 = "pthread_getname_np" fullword ascii
      $s18 = "Bungetc" fullword ascii
      $s19 = "9Target" fullword ascii
      $s20 = "'Target" fullword ascii
   condition:
      ( uint16(0) == 0x5a4d and filesize < 2000KB and ( 8 of them )
      ) or ( all of them )
}

rule _19e14e5ffefce00e9a96101005e11ce743f039f102dadc668827ea6a444de691_e4d67649c7704c50925bcd3fe6ac345cba54d118407f28f6550b398671_6 {
   meta:
      description = "samples - from files 19e14e5ffefce00e9a96101005e11ce743f039f102dadc668827ea6a444de691.exe, e4d67649c7704c50925bcd3fe6ac345cba54d118407f28f6550b398671b0284e.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "19e14e5ffefce00e9a96101005e11ce743f039f102dadc668827ea6a444de691"
      hash2 = "e4d67649c7704c50925bcd3fe6ac345cba54d118407f28f6550b398671b0284e"
   strings:
      $x1 = "user.config{0}\\FileZilla\\sitemanager.xmlcookies.sqlite\\Program Files (x86)\\configRoninWalletdisplayNamehost_key\\Electrum\\w" wide
      $x2 = "[^\\u0020-\\u007F]ProcessIdname_on_cardencrypted_valuehttps://ipinfo.io/ip%appdata%\\logins{0}\\FileZilla\\recentservers.xml%app" wide
      $s3 = "Happy.exe" fullword ascii
      $s4 = "DownloadAndExecuteUpdate" fullword ascii
      $s5 = "egram.exe" fullword wide
      $s6 = "System.Collections.Generic.IEnumerable<ScannedFile>.GetEnumerator" fullword ascii
      $s7 = "System.Collections.Generic.IEnumerator<ScannedFile>.get_Current" fullword ascii
      $s8 = "get_TaskProcessors" fullword ascii
      $s9 = "*autofillexpiraas21tion_yas21earffnbelfdoeiohenkjibnmadjiehjhajbProfilesTotal of RAMhttps://api.ip.sb/geoip%USERPEnvironmentROFI" wide
      $s10 = "get_encrypted_key" fullword ascii
      $s11 = "ITaskProcessor" fullword ascii
      $s12 = "get_ScanGeckoBrowsersPaths" fullword ascii
      $s13 = "System.Collections.Generic.IEnumerator<ScannedFile>.Current" fullword ascii
      $s14 = "ListOfProcesses" fullword ascii
      $s15 = "<TaskProcessors>k__BackingField" fullword ascii
      $s16 = "get_ScannedFiles" fullword ascii
      $s17 = "get_ScannedWallets" fullword ascii
      $s18 = "ScanPasswords" fullword ascii
      $s19 = "GeckoRoamingName" fullword ascii
      $s20 = "CommandLineUpdate" fullword ascii
   condition:
      ( uint16(0) == 0x5a4d and filesize < 300KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _17e36536f236d0effd2850906ccd9972beb6f73a994fe8c1bb03c2a850f453bb_b3fe1e7404ddef2f09b8f51c5c2010e799ebf69f647e7e519a4305dc2b_7 {
   meta:
      description = "samples - from files 17e36536f236d0effd2850906ccd9972beb6f73a994fe8c1bb03c2a850f453bb.exe, b3fe1e7404ddef2f09b8f51c5c2010e799ebf69f647e7e519a4305dc2b3a5695.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "17e36536f236d0effd2850906ccd9972beb6f73a994fe8c1bb03c2a850f453bb"
      hash2 = "b3fe1e7404ddef2f09b8f51c5c2010e799ebf69f647e7e519a4305dc2b3a5695"
   strings:
      $x1 = "srvcli.dll" fullword wide /* reversed goodware string 'lld.ilcvrs' */
      $x2 = "devrtl.dll" fullword wide /* reversed goodware string 'lld.ltrved' */
      $x3 = "dfscli.dll" fullword wide /* reversed goodware string 'lld.ilcsfd' */
      $x4 = "browcli.dll" fullword wide /* reversed goodware string 'lld.ilcworb' */
      $x5 = "linkinfo.dll" fullword wide /* reversed goodware string 'lld.ofniknil' */
      $s6 = "atl.dll" fullword wide /* reversed goodware string 'lld.lta' */
      $s7 = "SSPICLI.DLL" fullword wide
      $s8 = "UXTheme.dll" fullword wide
      $s9 = "oleaccrc.dll" fullword wide
      $s10 = "dnsapi.DLL" fullword wide
      $s11 = "iphlpapi.DLL" fullword wide
      $s12 = "WINNSI.DLL" fullword wide
      $s13 = "sfxrar.exe" fullword ascii
      $s14 = "Cannot create folder %sHChecksum error in the encrypted file %s. Corrupt file or wrong password." fullword wide
      $s15 = "D:\\Projects\\WinRAR\\sfx\\build\\sfxrar32\\Release\\sfxrar.pdb" fullword ascii
      $s16 = "  <asmv3:windowsSettings xmlns=\"http://schemas.microsoft.com/SMI/2005/WindowsSettings\">" fullword ascii
      $s17 = "$GETPASSWORD1:SIZE" fullword ascii
      $s18 = "$GETPASSWORD1:IDC_PASSWORDENTER" fullword ascii
      $s19 = "$GETPASSWORD1:IDOK" fullword ascii
      $s20 = "&Enter password for the encrypted file:" fullword wide
   condition:
      ( uint16(0) == 0x5a4d and filesize < 13000KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _408c4cb78449baf846592637c9a8f03f47c3df6786acdce6e9ad0ef0db370068_d61022cef95af3e20bb237b2690c817d948c3ea99a5f11153eca3bcfff_8 {
   meta:
      description = "samples - from files 408c4cb78449baf846592637c9a8f03f47c3df6786acdce6e9ad0ef0db370068.exe, d61022cef95af3e20bb237b2690c817d948c3ea99a5f11153eca3bcfff034eb0.exe, 1ef225d55b567e06ca8c6197aa237b76504a1a270a512b80b50280154af98146.exe, df9d5a6d4edf1baf28fe59cc742cb980dfba7613a17b50c5a75f3fdd756bbc54.exe, 3b03a24bfde864b0d8b17213f7f2deb6d7e3f5f74b34d3b601cbadd961b904fc.exe, cc38fb3ee3227606258b1b9ccba885393d6ed4a54a51aefef30a669cdc171e80.exe, 749911c61e23b64b45f28d453a8b70275f824092d8dab39ccc1e93464d26b450.exe, 6475637fff05177a05bf6e84301c09492f21766ea3ba0068f3f70c4d0d886a9e.exe, 7ce2d225442252064d744be1c38e9c1572dd355bbbaf7fa411ce79e41288dfca.exe, 2a5dac302572ede5da5d53df170d5882937027b58290b6ea60e24478453276c9.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "408c4cb78449baf846592637c9a8f03f47c3df6786acdce6e9ad0ef0db370068"
      hash2 = "d61022cef95af3e20bb237b2690c817d948c3ea99a5f11153eca3bcfff034eb0"
      hash3 = "1ef225d55b567e06ca8c6197aa237b76504a1a270a512b80b50280154af98146"
      hash4 = "df9d5a6d4edf1baf28fe59cc742cb980dfba7613a17b50c5a75f3fdd756bbc54"
      hash5 = "3b03a24bfde864b0d8b17213f7f2deb6d7e3f5f74b34d3b601cbadd961b904fc"
      hash6 = "cc38fb3ee3227606258b1b9ccba885393d6ed4a54a51aefef30a669cdc171e80"
      hash7 = "749911c61e23b64b45f28d453a8b70275f824092d8dab39ccc1e93464d26b450"
      hash8 = "6475637fff05177a05bf6e84301c09492f21766ea3ba0068f3f70c4d0d886a9e"
      hash9 = "7ce2d225442252064d744be1c38e9c1572dd355bbbaf7fa411ce79e41288dfca"
      hash10 = "2a5dac302572ede5da5d53df170d5882937027b58290b6ea60e24478453276c9"
   strings:
      $s1 = "ProcessIsTerminating" fullword ascii
      $s2 = "GetExportAddress" fullword ascii
      $s3 = "GetLoadedModuleAddress" fullword ascii
      $s4 = "GetLibraryAddress" fullword ascii
      $s5 = "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\" fullword wide
      $s6 = "Failed to parse module exports." fullword wide
      $s7 = "b64encoded" fullword ascii
      $s8 = ", Dll was not found or not loaded." fullword wide
      $s9 = "Could not get the handle for the function." fullword wide
      $s10 = "DInvokeCore" fullword ascii
      $s11 = "\\\\{0}\\root\\CIMV2" fullword wide
      $s12 = "InvalidAddress" fullword ascii
      $s13 = "ConflictingAddresses" fullword ascii
      $s14 = "Install Failed : " fullword wide
      $s15 = ", export not found." fullword wide
      $s16 = "D84F4C120005F1837DC65C04181F3DA9466B123FC369C359A301BABC12061570" ascii
      $s17 = "AmsiScanBuffer" fullword wide
      $s18 = "LogonFailure" fullword ascii /* Goodware String - occured 1 times */
      $s19 = "Cancelled" fullword ascii /* Goodware String - occured 105 times */
      $s20 = "ProductType" fullword wide /* Goodware String - occured 456 times */
   condition:
      ( uint16(0) == 0x5a4d and filesize < 600KB and ( 8 of them )
      ) or ( all of them )
}

rule _6b2b45511ae0d69b6b56f7ef9250154eef125db09138d5eef1a50312fc7ae438_6659e8c041d7b2bf5ca0756ea730d0f8cfb7a81da170c1e4c4210df200_9 {
   meta:
      description = "samples - from files 6b2b45511ae0d69b6b56f7ef9250154eef125db09138d5eef1a50312fc7ae438.exe, 6659e8c041d7b2bf5ca0756ea730d0f8cfb7a81da170c1e4c4210df200b0dee2.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "6b2b45511ae0d69b6b56f7ef9250154eef125db09138d5eef1a50312fc7ae438"
      hash2 = "6659e8c041d7b2bf5ca0756ea730d0f8cfb7a81da170c1e4c4210df200b0dee2"
   strings:
      $s1 = "GetXorByte" fullword ascii
      $s2 = "GetGValue" fullword ascii
      $s3 = "<n:\"`Xm" fullword ascii
      $s4 = "get_homer" fullword ascii
      $s5 = "intermediate3" fullword ascii
      $s6 = "intermediate4" fullword ascii
      $s7 = "intermediate1" fullword ascii
      $s8 = "intermediate2" fullword ascii
      $s9 = "+ b[XY" fullword ascii
      $s10 = "CnEeIs3" fullword ascii
      $s11 = "\\ 9^iSIy20/" fullword ascii
      $s12 = "DweN^iD" fullword ascii
      $s13 = "QdQdSgU" fullword ascii
      $s14 = "AtAxO{I" fullword ascii
      $s15 = "mXmTcDv" fullword ascii
      $s16 = "JbQN$YiB" fullword ascii
      $s17 = "zAvJl1Zo%" fullword ascii
      $s18 = "eNygNSB" fullword ascii
      $s19 = "Puz0JaVxqNliN\\~J" fullword ascii
      $s20 = "EdLY_gBW" fullword ascii
   condition:
      ( uint16(0) == 0x5a4d and filesize < 2000KB and ( 8 of them )
      ) or ( all of them )
}

rule _67ff6133af6e40080795a330042a914cc49db7503c264428af28b90fe1092a0f_6dd20416e47edce7d1b4ddc9761bc52a7df7af372a66affb368dacbd2c_10 {
   meta:
      description = "samples - from files 67ff6133af6e40080795a330042a914cc49db7503c264428af28b90fe1092a0f.exe, 6dd20416e47edce7d1b4ddc9761bc52a7df7af372a66affb368dacbd2c61bb84.exe, ccb61da22c88babe8ad01f4bea2227c0a9465cfb9866c1828ae1961c8b9a899d.exe, a11fbdded656bcd76edfbc2dede2cb854cdb5f5dbc688a8a9b2169f0eef273fb.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "67ff6133af6e40080795a330042a914cc49db7503c264428af28b90fe1092a0f"
      hash2 = "6dd20416e47edce7d1b4ddc9761bc52a7df7af372a66affb368dacbd2c61bb84"
      hash3 = "ccb61da22c88babe8ad01f4bea2227c0a9465cfb9866c1828ae1961c8b9a899d"
      hash4 = "a11fbdded656bcd76edfbc2dede2cb854cdb5f5dbc688a8a9b2169f0eef273fb"
   strings:
      $s1 = "C:\\local0\\asf\\release\\build-2.2.14\\support\\Release\\ab.pdb" fullword ascii
      $s2 = " Copyright 1996 Adam Twiss, Zeus Technology Ltd, http://www.zeustech.net/<br>" fullword ascii
      $s3 = "    -T content-type Content-type header for POSTing, eg." fullword ascii
      $s4 = "    -p postfile     File containing data to POST. Remember also to set -T" fullword ascii
      $s5 = "    -i              Use HEAD instead of GET" fullword ascii
      $s6 = "    -h              Display usage information (this message)" fullword ascii
      $s7 = "    -k              Use HTTP KeepAlive feature" fullword ascii
      $s8 = " This is ApacheBench, Version %s <i>&lt;%s&gt;</i><br>" fullword ascii
      $s9 = "    -r              Don't exit on socket receive errors." fullword ascii
      $s10 = " Licensed to The Apache Software Foundation, http://www.apache.org/<br>" fullword ascii
      $s11 = "    -X proxy:port   Proxyserver and port number to use" fullword ascii
      $s12 = "    -H attribute    Add Arbitrary header line, eg. 'Accept-Encoding: gzip'" fullword ascii
      $s13 = "  %d%%  %5I64d" fullword ascii
      $s14 = "                    are a colon separated username and password." fullword ascii
      $s15 = "    -u putfile      File containing data to PUT. Remember also to set -T" fullword ascii
      $s16 = "    -c concurrency  Number of multiple requests to make" fullword ascii
      $s17 = "    -z attributes   String to insert as td or th attributes" fullword ascii
      $s18 = "    -y attributes   String to insert as tr attributes" fullword ascii
      $s19 = "    -b windowsize   Size of TCP send/receive buffer, in bytes" fullword ascii
      $s20 = "    -t timelimit    Seconds to max. wait for responses" fullword ascii
   condition:
      ( uint16(0) == 0x5a4d and filesize < 200KB and ( 8 of them )
      ) or ( all of them )
}

rule _49dc64191a08c389e43a7b765975fe2119b0b5228172fbf5e76d5cabd9afc80e_6b28f747f2c23c959950851728a8e6e3aac110c42913977cd34ae51362_11 {
   meta:
      description = "samples - from files 49dc64191a08c389e43a7b765975fe2119b0b5228172fbf5e76d5cabd9afc80e.exe, 6b28f747f2c23c959950851728a8e6e3aac110c42913977cd34ae513627a7bd6.exe, 56e1d092c07322d9dad7d85d773953573cc3294b9e428b3bbbaf935ca4d2f7e7.exe, 4f30db298f99fc45d153f6568529228c98e1ad173249c1f76424977bd0b373c2.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "49dc64191a08c389e43a7b765975fe2119b0b5228172fbf5e76d5cabd9afc80e"
      hash2 = "6b28f747f2c23c959950851728a8e6e3aac110c42913977cd34ae513627a7bd6"
      hash3 = "56e1d092c07322d9dad7d85d773953573cc3294b9e428b3bbbaf935ca4d2f7e7"
      hash4 = "4f30db298f99fc45d153f6568529228c98e1ad173249c1f76424977bd0b373c2"
   strings:
      $s1 = "__mingw_winmain_lpCmdLine" fullword ascii
      $s2 = "__imp__get_invalid_parameter_handler" fullword ascii
      $s3 = "mingw_get_invalid_parameter_handler" fullword ascii
      $s4 = "_head_lib64_libmsvcrt_os_a" fullword ascii
      $s5 = "startinfo" fullword ascii
      $s6 = "mainret" fullword ascii
      $s7 = "managedapp" fullword ascii
      $s8 = ".refptr.__RUNTIME_PSEUDO_RELOC_LIST__" fullword ascii
      $s9 = "__gcc_deregister_frame" fullword ascii
      $s10 = "__mingw_winmain_nShowCmd" fullword ascii
      $s11 = ".refptr.__RUNTIME_PSEUDO_RELOC_LIST_END__" fullword ascii
      $s12 = "register_frame_ctor" fullword ascii
      $s13 = ".refptr.__imp__acmdln" fullword ascii
      $s14 = "__gcc_register_frame" fullword ascii
      $s15 = ".rdata$.refptr.__imp__acmdln" fullword ascii
      $s16 = ".rdata$.refptr.__RUNTIME_PSEUDO_RELOC_LIST__" fullword ascii
      $s17 = ".rdata$.refptr.__RUNTIME_PSEUDO_RELOC_LIST_END__" fullword ascii
      $s18 = ".rdata$.refptr._fmode" fullword ascii
      $s19 = ".refptr.__native_startup_lock" fullword ascii
      $s20 = ".refptr.__xc_z" fullword ascii
   condition:
      ( uint16(0) == 0x5a4d and filesize < 22000KB and ( 8 of them )
      ) or ( all of them )
}

rule _49dc64191a08c389e43a7b765975fe2119b0b5228172fbf5e76d5cabd9afc80e_6b28f747f2c23c959950851728a8e6e3aac110c42913977cd34ae51362_12 {
   meta:
      description = "samples - from files 49dc64191a08c389e43a7b765975fe2119b0b5228172fbf5e76d5cabd9afc80e.exe, 6b28f747f2c23c959950851728a8e6e3aac110c42913977cd34ae513627a7bd6.exe, 4f30db298f99fc45d153f6568529228c98e1ad173249c1f76424977bd0b373c2.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "49dc64191a08c389e43a7b765975fe2119b0b5228172fbf5e76d5cabd9afc80e"
      hash2 = "6b28f747f2c23c959950851728a8e6e3aac110c42913977cd34ae513627a7bd6"
      hash3 = "4f30db298f99fc45d153f6568529228c98e1ad173249c1f76424977bd0b373c2"
   strings:
      $s1 = "processthreadsapi.h" fullword ascii
      $s2 = "X86_TUNE_MISALIGNED_MOVE_STRING_PRO_EPILOGUES" fullword ascii
      $s3 = "__p__acmdln.c" fullword ascii
      $s4 = "complex _Float128" fullword ascii
      $s5 = "X86_TUNE_SOFTWARE_PREFETCHING_BENEFICIAL" fullword ascii
      $s6 = "cygwin.S" fullword ascii
      $s7 = "X86_TUNE_AVX256_UNALIGNED_LOAD_OPTIMAL" fullword ascii
      $s8 = ".pdata.unlikely" fullword ascii
      $s9 = "X86_TUNE_PAD_SHORT_FUNCTION" fullword ascii
      $s10 = "X86_TUNE_ACCUMULATE_OUTGOING_ARGS" fullword ascii
      $s11 = "X86_TUNE_AVOID_MEM_OPND_FOR_CMOVE" fullword ascii
      $s12 = "X86_TUNE_FUSE_CMP_AND_BRANCH_32" fullword ascii
      $s13 = "X86_TUNE_INTER_UNIT_MOVES_FROM_VEC" fullword ascii
      $s14 = "charmax.c" fullword ascii
      $s15 = "X86_TUNE_AVOID_128FMA_CHAINS" fullword ascii
      $s16 = "minwinbase.h" fullword ascii
      $s17 = "crtexe.c" fullword ascii
      $s18 = "X86_TUNE_SINGLE_PUSH" fullword ascii
      $s19 = "X86_TUNE_GENERAL_REGS_SSE_SPILL" fullword ascii
      $s20 = ".rdata$.refptr._matherr" fullword ascii
   condition:
      ( uint16(0) == 0x5a4d and filesize < 2000KB and ( 8 of them )
      ) or ( all of them )
}

rule _36e6a3dd4bfc86c4e707f43cd9515707442d6c424b7661cb41766cfdca322522_521d404952876e51d0cf3a4d0d69e30566406a3a129343d5e53d5d7274_13 {
   meta:
      description = "samples - from files 36e6a3dd4bfc86c4e707f43cd9515707442d6c424b7661cb41766cfdca322522.exe, 521d404952876e51d0cf3a4d0d69e30566406a3a129343d5e53d5d7274f4d3dc.exe, 0843b763880a4e1b559d29140afff5cd867bcada20eda6db2524d4e5045af114.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "36e6a3dd4bfc86c4e707f43cd9515707442d6c424b7661cb41766cfdca322522"
      hash2 = "521d404952876e51d0cf3a4d0d69e30566406a3a129343d5e53d5d7274f4d3dc"
      hash3 = "0843b763880a4e1b559d29140afff5cd867bcada20eda6db2524d4e5045af114"
   strings:
      $s1 = "BlockUpdate" fullword ascii
      $s2 = "<.ctor>b__1_0" fullword ascii /* Goodware String - occured 3 times */
      $s3 = "idBytes" fullword ascii /* Goodware String - occured 3 times */
      $s4 = "<>c__DisplayClass15_0" fullword ascii /* Goodware String - occured 4 times */
      $s5 = "<.ctor>b__3_0" fullword ascii /* Goodware String - occured 4 times */
      $s6 = "ReleaseToPool" fullword ascii /* Goodware String - occured 5 times */
   condition:
      ( uint16(0) == 0x5a4d and filesize < 14000KB and ( all of them )
      ) or ( all of them )
}

rule _f745359274019b502bda094e4c58c5e553e32cd56dcd72fb7984ad2e706a8eb6_f139a9c30967f1e0edaa605531560bf18ee4f190ab3b01b3540f1aefd2_14 {
   meta:
      description = "samples - from files f745359274019b502bda094e4c58c5e553e32cd56dcd72fb7984ad2e706a8eb6.exe, f139a9c30967f1e0edaa605531560bf18ee4f190ab3b01b3540f1aefd20adcdb.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "f745359274019b502bda094e4c58c5e553e32cd56dcd72fb7984ad2e706a8eb6"
      hash2 = "f139a9c30967f1e0edaa605531560bf18ee4f190ab3b01b3540f1aefd20adcdb"
   strings:
      $s1 = "SpotifyStartupTask.exe" fullword wide
      $s2 = "System.Collections.Generic.ICollection<H37.o75>.get_Count" fullword ascii
      $s3 = "System.Collections.Generic.IEnumerable<ns64.B45>.GetEnumerator" fullword ascii
      $s4 = "System.Collections.Generic.IEnumerator<ns64.B45>.get_Current" fullword ascii
      $s5 = "System.Collections.Generic.IList<H37.o75>.get_Item" fullword ascii
      $s6 = "System.Collections.Generic.ICollection<H37.o75>.get_IsReadOnly" fullword ascii
      $s7 = "System.Collections.Generic.IEnumerable<H37.o75>.GetEnumerator" fullword ascii
      $s8 = "System.IO.Stream.get_Length" fullword ascii
      $s9 = "System.IO.Stream.get_Position" fullword ascii
      $s10 = "System.Collections.Generic.IEnumerable<ns89.Class64>.GetEnumerator" fullword ascii
      $s11 = "System.Collections.Generic.IEnumerator<ns89.Class64>.get_Current" fullword ascii
      $s12 = "System.Object.Finalize" fullword ascii
      $s13 = "System.Collections.Generic.IList<H37.o75>.Insert" fullword ascii
      $s14 = "System.Collections.Generic.IList<H37.o75>.IndexOf" fullword ascii
      $s15 = "System.Collections.Generic.IList<H37.o75>.RemoveAt" fullword ascii
      $s16 = "System.Collections.Generic.ICollection<H37.o75>.Contains" fullword ascii
      $s17 = "System.Object.ToString" fullword ascii
      $s18 = "System.Collections.Generic.ICollection<H37.o75>.CopyTo" fullword ascii
      $s19 = "System.Collections.Generic.ICollection<H37.o75>.Clear" fullword ascii
      $s20 = "System.Collections.Generic.ICollection<H37.o75>.Remove" fullword ascii
   condition:
      ( uint16(0) == 0x5a4d and filesize < 6000KB and ( 8 of them )
      ) or ( all of them )
}

rule _283ece83572923032a368088751b611aee0d866be61d048935d9b5ca3d344a70_3f0dea5783c2deb7a9686accab4b1e17953f4babefbcc2668428a9fc00_15 {
   meta:
      description = "samples - from files 283ece83572923032a368088751b611aee0d866be61d048935d9b5ca3d344a70.exe, 3f0dea5783c2deb7a9686accab4b1e17953f4babefbcc2668428a9fc00a1c4ea.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "283ece83572923032a368088751b611aee0d866be61d048935d9b5ca3d344a70"
      hash2 = "3f0dea5783c2deb7a9686accab4b1e17953f4babefbcc2668428a9fc00a1c4ea"
   strings:
      $s1 = "BvVlZ\\" fullword ascii
      $s2 = "D.Hog^" fullword ascii
      $s3 = "O1NzNfj'fGv" fullword ascii
      $s4 = ".Wqb^?" fullword ascii
      $s5 = "62$|S)6f" fullword ascii
      $s6 = "XLuC'4" fullword ascii
      $s7 = "^.om5r" fullword ascii
      $s8 = "]1h=bfz" fullword ascii
      $s9 = "GBd<}v" fullword ascii
      $s10 = "6#RDP#" fullword ascii
      $s11 = "=O?AqP" fullword ascii
      $s12 = "VM%G]f" fullword ascii
      $s13 = "[`|bJj" fullword ascii
      $s14 = ".dx_LV9" fullword ascii
      $s15 = "][LK~lO" fullword ascii
      $s16 = "RM~]qY" fullword ascii
      $s17 = "PmR\"H?" fullword ascii
      $s18 = ".r&I|C" fullword ascii
      $s19 = "@h!Aq8" fullword ascii
      $s20 = "tM(ie-V" fullword ascii
   condition:
      ( uint16(0) == 0x5a4d and filesize < 16000KB and ( 8 of them )
      ) or ( all of them )
}

rule _ea520d8e6ca1d44593f26ceea349d55709ebd61565f67368947d38e484f5846f_19e14e5ffefce00e9a96101005e11ce743f039f102dadc668827ea6a44_16 {
   meta:
      description = "samples - from files ea520d8e6ca1d44593f26ceea349d55709ebd61565f67368947d38e484f5846f.exe, 19e14e5ffefce00e9a96101005e11ce743f039f102dadc668827ea6a444de691.exe, e4d67649c7704c50925bcd3fe6ac345cba54d118407f28f6550b398671b0284e.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "ea520d8e6ca1d44593f26ceea349d55709ebd61565f67368947d38e484f5846f"
      hash2 = "19e14e5ffefce00e9a96101005e11ce743f039f102dadc668827ea6a444de691"
      hash3 = "e4d67649c7704c50925bcd3fe6ac345cba54d118407f28f6550b398671b0284e"
   strings:
      $s1 = "BCrypt.BCryptGetProperty() (get size) failed with status code:{0}" fullword wide
      $s2 = "BCrypt.BCryptGetProperty() failed with status code:{0}" fullword wide
      $s3 = "BCrypt.BCryptImportKey() failed with status code:{0}" fullword wide
      $s4 = "BCRYPT_INIT_AUTH_MODE_INFO_VERSION" fullword ascii
      $s5 = "RecordHeaderField" fullword ascii
      $s6 = "bEncryptedData" fullword ascii
      $s7 = "MaxAuthTagSize" fullword ascii
      $s8 = "cbAuthData" fullword ascii
      $s9 = "dwInfoVersion" fullword ascii
      $s10 = "ReadTableFromOffset" fullword ascii
      $s11 = "RootNum" fullword ascii
      $s12 = "BCRYPT_KEY_LENGTHS_STRUCT" fullword ascii
      $s13 = "authTag" fullword ascii
      $s14 = "pbAuthData" fullword ascii
      $s15 = "bMasterKey" fullword ascii
      $s16 = "ReadMasterTable" fullword ascii
      $s17 = "pbKeyObject" fullword ascii
      $s18 = "cbKeyObject" fullword ascii
      $s19 = "Autofill" fullword ascii
      $s20 = "Coinomi" fullword wide
   condition:
      ( uint16(0) == 0x5a4d and filesize < 500KB and ( 8 of them )
      ) or ( all of them )
}

rule _408c4cb78449baf846592637c9a8f03f47c3df6786acdce6e9ad0ef0db370068_d61022cef95af3e20bb237b2690c817d948c3ea99a5f11153eca3bcfff_17 {
   meta:
      description = "samples - from files 408c4cb78449baf846592637c9a8f03f47c3df6786acdce6e9ad0ef0db370068.exe, d61022cef95af3e20bb237b2690c817d948c3ea99a5f11153eca3bcfff034eb0.exe, 1ef225d55b567e06ca8c6197aa237b76504a1a270a512b80b50280154af98146.exe, df9d5a6d4edf1baf28fe59cc742cb980dfba7613a17b50c5a75f3fdd756bbc54.exe, 3b03a24bfde864b0d8b17213f7f2deb6d7e3f5f74b34d3b601cbadd961b904fc.exe, cc38fb3ee3227606258b1b9ccba885393d6ed4a54a51aefef30a669cdc171e80.exe, 749911c61e23b64b45f28d453a8b70275f824092d8dab39ccc1e93464d26b450.exe, 6475637fff05177a05bf6e84301c09492f21766ea3ba0068f3f70c4d0d886a9e.exe, 7ce2d225442252064d744be1c38e9c1572dd355bbbaf7fa411ce79e41288dfca.exe, a8fcd268b48c903e21500439d6754500d59d12d7d5d4e2c7ea737661fa8fe230.exe, 2a5dac302572ede5da5d53df170d5882937027b58290b6ea60e24478453276c9.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "408c4cb78449baf846592637c9a8f03f47c3df6786acdce6e9ad0ef0db370068"
      hash2 = "d61022cef95af3e20bb237b2690c817d948c3ea99a5f11153eca3bcfff034eb0"
      hash3 = "1ef225d55b567e06ca8c6197aa237b76504a1a270a512b80b50280154af98146"
      hash4 = "df9d5a6d4edf1baf28fe59cc742cb980dfba7613a17b50c5a75f3fdd756bbc54"
      hash5 = "3b03a24bfde864b0d8b17213f7f2deb6d7e3f5f74b34d3b601cbadd961b904fc"
      hash6 = "cc38fb3ee3227606258b1b9ccba885393d6ed4a54a51aefef30a669cdc171e80"
      hash7 = "749911c61e23b64b45f28d453a8b70275f824092d8dab39ccc1e93464d26b450"
      hash8 = "6475637fff05177a05bf6e84301c09492f21766ea3ba0068f3f70c4d0d886a9e"
      hash9 = "7ce2d225442252064d744be1c38e9c1572dd355bbbaf7fa411ce79e41288dfca"
      hash10 = "a8fcd268b48c903e21500439d6754500d59d12d7d5d4e2c7ea737661fa8fe230"
      hash11 = "2a5dac302572ede5da5d53df170d5882937027b58290b6ea60e24478453276c9"
   strings:
      $s1 = "MpCmdRun.exe" fullword wide
      $s2 = "  <!-- Enable themes for Windows common controls and dialogs (Windows XP and later) -->" fullword ascii
      $s3 = "ConfigSecurityPolicy.exe" fullword wide
      $s4 = "MSConfig.exe" fullword wide
      $s5 = "procexp.exe" fullword wide
      $s6 = "MSASCui.exe" fullword wide
      $s7 = "MsMpEng.exe" fullword wide
      $s8 = "MpUXSrv.exe" fullword wide
      $s9 = "NisSrv.exe" fullword wide
      $s10 = "Regedit.exe" fullword wide
      $s11 = "<longPathAware xmlns=\"http://schemas.microsoft.com/SMI/2016/WindowsSettings\">true</longPathAware>" fullword ascii
      $s12 = "<dpiAwareness xmlns=\"http://schemas.microsoft.com/SMI/2016/WindowsSettings\">PerMonitorV2, PerMonitor</dpiAwareness>" fullword ascii
      $s13 = "AntiProcess" fullword ascii
      $s14 = "Anti_Process" fullword ascii
      $s15 = "UmVjZWl2ZWQ=" fullword wide /* base64 encoded string 'Received' */
      $s16 = "      <dpiAware xmlns=\"http://schemas.microsoft.com/SMI/2005/WindowsSettings\">true</dpiAware>" fullword ascii
      $s17 = "  <assemblyIdentity version=\"1.0.7.0\" name=\"MyApplication.app\"/>" fullword ascii
      $s18 = "       also set the 'EnableWindowsFormsHighDpiAutoResizing' setting to 'true' in their app.config. -->" fullword ascii
      $s19 = "isVM_by_wim_temper" fullword ascii
      $s20 = "       to opt in. Windows Forms applications targeting .NET Framework 4.6 that opt into this setting, should " fullword ascii
   condition:
      ( uint16(0) == 0x5a4d and filesize < 600KB and ( 8 of them )
      ) or ( all of them )
}

rule _f745359274019b502bda094e4c58c5e553e32cd56dcd72fb7984ad2e706a8eb6_b3fe1e7404ddef2f09b8f51c5c2010e799ebf69f647e7e519a4305dc2b_18 {
   meta:
      description = "samples - from files f745359274019b502bda094e4c58c5e553e32cd56dcd72fb7984ad2e706a8eb6.exe, b3fe1e7404ddef2f09b8f51c5c2010e799ebf69f647e7e519a4305dc2b3a5695.exe, f139a9c30967f1e0edaa605531560bf18ee4f190ab3b01b3540f1aefd20adcdb.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "f745359274019b502bda094e4c58c5e553e32cd56dcd72fb7984ad2e706a8eb6"
      hash2 = "b3fe1e7404ddef2f09b8f51c5c2010e799ebf69f647e7e519a4305dc2b3a5695"
      hash3 = "f139a9c30967f1e0edaa605531560bf18ee4f190ab3b01b3540f1aefd20adcdb"
   strings:
      $s1 = "KernelBase.dll" fullword ascii
      $s2 = "Process " fullword wide
      $s3 = "kernel " fullword wide
      $s4 = "DarkCrystal RAT" fullword wide
      $s5 = "4BED3ADC52D4904075F6BBF279EC4ACEDE079533B95E229A29809542EA324A7B" ascii
      $s6 = "7F535673D836D3D77A97DB03EB3D71EA780F44372F5AEBECEBEDD696AAEB8378" ascii
      $s7 = "0E448EF5E5E60630BDDB19388CB6378436E3C65D03DD66DA7C6EBFF563BD857A" ascii
      $s8 = "This assembly is protected by an unregistered version of Eziriz's \".NET Reactor\"! This assembly won't further work." fullword wide
      $s9 = "sabcst" fullword wide
      $s10 = "Protect" fullword wide /* Goodware String - occured 24 times */
      $s11 = "aa9FZxDinAnwWXPJclh`1" fullword ascii
      $s12 = "joHcOIFa2U" fullword ascii
      $s13 = "xTuFFuFOZ" fullword ascii
      $s14 = "AHdhEgDv4FIOxsf9Qwp" fullword ascii
      $s15 = "EaecoUppfe" fullword ascii
      $s16 = "<>9__45_0" fullword ascii /* Goodware String - occured 1 times */
      $s17 = "nW4lBacjpc" fullword ascii
      $s18 = "paramters" fullword ascii /* Goodware String - occured 1 times */
      $s19 = "ImNcIRvaPy" fullword ascii
      $s20 = " is tampered." fullword wide
   condition:
      ( uint16(0) == 0x5a4d and filesize < 13000KB and ( 8 of them )
      ) or ( all of them )
}

rule _eb7aa3469a93e430a4954aaab1520f3b7ebb66055e621a27e79842f4c8db6ea8_e583a74eee0a4dca05e41b16b1d384302c7130f2c88e3e9fd6602901f6_19 {
   meta:
      description = "samples - from files eb7aa3469a93e430a4954aaab1520f3b7ebb66055e621a27e79842f4c8db6ea8.exe, e583a74eee0a4dca05e41b16b1d384302c7130f2c88e3e9fd6602901f6afdb9a.exe, a045aae04ded2c18b1ab1e206c18bf954844afd6b9c6e9efcecc4cc05dae71da.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "eb7aa3469a93e430a4954aaab1520f3b7ebb66055e621a27e79842f4c8db6ea8"
      hash2 = "e583a74eee0a4dca05e41b16b1d384302c7130f2c88e3e9fd6602901f6afdb9a"
      hash3 = "a045aae04ded2c18b1ab1e206c18bf954844afd6b9c6e9efcecc4cc05dae71da"
   strings:
      $s1 = "            <requestedExecutionLevel level=\"asInvoker\"            uiAccess=\"false\"/>" fullword ascii
      $s2 = "        <dpiAware xmlns=\"http://schemas.microsoft.com/SMI/2005/WindowsSettings\">true</dpiAware>" fullword ascii
      $s3 = "    processorArchitecture=\"x86\"" fullword ascii
      $s4 = "        <supportedOS Id=\"{e2011457-1546-43c5-a5fe-008deee3d3f0}\"/>" fullword ascii
      $s5 = "        </requestedPrivileges>" fullword ascii
      $s6 = "        <supportedOS Id=\"{35138b9a-5d96-4fbd-8e2d-a2440225f93a}\"/>" fullword ascii
      $s7 = "        <requestedPrivileges>" fullword ascii
      $s8 = "                                                            " fullword wide /* Goodware String - occured 4 times */
   condition:
      ( uint16(0) == 0x5a4d and filesize < 13000KB and ( all of them )
      ) or ( all of them )
}

rule _408c4cb78449baf846592637c9a8f03f47c3df6786acdce6e9ad0ef0db370068_d61022cef95af3e20bb237b2690c817d948c3ea99a5f11153eca3bcfff_20 {
   meta:
      description = "samples - from files 408c4cb78449baf846592637c9a8f03f47c3df6786acdce6e9ad0ef0db370068.exe, d61022cef95af3e20bb237b2690c817d948c3ea99a5f11153eca3bcfff034eb0.exe, 1ef225d55b567e06ca8c6197aa237b76504a1a270a512b80b50280154af98146.exe, df9d5a6d4edf1baf28fe59cc742cb980dfba7613a17b50c5a75f3fdd756bbc54.exe, 3b03a24bfde864b0d8b17213f7f2deb6d7e3f5f74b34d3b601cbadd961b904fc.exe, cc38fb3ee3227606258b1b9ccba885393d6ed4a54a51aefef30a669cdc171e80.exe, 749911c61e23b64b45f28d453a8b70275f824092d8dab39ccc1e93464d26b450.exe, 6475637fff05177a05bf6e84301c09492f21766ea3ba0068f3f70c4d0d886a9e.exe, 2a5dac302572ede5da5d53df170d5882937027b58290b6ea60e24478453276c9.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "408c4cb78449baf846592637c9a8f03f47c3df6786acdce6e9ad0ef0db370068"
      hash2 = "d61022cef95af3e20bb237b2690c817d948c3ea99a5f11153eca3bcfff034eb0"
      hash3 = "1ef225d55b567e06ca8c6197aa237b76504a1a270a512b80b50280154af98146"
      hash4 = "df9d5a6d4edf1baf28fe59cc742cb980dfba7613a17b50c5a75f3fdd756bbc54"
      hash5 = "3b03a24bfde864b0d8b17213f7f2deb6d7e3f5f74b34d3b601cbadd961b904fc"
      hash6 = "cc38fb3ee3227606258b1b9ccba885393d6ed4a54a51aefef30a669cdc171e80"
      hash7 = "749911c61e23b64b45f28d453a8b70275f824092d8dab39ccc1e93464d26b450"
      hash8 = "6475637fff05177a05bf6e84301c09492f21766ea3ba0068f3f70c4d0d886a9e"
      hash9 = "2a5dac302572ede5da5d53df170d5882937027b58290b6ea60e24478453276c9"
   strings:
      $x1 = "C:\\Temp\\client.log" fullword wide
      $x2 = "C:\\Temp\\client_ex.log" fullword wide
      $s3 = "GetUserProcessList" fullword ascii
      $s4 = "C://Temp//1.log" fullword wide
      $s5 = "keyLogger" fullword wide
      $s6 = "KeylogMutexString" fullword ascii
      $s7 = "GetActiveProcessName" fullword ascii
      $s8 = "DataLogs_keylog_offline.txt" fullword wide
      $s9 = "DataLogs_keylog_online.txt" fullword wide
      $s10 = "Select * from Win32_Processor" fullword wide
      $s11 = "OfflineKeylogger" fullword wide
      $s12 = "keylogparam" fullword ascii
      $s13 = "keylogsetting" fullword wide
      $s14 = "FilterProcessWindow" fullword ascii
      $s15 = "loadofflinelog" fullword wide
      $s16 = "offlinelog" fullword wide
      $s17 = "KeylogConfFile" fullword ascii
      $s18 = "KeylogParams" fullword ascii
      $s19 = "DataLogs.conf" fullword wide
      $s20 = "runningapp" fullword wide
   condition:
      ( uint16(0) == 0x5a4d and filesize < 600KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _a37770babd802e2e67c301280ab05dd85859827ab81b8053b32fecabd34eee32_3f0dea5783c2deb7a9686accab4b1e17953f4babefbcc2668428a9fc00_21 {
   meta:
      description = "samples - from files a37770babd802e2e67c301280ab05dd85859827ab81b8053b32fecabd34eee32.exe, 3f0dea5783c2deb7a9686accab4b1e17953f4babefbcc2668428a9fc00a1c4ea.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "a37770babd802e2e67c301280ab05dd85859827ab81b8053b32fecabd34eee32"
      hash2 = "3f0dea5783c2deb7a9686accab4b1e17953f4babefbcc2668428a9fc00a1c4ea"
   strings:
      $s1 = "Failed to get _MEIPASS as PyObject." fullword ascii
      $s2 = "pyi-runtime-tmpdir" fullword ascii
      $s3 = "spyiboot01_bootstrap" fullword ascii
      $s4 = "Could not get __main__ module's dict." fullword ascii
      $s5 = "Could not get __main__ module." fullword ascii
      $s6 = "Failed to unmarshal code object for %s" fullword ascii
      $s7 = "base_library.zip" fullword ascii
      $s8 = "_MEIPASS" fullword ascii
      $s9 = "zPYZ-00.pyz" fullword ascii
      $s10 = "PyUnicode_Decode" fullword ascii
      $s11 = "PyUnicode_DecodeFSDefault" fullword ascii
      $s12 = "Py_DecodeLocale" fullword ascii
      $s13 = "b_socket.pyd" fullword ascii /* Goodware String - occured 1 times */
      $s14 = "ucrtbase.dll" fullword ascii /* Goodware String - occured 1 times */
      $s15 = "b_ssl.pyd" fullword ascii /* Goodware String - occured 1 times */
      $s16 = "|$\":uq" fullword ascii /* Goodware String - occured 1 times */
      $s17 = "bunicodedata.pyd" fullword ascii /* Goodware String - occured 1 times */
      $s18 = "xWI96tRI" fullword ascii /* Goodware String - occured 1 times */
      $s19 = "b_ctypes.pyd" fullword ascii /* Goodware String - occured 1 times */
      $s20 = "bselect.pyd" fullword ascii /* Goodware String - occured 1 times */
   condition:
      ( uint16(0) == 0x5a4d and filesize < 29000KB and ( 8 of them )
      ) or ( all of them )
}

rule _408c4cb78449baf846592637c9a8f03f47c3df6786acdce6e9ad0ef0db370068_d61022cef95af3e20bb237b2690c817d948c3ea99a5f11153eca3bcfff_22 {
   meta:
      description = "samples - from files 408c4cb78449baf846592637c9a8f03f47c3df6786acdce6e9ad0ef0db370068.exe, d61022cef95af3e20bb237b2690c817d948c3ea99a5f11153eca3bcfff034eb0.exe, 1ef225d55b567e06ca8c6197aa237b76504a1a270a512b80b50280154af98146.exe, ea520d8e6ca1d44593f26ceea349d55709ebd61565f67368947d38e484f5846f.exe, df9d5a6d4edf1baf28fe59cc742cb980dfba7613a17b50c5a75f3fdd756bbc54.exe, 3b03a24bfde864b0d8b17213f7f2deb6d7e3f5f74b34d3b601cbadd961b904fc.exe, cc38fb3ee3227606258b1b9ccba885393d6ed4a54a51aefef30a669cdc171e80.exe, 749911c61e23b64b45f28d453a8b70275f824092d8dab39ccc1e93464d26b450.exe, 50ce164844684892d697f16bc194d82841e4c1b951609d12bc26cab8b028192e.exe, 6475637fff05177a05bf6e84301c09492f21766ea3ba0068f3f70c4d0d886a9e.exe, 7ce2d225442252064d744be1c38e9c1572dd355bbbaf7fa411ce79e41288dfca.exe, a8fcd268b48c903e21500439d6754500d59d12d7d5d4e2c7ea737661fa8fe230.exe, ab0486b2252a7c4c577ca2d3082084418b624f6c28a5ae27aa22add6236d05ce.exe, 2a5dac302572ede5da5d53df170d5882937027b58290b6ea60e24478453276c9.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "408c4cb78449baf846592637c9a8f03f47c3df6786acdce6e9ad0ef0db370068"
      hash2 = "d61022cef95af3e20bb237b2690c817d948c3ea99a5f11153eca3bcfff034eb0"
      hash3 = "1ef225d55b567e06ca8c6197aa237b76504a1a270a512b80b50280154af98146"
      hash4 = "ea520d8e6ca1d44593f26ceea349d55709ebd61565f67368947d38e484f5846f"
      hash5 = "df9d5a6d4edf1baf28fe59cc742cb980dfba7613a17b50c5a75f3fdd756bbc54"
      hash6 = "3b03a24bfde864b0d8b17213f7f2deb6d7e3f5f74b34d3b601cbadd961b904fc"
      hash7 = "cc38fb3ee3227606258b1b9ccba885393d6ed4a54a51aefef30a669cdc171e80"
      hash8 = "749911c61e23b64b45f28d453a8b70275f824092d8dab39ccc1e93464d26b450"
      hash9 = "50ce164844684892d697f16bc194d82841e4c1b951609d12bc26cab8b028192e"
      hash10 = "6475637fff05177a05bf6e84301c09492f21766ea3ba0068f3f70c4d0d886a9e"
      hash11 = "7ce2d225442252064d744be1c38e9c1572dd355bbbaf7fa411ce79e41288dfca"
      hash12 = "a8fcd268b48c903e21500439d6754500d59d12d7d5d4e2c7ea737661fa8fe230"
      hash13 = "ab0486b2252a7c4c577ca2d3082084418b624f6c28a5ae27aa22add6236d05ce"
      hash14 = "2a5dac302572ede5da5d53df170d5882937027b58290b6ea60e24478453276c9"
   strings:
      $s1 = "CloseMutex" fullword ascii
      $s2 = "EXECUTION_STATE" fullword ascii
      $s3 = "GetAsUInt64" fullword ascii
      $s4 = "GetUtf8Bytes" fullword ascii
      $s5 = "GetAsInteger" fullword ascii
      $s6 = "GetAsFloat" fullword ascii
      $s7 = "GetActiveWindowTitle" fullword ascii
      $s8 = "ES_SYSTEM_REQUIRED" fullword ascii
      $s9 = "ReadTools" fullword ascii
      $s10 = "ReadServertData" fullword ascii
      $s11 = "DecodeFromBytes" fullword ascii
      $s12 = "DecodeFromFile" fullword ascii
      $s13 = "DecodeFromStream" fullword ascii
      $s14 = "SetAsUInt64" fullword ascii
      $s15 = "SwapInt16" fullword ascii
      $s16 = "SwapInt64" fullword ascii
      $s17 = "Reconnect" fullword ascii /* Goodware String - occured 19 times */
      $s18 = "IsAdmin" fullword ascii /* Goodware String - occured 28 times */
      $s19 = "MsgPackType" fullword ascii
      $s20 = "SetAsBytes" fullword ascii
   condition:
      ( uint16(0) == 0x5a4d and filesize < 600KB and ( 8 of them )
      ) or ( all of them )
}

rule _f745359274019b502bda094e4c58c5e553e32cd56dcd72fb7984ad2e706a8eb6_17e36536f236d0effd2850906ccd9972beb6f73a994fe8c1bb03c2a850_23 {
   meta:
      description = "samples - from files f745359274019b502bda094e4c58c5e553e32cd56dcd72fb7984ad2e706a8eb6.exe, 17e36536f236d0effd2850906ccd9972beb6f73a994fe8c1bb03c2a850f453bb.exe, b3fe1e7404ddef2f09b8f51c5c2010e799ebf69f647e7e519a4305dc2b3a5695.exe, f139a9c30967f1e0edaa605531560bf18ee4f190ab3b01b3540f1aefd20adcdb.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "f745359274019b502bda094e4c58c5e553e32cd56dcd72fb7984ad2e706a8eb6"
      hash2 = "17e36536f236d0effd2850906ccd9972beb6f73a994fe8c1bb03c2a850f453bb"
      hash3 = "b3fe1e7404ddef2f09b8f51c5c2010e799ebf69f647e7e519a4305dc2b3a5695"
      hash4 = "f139a9c30967f1e0edaa605531560bf18ee4f190ab3b01b3540f1aefd20adcdb"
   strings:
      $s1 = "ture=neutral, PublicKeyToken=b77a5c561934e089]][]" fullword ascii
      $s2 = "$ebc25cf6-9120-4283-b972-0e5520d0000D" fullword ascii /* Goodware String - occured 1 times */
      $s3 = "$ebc25cf6-9120-4283-b972-0e5520d00006" fullword ascii /* Goodware String - occured 1 times */
      $s4 = "$ebc25cf6-9120-4283-b972-0e5520d00008" fullword ascii /* Goodware String - occured 1 times */
      $s5 = "$ebc25cf6-9120-4283-b972-0e5520d00007" fullword ascii /* Goodware String - occured 1 times */
      $s6 = "$ebc25cf6-9120-4283-b972-0e5520d00004" fullword ascii /* Goodware String - occured 1 times */
      $s7 = "$ebc25cf6-9120-4283-b972-0e5520d0000A" fullword ascii /* Goodware String - occured 1 times */
      $s8 = "$ebc25cf6-9120-4283-b972-0e5520d0000C" fullword ascii /* Goodware String - occured 1 times */
      $s9 = "$ebc25cf6-9120-4283-b972-0e5520d0000B" fullword ascii /* Goodware String - occured 1 times */
      $s10 = "$ebc25cf6-9120-4283-b972-0e5520d0000E" fullword ascii /* Goodware String - occured 1 times */
      $s11 = "$ebc25cf6-9120-4283-b972-0e5520d00005" fullword ascii /* Goodware String - occured 1 times */
      $s12 = "$ebc25cf6-9120-4283-b972-0e5520d00009" fullword ascii /* Goodware String - occured 1 times */
      $s13 = "waveInGetDevCaps" fullword ascii /* Goodware String - occured 2 times */
   condition:
      ( uint16(0) == 0x5a4d and filesize < 13000KB and ( 8 of them )
      ) or ( all of them )
}

rule _f745359274019b502bda094e4c58c5e553e32cd56dcd72fb7984ad2e706a8eb6_521d404952876e51d0cf3a4d0d69e30566406a3a129343d5e53d5d7274_24 {
   meta:
      description = "samples - from files f745359274019b502bda094e4c58c5e553e32cd56dcd72fb7984ad2e706a8eb6.exe, 521d404952876e51d0cf3a4d0d69e30566406a3a129343d5e53d5d7274f4d3dc.exe, 17e36536f236d0effd2850906ccd9972beb6f73a994fe8c1bb03c2a850f453bb.exe, 0843b763880a4e1b559d29140afff5cd867bcada20eda6db2524d4e5045af114.exe, b3fe1e7404ddef2f09b8f51c5c2010e799ebf69f647e7e519a4305dc2b3a5695.exe, f139a9c30967f1e0edaa605531560bf18ee4f190ab3b01b3540f1aefd20adcdb.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "f745359274019b502bda094e4c58c5e553e32cd56dcd72fb7984ad2e706a8eb6"
      hash2 = "521d404952876e51d0cf3a4d0d69e30566406a3a129343d5e53d5d7274f4d3dc"
      hash3 = "17e36536f236d0effd2850906ccd9972beb6f73a994fe8c1bb03c2a850f453bb"
      hash4 = "0843b763880a4e1b559d29140afff5cd867bcada20eda6db2524d4e5045af114"
      hash5 = "b3fe1e7404ddef2f09b8f51c5c2010e799ebf69f647e7e519a4305dc2b3a5695"
      hash6 = "f139a9c30967f1e0edaa605531560bf18ee4f190ab3b01b3540f1aefd20adcdb"
   strings:
      $s1 = "typemdt" fullword ascii
      $s2 = "Hashtable" fullword ascii /* Goodware String - occured 645 times */
      $s3 = "nativeEntry" fullword ascii
      $s4 = "classthis" fullword ascii
      $s5 = "nativeSizeOfCode" fullword ascii
      $s6 = "GetDelegateForFunctionPointer" fullword wide /* Goodware String - occured 1 times */
      $s7 = "{11111-22222-50001-00000}" fullword wide
      $s8 = "{11111-22222-40001-00001}" fullword wide
      $s9 = "{11111-22222-40001-00002}" fullword wide
   condition:
      ( uint16(0) == 0x5a4d and filesize < 14000KB and ( all of them )
      ) or ( all of them )
}

rule _2449fe334bbf8f09ff80422578a6c6961d20a0a456b214f6490c5ed1ae859c9e_2f502689b799fd964bced77e57edf4206809bb11da16cf4f7895df1df5_25 {
   meta:
      description = "samples - from files 2449fe334bbf8f09ff80422578a6c6961d20a0a456b214f6490c5ed1ae859c9e.exe, 2f502689b799fd964bced77e57edf4206809bb11da16cf4f7895df1df54cdc97.exe, ddeb365475b677380faf477533c9a6319f4f466b7d4be97c350dfd058966f308.exe, 1314eb993b4effdda7e10527b7fd8996f94c7c5cf817f23ce340647728f0e57a.exe, 17e36536f236d0effd2850906ccd9972beb6f73a994fe8c1bb03c2a850f453bb.exe, 71af9ae73d69eff082dd445af8d96351cd106afd0ca27824d35a8a667f7ef38b.exe, 4a33dd36f9cd9bdf25e3d0207a3c8ad7c04f61178ef0fe62e5c054c1f311e9a9.exe, d4b8014a57142265ac47b3e29f68de51eb145b62ae613f7efb8ff1fe4fb22c8c.exe, a37770babd802e2e67c301280ab05dd85859827ab81b8053b32fecabd34eee32.exe, b3fe1e7404ddef2f09b8f51c5c2010e799ebf69f647e7e519a4305dc2b3a5695.exe, 3ab831a2370cb682ff6ee4113a8a8985774cae1afd85196bd473423f98185e83.exe, 3f0dea5783c2deb7a9686accab4b1e17953f4babefbcc2668428a9fc00a1c4ea.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "2449fe334bbf8f09ff80422578a6c6961d20a0a456b214f6490c5ed1ae859c9e"
      hash2 = "2f502689b799fd964bced77e57edf4206809bb11da16cf4f7895df1df54cdc97"
      hash3 = "ddeb365475b677380faf477533c9a6319f4f466b7d4be97c350dfd058966f308"
      hash4 = "1314eb993b4effdda7e10527b7fd8996f94c7c5cf817f23ce340647728f0e57a"
      hash5 = "17e36536f236d0effd2850906ccd9972beb6f73a994fe8c1bb03c2a850f453bb"
      hash6 = "71af9ae73d69eff082dd445af8d96351cd106afd0ca27824d35a8a667f7ef38b"
      hash7 = "4a33dd36f9cd9bdf25e3d0207a3c8ad7c04f61178ef0fe62e5c054c1f311e9a9"
      hash8 = "d4b8014a57142265ac47b3e29f68de51eb145b62ae613f7efb8ff1fe4fb22c8c"
      hash9 = "a37770babd802e2e67c301280ab05dd85859827ab81b8053b32fecabd34eee32"
      hash10 = "b3fe1e7404ddef2f09b8f51c5c2010e799ebf69f647e7e519a4305dc2b3a5695"
      hash11 = "3ab831a2370cb682ff6ee4113a8a8985774cae1afd85196bd473423f98185e83"
      hash12 = "3f0dea5783c2deb7a9686accab4b1e17953f4babefbcc2668428a9fc00a1c4ea"
   strings:
      $s1 = " Type Descriptor'" fullword ascii
      $s2 = " Base Class Descriptor at (" fullword ascii
      $s3 = " Class Hierarchy Descriptor'" fullword ascii
      $s4 = " Complete Object Locator'" fullword ascii
      $s5 = " delete[]" fullword ascii
      $s6 = " delete" fullword ascii
      $s7 = " new[]" fullword ascii
      $s8 = " Base Class Array'" fullword ascii
   condition:
      ( uint16(0) == 0x5a4d and filesize < 29000KB and ( all of them )
      ) or ( all of them )
}

rule _81b7a88094afc7849af4f05d933cf46a5f8ab7ef913c74b320b5153e3cfa08b5_da7e3ec3246fde5e42f11dd557cf23af84460b5e6048f84e5db35a15c8_26 {
   meta:
      description = "samples - from files 81b7a88094afc7849af4f05d933cf46a5f8ab7ef913c74b320b5153e3cfa08b5.exe, da7e3ec3246fde5e42f11dd557cf23af84460b5e6048f84e5db35a15c899fb2c.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "81b7a88094afc7849af4f05d933cf46a5f8ab7ef913c74b320b5153e3cfa08b5"
      hash2 = "da7e3ec3246fde5e42f11dd557cf23af84460b5e6048f84e5db35a15c899fb2c"
   strings:
      $x1 = "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?> <assembly xmlns=\"urn:schemas-microsoft-com:asm.v1\" manifestVersi" ascii
      $s2 = " or \"requireAdministrator\" --> <v3:requestedExecutionLevel level=\"highestAvailable\" /> </v3:requestedPrivileges> </v3:securi" ascii
      $s3 = "> <dependency> <dependentAssembly> <assemblyIdentity type=\"win32\" name=\"Microsoft.Windows.Common-Controls\" version=\"6.0.0.0" ascii
      $s4 = "v3=\"urn:schemas-microsoft-com:asm.v3\"> <v3:security> <v3:requestedPrivileges> <!-- level can be \"asInvoker\", \"highestAvaila" ascii
      $s5 = "cessorArchitecture=\"*\" publicKeyToken=\"6595b64144ccf1df\" language=\"*\" /> </dependentAssembly> </dependency> <v3:trustInfo " ascii
      $s6 = "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?> <assembly xmlns=\"urn:schemas-microsoft-com:asm.v1\" manifestVersi" ascii
      $s7 = "[]A\\A]A^A_" fullword ascii /* Goodware String - occured 2 times */
      $s8 = "M4\"P@y5Xf;" fullword ascii
      $s9 = "F,JPlPo" fullword ascii
      $s10 = "~>iK7}8" fullword ascii
      $s11 = "G-w?yF" fullword ascii
      $s12 = "+2U'c]F" fullword ascii
      $s13 = "fS3/*u" fullword ascii
      $s14 = "IG(&E-&" fullword ascii
      $s15 = "KR/:E3" fullword ascii
      $s16 = "05-M:k" fullword ascii
      $s17 = "qF\\PV8" fullword ascii
      $s18 = "Dvi(KT" fullword ascii
      $s19 = "]59Ct5" fullword ascii
      $s20 = "(]_^[H" fullword ascii
   condition:
      ( uint16(0) == 0x5a4d and filesize < 100KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _49dc64191a08c389e43a7b765975fe2119b0b5228172fbf5e76d5cabd9afc80e_56e1d092c07322d9dad7d85d773953573cc3294b9e428b3bbbaf935ca4_27 {
   meta:
      description = "samples - from files 49dc64191a08c389e43a7b765975fe2119b0b5228172fbf5e76d5cabd9afc80e.exe, 56e1d092c07322d9dad7d85d773953573cc3294b9e428b3bbbaf935ca4d2f7e7.exe, 4f30db298f99fc45d153f6568529228c98e1ad173249c1f76424977bd0b373c2.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "49dc64191a08c389e43a7b765975fe2119b0b5228172fbf5e76d5cabd9afc80e"
      hash2 = "56e1d092c07322d9dad7d85d773953573cc3294b9e428b3bbbaf935ca4d2f7e7"
      hash3 = "4f30db298f99fc45d153f6568529228c98e1ad173249c1f76424977bd0b373c2"
   strings:
      $s1 = "__mingw_module_is_dll" fullword ascii
      $s2 = ".rdata$.refptr._commode" fullword ascii
      $s3 = "__imp___p__commode" fullword ascii
      $s4 = "__imp__commode" fullword ascii
      $s5 = ".refptr.__imp__commode" fullword ascii
      $s6 = ".refptr._commode" fullword ascii
      $s7 = ".rdata$.refptr.__imp__commode" fullword ascii
      $s8 = "_charmax" fullword ascii
      $s9 = "__imp_RaiseException" fullword ascii /* Goodware String - occured 1 times */
      $s10 = ".CRT$XLZX" fullword ascii
      $s11 = "__imp_AddVectoredExceptionHandler" fullword ascii
      $s12 = ".CRT$XDZh" fullword ascii
      $s13 = ".CRT$XDA`" fullword ascii
      $s14 = "__imp_WaitForMultipleObjects" fullword ascii /* Goodware String - occured 5 times */
   condition:
      ( uint16(0) == 0x5a4d and filesize < 22000KB and ( 8 of them )
      ) or ( all of them )
}

rule _36e6a3dd4bfc86c4e707f43cd9515707442d6c424b7661cb41766cfdca322522_19e14e5ffefce00e9a96101005e11ce743f039f102dadc668827ea6a44_28 {
   meta:
      description = "samples - from files 36e6a3dd4bfc86c4e707f43cd9515707442d6c424b7661cb41766cfdca322522.exe, 19e14e5ffefce00e9a96101005e11ce743f039f102dadc668827ea6a444de691.exe, e4d67649c7704c50925bcd3fe6ac345cba54d118407f28f6550b398671b0284e.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "36e6a3dd4bfc86c4e707f43cd9515707442d6c424b7661cb41766cfdca322522"
      hash2 = "19e14e5ffefce00e9a96101005e11ce743f039f102dadc668827ea6a444de691"
      hash3 = "e4d67649c7704c50925bcd3fe6ac345cba54d118407f28f6550b398671b0284e"
   strings:
      $s1 = "<Logins>k__BackingField" fullword ascii
      $s2 = "set_Processes" fullword ascii
      $s3 = "<Processes>k__BackingField" fullword ascii
      $s4 = "set_Logins" fullword ascii
      $s5 = "set_Monitor" fullword ascii
      $s6 = "<Username>k__BackingField" fullword ascii /* Goodware String - occured 1 times */
      $s7 = "<>9__3_1" fullword ascii /* Goodware String - occured 1 times */
      $s8 = "__StaticArrayInitTypeSize=124" fullword ascii /* Goodware String - occured 1 times */
      $s9 = "<Country>k__BackingField" fullword ascii /* Goodware String - occured 1 times */
      $s10 = "<Resolution>k__BackingField" fullword ascii
      $s11 = "<Monitor>k__BackingField" fullword ascii
      $s12 = "get_Monitor" fullword ascii /* Goodware String - occured 1 times */
      $s13 = "get_Processes" fullword ascii /* Goodware String - occured 2 times */
      $s14 = "country_code" fullword ascii /* Goodware String - occured 3 times */
   condition:
      ( uint16(0) == 0x5a4d and filesize < 10000KB and ( 8 of them )
      ) or ( all of them )
}

rule _3b03a24bfde864b0d8b17213f7f2deb6d7e3f5f74b34d3b601cbadd961b904fc_6475637fff05177a05bf6e84301c09492f21766ea3ba0068f3f70c4d0d_29 {
   meta:
      description = "samples - from files 3b03a24bfde864b0d8b17213f7f2deb6d7e3f5f74b34d3b601cbadd961b904fc.exe, 6475637fff05177a05bf6e84301c09492f21766ea3ba0068f3f70c4d0d886a9e.exe, 2a5dac302572ede5da5d53df170d5882937027b58290b6ea60e24478453276c9.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "3b03a24bfde864b0d8b17213f7f2deb6d7e3f5f74b34d3b601cbadd961b904fc"
      hash2 = "6475637fff05177a05bf6e84301c09492f21766ea3ba0068f3f70c4d0d886a9e"
      hash3 = "2a5dac302572ede5da5d53df170d5882937027b58290b6ea60e24478453276c9"
   strings:
      $s1 = "ZVAY]]\\A" fullword ascii
      $s2 = "sxVN_n\"" fullword ascii
      $s3 = "([xtKh?" fullword ascii
      $s4 = "BbhP%2W" fullword ascii
      $s5 = "wLjiwyD" fullword ascii
      $s6 = "UNZK~?U" fullword ascii
      $s7 = "\\r8\"E\\" fullword ascii
      $s8 = "9H;.&8" fullword ascii
      $s9 = "4:9PJ@)" fullword ascii
      $s10 = "Q_RZH$" fullword ascii
      $s11 = "-i9o\\{" fullword ascii
      $s12 = "NvVacf" fullword ascii
      $s13 = "Obp&GI" fullword ascii
      $s14 = ";ZJ 9vd~" fullword ascii
      $s15 = "}n7:X7r," fullword ascii
      $s16 = "!TpOJA" fullword ascii
      $s17 = "[(wa0d$" fullword ascii
      $s18 = "`dKZhT" fullword ascii
      $s19 = "m0bDtC$" fullword ascii
      $s20 = "z?)qi6" fullword ascii
   condition:
      ( uint16(0) == 0x5a4d and filesize < 600KB and ( 8 of them )
      ) or ( all of them )
}

rule _408c4cb78449baf846592637c9a8f03f47c3df6786acdce6e9ad0ef0db370068_d61022cef95af3e20bb237b2690c817d948c3ea99a5f11153eca3bcfff_30 {
   meta:
      description = "samples - from files 408c4cb78449baf846592637c9a8f03f47c3df6786acdce6e9ad0ef0db370068.exe, d61022cef95af3e20bb237b2690c817d948c3ea99a5f11153eca3bcfff034eb0.exe, 1ef225d55b567e06ca8c6197aa237b76504a1a270a512b80b50280154af98146.exe, ea520d8e6ca1d44593f26ceea349d55709ebd61565f67368947d38e484f5846f.exe, df9d5a6d4edf1baf28fe59cc742cb980dfba7613a17b50c5a75f3fdd756bbc54.exe, 3b03a24bfde864b0d8b17213f7f2deb6d7e3f5f74b34d3b601cbadd961b904fc.exe, cc38fb3ee3227606258b1b9ccba885393d6ed4a54a51aefef30a669cdc171e80.exe, 749911c61e23b64b45f28d453a8b70275f824092d8dab39ccc1e93464d26b450.exe, 50ce164844684892d697f16bc194d82841e4c1b951609d12bc26cab8b028192e.exe, 07d35c2c242d2c2a7bbf3d70315f7679c90b3f5a32b2ff542fdfca8a0b9cb4c8.exe, 6475637fff05177a05bf6e84301c09492f21766ea3ba0068f3f70c4d0d886a9e.exe, 7ce2d225442252064d744be1c38e9c1572dd355bbbaf7fa411ce79e41288dfca.exe, a8fcd268b48c903e21500439d6754500d59d12d7d5d4e2c7ea737661fa8fe230.exe, ab0486b2252a7c4c577ca2d3082084418b624f6c28a5ae27aa22add6236d05ce.exe, 2a5dac302572ede5da5d53df170d5882937027b58290b6ea60e24478453276c9.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "408c4cb78449baf846592637c9a8f03f47c3df6786acdce6e9ad0ef0db370068"
      hash2 = "d61022cef95af3e20bb237b2690c817d948c3ea99a5f11153eca3bcfff034eb0"
      hash3 = "1ef225d55b567e06ca8c6197aa237b76504a1a270a512b80b50280154af98146"
      hash4 = "ea520d8e6ca1d44593f26ceea349d55709ebd61565f67368947d38e484f5846f"
      hash5 = "df9d5a6d4edf1baf28fe59cc742cb980dfba7613a17b50c5a75f3fdd756bbc54"
      hash6 = "3b03a24bfde864b0d8b17213f7f2deb6d7e3f5f74b34d3b601cbadd961b904fc"
      hash7 = "cc38fb3ee3227606258b1b9ccba885393d6ed4a54a51aefef30a669cdc171e80"
      hash8 = "749911c61e23b64b45f28d453a8b70275f824092d8dab39ccc1e93464d26b450"
      hash9 = "50ce164844684892d697f16bc194d82841e4c1b951609d12bc26cab8b028192e"
      hash10 = "07d35c2c242d2c2a7bbf3d70315f7679c90b3f5a32b2ff542fdfca8a0b9cb4c8"
      hash11 = "6475637fff05177a05bf6e84301c09492f21766ea3ba0068f3f70c4d0d886a9e"
      hash12 = "7ce2d225442252064d744be1c38e9c1572dd355bbbaf7fa411ce79e41288dfca"
      hash13 = "a8fcd268b48c903e21500439d6754500d59d12d7d5d4e2c7ea737661fa8fe230"
      hash14 = "ab0486b2252a7c4c577ca2d3082084418b624f6c28a5ae27aa22add6236d05ce"
      hash15 = "2a5dac302572ede5da5d53df170d5882937027b58290b6ea60e24478453276c9"
   strings:
      $s1 = "get_AsArray" fullword ascii
      $s2 = "get_SslClient" fullword ascii
      $s3 = "get_AsInteger" fullword ascii
      $s4 = "get_AsFloat" fullword ascii
      $s5 = "<HeaderSize>k__BackingField" fullword ascii
      $s6 = "Plugin.Plugin" fullword wide
      $s7 = "get_Ping" fullword ascii
      $s8 = "set_TcpClient" fullword ascii
      $s9 = "set_AsString" fullword ascii
      $s10 = "<SslClient>k__BackingField" fullword ascii
      $s11 = "<Interval>k__BackingField" fullword ascii
      $s12 = "set_SslClient" fullword ascii
      $s13 = "<Ping>k__BackingField" fullword ascii
      $s14 = "set_AsInteger" fullword ascii
      $s15 = "get_AsString" fullword ascii /* Goodware String - occured 1 times */
      $s16 = "<TcpClient>k__BackingField" fullword ascii
      $s17 = "set_AsFloat" fullword ascii
      $s18 = "sendPlugin" fullword wide
      $s19 = "ClientInfo" fullword wide /* Goodware String - occured 1 times */
      $s20 = "(never used) type $c1" fullword wide
   condition:
      ( uint16(0) == 0x5a4d and filesize < 600KB and ( 8 of them )
      ) or ( all of them )
}

rule _6ea0f794612002992d031fdec0e12d70df57ae9077ad3bcb817bb9e4115b2d40_521d404952876e51d0cf3a4d0d69e30566406a3a129343d5e53d5d7274_31 {
   meta:
      description = "samples - from files 6ea0f794612002992d031fdec0e12d70df57ae9077ad3bcb817bb9e4115b2d40.exe, 521d404952876e51d0cf3a4d0d69e30566406a3a129343d5e53d5d7274f4d3dc.exe, 0843b763880a4e1b559d29140afff5cd867bcada20eda6db2524d4e5045af114.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "6ea0f794612002992d031fdec0e12d70df57ae9077ad3bcb817bb9e4115b2d40"
      hash2 = "521d404952876e51d0cf3a4d0d69e30566406a3a129343d5e53d5d7274f4d3dc"
      hash3 = "0843b763880a4e1b559d29140afff5cd867bcada20eda6db2524d4e5045af114"
   strings:
      $s1 = "WebBrowser" fullword ascii /* Goodware String - occured 44 times */
      $s2 = "<>9__3" fullword ascii
      $s3 = "<>9__22_3" fullword ascii
      $s4 = "<>9__22_2" fullword ascii
      $s5 = "<>9__1" fullword ascii /* Goodware String - occured 4 times */
      $s6 = "14.0.0.0" fullword ascii /* Goodware String - occured 4 times */
      $s7 = "<>9__22_1" fullword ascii
      $s8 = "<>9__22_5" fullword ascii
   condition:
      ( uint16(0) == 0x5a4d and filesize < 14000KB and ( all of them )
      ) or ( all of them )
}

rule _2449fe334bbf8f09ff80422578a6c6961d20a0a456b214f6490c5ed1ae859c9e_2f502689b799fd964bced77e57edf4206809bb11da16cf4f7895df1df5_32 {
   meta:
      description = "samples - from files 2449fe334bbf8f09ff80422578a6c6961d20a0a456b214f6490c5ed1ae859c9e.exe, 2f502689b799fd964bced77e57edf4206809bb11da16cf4f7895df1df54cdc97.exe, ddeb365475b677380faf477533c9a6319f4f466b7d4be97c350dfd058966f308.exe, 3e9b442995fc472566f6689c275b24bb9d2a0244bd002671d471654d0b0893b0.exe, d4b8014a57142265ac47b3e29f68de51eb145b62ae613f7efb8ff1fe4fb22c8c.exe, 3f0dea5783c2deb7a9686accab4b1e17953f4babefbcc2668428a9fc00a1c4ea.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "2449fe334bbf8f09ff80422578a6c6961d20a0a456b214f6490c5ed1ae859c9e"
      hash2 = "2f502689b799fd964bced77e57edf4206809bb11da16cf4f7895df1df54cdc97"
      hash3 = "ddeb365475b677380faf477533c9a6319f4f466b7d4be97c350dfd058966f308"
      hash4 = "3e9b442995fc472566f6689c275b24bb9d2a0244bd002671d471654d0b0893b0"
      hash5 = "d4b8014a57142265ac47b3e29f68de51eb145b62ae613f7efb8ff1fe4fb22c8c"
      hash6 = "3f0dea5783c2deb7a9686accab4b1e17953f4babefbcc2668428a9fc00a1c4ea"
   strings:
      $s1 = "wrong protocol type" fullword ascii /* Goodware String - occured 567 times */
      $s2 = "network reset" fullword ascii /* Goodware String - occured 567 times */
      $s3 = "connection already in progress" fullword ascii /* Goodware String - occured 567 times */
      $s4 = "owner dead" fullword ascii /* Goodware String - occured 567 times */
      $s5 = "network down" fullword ascii /* Goodware String - occured 567 times */
      $s6 = "protocol not supported" fullword ascii /* Goodware String - occured 568 times */
      $s7 = "connection aborted" fullword ascii /* Goodware String - occured 568 times */
      $s8 = "network unreachable" fullword ascii /* Goodware String - occured 569 times */
      $s9 = "host unreachable" fullword ascii /* Goodware String - occured 571 times */
      $s10 = "protocol error" fullword ascii /* Goodware String - occured 588 times */
      $s11 = "connection refused" fullword ascii /* Goodware String - occured 597 times */
   condition:
      ( uint16(0) == 0x5a4d and filesize < 16000KB and ( 8 of them )
      ) or ( all of them )
}

rule _8601904fb878151c3dfa821f653e529747f50a961854bec78014e9e2ed44b9cc_521d404952876e51d0cf3a4d0d69e30566406a3a129343d5e53d5d7274_33 {
   meta:
      description = "samples - from files 8601904fb878151c3dfa821f653e529747f50a961854bec78014e9e2ed44b9cc.exe, 521d404952876e51d0cf3a4d0d69e30566406a3a129343d5e53d5d7274f4d3dc.exe, 0843b763880a4e1b559d29140afff5cd867bcada20eda6db2524d4e5045af114.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "8601904fb878151c3dfa821f653e529747f50a961854bec78014e9e2ed44b9cc"
      hash2 = "521d404952876e51d0cf3a4d0d69e30566406a3a129343d5e53d5d7274f4d3dc"
      hash3 = "0843b763880a4e1b559d29140afff5cd867bcada20eda6db2524d4e5045af114"
   strings:
      $s1 = "4System.Web.Services.Protocols.SoapHttpClientProtocol" fullword ascii
      $s2 = "My.Computer" fullword ascii
      $s3 = "MyTemplate" fullword ascii
      $s4 = "m_MyWebServicesObjectProvider" fullword ascii
      $s5 = "MyWebServices" fullword ascii
      $s6 = "m_ThreadStaticValue" fullword ascii
      $s7 = "m_UserObjectProvider" fullword ascii
      $s8 = "My.WebServices" fullword ascii
      $s9 = "ThreadSafeObjectProvider`1" fullword ascii
      $s10 = "m_ComputerObjectProvider" fullword ascii
      $s11 = "MyProject" fullword ascii
      $s12 = "Dispose__Instance__" fullword ascii
      $s13 = "Create__Instance__" fullword ascii
      $s14 = "My.User" fullword ascii
      $s15 = "m_AppObjectProvider" fullword ascii
      $s16 = "get_Computer" fullword ascii /* Goodware String - occured 4 times */
      $s17 = "My.Application" fullword ascii
      $s18 = "MyApplication" fullword ascii
   condition:
      ( uint16(0) == 0x5a4d and filesize < 14000KB and ( 8 of them )
      ) or ( all of them )
}

rule _8ed24ddbcd88141fb1934ea20761b97d7cbdcb4e5042f6e1d893ed817a5b4a89_283ece83572923032a368088751b611aee0d866be61d048935d9b5ca3d_34 {
   meta:
      description = "samples - from files 8ed24ddbcd88141fb1934ea20761b97d7cbdcb4e5042f6e1d893ed817a5b4a89.exe, 283ece83572923032a368088751b611aee0d866be61d048935d9b5ca3d344a70.exe, 3f0dea5783c2deb7a9686accab4b1e17953f4babefbcc2668428a9fc00a1c4ea.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "8ed24ddbcd88141fb1934ea20761b97d7cbdcb4e5042f6e1d893ed817a5b4a89"
      hash2 = "283ece83572923032a368088751b611aee0d866be61d048935d9b5ca3d344a70"
      hash3 = "3f0dea5783c2deb7a9686accab4b1e17953f4babefbcc2668428a9fc00a1c4ea"
   strings:
      $s1 = ";uC#h/" fullword ascii
      $s2 = "$HypYkf" fullword ascii
      $s3 = "5'0v2ZP" fullword ascii
      $s4 = "~R65Fu" fullword ascii
      $s5 = "r~s-v7" fullword ascii
      $s6 = "3Ej%Tb" fullword ascii
      $s7 = "VY5[;o" fullword ascii
      $s8 = "_ee/?P" fullword ascii
      $s9 = "`28)fk" fullword ascii
      $s10 = "'pSN.F" fullword ascii
      $s11 = "'A,6y-" fullword ascii
      $s12 = "s=%(nh0" fullword ascii
      $s13 = "}BzJ88" fullword ascii
      $s14 = ",9(}ZA" fullword ascii
      $s15 = ";>4>se=" fullword ascii
      $s16 = "$>Mm/JhA" fullword ascii
      $s17 = "/\\U ?J" fullword ascii
      $s18 = "L4uGv~;6" fullword ascii
      $s19 = "BY_Lq)" fullword ascii
      $s20 = "k/.fG\"" fullword ascii
   condition:
      ( uint16(0) == 0x5a4d and filesize < 16000KB and ( 8 of them )
      ) or ( all of them )
}

rule _8ed24ddbcd88141fb1934ea20761b97d7cbdcb4e5042f6e1d893ed817a5b4a89_3f0dea5783c2deb7a9686accab4b1e17953f4babefbcc2668428a9fc00_35 {
   meta:
      description = "samples - from files 8ed24ddbcd88141fb1934ea20761b97d7cbdcb4e5042f6e1d893ed817a5b4a89.exe, 3f0dea5783c2deb7a9686accab4b1e17953f4babefbcc2668428a9fc00a1c4ea.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "8ed24ddbcd88141fb1934ea20761b97d7cbdcb4e5042f6e1d893ed817a5b4a89"
      hash2 = "3f0dea5783c2deb7a9686accab4b1e17953f4babefbcc2668428a9fc00a1c4ea"
   strings:
      $s1 = "YedcCH}" fullword ascii
      $s2 = "wOUigi<" fullword ascii
      $s3 = "SQ8_d`\\" fullword ascii
      $s4 = "qTm_fC=" fullword ascii
      $s5 = "!#QRFt" fullword ascii
      $s6 = "fdxfv%" fullword ascii
      $s7 = "Y;C;8V" fullword ascii
      $s8 = "2\\fWQx" fullword ascii
      $s9 = "-,O'-U" fullword ascii
      $s10 = "X @l(&" fullword ascii
      $s11 = "K5!n^n" fullword ascii
      $s12 = "HU>mA$_E*" fullword ascii
      $s13 = "{5`q@roz?" fullword ascii
      $s14 = "|c~=;F" fullword ascii
      $s15 = "Dc&6\\<H:" fullword ascii
      $s16 = "M}8vhJ" fullword ascii
      $s17 = " _$7*xq?\"" fullword ascii
      $s18 = "2cb:RO" fullword ascii
      $s19 = "J#}QU^u" fullword ascii
      $s20 = "g u}DE" fullword ascii
   condition:
      ( uint16(0) == 0x5a4d and filesize < 16000KB and ( 8 of them )
      ) or ( all of them )
}

rule _36e6a3dd4bfc86c4e707f43cd9515707442d6c424b7661cb41766cfdca322522_ea520d8e6ca1d44593f26ceea349d55709ebd61565f67368947d38e484_36 {
   meta:
      description = "samples - from files 36e6a3dd4bfc86c4e707f43cd9515707442d6c424b7661cb41766cfdca322522.exe, ea520d8e6ca1d44593f26ceea349d55709ebd61565f67368947d38e484f5846f.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "36e6a3dd4bfc86c4e707f43cd9515707442d6c424b7661cb41766cfdca322522"
      hash2 = "ea520d8e6ca1d44593f26ceea349d55709ebd61565f67368947d38e484f5846f"
   strings:
      $s1 = "crypto" fullword wide
      $s2 = "chcp 65001" fullword wide
      $s3 = "logins" fullword wide /* Goodware String - occured 2 times */
      $s4 = "logins.json" fullword wide /* Goodware String - occured 2 times */
      $s5 = "7D78CB380BF5EFB7B851409CA6A875F77DECF09D19B9149DA17A3EBF674BC0F9" ascii
      $s6 = "GatewayIPAddressInformation" fullword ascii /* Goodware String - occured 5 times */
   condition:
      ( uint16(0) == 0x5a4d and filesize < 10000KB and ( all of them )
      ) or ( all of them )
}

rule _eb7aa3469a93e430a4954aaab1520f3b7ebb66055e621a27e79842f4c8db6ea8_1314eb993b4effdda7e10527b7fd8996f94c7c5cf817f23ce340647728_37 {
   meta:
      description = "samples - from files eb7aa3469a93e430a4954aaab1520f3b7ebb66055e621a27e79842f4c8db6ea8.exe, 1314eb993b4effdda7e10527b7fd8996f94c7c5cf817f23ce340647728f0e57a.exe, e583a74eee0a4dca05e41b16b1d384302c7130f2c88e3e9fd6602901f6afdb9a.exe, 71af9ae73d69eff082dd445af8d96351cd106afd0ca27824d35a8a667f7ef38b.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "eb7aa3469a93e430a4954aaab1520f3b7ebb66055e621a27e79842f4c8db6ea8"
      hash2 = "1314eb993b4effdda7e10527b7fd8996f94c7c5cf817f23ce340647728f0e57a"
      hash3 = "e583a74eee0a4dca05e41b16b1d384302c7130f2c88e3e9fd6602901f6afdb9a"
      hash4 = "71af9ae73d69eff082dd445af8d96351cd106afd0ca27824d35a8a667f7ef38b"
   strings:
      $s1 = "7http://cacerts.digicert.com/DigiCertAssuredIDRootCA.crt0E" fullword ascii
      $s2 = "5http://cacerts.digicert.com/DigiCertTrustedRootG4.crt0C" fullword ascii
      $s3 = "2http://crl3.digicert.com/DigiCertTrustedRootG4.crl0 " fullword ascii
      $s4 = "4http://crl3.digicert.com/DigiCertAssuredIDRootCA.crl0" fullword ascii
      $s5 = "http://ocsp.digicert.com0X" fullword ascii
      $s6 = "Lhttp://cacerts.digicert.com/DigiCertTrustedG4RSA4096SHA256TimeStampingCA.crt0" fullword ascii
      $s7 = "Ihttp://crl3.digicert.com/DigiCertTrustedG4RSA4096SHA256TimeStampingCA.crl0" fullword ascii
      $s8 = "DigiCert, Inc.1 0" fullword ascii
      $s9 = "v=Y]Bv" fullword ascii /* Goodware String - occured 1 times */
      $s10 = "]J<0\"0i3" fullword ascii /* Goodware String - occured 1 times */
      $s11 = "DigiCert, Inc.1;09" fullword ascii
      $s12 = "DigiCert Timestamp 20230" fullword ascii
      $s13 = "DigiCert Trusted Root G40" fullword ascii /* Goodware String - occured 1 times */
      $s14 = "2DigiCert Trusted G4 RSA4096 SHA256 TimeStamping CA" fullword ascii
      $s15 = "2DigiCert Trusted G4 RSA4096 SHA256 TimeStamping CA0" fullword ascii
      $s16 = "311109235959Z0b1" fullword ascii
      $s17 = "~qj#k\"" fullword ascii
      $s18 = "311109235959" ascii
      $s19 = "220323000000Z" fullword ascii
      $s20 = "(f*^[0" fullword ascii
   condition:
      ( uint16(0) == 0x5a4d and filesize < 15000KB and ( 8 of them )
      ) or ( all of them )
}

rule _408c4cb78449baf846592637c9a8f03f47c3df6786acdce6e9ad0ef0db370068_d61022cef95af3e20bb237b2690c817d948c3ea99a5f11153eca3bcfff_38 {
   meta:
      description = "samples - from files 408c4cb78449baf846592637c9a8f03f47c3df6786acdce6e9ad0ef0db370068.exe, d61022cef95af3e20bb237b2690c817d948c3ea99a5f11153eca3bcfff034eb0.exe, 1ef225d55b567e06ca8c6197aa237b76504a1a270a512b80b50280154af98146.exe, ea520d8e6ca1d44593f26ceea349d55709ebd61565f67368947d38e484f5846f.exe, df9d5a6d4edf1baf28fe59cc742cb980dfba7613a17b50c5a75f3fdd756bbc54.exe, 3b03a24bfde864b0d8b17213f7f2deb6d7e3f5f74b34d3b601cbadd961b904fc.exe, cc38fb3ee3227606258b1b9ccba885393d6ed4a54a51aefef30a669cdc171e80.exe, 749911c61e23b64b45f28d453a8b70275f824092d8dab39ccc1e93464d26b450.exe, 50ce164844684892d697f16bc194d82841e4c1b951609d12bc26cab8b028192e.exe, 6475637fff05177a05bf6e84301c09492f21766ea3ba0068f3f70c4d0d886a9e.exe, 7ce2d225442252064d744be1c38e9c1572dd355bbbaf7fa411ce79e41288dfca.exe, a8fcd268b48c903e21500439d6754500d59d12d7d5d4e2c7ea737661fa8fe230.exe, 2a5dac302572ede5da5d53df170d5882937027b58290b6ea60e24478453276c9.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "408c4cb78449baf846592637c9a8f03f47c3df6786acdce6e9ad0ef0db370068"
      hash2 = "d61022cef95af3e20bb237b2690c817d948c3ea99a5f11153eca3bcfff034eb0"
      hash3 = "1ef225d55b567e06ca8c6197aa237b76504a1a270a512b80b50280154af98146"
      hash4 = "ea520d8e6ca1d44593f26ceea349d55709ebd61565f67368947d38e484f5846f"
      hash5 = "df9d5a6d4edf1baf28fe59cc742cb980dfba7613a17b50c5a75f3fdd756bbc54"
      hash6 = "3b03a24bfde864b0d8b17213f7f2deb6d7e3f5f74b34d3b601cbadd961b904fc"
      hash7 = "cc38fb3ee3227606258b1b9ccba885393d6ed4a54a51aefef30a669cdc171e80"
      hash8 = "749911c61e23b64b45f28d453a8b70275f824092d8dab39ccc1e93464d26b450"
      hash9 = "50ce164844684892d697f16bc194d82841e4c1b951609d12bc26cab8b028192e"
      hash10 = "6475637fff05177a05bf6e84301c09492f21766ea3ba0068f3f70c4d0d886a9e"
      hash11 = "7ce2d225442252064d744be1c38e9c1572dd355bbbaf7fa411ce79e41288dfca"
      hash12 = "a8fcd268b48c903e21500439d6754500d59d12d7d5d4e2c7ea737661fa8fe230"
      hash13 = "2a5dac302572ede5da5d53df170d5882937027b58290b6ea60e24478453276c9"
   strings:
      $s1 = "MutexControl" fullword ascii
      $s2 = "ProcessCritical" fullword ascii
      $s3 = "AuthKeyLength" fullword ascii
      $s4 = "Client.Connection" fullword ascii
      $s5 = "SystemEvents_SessionEnding" fullword ascii
      $s6 = "_authKey" fullword ascii
      $s7 = "Client.Install" fullword ascii
      $s8 = "Client.Helper" fullword ascii
      $s9 = "RunAntiAnalysis" fullword ascii
      $s10 = "Client.Algorithm" fullword ascii
      $s11 = "Antivirus" fullword ascii /* Goodware String - occured 16 times */
      $s12 = "NormalStartup" fullword ascii
      $s13 = "SetRegistry" fullword ascii /* Goodware String - occured 1 times */
      $s14 = "IvLength" fullword ascii
      $s15 = "Anti_Analysis" fullword ascii
      $s16 = "SendInfo" fullword ascii
      $s17 = "HwidGen" fullword ascii
      $s18 = "IdSender" fullword ascii
      $s19 = "HmacSha256Length" fullword ascii
      $s20 = "ClientSocket" fullword ascii
   condition:
      ( uint16(0) == 0x5a4d and filesize < 600KB and ( 8 of them )
      ) or ( all of them )
}

rule _408c4cb78449baf846592637c9a8f03f47c3df6786acdce6e9ad0ef0db370068_d61022cef95af3e20bb237b2690c817d948c3ea99a5f11153eca3bcfff_39 {
   meta:
      description = "samples - from files 408c4cb78449baf846592637c9a8f03f47c3df6786acdce6e9ad0ef0db370068.exe, d61022cef95af3e20bb237b2690c817d948c3ea99a5f11153eca3bcfff034eb0.exe, 1ef225d55b567e06ca8c6197aa237b76504a1a270a512b80b50280154af98146.exe, df9d5a6d4edf1baf28fe59cc742cb980dfba7613a17b50c5a75f3fdd756bbc54.exe, 3b03a24bfde864b0d8b17213f7f2deb6d7e3f5f74b34d3b601cbadd961b904fc.exe, cc38fb3ee3227606258b1b9ccba885393d6ed4a54a51aefef30a669cdc171e80.exe, 749911c61e23b64b45f28d453a8b70275f824092d8dab39ccc1e93464d26b450.exe, 753d66621ae168b5968406b8c2ad1845f1c9bf42f47556e7646d14e8484adeb8.exe, 6475637fff05177a05bf6e84301c09492f21766ea3ba0068f3f70c4d0d886a9e.exe, 7ce2d225442252064d744be1c38e9c1572dd355bbbaf7fa411ce79e41288dfca.exe, a8fcd268b48c903e21500439d6754500d59d12d7d5d4e2c7ea737661fa8fe230.exe, 2a5dac302572ede5da5d53df170d5882937027b58290b6ea60e24478453276c9.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "408c4cb78449baf846592637c9a8f03f47c3df6786acdce6e9ad0ef0db370068"
      hash2 = "d61022cef95af3e20bb237b2690c817d948c3ea99a5f11153eca3bcfff034eb0"
      hash3 = "1ef225d55b567e06ca8c6197aa237b76504a1a270a512b80b50280154af98146"
      hash4 = "df9d5a6d4edf1baf28fe59cc742cb980dfba7613a17b50c5a75f3fdd756bbc54"
      hash5 = "3b03a24bfde864b0d8b17213f7f2deb6d7e3f5f74b34d3b601cbadd961b904fc"
      hash6 = "cc38fb3ee3227606258b1b9ccba885393d6ed4a54a51aefef30a669cdc171e80"
      hash7 = "749911c61e23b64b45f28d453a8b70275f824092d8dab39ccc1e93464d26b450"
      hash8 = "753d66621ae168b5968406b8c2ad1845f1c9bf42f47556e7646d14e8484adeb8"
      hash9 = "6475637fff05177a05bf6e84301c09492f21766ea3ba0068f3f70c4d0d886a9e"
      hash10 = "7ce2d225442252064d744be1c38e9c1572dd355bbbaf7fa411ce79e41288dfca"
      hash11 = "a8fcd268b48c903e21500439d6754500d59d12d7d5d4e2c7ea737661fa8fe230"
      hash12 = "2a5dac302572ede5da5d53df170d5882937027b58290b6ea60e24478453276c9"
   strings:
      $s1 = "dwProcessHandle" fullword ascii
      $s2 = "<GetFiltes>b__0" fullword ascii
      $s3 = "ppEnumMoniker" fullword ascii
      $s4 = "hSnapshot" fullword ascii /* Goodware String - occured 2 times */
      $s5 = "00AA004BB851" ascii
      $s6 = "00A0C911CE86" ascii
      $s7 = "ICreateDevEnum" fullword ascii /* Goodware String - occured 4 times */
      $s8 = "$29840822-5B84-11D0-BD3B-00A0C911CE86" fullword ascii
      $s9 = "CreateClassEnumerator" fullword ascii
      $s10 = "<>c__DisplayClass5_0" fullword ascii /* Goodware String - occured 5 times */
   condition:
      ( uint16(0) == 0x5a4d and filesize < 1000KB and ( all of them )
      ) or ( all of them )
}

rule _36e6a3dd4bfc86c4e707f43cd9515707442d6c424b7661cb41766cfdca322522_c3c657fa980e2ddcd6fc94d3464fea9816a4d5803c6ec80dee6a8b11fe_40 {
   meta:
      description = "samples - from files 36e6a3dd4bfc86c4e707f43cd9515707442d6c424b7661cb41766cfdca322522.exe, c3c657fa980e2ddcd6fc94d3464fea9816a4d5803c6ec80dee6a8b11fed28d36.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "36e6a3dd4bfc86c4e707f43cd9515707442d6c424b7661cb41766cfdca322522"
      hash2 = "c3c657fa980e2ddcd6fc94d3464fea9816a4d5803c6ec80dee6a8b11fed28d36"
   strings:
      $s1 = "serverHello" fullword ascii
      $s2 = "serverShare" fullword ascii
      $s3 = "ExportKeyingMaterial" fullword ascii
      $s4 = "server" fullword ascii /* Goodware String - occured 401 times */
      $s5 = "selectedIdentity" fullword ascii
      $s6 = "ContextSpecific" fullword ascii
      $s7 = "AddCert" fullword ascii
      $s8 = "PushBack" fullword ascii /* Goodware String - occured 3 times */
   condition:
      ( uint16(0) == 0x5a4d and filesize < 21000KB and ( all of them )
      ) or ( all of them )
}

rule _408c4cb78449baf846592637c9a8f03f47c3df6786acdce6e9ad0ef0db370068_d61022cef95af3e20bb237b2690c817d948c3ea99a5f11153eca3bcfff_41 {
   meta:
      description = "samples - from files 408c4cb78449baf846592637c9a8f03f47c3df6786acdce6e9ad0ef0db370068.exe, d61022cef95af3e20bb237b2690c817d948c3ea99a5f11153eca3bcfff034eb0.exe, 1ef225d55b567e06ca8c6197aa237b76504a1a270a512b80b50280154af98146.exe, ea520d8e6ca1d44593f26ceea349d55709ebd61565f67368947d38e484f5846f.exe, df9d5a6d4edf1baf28fe59cc742cb980dfba7613a17b50c5a75f3fdd756bbc54.exe, 3b03a24bfde864b0d8b17213f7f2deb6d7e3f5f74b34d3b601cbadd961b904fc.exe, cc38fb3ee3227606258b1b9ccba885393d6ed4a54a51aefef30a669cdc171e80.exe, 749911c61e23b64b45f28d453a8b70275f824092d8dab39ccc1e93464d26b450.exe, 50ce164844684892d697f16bc194d82841e4c1b951609d12bc26cab8b028192e.exe, 07d35c2c242d2c2a7bbf3d70315f7679c90b3f5a32b2ff542fdfca8a0b9cb4c8.exe, 6475637fff05177a05bf6e84301c09492f21766ea3ba0068f3f70c4d0d886a9e.exe, 7ce2d225442252064d744be1c38e9c1572dd355bbbaf7fa411ce79e41288dfca.exe, a8fcd268b48c903e21500439d6754500d59d12d7d5d4e2c7ea737661fa8fe230.exe, 2a5dac302572ede5da5d53df170d5882937027b58290b6ea60e24478453276c9.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "408c4cb78449baf846592637c9a8f03f47c3df6786acdce6e9ad0ef0db370068"
      hash2 = "d61022cef95af3e20bb237b2690c817d948c3ea99a5f11153eca3bcfff034eb0"
      hash3 = "1ef225d55b567e06ca8c6197aa237b76504a1a270a512b80b50280154af98146"
      hash4 = "ea520d8e6ca1d44593f26ceea349d55709ebd61565f67368947d38e484f5846f"
      hash5 = "df9d5a6d4edf1baf28fe59cc742cb980dfba7613a17b50c5a75f3fdd756bbc54"
      hash6 = "3b03a24bfde864b0d8b17213f7f2deb6d7e3f5f74b34d3b601cbadd961b904fc"
      hash7 = "cc38fb3ee3227606258b1b9ccba885393d6ed4a54a51aefef30a669cdc171e80"
      hash8 = "749911c61e23b64b45f28d453a8b70275f824092d8dab39ccc1e93464d26b450"
      hash9 = "50ce164844684892d697f16bc194d82841e4c1b951609d12bc26cab8b028192e"
      hash10 = "07d35c2c242d2c2a7bbf3d70315f7679c90b3f5a32b2ff542fdfca8a0b9cb4c8"
      hash11 = "6475637fff05177a05bf6e84301c09492f21766ea3ba0068f3f70c4d0d886a9e"
      hash12 = "7ce2d225442252064d744be1c38e9c1572dd355bbbaf7fa411ce79e41288dfca"
      hash13 = "a8fcd268b48c903e21500439d6754500d59d12d7d5d4e2c7ea737661fa8fe230"
      hash14 = "2a5dac302572ede5da5d53df170d5882937027b58290b6ea60e24478453276c9"
   strings:
      $s1 = "get_SendSync" fullword ascii
      $s2 = "\" /f /q" fullword wide
      $s3 = "Select * from AntivirusProduct" fullword wide
      $s4 = "Msgpack" fullword wide
      $s5 = "\" /tr '\"" fullword wide
      $s6 = "%AppData%" fullword wide /* Goodware String - occured 8 times */
      $s7 = "<SendSync>k__BackingField" fullword ascii
      $s8 = "timeout 3 > NUL" fullword wide
      $s9 = "START \"\" \"" fullword wide
      $s10 = "\\root\\SecurityCenter2" fullword wide /* Goodware String - occured 1 times */
      $s11 = "\"' & exit" fullword wide
   condition:
      ( uint16(0) == 0x5a4d and filesize < 600KB and ( 8 of them )
      ) or ( all of them )
}

rule _7df44db488eeb747b7875331dfc29481aaf77789fe909f8dbf5d84abf072e2b2_c9701863c3174a552ab6ff2ec367111a8d8853b57e5b093429d1c0f247_42 {
   meta:
      description = "samples - from files 7df44db488eeb747b7875331dfc29481aaf77789fe909f8dbf5d84abf072e2b2.exe, c9701863c3174a552ab6ff2ec367111a8d8853b57e5b093429d1c0f247e20d05.exe, 1979b3e9366928d0774a41e8bd5e7610a0302cdf62e9a533d2ff6c5ff7c346e9.exe, dbfd6c69423e517932f611242d5c6a287d7dd8512e947283eded1b0e0223e461.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "7df44db488eeb747b7875331dfc29481aaf77789fe909f8dbf5d84abf072e2b2"
      hash2 = "c9701863c3174a552ab6ff2ec367111a8d8853b57e5b093429d1c0f247e20d05"
      hash3 = "1979b3e9366928d0774a41e8bd5e7610a0302cdf62e9a533d2ff6c5ff7c346e9"
      hash4 = "dbfd6c69423e517932f611242d5c6a287d7dd8512e947283eded1b0e0223e461"
   strings:
      $s1 = "_set_app_type" fullword ascii /* Goodware String - occured 3 times */
      $s2 = "_set_new_mode" fullword ascii /* Goodware String - occured 3 times */
      $s3 = "_get_initial_narrow_environment" fullword ascii /* Goodware String - occured 3 times */
      $s4 = "_seh_filter_exe" fullword ascii /* Goodware String - occured 3 times */
      $s5 = "_register_thread_local_exe_atexit_callback" fullword ascii /* Goodware String - occured 5 times */
   condition:
      ( uint16(0) == 0x5a4d and filesize < 7000KB and ( all of them )
      ) or ( all of them )
}

rule _49dc64191a08c389e43a7b765975fe2119b0b5228172fbf5e76d5cabd9afc80e_c8009295795a41ddf450d7e6fd947d17f0a344aedb28cb1f1d00d5b28d_43 {
   meta:
      description = "samples - from files 49dc64191a08c389e43a7b765975fe2119b0b5228172fbf5e76d5cabd9afc80e.exe, c8009295795a41ddf450d7e6fd947d17f0a344aedb28cb1f1d00d5b28d225acd.exe, 4f30db298f99fc45d153f6568529228c98e1ad173249c1f76424977bd0b373c2.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "49dc64191a08c389e43a7b765975fe2119b0b5228172fbf5e76d5cabd9afc80e"
      hash2 = "c8009295795a41ddf450d7e6fd947d17f0a344aedb28cb1f1d00d5b28d225acd"
      hash3 = "4f30db298f99fc45d153f6568529228c98e1ad173249c1f76424977bd0b373c2"
   strings:
      $s1 = "=UUUUw" fullword ascii /* Goodware String - occured 1 times */
      $s2 = "ATUWVSHcY" fullword ascii
      $s3 = "S$9S(~" fullword ascii
      $s4 = "C$9C(~" fullword ascii
      $s5 = " [^_]A\\A]A^" fullword ascii
   condition:
      ( uint16(0) == 0x5a4d and filesize < 2000KB and ( all of them )
      ) or ( all of them )
}

rule _521d404952876e51d0cf3a4d0d69e30566406a3a129343d5e53d5d7274f4d3dc_17e36536f236d0effd2850906ccd9972beb6f73a994fe8c1bb03c2a850_44 {
   meta:
      description = "samples - from files 521d404952876e51d0cf3a4d0d69e30566406a3a129343d5e53d5d7274f4d3dc.exe, 17e36536f236d0effd2850906ccd9972beb6f73a994fe8c1bb03c2a850f453bb.exe, 0843b763880a4e1b559d29140afff5cd867bcada20eda6db2524d4e5045af114.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "521d404952876e51d0cf3a4d0d69e30566406a3a129343d5e53d5d7274f4d3dc"
      hash2 = "17e36536f236d0effd2850906ccd9972beb6f73a994fe8c1bb03c2a850f453bb"
      hash3 = "0843b763880a4e1b559d29140afff5cd867bcada20eda6db2524d4e5045af114"
   strings:
      $s1 = "$$method0x600002a-1" fullword ascii /* Goodware String - occured 1 times */
      $s2 = "$$method0x6000039-1" fullword ascii
      $s3 = "$$method0x6000020-1" fullword ascii /* Goodware String - occured 1 times */
      $s4 = "$$method0x6000007-1" fullword ascii
      $s5 = "$$method0x6000020-2" fullword ascii
      $s6 = "$$method0x600002a-2" fullword ascii
      $s7 = "$$method0x600005f-1" fullword ascii
      $s8 = "$$method0x600027b-1" fullword ascii /* Goodware String - occured 4 times */
      $s9 = "{11111-22222-10009-11112}" fullword wide
      $s10 = "{11111-22222-20001-00001}" fullword wide
      $s11 = "{11111-22222-20001-00002}" fullword wide
      $s12 = "{11111-22222-30001-00001}" fullword wide
      $s13 = "{11111-22222-30001-00002}" fullword wide
   condition:
      ( uint16(0) == 0x5a4d and filesize < 14000KB and ( 8 of them )
      ) or ( all of them )
}

rule _2f502689b799fd964bced77e57edf4206809bb11da16cf4f7895df1df54cdc97_1314eb993b4effdda7e10527b7fd8996f94c7c5cf817f23ce340647728_45 {
   meta:
      description = "samples - from files 2f502689b799fd964bced77e57edf4206809bb11da16cf4f7895df1df54cdc97.exe, 1314eb993b4effdda7e10527b7fd8996f94c7c5cf817f23ce340647728f0e57a.exe, 71af9ae73d69eff082dd445af8d96351cd106afd0ca27824d35a8a667f7ef38b.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "2f502689b799fd964bced77e57edf4206809bb11da16cf4f7895df1df54cdc97"
      hash2 = "1314eb993b4effdda7e10527b7fd8996f94c7c5cf817f23ce340647728f0e57a"
      hash3 = "71af9ae73d69eff082dd445af8d96351cd106afd0ca27824d35a8a667f7ef38b"
   strings:
      $s1 = "QQSVj8j@" fullword ascii
      $s2 = "5:5B5_5o5{5" fullword ascii /* Goodware String - occured 2 times */
      $s3 = "M,j\"^QRRRRR" fullword ascii
      $s4 = "^PQQQQQ" fullword ascii
      $s5 = "M$j\"^QRRRRR" fullword ascii
      $s6 = "A<lt'<tt" fullword ascii
      $s7 = "j\"[VWWWW" fullword ascii
      $s8 = "tb9^4~]" fullword ascii
      $s9 = "Vj0XPW" fullword ascii
      $s10 = "<ItC<Lt3<Tt#<h" fullword ascii
      $s11 = "E ^PQQQQ" fullword ascii
      $s12 = "2,2024282<2@2H2`2p2t2" fullword ascii /* Goodware String - occured 5 times */
   condition:
      ( uint16(0) == 0x5a4d and filesize < 15000KB and ( 8 of them )
      ) or ( all of them )
}

rule _408c4cb78449baf846592637c9a8f03f47c3df6786acdce6e9ad0ef0db370068_d61022cef95af3e20bb237b2690c817d948c3ea99a5f11153eca3bcfff_46 {
   meta:
      description = "samples - from files 408c4cb78449baf846592637c9a8f03f47c3df6786acdce6e9ad0ef0db370068.exe, d61022cef95af3e20bb237b2690c817d948c3ea99a5f11153eca3bcfff034eb0.exe, 1ef225d55b567e06ca8c6197aa237b76504a1a270a512b80b50280154af98146.exe, ea520d8e6ca1d44593f26ceea349d55709ebd61565f67368947d38e484f5846f.exe, df9d5a6d4edf1baf28fe59cc742cb980dfba7613a17b50c5a75f3fdd756bbc54.exe, 3b03a24bfde864b0d8b17213f7f2deb6d7e3f5f74b34d3b601cbadd961b904fc.exe, cc38fb3ee3227606258b1b9ccba885393d6ed4a54a51aefef30a669cdc171e80.exe, 749911c61e23b64b45f28d453a8b70275f824092d8dab39ccc1e93464d26b450.exe, 6475637fff05177a05bf6e84301c09492f21766ea3ba0068f3f70c4d0d886a9e.exe, 2a5dac302572ede5da5d53df170d5882937027b58290b6ea60e24478453276c9.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "408c4cb78449baf846592637c9a8f03f47c3df6786acdce6e9ad0ef0db370068"
      hash2 = "d61022cef95af3e20bb237b2690c817d948c3ea99a5f11153eca3bcfff034eb0"
      hash3 = "1ef225d55b567e06ca8c6197aa237b76504a1a270a512b80b50280154af98146"
      hash4 = "ea520d8e6ca1d44593f26ceea349d55709ebd61565f67368947d38e484f5846f"
      hash5 = "df9d5a6d4edf1baf28fe59cc742cb980dfba7613a17b50c5a75f3fdd756bbc54"
      hash6 = "3b03a24bfde864b0d8b17213f7f2deb6d7e3f5f74b34d3b601cbadd961b904fc"
      hash7 = "cc38fb3ee3227606258b1b9ccba885393d6ed4a54a51aefef30a669cdc171e80"
      hash8 = "749911c61e23b64b45f28d453a8b70275f824092d8dab39ccc1e93464d26b450"
      hash9 = "6475637fff05177a05bf6e84301c09492f21766ea3ba0068f3f70c4d0d886a9e"
      hash10 = "2a5dac302572ede5da5d53df170d5882937027b58290b6ea60e24478453276c9"
   strings:
      $s1 = "WHKEYBOARDLL" fullword ascii
      $s2 = "GetCPUName" fullword ascii
      $s3 = "LowLevelKeyboardProc" fullword ascii
      $s4 = "SetHook" fullword ascii /* Goodware String - occured 6 times */
      $s5 = "Keylogger" fullword ascii /* Goodware String - occured 7 times */
      $s6 = "PrevActiveWindowTitle" fullword ascii
      $s7 = "vkCode" fullword ascii /* Goodware String - occured 1 times */
      $s8 = "_hookID" fullword ascii
      $s9 = "HookCallback" fullword ascii
   condition:
      ( uint16(0) == 0x5a4d and filesize < 600KB and ( all of them )
      ) or ( all of them )
}

rule _7388c664fecd46ba3176b1e55a873b5aff6d0713144ee3431f2269af4bb1868e_36e6a3dd4bfc86c4e707f43cd9515707442d6c424b7661cb41766cfdca_47 {
   meta:
      description = "samples - from files 7388c664fecd46ba3176b1e55a873b5aff6d0713144ee3431f2269af4bb1868e.exe, 36e6a3dd4bfc86c4e707f43cd9515707442d6c424b7661cb41766cfdca322522.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "7388c664fecd46ba3176b1e55a873b5aff6d0713144ee3431f2269af4bb1868e"
      hash2 = "36e6a3dd4bfc86c4e707f43cd9515707442d6c424b7661cb41766cfdca322522"
   strings:
      $s1 = "/s /t 0" fullword wide
      $s2 = "/r /t 0" fullword wide
      $s3 = "shutdown" fullword wide /* Goodware String - occured 93 times */
      $s4 = "lpvParam" fullword ascii
      $s5 = "uAction" fullword ascii
      $s6 = "<>8__1" fullword ascii
      $s7 = "uParam" fullword ascii
   condition:
      ( uint16(0) == 0x5a4d and filesize < 10000KB and ( all of them )
      ) or ( all of them )
}

rule _408c4cb78449baf846592637c9a8f03f47c3df6786acdce6e9ad0ef0db370068_d61022cef95af3e20bb237b2690c817d948c3ea99a5f11153eca3bcfff_48 {
   meta:
      description = "samples - from files 408c4cb78449baf846592637c9a8f03f47c3df6786acdce6e9ad0ef0db370068.exe, d61022cef95af3e20bb237b2690c817d948c3ea99a5f11153eca3bcfff034eb0.exe, 36e6a3dd4bfc86c4e707f43cd9515707442d6c424b7661cb41766cfdca322522.exe, 1ef225d55b567e06ca8c6197aa237b76504a1a270a512b80b50280154af98146.exe, ea520d8e6ca1d44593f26ceea349d55709ebd61565f67368947d38e484f5846f.exe, df9d5a6d4edf1baf28fe59cc742cb980dfba7613a17b50c5a75f3fdd756bbc54.exe, 3b03a24bfde864b0d8b17213f7f2deb6d7e3f5f74b34d3b601cbadd961b904fc.exe, cc38fb3ee3227606258b1b9ccba885393d6ed4a54a51aefef30a669cdc171e80.exe, 749911c61e23b64b45f28d453a8b70275f824092d8dab39ccc1e93464d26b450.exe, 6475637fff05177a05bf6e84301c09492f21766ea3ba0068f3f70c4d0d886a9e.exe, 2a5dac302572ede5da5d53df170d5882937027b58290b6ea60e24478453276c9.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "408c4cb78449baf846592637c9a8f03f47c3df6786acdce6e9ad0ef0db370068"
      hash2 = "d61022cef95af3e20bb237b2690c817d948c3ea99a5f11153eca3bcfff034eb0"
      hash3 = "36e6a3dd4bfc86c4e707f43cd9515707442d6c424b7661cb41766cfdca322522"
      hash4 = "1ef225d55b567e06ca8c6197aa237b76504a1a270a512b80b50280154af98146"
      hash5 = "ea520d8e6ca1d44593f26ceea349d55709ebd61565f67368947d38e484f5846f"
      hash6 = "df9d5a6d4edf1baf28fe59cc742cb980dfba7613a17b50c5a75f3fdd756bbc54"
      hash7 = "3b03a24bfde864b0d8b17213f7f2deb6d7e3f5f74b34d3b601cbadd961b904fc"
      hash8 = "cc38fb3ee3227606258b1b9ccba885393d6ed4a54a51aefef30a669cdc171e80"
      hash9 = "749911c61e23b64b45f28d453a8b70275f824092d8dab39ccc1e93464d26b450"
      hash10 = "6475637fff05177a05bf6e84301c09492f21766ea3ba0068f3f70c4d0d886a9e"
      hash11 = "2a5dac302572ede5da5d53df170d5882937027b58290b6ea60e24478453276c9"
   strings:
      $s1 = "Select * From Win32_ComputerSystem" fullword wide
      $s2 = "idHook" fullword ascii /* Goodware String - occured 3 times */
      $s3 = "wScanCode" fullword ascii /* Goodware String - occured 3 times */
      $s4 = "pwszBuff" fullword ascii /* Goodware String - occured 3 times */
      $s5 = "wVirtKey" fullword ascii /* Goodware String - occured 3 times */
      $s6 = "cchBuff" fullword ascii /* Goodware String - occured 3 times */
      $s7 = "lpKeyState" fullword ascii /* Goodware String - occured 5 times */
   condition:
      ( uint16(0) == 0x5a4d and filesize < 10000KB and ( all of them )
      ) or ( all of them )
}

rule _8ed24ddbcd88141fb1934ea20761b97d7cbdcb4e5042f6e1d893ed817a5b4a89_283ece83572923032a368088751b611aee0d866be61d048935d9b5ca3d_49 {
   meta:
      description = "samples - from files 8ed24ddbcd88141fb1934ea20761b97d7cbdcb4e5042f6e1d893ed817a5b4a89.exe, 283ece83572923032a368088751b611aee0d866be61d048935d9b5ca3d344a70.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "8ed24ddbcd88141fb1934ea20761b97d7cbdcb4e5042f6e1d893ed817a5b4a89"
      hash2 = "283ece83572923032a368088751b611aee0d866be61d048935d9b5ca3d344a70"
   strings:
      $s1 = "sJfw>7G9@>" fullword ascii
      $s2 = "2Uiwp\"9" fullword ascii
      $s3 = "!D]#t^;Gc" fullword ascii
      $s4 = "}9]Jn+LhyK" fullword ascii
      $s5 = "0M2~@p" fullword ascii
      $s6 = "!3mmXs" fullword ascii
      $s7 = "+A*Z<Z" fullword ascii
      $s8 = "t0;?ZlP*m" fullword ascii
      $s9 = "s6!TYK" fullword ascii
      $s10 = "-LTY/:]" fullword ascii
      $s11 = "/`P*d#" fullword ascii
      $s12 = "%IW;\"!*" fullword ascii
   condition:
      ( uint16(0) == 0x5a4d and filesize < 11000KB and ( 8 of them )
      ) or ( all of them )
}

rule _ea520d8e6ca1d44593f26ceea349d55709ebd61565f67368947d38e484f5846f_50ce164844684892d697f16bc194d82841e4c1b951609d12bc26cab8b0_50 {
   meta:
      description = "samples - from files ea520d8e6ca1d44593f26ceea349d55709ebd61565f67368947d38e484f5846f.exe, 50ce164844684892d697f16bc194d82841e4c1b951609d12bc26cab8b028192e.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "ea520d8e6ca1d44593f26ceea349d55709ebd61565f67368947d38e484f5846f"
      hash2 = "50ce164844684892d697f16bc194d82841e4c1b951609d12bc26cab8b028192e"
   strings:
      $s1 = "Pastebin" fullword ascii
      $s2 = "Client.Handle_Packet" fullword ascii
      $s3 = "Sha256" fullword ascii /* Goodware String - occured 11 times */
      $s4 = "DetectSandboxie" fullword ascii
      $s5 = "InstallFile" fullword ascii
      $s6 = "DetectManufacturer" fullword ascii
      $s7 = "DetectDebugger" fullword ascii
      $s8 = "IsSmallDisk" fullword ascii
      $s9 = "isDebuggerPresent" fullword ascii /* Goodware String - occured 2 times */
      $s10 = "<>o__2" fullword ascii
   condition:
      ( uint16(0) == 0x5a4d and filesize < 500KB and ( all of them )
      ) or ( all of them )
}

rule _ea520d8e6ca1d44593f26ceea349d55709ebd61565f67368947d38e484f5846f_50ce164844684892d697f16bc194d82841e4c1b951609d12bc26cab8b0_51 {
   meta:
      description = "samples - from files ea520d8e6ca1d44593f26ceea349d55709ebd61565f67368947d38e484f5846f.exe, 50ce164844684892d697f16bc194d82841e4c1b951609d12bc26cab8b028192e.exe, 07d35c2c242d2c2a7bbf3d70315f7679c90b3f5a32b2ff542fdfca8a0b9cb4c8.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "ea520d8e6ca1d44593f26ceea349d55709ebd61565f67368947d38e484f5846f"
      hash2 = "50ce164844684892d697f16bc194d82841e4c1b951609d12bc26cab8b028192e"
      hash3 = "07d35c2c242d2c2a7bbf3d70315f7679c90b3f5a32b2ff542fdfca8a0b9cb4c8"
   strings:
      $s1 = "Select * from Win32_ComputerSystem" fullword wide
      $s2 = "vmware" fullword wide
      $s3 = "Pastebin" fullword wide
      $s4 = "microsoft corporation" fullword wide
      $s5 = "\\nuR\\noisreVtnerruC\\swodniW\\tfosorciM\\erawtfoS" fullword wide
      $s6 = "VirtualBox" fullword wide /* Goodware String - occured 5 times */
      $s7 = "SbieDll.dll" fullword wide /* Goodware String - occured 2 times */
      $s8 = "VIRTUAL" fullword wide /* Goodware String - occured 4 times */
   condition:
      ( uint16(0) == 0x5a4d and filesize < 500KB and ( all of them )
      ) or ( all of them )
}

rule _8ed24ddbcd88141fb1934ea20761b97d7cbdcb4e5042f6e1d893ed817a5b4a89_36e6a3dd4bfc86c4e707f43cd9515707442d6c424b7661cb41766cfdca_52 {
   meta:
      description = "samples - from files 8ed24ddbcd88141fb1934ea20761b97d7cbdcb4e5042f6e1d893ed817a5b4a89.exe, 36e6a3dd4bfc86c4e707f43cd9515707442d6c424b7661cb41766cfdca322522.exe, c3c657fa980e2ddcd6fc94d3464fea9816a4d5803c6ec80dee6a8b11fed28d36.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "8ed24ddbcd88141fb1934ea20761b97d7cbdcb4e5042f6e1d893ed817a5b4a89"
      hash2 = "36e6a3dd4bfc86c4e707f43cd9515707442d6c424b7661cb41766cfdca322522"
      hash3 = "c3c657fa980e2ddcd6fc94d3464fea9816a4d5803c6ec80dee6a8b11fed28d36"
   strings:
      $s1 = "waiting" fullword ascii /* Goodware String - occured 34 times */
      $s2 = "ProbablyPrime" fullword ascii
      $s3 = "BitLen" fullword ascii /* Goodware String - occured 1 times */
      $s4 = "AndNot" fullword ascii /* Goodware String - occured 4 times */
      $s5 = "ScalarMult" fullword ascii
   condition:
      ( uint16(0) == 0x5a4d and filesize < 21000KB and ( all of them )
      ) or ( all of them )
}

rule _8ed24ddbcd88141fb1934ea20761b97d7cbdcb4e5042f6e1d893ed817a5b4a89_c3c657fa980e2ddcd6fc94d3464fea9816a4d5803c6ec80dee6a8b11fe_53 {
   meta:
      description = "samples - from files 8ed24ddbcd88141fb1934ea20761b97d7cbdcb4e5042f6e1d893ed817a5b4a89.exe, c3c657fa980e2ddcd6fc94d3464fea9816a4d5803c6ec80dee6a8b11fed28d36.exe, 56e1d092c07322d9dad7d85d773953573cc3294b9e428b3bbbaf935ca4d2f7e7.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "8ed24ddbcd88141fb1934ea20761b97d7cbdcb4e5042f6e1d893ed817a5b4a89"
      hash2 = "c3c657fa980e2ddcd6fc94d3464fea9816a4d5803c6ec80dee6a8b11fed28d36"
      hash3 = "56e1d092c07322d9dad7d85d773953573cc3294b9e428b3bbbaf935ca4d2f7e7"
   strings:
      $s1 = "L|]C5;" fullword ascii
      $s2 = "8>G#g$" fullword ascii
      $s3 = "_R?Z}5" fullword ascii
      $s4 = "wqBv/?" fullword ascii
      $s5 = "7Cxl2i5n" fullword ascii
      $s6 = "?/\"=~Fr" fullword ascii
   condition:
      ( uint16(0) == 0x5a4d and filesize < 22000KB and ( all of them )
      ) or ( all of them )
}

rule _d7db753381fdd9779be8db851e3f7a015a6f584ae4a15b546f6bac80ccfe01d7_8bb7ce7b157a6282e22cbdb19616fff926cd387427f69b276dfe30a58c_54 {
   meta:
      description = "samples - from files d7db753381fdd9779be8db851e3f7a015a6f584ae4a15b546f6bac80ccfe01d7.exe, 8bb7ce7b157a6282e22cbdb19616fff926cd387427f69b276dfe30a58c4ee874.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "d7db753381fdd9779be8db851e3f7a015a6f584ae4a15b546f6bac80ccfe01d7"
      hash2 = "8bb7ce7b157a6282e22cbdb19616fff926cd387427f69b276dfe30a58c4ee874"
   strings:
      $s1 = "CompanyNames" fullword wide
      $s2 = "ProductVercion" fullword wide
      $s3 = "LegalCopyrights" fullword wide
      $s4 = "Cokasacol hujihelar" fullword wide
      $s5 = "YYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYY" ascii /* Goodware String - occured 2 times */
      $s6 = "040501E2" wide
      $s7 = "FileVersions" fullword wide /* Goodware String - occured 5 times */
      $s8 = "UDaha kahafaxe xojipubax niju pahoboh pofegoj canenidabe pobaxamesiw juwaku favuratexuBJetabejijoxixu cusatofetoca pudabuvu xaso" wide
   condition:
      ( uint16(0) == 0x5a4d and filesize < 8000KB and ( all of them )
      ) or ( all of them )
}

rule _50ce164844684892d697f16bc194d82841e4c1b951609d12bc26cab8b028192e_07d35c2c242d2c2a7bbf3d70315f7679c90b3f5a32b2ff542fdfca8a0b_55 {
   meta:
      description = "samples - from files 50ce164844684892d697f16bc194d82841e4c1b951609d12bc26cab8b028192e.exe, 07d35c2c242d2c2a7bbf3d70315f7679c90b3f5a32b2ff542fdfca8a0b9cb4c8.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "50ce164844684892d697f16bc194d82841e4c1b951609d12bc26cab8b028192e"
      hash2 = "07d35c2c242d2c2a7bbf3d70315f7679c90b3f5a32b2ff542fdfca8a0b9cb4c8"
   strings:
      $s1 = "Stub.exe" fullword wide
      $s2 = "    <asmv3:windowsSettings xmlns=\"http://schemas.microsoft.com/SMI/2005/WindowsSettings\">" fullword ascii
      $s3 = "AsyncClient" fullword ascii
      $s4 = "  <asmv3:application  xmlns:asmv3=\"urn:schemas-microsoft-com:asm.v3\" >" fullword ascii
      $s5 = "  </asmv3:application>" fullword ascii
   condition:
      ( uint16(0) == 0x5a4d and filesize < 100KB and ( all of them )
      ) or ( all of them )
}

rule _49dc64191a08c389e43a7b765975fe2119b0b5228172fbf5e76d5cabd9afc80e_283ece83572923032a368088751b611aee0d866be61d048935d9b5ca3d_56 {
   meta:
      description = "samples - from files 49dc64191a08c389e43a7b765975fe2119b0b5228172fbf5e76d5cabd9afc80e.exe, 283ece83572923032a368088751b611aee0d866be61d048935d9b5ca3d344a70.exe, 4f30db298f99fc45d153f6568529228c98e1ad173249c1f76424977bd0b373c2.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "49dc64191a08c389e43a7b765975fe2119b0b5228172fbf5e76d5cabd9afc80e"
      hash2 = "283ece83572923032a368088751b611aee0d866be61d048935d9b5ca3d344a70"
      hash3 = "4f30db298f99fc45d153f6568529228c98e1ad173249c1f76424977bd0b373c2"
   strings:
      $s1 = "        <requestedExecutionLevel level=\"asInvoker\"/>" fullword ascii
      $s2 = "      <!--The ID below indicates application support for Windows 8.1 -->" fullword ascii
      $s3 = "      <!--The ID below indicates application support for Windows 7 -->" fullword ascii
      $s4 = "      <!--The ID below indicates application support for Windows 8 -->" fullword ascii
      $s5 = "      <!--The ID below indicates application support for Windows Vista -->" fullword ascii
      $s6 = "      <!--The ID below indicates application support for Windows 10 -->" fullword ascii
      $s7 = "      <supportedOS Id=\"{1f676c76-80e1-4239-95bb-83d0f6d0da78}\"/> " fullword ascii
      $s8 = "      <supportedOS Id=\"{8e0f7a12-bfb3-4fe8-b9a5-48fd50a15a9a}\"/> " fullword ascii
   condition:
      ( uint16(0) == 0x5a4d and filesize < 9000KB and ( all of them )
      ) or ( all of them )
}

rule _2449fe334bbf8f09ff80422578a6c6961d20a0a456b214f6490c5ed1ae859c9e_2f502689b799fd964bced77e57edf4206809bb11da16cf4f7895df1df5_57 {
   meta:
      description = "samples - from files 2449fe334bbf8f09ff80422578a6c6961d20a0a456b214f6490c5ed1ae859c9e.exe, 2f502689b799fd964bced77e57edf4206809bb11da16cf4f7895df1df54cdc97.exe, 1314eb993b4effdda7e10527b7fd8996f94c7c5cf817f23ce340647728f0e57a.exe, 71af9ae73d69eff082dd445af8d96351cd106afd0ca27824d35a8a667f7ef38b.exe, b3fe1e7404ddef2f09b8f51c5c2010e799ebf69f647e7e519a4305dc2b3a5695.exe, 3f0dea5783c2deb7a9686accab4b1e17953f4babefbcc2668428a9fc00a1c4ea.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "2449fe334bbf8f09ff80422578a6c6961d20a0a456b214f6490c5ed1ae859c9e"
      hash2 = "2f502689b799fd964bced77e57edf4206809bb11da16cf4f7895df1df54cdc97"
      hash3 = "1314eb993b4effdda7e10527b7fd8996f94c7c5cf817f23ce340647728f0e57a"
      hash4 = "71af9ae73d69eff082dd445af8d96351cd106afd0ca27824d35a8a667f7ef38b"
      hash5 = "b3fe1e7404ddef2f09b8f51c5c2010e799ebf69f647e7e519a4305dc2b3a5695"
      hash6 = "3f0dea5783c2deb7a9686accab4b1e17953f4babefbcc2668428a9fc00a1c4ea"
   strings:
      $s1 = "operator<=>" fullword ascii
      $s2 = "operator co_await" fullword ascii
      $s3 = "__swift_3" fullword ascii
      $s4 = "__swift_1" fullword ascii
      $s5 = "__swift_2" fullword ascii
      $s6 = "api-ms-" fullword wide
   condition:
      ( uint16(0) == 0x5a4d and filesize < 16000KB and ( all of them )
      ) or ( all of them )
}

rule _24354c0c950c77d5ee246d90fffc025f457fba62ebc384c0810d1b0129b67eec_ef50f2acca59baa3c2565a2241fd895d535b10586beb65bd72f9e0bea6_58 {
   meta:
      description = "samples - from files 24354c0c950c77d5ee246d90fffc025f457fba62ebc384c0810d1b0129b67eec.exe, ef50f2acca59baa3c2565a2241fd895d535b10586beb65bd72f9e0bea6462649.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "24354c0c950c77d5ee246d90fffc025f457fba62ebc384c0810d1b0129b67eec"
      hash2 = "ef50f2acca59baa3c2565a2241fd895d535b10586beb65bd72f9e0bea6462649"
   strings:
      $s1 = "  <description></description>" fullword ascii
      $s2 = "    processorArchitecture=\"X86\"" fullword ascii
      $s3 = "        processorArchitecture=\"X86\"" fullword ascii
      $s4 = "    name=\"CompanyName.ProductName.YourApp\"" fullword ascii
      $s5 = "  <assemblyIdentity" fullword ascii
   condition:
      ( uint16(0) == 0x5a4d and filesize < 300KB and ( all of them )
      ) or ( all of them )
}

rule _3b03a24bfde864b0d8b17213f7f2deb6d7e3f5f74b34d3b601cbadd961b904fc_6475637fff05177a05bf6e84301c09492f21766ea3ba0068f3f70c4d0d_59 {
   meta:
      description = "samples - from files 3b03a24bfde864b0d8b17213f7f2deb6d7e3f5f74b34d3b601cbadd961b904fc.exe, 6475637fff05177a05bf6e84301c09492f21766ea3ba0068f3f70c4d0d886a9e.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "3b03a24bfde864b0d8b17213f7f2deb6d7e3f5f74b34d3b601cbadd961b904fc"
      hash2 = "6475637fff05177a05bf6e84301c09492f21766ea3ba0068f3f70c4d0d886a9e"
   strings:
      $s1 = "GPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDING" fullword ascii
      $s2 = "GlassWire" fullword wide
      $s3 = "GlassWire Setup" fullword wide
      $s4 = "(c) 2024 GlassWire" fullword wide
      $s5 = "PPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDIN" ascii /* Goodware String - occured 2 times */
      $s6 = "3.3.678.0" fullword wide
   condition:
      ( uint16(0) == 0x5a4d and filesize < 600KB and ( all of them )
      ) or ( all of them )
}

rule _408c4cb78449baf846592637c9a8f03f47c3df6786acdce6e9ad0ef0db370068_d61022cef95af3e20bb237b2690c817d948c3ea99a5f11153eca3bcfff_60 {
   meta:
      description = "samples - from files 408c4cb78449baf846592637c9a8f03f47c3df6786acdce6e9ad0ef0db370068.exe, d61022cef95af3e20bb237b2690c817d948c3ea99a5f11153eca3bcfff034eb0.exe, 36e6a3dd4bfc86c4e707f43cd9515707442d6c424b7661cb41766cfdca322522.exe, 1ef225d55b567e06ca8c6197aa237b76504a1a270a512b80b50280154af98146.exe, 4a33dd36f9cd9bdf25e3d0207a3c8ad7c04f61178ef0fe62e5c054c1f311e9a9.exe, df9d5a6d4edf1baf28fe59cc742cb980dfba7613a17b50c5a75f3fdd756bbc54.exe, 3b03a24bfde864b0d8b17213f7f2deb6d7e3f5f74b34d3b601cbadd961b904fc.exe, cc38fb3ee3227606258b1b9ccba885393d6ed4a54a51aefef30a669cdc171e80.exe, 749911c61e23b64b45f28d453a8b70275f824092d8dab39ccc1e93464d26b450.exe, 50ce164844684892d697f16bc194d82841e4c1b951609d12bc26cab8b028192e.exe, 07d35c2c242d2c2a7bbf3d70315f7679c90b3f5a32b2ff542fdfca8a0b9cb4c8.exe, 6475637fff05177a05bf6e84301c09492f21766ea3ba0068f3f70c4d0d886a9e.exe, 7ce2d225442252064d744be1c38e9c1572dd355bbbaf7fa411ce79e41288dfca.exe, a8fcd268b48c903e21500439d6754500d59d12d7d5d4e2c7ea737661fa8fe230.exe, 2a5dac302572ede5da5d53df170d5882937027b58290b6ea60e24478453276c9.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "408c4cb78449baf846592637c9a8f03f47c3df6786acdce6e9ad0ef0db370068"
      hash2 = "d61022cef95af3e20bb237b2690c817d948c3ea99a5f11153eca3bcfff034eb0"
      hash3 = "36e6a3dd4bfc86c4e707f43cd9515707442d6c424b7661cb41766cfdca322522"
      hash4 = "1ef225d55b567e06ca8c6197aa237b76504a1a270a512b80b50280154af98146"
      hash5 = "4a33dd36f9cd9bdf25e3d0207a3c8ad7c04f61178ef0fe62e5c054c1f311e9a9"
      hash6 = "df9d5a6d4edf1baf28fe59cc742cb980dfba7613a17b50c5a75f3fdd756bbc54"
      hash7 = "3b03a24bfde864b0d8b17213f7f2deb6d7e3f5f74b34d3b601cbadd961b904fc"
      hash8 = "cc38fb3ee3227606258b1b9ccba885393d6ed4a54a51aefef30a669cdc171e80"
      hash9 = "749911c61e23b64b45f28d453a8b70275f824092d8dab39ccc1e93464d26b450"
      hash10 = "50ce164844684892d697f16bc194d82841e4c1b951609d12bc26cab8b028192e"
      hash11 = "07d35c2c242d2c2a7bbf3d70315f7679c90b3f5a32b2ff542fdfca8a0b9cb4c8"
      hash12 = "6475637fff05177a05bf6e84301c09492f21766ea3ba0068f3f70c4d0d886a9e"
      hash13 = "7ce2d225442252064d744be1c38e9c1572dd355bbbaf7fa411ce79e41288dfca"
      hash14 = "a8fcd268b48c903e21500439d6754500d59d12d7d5d4e2c7ea737661fa8fe230"
      hash15 = "2a5dac302572ede5da5d53df170d5882937027b58290b6ea60e24478453276c9"
   strings:
      $s1 = "      <!-- Windows 10 -->" fullword ascii
      $s2 = "      <!-- Windows 8.1 -->" fullword ascii
      $s3 = "      <!-- Windows Vista -->" fullword ascii
      $s4 = "      <!-- Windows 7 -->" fullword ascii
      $s5 = "      <!-- Windows 8 -->" fullword ascii
   condition:
      ( uint16(0) == 0x5a4d and filesize < 10000KB and ( all of them )
      ) or ( all of them )
}

rule _14f21a1b7991bae07182b22c03f633e54e39a581e4898cb95eb5853e4359c819_a9b37a8c3a1a2476a2e44d0dcba2b117bd300983b337af45de92d31881_61 {
   meta:
      description = "samples - from files 14f21a1b7991bae07182b22c03f633e54e39a581e4898cb95eb5853e4359c819.exe, a9b37a8c3a1a2476a2e44d0dcba2b117bd300983b337af45de92d31881170962.exe, 56e1d092c07322d9dad7d85d773953573cc3294b9e428b3bbbaf935ca4d2f7e7.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-08-04"
      hash1 = "14f21a1b7991bae07182b22c03f633e54e39a581e4898cb95eb5853e4359c819"
      hash2 = "a9b37a8c3a1a2476a2e44d0dcba2b117bd300983b337af45de92d31881170962"
      hash3 = "56e1d092c07322d9dad7d85d773953573cc3294b9e428b3bbbaf935ca4d2f7e7"
   strings:
      $s1 = "tTIcB<L" fullword ascii
      $s2 = "tSIcK<L" fullword ascii
      $s3 = "tKIcA<L" fullword ascii
      $s4 = "tNHcA<H" fullword ascii
      $s5 = "tCHcA<H" fullword ascii
   condition:
      ( uint16(0) == 0x5a4d and filesize < 22000KB and ( all of them )
      ) or ( all of them )
}

