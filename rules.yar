/*
   YARA Rule Set
   Author: Grim
   Date: 2024-06-29
   Identifier: samples
   Reference: @grimbinary
*/

/* Rule Set ----------------------------------------------------------------- */

rule sig_249009648a4e88d2cd0fb5e595c911e5dca3ec1d70252981554ab0331800cb92 {
   meta:
      description = "samples - file 249009648a4e88d2cd0fb5e595c911e5dca3ec1d70252981554ab0331800cb92.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "249009648a4e88d2cd0fb5e595c911e5dca3ec1d70252981554ab0331800cb92"
   strings:
      $s1 = "q78NeqovUNINw8DJ6kB.Sn2GWloHkdpWe47xD5o+xrGk4RoAwH9p6Kt234J+qhyBYro3LOcY1qebmPt`1[[System.Object, mscorlib, Version=4.0.0.0, Cul" ascii
      $s2 = "q78NeqovUNINw8DJ6kB.Sn2GWloHkdpWe47xD5o+xrGk4RoAwH9p6Kt234J+qhyBYro3LOcY1qebmPt`1[[System.Object, mscorlib, Version=4.0.0.0, Cul" ascii
      $s3 = "MnhkWE5xMc" fullword ascii /* base64 encoded string '2xdXNq1' */
      $s4 = "LyZpPFxFLi" fullword ascii /* base64 encoded string '/&i<\E.' */
      $s5 = "Q3wjRHpcSF" fullword ascii /* base64 encoded string 'C|#Dz\H' */
      $s6 = "JjhPVyAlYd" fullword ascii /* base64 encoded string '&8OW %a' */
      $s7 = "ture=neutral, PublicKeyToken=b77a5c561934e089]][]" fullword ascii
      $s8 = "r8L4mZKEYe3uQ8Wvq73" fullword ascii
      $s9 = "IWF5Snktc5" fullword ascii /* base64 encoded string '!ayJy-s' */
      $s10 = "Tyo5NyouN7" fullword ascii /* base64 encoded string 'O*97*.7' */
      $s11 = "mb5f3iElamcgBP0C9rH" fullword ascii
      $s12 = "ynGrggudXImO2sMtP2X" fullword ascii
      $s13 = "uN56tk82ZJKFp0ceCrm" fullword ascii
      $s14 = "J5hklg0fTPjxqGgNdwk" fullword ascii
      $s15 = "k12EVIluUeEnki3WBNu" fullword ascii
      $s16 = "bIxv9sFLogxoKhj7D4J" fullword ascii
      $s17 = "fNiwAMQcSjpwuieyESW" fullword ascii
      $s18 = "HDllUetiNIIYsPfELjG" fullword ascii
      $s19 = "EkW6nUlOgMisa5kTbXt" fullword ascii
      $s20 = "d7gs5JRijJrMmhLOgHQ" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 2000KB and
      8 of them
}

rule f9dc41ab7a043cf887b9737060be951dd11571c5774a8b6ca004b503c1995c72 {
   meta:
      description = "samples - file f9dc41ab7a043cf887b9737060be951dd11571c5774a8b6ca004b503c1995c72.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "f9dc41ab7a043cf887b9737060be951dd11571c5774a8b6ca004b503c1995c72"
   strings:
      $s1 = "DN7D24oTIvLvelUFhJ8.Cnh9yaoRbBCwNtcZdmq+zpW820ott9J04VZfkPl+Bxcj9SofNG7H015mapn`1[[System.Object, mscorlib, Version=4.0.0.0, Cul" ascii
      $s2 = "DN7D24oTIvLvelUFhJ8.Cnh9yaoRbBCwNtcZdmq+zpW820ott9J04VZfkPl+Bxcj9SofNG7H015mapn`1[[System.Object, mscorlib, Version=4.0.0.0, Cul" ascii
      $s3 = "fEMhMnFYSZ" fullword ascii /* base64 encoded string '|C!2qXI' */
      $s4 = "fntnPUpKNZ" fullword ascii /* base64 encoded string '~{g=JJ5' */
      $s5 = "ture=neutral, PublicKeyToken=b77a5c561934e089]][]" fullword ascii
      $s6 = "ITQ8aUR2cR" fullword ascii /* base64 encoded string '!4<iDvq' */
      $s7 = "fT9iM1wvXC" fullword ascii /* base64 encoded string '}?b3\/\' */
      $s8 = "NC9UUHUw6" fullword ascii /* base64 encoded string '4/TPu0' */
      $s9 = "nc6usNGgv0NOP0CXIJ5" fullword ascii
      $s10 = "wymMoJbUWNFvSMfwspy" fullword ascii
      $s11 = "khDsPyQ4lJyapySttKV" fullword ascii
      $s12 = "mBufynsQHGet99tbGUL" fullword ascii
      $s13 = "lOgH8G8Tos" fullword ascii
      $s14 = "ircN3i4sRf" fullword ascii
      $s15 = "kNPK30dLlHpLr6aW377" fullword ascii
      $s16 = "qasgq0EyeuyMiAVWumZ" fullword ascii
      $s17 = "jp0cHRvWV3djGo7GmDQ" fullword ascii
      $s18 = "FnA5QWST77DLl5JflSr" fullword ascii
      $s19 = "irCNHLorpNdHWCfufGW" fullword ascii
      $s20 = "JcMKY0T7EYeurHYJg30" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 4000KB and
      8 of them
}

rule sig_00db2c26608e0e750b9262587d68d19dfd37e45b185a22b9438fb309ceb15cd9 {
   meta:
      description = "samples - file 00db2c26608e0e750b9262587d68d19dfd37e45b185a22b9438fb309ceb15cd9.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "00db2c26608e0e750b9262587d68d19dfd37e45b185a22b9438fb309ceb15cd9"
   strings:
      $s1 = "KHvUK7wZZJO5d6fJCpY.IZF2bgwbGpOygERPqp8+q2HmYjwdZVvFsjD964F+bQMVZlwWUTKYuhUDo0V`1[[System.Object, mscorlib, Version=4.0.0.0, Cul" ascii
      $s2 = "KHvUK7wZZJO5d6fJCpY.IZF2bgwbGpOygERPqp8+q2HmYjwdZVvFsjD964F+bQMVZlwWUTKYuhUDo0V`1[[System.Object, mscorlib, Version=4.0.0.0, Cul" ascii
      $s3 = "TCMiM2FCRN" fullword ascii /* base64 encoded string 'L#"3aBD' */
      $s4 = "ture=neutral, PublicKeyToken=b77a5c561934e089]][]" fullword ascii
      $s5 = "eiWvH7l4EfXZJDLLcwV" fullword ascii
      $s6 = ";`> [7{.D" fullword ascii /* hex encoded string '}' */
      $s7 = "asiQBQVIrcfh9RR2g4s" fullword ascii
      $s8 = "dgsMi40WLsR1sKt2gET" fullword ascii
      $s9 = "&8sPYq-I 2H" fullword ascii
      $s10 = "Ut0SU4ibPVEBlookdLl" fullword ascii
      $s11 = "FtPxMwqk2C" fullword ascii
      $s12 = "evNX0SJIOvMiGp0Cueb" fullword ascii
      $s13 = "OTNQig9B8570KspY3A3" fullword ascii
      $s14 = "M3SpYa2YfAdLROiTx0j" fullword ascii
      $s15 = "IrcqaXaaAX" fullword ascii
      $s16 = "HjKLtUlR2jssPYHWYwK" fullword ascii
      $s17 = "DV3ZfqrrAT" fullword ascii
      $s18 = " ViRcij:" fullword ascii
      $s19 = "FTpPtgeG5Bekw9a4ROw" fullword ascii
      $s20 = "wspykF6IWO" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 8000KB and
      8 of them
}

rule fe20286db492e192672c31c79ef6808d9e33601b4fbf4c61ad1aeab5ba3b6b93 {
   meta:
      description = "samples - file fe20286db492e192672c31c79ef6808d9e33601b4fbf4c61ad1aeab5ba3b6b93.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "fe20286db492e192672c31c79ef6808d9e33601b4fbf4c61ad1aeab5ba3b6b93"
   strings:
      $s1 = "Dq1qHHnu9y3wJMsXm1v.wExyiTnsie7UyN8niSs+NBKQisnoZByuVPs7yvZ+MEj3xgnA3AHZgUsQUiK`1[[System.Object, mscorlib, Version=4.0.0.0, Cul" ascii
      $s2 = "Dq1qHHnu9y3wJMsXm1v.wExyiTnsie7UyN8niSs+NBKQisnoZByuVPs7yvZ+MEj3xgnA3AHZgUsQUiK`1[[System.Object, mscorlib, Version=4.0.0.0, Cul" ascii
      $s3 = "KT1hSllseN" fullword ascii /* base64 encoded string ')=aJYlx' */
      $s4 = "cmVsV1NgIL" fullword ascii /* base64 encoded string 'relWS` ' */
      $s5 = "ture=neutral, PublicKeyToken=b77a5c561934e089]][]" fullword ascii
      $s6 = "hFiBOrUnLoGnfh8OOI7" fullword ascii
      $s7 = "Ti5eLl5eau" fullword ascii /* base64 encoded string 'N.^.^^j' */
      $s8 = "GEtTeJk348" fullword ascii
      $s9 = "aDlLEOpbM2" fullword ascii
      $s10 = "FTPMiRihWC" fullword ascii
      $s11 = "SpU7dwdlLTCkWd6V0Vh" fullword ascii
      $s12 = "p0CiVtwcU3" fullword ascii
      $s13 = "zogCQ0JlOG" fullword ascii
      $s14 = "lTo0NVgeTc75kqXMDrA" fullword ascii
      $s15 = "VnQ1fwYNaiMSqUCGeTF" fullword ascii
      $s16 = "zjftpL2vi4" fullword ascii
      $s17 = "sCkVKUXCW69dLlMW3vH" fullword ascii
      $s18 = "TeiFgTN9Np0CQBqsANX" fullword ascii
      $s19 = "IGloGnLBPwdZSMjYckO" fullword ascii
      $s20 = "tWTCGetMFZLLyx5Chgx" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 2000KB and
      8 of them
}

rule sig_2891ed67cda3644765fd94fce012ff41aa4e32fc4c2857e63648803884d76c6f {
   meta:
      description = "samples - file 2891ed67cda3644765fd94fce012ff41aa4e32fc4c2857e63648803884d76c6f.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "2891ed67cda3644765fd94fce012ff41aa4e32fc4c2857e63648803884d76c6f"
   strings:
      $s1 = "enNMw21uCPZX1yXkLOj.mpbnCT1YQfX1qIkT1jO+b4Rxi81TE6eZHrYonB3+aiYMeT1Uws8mwFvHAGS`1[[System.Object, mscorlib, Version=4.0.0.0, Cul" ascii
      $s2 = "enNMw21uCPZX1yXkLOj.mpbnCT1YQfX1qIkT1jO+b4Rxi81TE6eZHrYonB3+aiYMeT1Uws8mwFvHAGS`1[[System.Object, mscorlib, Version=4.0.0.0, Cul" ascii
      $s3 = "Ok1NPEo3OC" fullword ascii /* base64 encoded string ':MM<J78' */
      $s4 = "ture=neutral, PublicKeyToken=b77a5c561934e089]][]" fullword ascii
      $s5 = "fCZ4MUE5Kl" fullword ascii /* base64 encoded string '|&x1A9*' */
      $s6 = "JDN1W0dcNo" fullword ascii /* base64 encoded string '$3u[G\6' */
      $s7 = "HRMkIqQVoySpyvCUKk6" fullword ascii
      $s8 = "4SiPYBhL7Z.zuC" fullword ascii
      $s9 = "wFiEDlloIdZ0uSWRjtM" fullword ascii
      $s10 = "B9yAQGeTX" fullword ascii
      $s11 = "nrJNDUqQSpyZqCpMnEH" fullword ascii
      $s12 = "bwiAspYjao" fullword ascii
      $s13 = "zmkueZa5Sj0LIxeyeXC" fullword ascii
      $s14 = "hjtsPY10JP" fullword ascii
      $s15 = "i7KaQPpSC73DLLlNED" fullword ascii
      $s16 = "HI2AOssPYq" fullword ascii
      $s17 = "qPmRVsV7t2yvjExeLog" fullword ascii
      $s18 = "GetcesbQDlMZCw6LlVD" fullword ascii
      $s19 = "cuoDllqKBqqpaMv6XjA" fullword ascii
      $s20 = "* cb]e" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 4000KB and
      8 of them
}

rule sig_258424cd8a701639a5ba89800e9e425463ab6219ce8435a37ea3c28b9b181ffa {
   meta:
      description = "samples - file 258424cd8a701639a5ba89800e9e425463ab6219ce8435a37ea3c28b9b181ffa.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "258424cd8a701639a5ba89800e9e425463ab6219ce8435a37ea3c28b9b181ffa"
   strings:
      $s1 = "zwSguJAV5URZIpGZ5LL.T1Mu9nAUUtm8FghnqCT+nGXPIqAembdv34AbDHk+kP9JnJA4uGZjZrwNyli`1[[System.Object, mscorlib, Version=4.0.0.0, Cul" ascii
      $s2 = "9vbVCBLH81j8Frkv63zelcdrX.exe" fullword wide
      $s3 = "8asKIMziG01.exe" fullword wide
      $s4 = "zwSguJAV5URZIpGZ5LL.T1Mu9nAUUtm8FghnqCT+nGXPIqAembdv34AbDHk+kP9JnJA4uGZjZrwNyli`1[[System.Object, mscorlib, Version=4.0.0.0, Cul" ascii
      $s5 = "TVIwZSdJJx" fullword ascii /* base64 encoded string 'MR0e'I'' */
      $s6 = "bElOflVYct" fullword ascii /* base64 encoded string 'lIN~UXr' */
      $s7 = "KVMhITFEeA" fullword ascii /* base64 encoded string ')S!!1Dx' */
      $s8 = "ture=neutral, PublicKeyToken=b77a5c561934e089]][]" fullword ascii
      $s9 = "dFtPbZvEy0" fullword ascii
      $s10 = "xWRRQaIcqDswqnIRCd6" fullword ascii
      $s11 = "mOq5IkFcmYndGsEgetO" fullword ascii
      $s12 = "OCSpYBAZwl" fullword ascii
      $s13 = "MPYO49beye" fullword ascii
      $s14 = "Ktr85srqe2QtiLhrP0C" fullword ascii
      $s15 = "FV1fTPZZxF" fullword ascii
      $s16 = "yspyTbhWI3x9FDrZSyd" fullword ascii
      $s17 = "AOsuXIrchq7ZTPwUIpn" fullword ascii
      $s18 = "Ea7jnPDlL1qKJ4rbJsX" fullword ascii
      $s19 = "Sp2SOqS9spy1PgJNUfv" fullword ascii
      $s20 = "vkdKMf99n9ChlQspyjF" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 5000KB and
      8 of them
}

rule ea6e4e54c6aa6df24c7a386a5ac3bd9a224d69ecd629a555744e72cde043cadd {
   meta:
      description = "samples - file ea6e4e54c6aa6df24c7a386a5ac3bd9a224d69ecd629a555744e72cde043cadd.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "ea6e4e54c6aa6df24c7a386a5ac3bd9a224d69ecd629a555744e72cde043cadd"
   strings:
      $s1 = "eXZTxOGQRVFrRUEnTZf.pWM1JmG054sHdUdbyF6+bpatFTGaS1dNeClkMJS+nkdAEMGT9tfk4XlUT4A`1[[System.Object, mscorlib, Version=4.0.0.0, Cul" ascii
      $s2 = "eXZTxOGQRVFrRUEnTZf.pWM1JmG054sHdUdbyF6+bpatFTGaS1dNeClkMJS+nkdAEMGT9tfk4XlUT4A`1[[System.Object, mscorlib, Version=4.0.0.0, Cul" ascii
      $s3 = "Ki1WcHpHUv" fullword ascii /* base64 encoded string '*-VpzGR' */
      $s4 = "eHxJNS5XOb" fullword ascii /* base64 encoded string 'x|I5.W9' */
      $s5 = "ture=neutral, PublicKeyToken=b77a5c561934e089]][]" fullword ascii
      $s6 = "QXN4UUQoTC" fullword ascii /* base64 encoded string 'AsxQD(L' */
      $s7 = "gkWHdlLeK8" fullword ascii
      $s8 = "sY8jdLl31v" fullword ascii
      $s9 = "hgW87SPygsudhoYLIJd" fullword ascii
      $s10 = "sgTDLogA95Y8l9ppJDf" fullword ascii
      $s11 = "LuQjLoG2db" fullword ascii
      $s12 = "HUthVoGETMIm0kiEfLt" fullword ascii
      $s13 = "jH1owEYEjG6wBGNX6Xx" fullword ascii
      $s14 = "xMdlLewiakAfhVTLlqQ" fullword ascii
      $s15 = "fZYspylG3l" fullword ascii
      $s16 = "geTsnMTvexxY6DNLvPZ" fullword ascii
      $s17 = "N2FstIrcbaETfvn1bgS" fullword ascii
      $s18 = "LMW2aajiRCf65Ccp7Nb" fullword ascii
      $s19 = "CKm2FnwhiV2SpYWw8iH" fullword ascii
      $s20 = "LOmpFLOgUf5nj0YI8e6" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 4000KB and
      8 of them
}

rule sig_8fc9056ebee5adcd70c3d96e53885fcb355030869137a6f1977a463759f15d86 {
   meta:
      description = "samples - file 8fc9056ebee5adcd70c3d96e53885fcb355030869137a6f1977a463759f15d86.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "8fc9056ebee5adcd70c3d96e53885fcb355030869137a6f1977a463759f15d86"
   strings:
      $x1 = "srvcli.dll" fullword wide /* reversed goodware string 'lld.ilcvrs' */
      $x2 = "devrtl.dll" fullword wide /* reversed goodware string 'lld.ltrved' */
      $x3 = "dfscli.dll" fullword wide /* reversed goodware string 'lld.ilcsfd' */
      $x4 = "browcli.dll" fullword wide /* reversed goodware string 'lld.ilcworb' */
      $x5 = "linkinfo.dll" fullword wide /* reversed goodware string 'lld.ofniknil' */
      $s6 = "atl.dll" fullword wide /* reversed goodware string 'lld.lta' */
      $s7 = "DN7D24oTIvLvelUFhJ8.Cnh9yaoRbBCwNtcZdmq+zpW820ott9J04VZfkPl+Bxcj9SofNG7H015mapn`1[[System.Object, mscorlib, Version=4.0.0.0, Cul" ascii
      $s8 = "SSPICLI.DLL" fullword wide
      $s9 = "UXTheme.dll" fullword wide
      $s10 = "oleaccrc.dll" fullword wide
      $s11 = "dnsapi.DLL" fullword wide
      $s12 = "iphlpapi.DLL" fullword wide
      $s13 = "WINNSI.DLL" fullword wide
      $s14 = "UnZiper.exe" fullword ascii
      $s15 = "sfxrar.exe" fullword ascii
      $s16 = "Cannot create folder %sHChecksum error in the encrypted file %s. Corrupt file or wrong password." fullword wide
      $s17 = "D:\\Projects\\WinRAR\\sfx\\build\\sfxrar32\\Release\\sfxrar.pdb" fullword ascii
      $s18 = "DN7D24oTIvLvelUFhJ8.Cnh9yaoRbBCwNtcZdmq+zpW820ott9J04VZfkPl+Bxcj9SofNG7H015mapn`1[[System.Object, mscorlib, Version=4.0.0.0, Cul" ascii
      $s19 = "  <asmv3:windowsSettings xmlns=\"http://schemas.microsoft.com/SMI/2005/WindowsSettings\">" fullword ascii
      $s20 = "\"C:\\WinRAR\\UnZiper.exe\"" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 5000KB and
      1 of ($x*) and 4 of them
}

rule sig_825196f7ae2364e7712c9893e97c50fa639a3ecb747e7b431d6fa47110724eca {
   meta:
      description = "samples - file 825196f7ae2364e7712c9893e97c50fa639a3ecb747e7b431d6fa47110724eca.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "825196f7ae2364e7712c9893e97c50fa639a3ecb747e7b431d6fa47110724eca"
   strings:
      $x1 = "fSystem.Drawing.Icon, System.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3ajSystem.CodeDom.MemberAtt" ascii
      $x2 = "fSystem.Drawing.Icon, System.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3ajSystem.CodeDom.MemberAtt" ascii
      $s3 = "A8NwoWFW3g6LTUwSystem.ServiceModel.SessionMode, System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c5619" ascii
      $s4 = "A8NwoWFW3g6LTUwSystem.ServiceModel.SessionMode, System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c5619" ascii
      $s5 = "ersion=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089fSystem.Drawing.Size, System.Drawing, Version=4.0.0.0, Culture=n" ascii
      $s6 = "ributes, System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089mSystem.Globalization.CultureInfo, mscorlib, V" ascii
      $s7 = "XBlvIhPlqCjV4baOax.A2H1lUZ15GsIooGy4G+IjZcs3VDm9dvvTxnOS+gI8tKfdjZh6jXHhZoef`1[[System.Object, mscorlib, Version=4.0.0.0, Cultur" ascii
      $s8 = "Janitrixes.exe" fullword wide
      $s9 = "SystemProcessorPerformanceInformation" fullword ascii
      $s10 = "FileMapExecute" fullword ascii
      $s11 = "<GetDecoded>b__0_0" fullword ascii
      $s12 = "GetDecoded" fullword ascii
      $s13 = "ProcessBytes" fullword ascii
      $s14 = "ListOfProcesses" fullword ascii
      $s15 = "XBlvIhPlqCjV4baOax.A2H1lUZ15GsIooGy4G+IjZcs3VDm9dvvTxnOS+gI8tKfdjZh6jXHhZoef`1[[System.Object, mscorlib, Version=4.0.0.0, Cultur" ascii
      $s16 = "ProcessByte" fullword ascii
      $s17 = "Process " fullword wide
      $s18 = "GQitAJFJE" fullword ascii /* base64 encoded string 'B+@$RD' */
      $s19 = "SystemPerformanceInformation" fullword ascii
      $s20 = " System.Globalization.CompareInfo" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 2000KB and
      1 of ($x*) and 4 of them
}

rule f181b5a4e2f0dc0cdf70e16c18e3466e436aae0bb96ef9b7dc24c7f219167115 {
   meta:
      description = "samples - file f181b5a4e2f0dc0cdf70e16c18e3466e436aae0bb96ef9b7dc24c7f219167115.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "f181b5a4e2f0dc0cdf70e16c18e3466e436aae0bb96ef9b7dc24c7f219167115"
   strings:
      $x1 = "blyIdentity type=\"win32\" name=\"Microsoft.Windows.Common-Controls\" version=\"6.0.0.0\" processorArchitecture=\"x86\" publicKe" ascii
      $x2 = "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?><assembly xmlns=\"urn:schemas-microsoft-com:asm.v1\" manifestVersio" ascii
      $x3 = "PGma.System.MouseKeyHook, Version=5.6.130.0, Culture=neutral, PublicKeyToken=null" fullword ascii
      $x4 = "DQuasar.Common, Version=1.4.1.0, Culture=neutral, PublicKeyToken=null" fullword ascii
      $s5 = "Process already elevated." fullword wide
      $s6 = "     * @returns {string} pem encoded representation of the private key WITH header and footer" fullword ascii
      $s7 = "     * @returns {string} the pem encoded private key with header/footer" fullword ascii
      $s8 = "get_PotentiallyVulnerablePasswords" fullword ascii
      $s9 = "     * @returns {string} pem encoded representation of the private key WITHOUT header and footer" fullword ascii
      $s10 = "     * @returns {string} pem encoded representation of the public key WITH header and footer" fullword ascii
      $s11 = "     * @returns {string} the pem encoded public key with header/footer" fullword ascii
      $s12 = "     * @returns {string} pem encoded representation of the public key WITHOUT header and footer" fullword ascii
      $s13 = "error processing extended key usage extension" fullword wide
      $s14 = "https://www.baomi.org.cn/portal/main-api/loginInNew.do" fullword ascii
      $s15 = "     * Method to parse a pem encoded string containing both a public or private key." fullword ascii
      $s16 = "Private key passed - public key expected." fullword wide
      $s17 = "Public key passed - private key expected" fullword wide
      $s18 = "attempt to process message to long for cipher" fullword wide
      $s19 = "Key length invalid. Key needs to be 32 byte - 256 bit!!!" fullword wide
      $s20 = "https://www.baomi.org.cn/portal/main-api/v2/activity/exam/getExamContentData.do?examId=" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 15000KB and
      1 of ($x*) and 4 of them
}

rule a23d1f07dfef6b5fda6381ecf6866746d624dbc1e510073d83f431124bf7d556 {
   meta:
      description = "samples - file a23d1f07dfef6b5fda6381ecf6866746d624dbc1e510073d83f431124bf7d556.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "a23d1f07dfef6b5fda6381ecf6866746d624dbc1e510073d83f431124bf7d556"
   strings:
      $x1 = "@System.Windows.Forms.Design.ParentControlDesigner, System.DesignqSystem.ComponentModel.Design.IDesigner, System, Version=4.0.0." ascii
      $s2 = "System.Windows.Forms.Design.StringCollectionEditor, System.Design, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d5" ascii
      $s3 = "System.Windows.Forms.Design.StringCollectionEditor, System.Design, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d5" ascii
      $s4 = "hSystem.Drawing.Bitmap, System.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3aPADPADO" fullword ascii
      $s5 = "hSystem.Drawing.Bitmap, System.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3aPADPADu" fullword ascii
      $s6 = "0a3auSystem.Drawing.Design.UITypeEditor, System.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a" fullword ascii
      $s7 = "hSystem.Drawing.Bitmap, System.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3aPADPADG%" fullword ascii
      $s8 = "hSystem.Drawing.Bitmap, System.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3aPADPAD>" fullword ascii
      $s9 = "PBDL.exe" fullword wide
      $s10 = "SmoothControls.Resources.process-working_5.png" fullword ascii
      $s11 = "SmoothControls.Resources.process-working_30.png" fullword ascii
      $s12 = "SmoothControls.Resources.process-working_24.png" fullword ascii
      $s13 = "SmoothControls.Resources.process-working_26.png" fullword ascii
      $s14 = "SmoothControls.Resources.process-working_11.png" fullword ascii
      $s15 = "SmoothControls.Resources.process-working_12.png" fullword ascii
      $s16 = "SmoothControls.Resources.process-working_23.png" fullword ascii
      $s17 = "SmoothControls.Resources.process-working_2.png" fullword ascii
      $s18 = "SmoothControls.Resources.process-working_25.png" fullword ascii
      $s19 = "SmoothControls.Resources.process-working_28.png" fullword ascii
      $s20 = "SmoothControls.Resources.process-working_15.png" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 3000KB and
      1 of ($x*) and 4 of them
}

rule sig_4fc50e04ab73013e2fe98c0bf05d5a13e7253fc15805f8b85ed256567bdfbed8 {
   meta:
      description = "samples - file 4fc50e04ab73013e2fe98c0bf05d5a13e7253fc15805f8b85ed256567bdfbed8.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "4fc50e04ab73013e2fe98c0bf05d5a13e7253fc15805f8b85ed256567bdfbed8"
   strings:
      $s1 = "random.exe" fullword wide
      $s2 = "    \"Password Manager (Encrypted)\", \"Packing List Template\", \"Investment Portfolio\"," fullword ascii
      $s3 = "    $content = $theme.Header + \"`n\" + ($theme.Data -join \"`n\")" fullword ascii
      $s4 = "# Function to get random content" fullword ascii
      $s5 = "    $compilerParams.ReferencedAssemblies.Add(\"System.dll\")" fullword ascii
      $s6 = "    $compilerParams.ReferencedAssemblies.Add(\"System.Windows.Forms.dll\")" fullword ascii
      $s7 = "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAC" ascii /* base64 encoded string '                                         ' */
      $s8 = "AAAAAAAAAAAAAAAC" ascii /* base64 encoded string '           ' */
      $s9 = "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAC" ascii /* base64 encoded string '                          ' */
      $s10 = "        Write-Host \"Compilation errors occurred:\"" fullword ascii
      $s11 = "1. Phase 1: Requirements Gathering - COMPLETED" fullword ascii
      $s12 = "# Requires -Module ImportExcel" fullword ascii
      $s13 = "$($script.Content)" fullword ascii
      $s14 = "2. Phase 2: Design - IN PROGRESS (75% complete)" fullword ascii
      $s15 = "Set folder = fso.GetFolder(\"C:\\\")" fullword ascii
      $s16 = "function Get-RandomContent {" fullword ascii
      $s17 = "    $script = Get-Random -InputObject $scripts" fullword ascii
      $s18 = "    $compilerParams = New-Object System.CodeDom.Compiler.CompilerParameters" fullword ascii
      $s19 = "    $compilerParams.GenerateExecutable = $true" fullword ascii
      $s20 = "# Function to create a JPEG image (dummy content with JPEG structure)" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 200KB and
      8 of them
}

rule sig_90a58064c6df293fc564fa5b616c737f6fd31f6288433da2030ec56d6dc46962 {
   meta:
      description = "samples - file 90a58064c6df293fc564fa5b616c737f6fd31f6288433da2030ec56d6dc46962.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "90a58064c6df293fc564fa5b616c737f6fd31f6288433da2030ec56d6dc46962"
   strings:
      $s1 = "Process already elevated." fullword wide
      $s2 = "https://github.com/ImagineBeingRatted/Sigma/raw/main/Install.exe" fullword wide
      $s3 = "SCHTASKS.exe" fullword wide
      $s4 = "/c start computerdefaults.exe" fullword wide
      $s5 = "Unify.exe" fullword wide
      $s6 = "GetKeyloggerLogs" fullword ascii
      $s7 = "GetKeyloggerLogsResponse" fullword ascii
      $s8 = "DoDownloadAndExecute" fullword ascii
      $s9 = "Install.exe" fullword wide
      $s10 = "GetProcessesResponse" fullword ascii
      $s11 = "get_Processname" fullword ascii
      $s12 = "uacbypass" fullword ascii
      $s13 = "Passwords" fullword ascii
      $s14 = "ping -n 10 localhost > nul" fullword wide
      $s15 = "Execution failed: " fullword wide
      $s16 = "User refused the elevation request." fullword wide
      $s17 = "Execution failed!" fullword wide
      $s18 = "System.Collections.Generic.IEnumerator<xClient.Core.MouseKeyHook.KeyPressEventArgsExt>.get_Current" fullword ascii
      $s19 = "DoShellExecute" fullword ascii
      $s20 = "System.Collections.Generic.IEnumerable<xClient.Core.MouseKeyHook.KeyPressEventArgsExt>.GetEnumerator" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 1000KB and
      8 of them
}

rule sig_2f175dac5c8571e586722f6927b0112af22637a17efb3acfd78e813a804a38f8 {
   meta:
      description = "samples - file 2f175dac5c8571e586722f6927b0112af22637a17efb3acfd78e813a804a38f8.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "2f175dac5c8571e586722f6927b0112af22637a17efb3acfd78e813a804a38f8"
   strings:
      $x1 = "C:\\Users\\dahall\\Documents\\GitHubRepos\\TaskScheduler\\TaskService\\obj\\Release\\net452\\Microsoft.Win32.TaskScheduler.pdb" fullword ascii
      $x2 = "Set-Content -Value $script -Path \"$($env:SystemDrive)\\Users\\Public\\updates.ps1\"" fullword ascii
      $s3 = "gSystem.Net.Mail.MailPriority, System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" fullword ascii
      $s4 = "System32.exe" fullword wide
      $s5 = "rSystem.Diagnostics.ProcessPriorityClass, System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" fullword ascii
      $s6 = "      <Arguments>-WindowStyle Hidden -File $($env:SystemDrive)\\Users\\Public\\updates.ps1</Arguments>" fullword ascii
      $s7 = "XSystem.Guid, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089$00000000-0000-0000-0000-000000000000" fullword ascii
      $s8 = "Svchost.exe" fullword wide
      $s9 = "FileZSystem.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" fullword ascii
      $s10 = "PowerShell.exe" fullword wide
      $s11 = "-NoLogo -NonInteractive -WindowStyle Hidden -Command \"& {{<# {0}:{1} #> {2}}}\"" fullword wide
      $s12 = "]System.Attribute, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" fullword ascii
      $s13 = "      <Command>$($env:SystemDrive)\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe</Command>" fullword ascii
      $s14 = "[System.Version, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" fullword ascii
      $s15 = "get_ActionTypeExecute" fullword ascii
      $s16 = "Microsoft.Win32.TaskScheduler.dll" fullword wide
      $s17 = "get_ProcessTokenSidType" fullword ascii
      $s18 = "Microsoft.Win32.TaskSchedulerEditor.dll" fullword wide
      $s19 = "TimeSpan2.dll" fullword wide
      $s20 = "may only contain ExecAction and ComHanlderAction types unless Actions.PowerShellConversion includes Version2." fullword wide
   condition:
      uint16(0) == 0x5a4d and filesize < 1000KB and
      1 of ($x*) and 4 of them
}

rule d4b22461e379bba07e2e2f6cf1833884c0ff656b84afdd3b2284be856f598ae0 {
   meta:
      description = "samples - file d4b22461e379bba07e2e2f6cf1833884c0ff656b84afdd3b2284be856f598ae0.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "d4b22461e379bba07e2e2f6cf1833884c0ff656b84afdd3b2284be856f598ae0"
   strings:
      $x1 = "api-ms-win-core-processenvironment-l1-1-0.dll" fullword wide /* reversed goodware string 'lld.0-1-1l-tnemnorivnessecorp-eroc-niw-sm-ipa' */
      $x2 = "api-ms-win-core-processtopology-obsolete-l1-1-0.dll" fullword wide /* reversed goodware string 'lld.0-1-1l-etelosbo-ygolopotssecorp-eroc-niw-sm-ipa' */
      $x3 = "api-ms-win-core-namedpipe-l1-1-0.dll" fullword wide /* reversed goodware string 'lld.0-1-1l-epipdeman-eroc-niw-sm-ipa' */
      $x4 = "api-ms-win-core-winrt-error-l1-1-0.dll" fullword wide /* reversed goodware string 'lld.0-1-1l-rorre-trniw-eroc-niw-sm-ipa' */
      $x5 = "api-ms-win-core-errorhandling-l1-1-0.dll" fullword wide /* reversed goodware string 'lld.0-1-1l-gnildnahrorre-eroc-niw-sm-ipa' */
      $x6 = "api-ms-win-service-core-l1-1-1.dll" fullword wide /* reversed goodware string 'lld.1-1-1l-eroc-ecivres-niw-sm-ipa' */
      $x7 = "api-ms-win-service-management-l1-1-0.dll" fullword wide /* reversed goodware string 'lld.0-1-1l-tnemeganam-ecivres-niw-sm-ipa' */
      $x8 = "api-ms-win-service-management-l2-1-0.dll" fullword wide /* reversed goodware string 'lld.0-1-2l-tnemeganam-ecivres-niw-sm-ipa' */
      $x9 = "api-ms-win-service-winsvc-l1-1-0.dll" fullword wide /* reversed goodware string 'lld.0-1-1l-cvsniw-ecivres-niw-sm-ipa' */
      $x10 = "api-ms-win-core-threadpool-l1-2-0.dll" fullword wide /* reversed goodware string 'lld.0-2-1l-loopdaerht-eroc-niw-sm-ipa' */
      $x11 = "fSystem.Drawing.Icon, System.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3ajSystem.CodeDom.MemberAtt" ascii
      $x12 = "fSystem.Drawing.Icon, System.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3ajSystem.CodeDom.MemberAtt" ascii
      $s13 = "api-ms-win-core-sysinfo-l1-2-0.dll" fullword wide /* reversed goodware string 'lld.0-2-1l-ofnisys-eroc-niw-sm-ipa' */
      $s14 = "api-ms-win-core-console-l1-1-0.dll" fullword wide /* reversed goodware string 'lld.0-1-1l-elosnoc-eroc-niw-sm-ipa' */
      $s15 = "api-ms-win-core-console-l2-1-0.dll" fullword wide /* reversed goodware string 'lld.0-1-2l-elosnoc-eroc-niw-sm-ipa' */
      $s16 = "api-ms-win-core-file-l2-1-0.dll" fullword wide /* reversed goodware string 'lld.0-1-2l-elif-eroc-niw-sm-ipa' */
      $s17 = "api-ms-win-core-handle-l1-1-0.dll" fullword wide /* reversed goodware string 'lld.0-1-1l-eldnah-eroc-niw-sm-ipa' */
      $s18 = "api-ms-win-core-heap-obsolete-l1-1-0.dll" fullword wide /* reversed goodware string 'lld.0-1-1l-etelosbo-paeh-eroc-niw-sm-ipa' */
      $s19 = "api-ms-win-core-heap-l1-1-0.dll" fullword wide /* reversed goodware string 'lld.0-1-1l-paeh-eroc-niw-sm-ipa' */
      $s20 = "api-ms-win-core-io-l1-1-0.dll" fullword wide /* reversed goodware string 'lld.0-1-1l-oi-eroc-niw-sm-ipa' */
   condition:
      uint16(0) == 0x5a4d and filesize < 15000KB and
      1 of ($x*) and all of them
}

rule sig_8c909dda150a980bd5bb6a0bdb8ca6e92847b3b2152a9c7e9168edcda0d78ae0 {
   meta:
      description = "samples - file 8c909dda150a980bd5bb6a0bdb8ca6e92847b3b2152a9c7e9168edcda0d78ae0.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "8c909dda150a980bd5bb6a0bdb8ca6e92847b3b2152a9c7e9168edcda0d78ae0"
   strings:
      $x1 = "<?xml version=\"1.0\" encoding=\"utf-8\" standalone=\"yes\"?><assembly xmlns=\"urn:schemas-microsoft-com:asm.v1\" manifestVersio" ascii
      $s2 = "questedPrivileges xmlns=\"urn:schemas-microsoft-com:asm.v3\"><requestedExecutionLevel level=\"asInvoker\" uiAccess=\"false\" /><" ascii
      $s3 = "IMG_2007_520073.exe" fullword wide
      $s4 = "<assemblyIdentity version=\"1.0.0.0\" name=\"MyApplication.app\" /><trustInfo xmlns=\"urn:schemas-microsoft-com:asm.v2\"><securi" ascii
      $s5 = "+QALrQWVhCsdvwydyQ0Rtg7W6woLvA2axgBDngWM7xcMqxm52QodtAKU00IfvBSn7AwUtS6ZxxxDthCn4xcdqBWZxhAMoFufzw0nlQWWzQ0Q4ied3i0BqQW+2BYVkQGW" wide
      $s6 = ".NET Framework 4.5l" fullword ascii
      $s7 = "#\"$\"&%+*,*213141" fullword wide /* hex encoded string '!1A' */
      $s8 = "ffeeffefeef" ascii
      $s9 = "fefefeffefe" ascii
      $s10 = "ffeefefeffe" ascii
      $s11 = "afefeffeefa" ascii
      $s12 = "afeffeefef" ascii
      $s13 = "ffeeffefea" ascii
      $s14 = "fefeffeefefa" ascii
      $s15 = "afefefeffe" ascii
      $s16 = "affefefeeffe" ascii
      $s17 = "ffeeffefefe" ascii
      $s18 = "fefeffeef" ascii
      $s19 = "ffeeffefe" ascii
      $s20 = "feffefefea" ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 700KB and
      1 of ($x*) and 4 of them
}

rule fdc933b64df0832a1f88f0e19a4cab67fb110d54c4913367a7215d7890f8a5b7 {
   meta:
      description = "samples - file fdc933b64df0832a1f88f0e19a4cab67fb110d54c4913367a7215d7890f8a5b7.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "fdc933b64df0832a1f88f0e19a4cab67fb110d54c4913367a7215d7890f8a5b7"
   strings:
      $x1 = "/k start /b powershell.exe Set-MpPreference -DisableIntrusionPreventionSystem $true -DisableIOAVProtection $true -DisableRealtim" wide
      $x2 = "ProcessHacker.exe" fullword wide
      $s3 = "gSystem.Net.Mail.MailPriority, System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" fullword ascii
      $s4 = "/k start /b powershell -inputformat none -outputformat none -NonInteractive -Command Add-MpPreference -ExclusionPath " fullword wide
      $s5 = "MpCmdRun.exe" fullword wide
      $s6 = "rSystem.Diagnostics.ProcessPriorityClass, System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" fullword ascii
      $s7 = "XSystem.Guid, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089$00000000-0000-0000-0000-000000000000" fullword ascii
      $s8 = "FileZSystem.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" fullword ascii
      $s9 = "taskkill /FI \"IMAGENAME eq processhacker*\" /IM * /F /T >nul 2>&1" fullword wide
      $s10 = "taskkill /f /im HTTPDebuggerUI.exe >nul 2>&1" fullword wide
      $s11 = "taskkill /f /im HTTPDebuggerSvc.exe >nul 2>&1" fullword wide
      $s12 = "  <!-- Enable themes for Windows common controls and dialogs (Windows XP and later) -->" fullword ascii
      $s13 = "ConfigSecurityPolicy.exe" fullword wide
      $s14 = "MSConfig.exe" fullword wide
      $s15 = "-NoLogo -NonInteractive -WindowStyle Hidden -Command \"& {{<# {0}:{1} #> {2}}}\"" fullword wide
      $s16 = "]System.Attribute, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" fullword ascii
      $s17 = "[System.Version, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" fullword ascii
      $s18 = "get_ActionTypeExecute" fullword ascii
      $s19 = "get_ProcessTokenSidType" fullword ascii
      $s20 = "Microsoft.Win32.TaskSchedulerEditor.dll" fullword wide
   condition:
      uint16(0) == 0x5a4d and filesize < 1000KB and
      1 of ($x*) and 4 of them
}

rule sig_0738981879dde83f3a14602cfa2842e934a11c5339b460a8dd4c57c778221ddd {
   meta:
      description = "samples - file 0738981879dde83f3a14602cfa2842e934a11c5339b460a8dd4c57c778221ddd.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "0738981879dde83f3a14602cfa2842e934a11c5339b460a8dd4c57c778221ddd"
   strings:
      $x1 = "C:\\Users\\Administrator\\Desktop\\2023CryptsDone\\DBasse\\obj\\Debug\\Lenaon.pdb" fullword ascii
      $s2 = "Lenaon.exe" fullword wide
      $s3 = "https://filetransfer.io/data-package/nNTECeJU/download" fullword wide
      $s4 = "get_PMDatabaseConnectionString" fullword ascii
      $s5 = "get_Observaciones" fullword ascii
      $s6 = "get_Paciente" fullword ascii
      $s7 = "jqjajajwd" fullword ascii
      $s8 = "hahjadakdj" fullword ascii
      $s9 = "comboBox2" fullword wide
      $s10 = "comboBox1_SelectedIndexChanged" fullword ascii
      $s11 = "Lenaon.Properties" fullword ascii
      $s12 = "dd/MMM/yyyy hh:mm" fullword wide
      $s13 = "PMDatabaseConnectionString" fullword wide
      $s14 = "AGENDAR" fullword wide
      $s15 = "get_Lugar" fullword ascii
      $s16 = "get_Fecha" fullword ascii
      $s17 = "15.9.0.0" fullword ascii
      $s18 = "kData Source=(LocalDB)\\MSSQLLocalDB;AttachDbFilename=|DataDirectory|\\PMDatabase.mdf;Integrated Security=True" fullword ascii
      $s19 = "Pacientes" fullword wide
      $s20 = "listBox2" fullword wide
   condition:
      uint16(0) == 0x5a4d and filesize < 300KB and
      1 of ($x*) and 4 of them
}

rule sig_5251011e8feda9381a5a1b119b36c8bd4bbd3de97044743d8cea2d2f69ee0b4d {
   meta:
      description = "samples - file 5251011e8feda9381a5a1b119b36c8bd4bbd3de97044743d8cea2d2f69ee0b4d.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "5251011e8feda9381a5a1b119b36c8bd4bbd3de97044743d8cea2d2f69ee0b4d"
   strings:
      $s1 = "System.Security.Permissions.SecurityPermissionAttribute, mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934" ascii
      $s2 = "lSystem.Resources.ResourceReader, mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089#System.Resources.R" ascii
      $s3 = "H7rrlW34uZ4g7TG29m695QHDWNDM6maH760RUMe2fvs6fBSV9ArU3xwZc58t79bYW92J4Kch8bJvQTXR7ZSLOpr16aCx9Y9b8sq08YK78X7af00cL6y1OAAaRhD2nS88" wide
      $s4 = "GetMusic" fullword ascii
      $s5 = "_getPath" fullword ascii
      $s6 = "approximation" fullword wide
      $s7 = "chieftain" fullword wide
      $s8 = "26fc2.resources" fullword ascii
      $s9 = "MusicReader" fullword ascii
      $s10 = "1973c.png" fullword wide
      $s11 = "1.28.14.52" fullword wide
      $s12 = " gluttonous" fullword wide
      $s13 = "aluminium " fullword wide
      $s14 = "button26" fullword wide
      $s15 = "button14" fullword wide
      $s16 = "button73" fullword wide
      $s17 = "button25" fullword wide
      $s18 = "button80" fullword wide
      $s19 = "button17" fullword wide
      $s20 = "textBox11" fullword wide
   condition:
      uint16(0) == 0x5a4d and filesize < 300KB and
      8 of them
}

rule af2f05611639653b5c588b25b9e42d57f53fd0262681f89f6acdc24b58887214 {
   meta:
      description = "samples - file af2f05611639653b5c588b25b9e42d57f53fd0262681f89f6acdc24b58887214.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "af2f05611639653b5c588b25b9e42d57f53fd0262681f89f6acdc24b58887214"
   strings:
      $s1 = "System.Security.Permissions.SecurityPermissionAttribute, mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934" ascii
      $s2 = "lSystem.Resources.ResourceReader, mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089#System.Resources.R" ascii
      $s3 = "https://www.sysinternals.com0" fullword ascii
      $s4 = "Phttp://www.microsoft.com/pkiops/certs/Microsoft%20Time-Stamp%20PCA%202010(1).crt0" fullword ascii
      $s5 = "Nhttp://www.microsoft.com/pkiops/crl/Microsoft%20Time-Stamp%20PCA%202010(1).crl0l" fullword ascii
      $s6 = "H7rrlW34uZ4g7TG29m695QHDWNDM6maH760RUMe2fvs6fBSV9ArU3xwZc58t79bYW92J4Kch8bJvQTXR7ZSLOpr16aCx9Y9b8sq08YK78X7af00cL6y1OAAaRhD2nS88" wide
      $s7 = "GetMusic" fullword ascii
      $s8 = "_getPath" fullword ascii
      $s9 = " Microsoft Operations Puerto Rico1" fullword ascii
      $s10 = " Microsoft Operations Puerto Rico1&0$" fullword ascii
      $s11 = "approximation" fullword wide
      $s12 = "chieftain" fullword wide
      $s13 = "26fc2.resources" fullword ascii
      $s14 = "MusicReader" fullword ascii
      $s15 = "1973c.png" fullword wide
      $s16 = "1.28.14.52" fullword wide
      $s17 = " gluttonous" fullword wide
      $s18 = "aluminium " fullword wide
      $s19 = "Sigchec" fullword wide
      $s20 = "button26" fullword wide
   condition:
      uint16(0) == 0x5a4d and filesize < 400KB and
      8 of them
}

rule sig_0ff8f9853b1951fcefad14ec98e7c21d098fa87d5e3af0cb0d1f2962315a483f {
   meta:
      description = "samples - file 0ff8f9853b1951fcefad14ec98e7c21d098fa87d5e3af0cb0d1f2962315a483f.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "0ff8f9853b1951fcefad14ec98e7c21d098fa87d5e3af0cb0d1f2962315a483f"
   strings:
      $s1 = "System.Security.Permissions.SecurityPermissionAttribute, mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934" ascii
      $s2 = "lSystem.Resources.ResourceReader, mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089#System.Resources.R" ascii
      $s3 = "https://www.sysinternals.com0" fullword ascii
      $s4 = "Phttp://www.microsoft.com/pkiops/certs/Microsoft%20Time-Stamp%20PCA%202010(1).crt0" fullword ascii
      $s5 = "Nhttp://www.microsoft.com/pkiops/crl/Microsoft%20Time-Stamp%20PCA%202010(1).crl0l" fullword ascii
      $s6 = "H7rrlW34uZ4g7TG29m695QHDWNDM6maH760RUMe2fvs6fBSV9ArU3xwZc58t79bYW92J4Kch8bJvQTXR7ZSLOpr16aCx9Y9b8sq08YK78X7af00cL6y1OAAaRhD2nS88" wide
      $s7 = "GetMusic" fullword ascii
      $s8 = "_getPath" fullword ascii
      $s9 = " Microsoft Operations Puerto Rico1" fullword ascii
      $s10 = " Microsoft Operations Puerto Rico1&0$" fullword ascii
      $s11 = "approximation" fullword wide
      $s12 = "chieftain" fullword wide
      $s13 = "26fc2.resources" fullword ascii
      $s14 = "MusicReader" fullword ascii
      $s15 = "1973c.png" fullword wide
      $s16 = "1.28.14.52" fullword wide
      $s17 = " gluttonous" fullword wide
      $s18 = "aluminium " fullword wide
      $s19 = "Sigchec" fullword wide
      $s20 = "button26" fullword wide
   condition:
      uint16(0) == 0x5a4d and filesize < 300KB and
      8 of them
}

rule sig_7e93b3a5bed3d2ab87eac6f297e6bbc63c7cc27e8da00b1ad4f6275c428a130f {
   meta:
      description = "samples - file 7e93b3a5bed3d2ab87eac6f297e6bbc63c7cc27e8da00b1ad4f6275c428a130f.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "7e93b3a5bed3d2ab87eac6f297e6bbc63c7cc27e8da00b1ad4f6275c428a130f"
   strings:
      $s1 = "System.Security.Permissions.SecurityPermissionAttribute, mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934" ascii
      $s2 = "lSystem.Resources.ResourceReader, mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089#System.Resources.R" ascii
      $s3 = "https://www.sysinternals.com0" fullword ascii
      $s4 = "Phttp://www.microsoft.com/pkiops/certs/Microsoft%20Time-Stamp%20PCA%202010(1).crt0" fullword ascii
      $s5 = "Nhttp://www.microsoft.com/pkiops/crl/Microsoft%20Time-Stamp%20PCA%202010(1).crl0l" fullword ascii
      $s6 = "H7rrlW34uZ4g7TG29m695QHDWNDM6maH760RUMe2fvs6fBSV9ArU3xwZc58t79bYW92J4Kch8bJvQTXR7ZSLOpr16aCx9Y9b8sq08YK78X7af00cL6y1OAAaRhD2nS88" wide
      $s7 = "GetMusic" fullword ascii
      $s8 = "_getPath" fullword ascii
      $s9 = " Microsoft Operations Puerto Rico1" fullword ascii
      $s10 = " Microsoft Operations Puerto Rico1&0$" fullword ascii
      $s11 = "approximation" fullword wide
      $s12 = "chieftain" fullword wide
      $s13 = "26fc2.resources" fullword ascii
      $s14 = "MusicReader" fullword ascii
      $s15 = "1973c.png" fullword wide
      $s16 = "1.28.14.52" fullword wide
      $s17 = " gluttonous" fullword wide
      $s18 = "aluminium " fullword wide
      $s19 = "Sigchec" fullword wide
      $s20 = "button26" fullword wide
   condition:
      uint16(0) == 0x5a4d and filesize < 300KB and
      8 of them
}

rule sig_518ee9f74a609d856403d4a94c650e62aba87c9dd17e6e885fe4e0adc4113e9a {
   meta:
      description = "samples - file 518ee9f74a609d856403d4a94c650e62aba87c9dd17e6e885fe4e0adc4113e9a.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "518ee9f74a609d856403d4a94c650e62aba87c9dd17e6e885fe4e0adc4113e9a"
   strings:
      $s1 = "System.Security.Permissions.SecurityPermissionAttribute, mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934" ascii
      $s2 = "lSystem.Resources.ResourceReader, mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089#System.Resources.R" ascii
      $s3 = "https://www.sysinternals.com0" fullword ascii
      $s4 = "Phttp://www.microsoft.com/pkiops/certs/Microsoft%20Time-Stamp%20PCA%202010(1).crt0" fullword ascii
      $s5 = "Nhttp://www.microsoft.com/pkiops/crl/Microsoft%20Time-Stamp%20PCA%202010(1).crl0l" fullword ascii
      $s6 = "H7rrlW34uZ4g7TG29m695QHDWNDM6maH760RUMe2fvs6fBSV9ArU3xwZc58t79bYW92J4Kch8bJvQTXR7ZSLOpr16aCx9Y9b8sq08YK78X7af00cL6y1OAAaRhD2nS88" wide
      $s7 = "GetMusic" fullword ascii
      $s8 = "_getPath" fullword ascii
      $s9 = " Microsoft Operations Puerto Rico1" fullword ascii
      $s10 = " Microsoft Operations Puerto Rico1&0$" fullword ascii
      $s11 = "approximation" fullword wide
      $s12 = "chieftain" fullword wide
      $s13 = "26fc2.resources" fullword ascii
      $s14 = "MusicReader" fullword ascii
      $s15 = "1973c.png" fullword wide
      $s16 = "1.28.14.52" fullword wide
      $s17 = " gluttonous" fullword wide
      $s18 = "aluminium " fullword wide
      $s19 = "Sigchec" fullword wide
      $s20 = "button26" fullword wide
   condition:
      uint16(0) == 0x5a4d and filesize < 300KB and
      8 of them
}

rule sig_11be7cf9279c9dd3f8584bfafe98ed1aae2d278d3a1e2009203dbac56967cc99 {
   meta:
      description = "samples - file 11be7cf9279c9dd3f8584bfafe98ed1aae2d278d3a1e2009203dbac56967cc99.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "11be7cf9279c9dd3f8584bfafe98ed1aae2d278d3a1e2009203dbac56967cc99"
   strings:
      $s1 = "hSystem.Drawing.Bitmap, System.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3afSystem.Drawing.Icon, S" ascii
      $s2 = "hSystem.Drawing.Bitmap, System.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3aPADPADp" fullword ascii
      $s3 = "hSystem.Drawing.Bitmap, System.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3afSystem.Drawing.Icon, S" ascii
      $s4 = "ystem.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3aPADPADPBj" fullword ascii
      $s5 = "65745479706546726F6D48616E646C650052756E74696D655479706548616E646C65004D6F6E69746F7200456E74657200417070446F6D61696E006765745F43" ascii /* hex encoded string 'etTypeFromHandleRuntimeTypeHandleMonitorEnterAppDomainget_C' */
      $s6 = "7263654D616E616765720053797374656D2E5265736F7572636573004765744F626A656374004C6F77657374427265616B497465726174696F6E007831300070" ascii /* hex encoded string 'rceManagerSystem.ResourcesGetObjectLowestBreakIterationx10p' */
      $s7 = "7200536563757269747953616665437269746963616C4174747269627574650053797374656D2E5365637572697479002E63746F720043616E766173004D7573" ascii /* hex encoded string 'rSecuritySafeCriticalAttributeSystem.Security.ctorCanvasMus' */
      $s8 = "49650062003400350066006100630064002D0033003100380030002D0034006200650039002D0062003800620063002D00630034006200320039003000350065" ascii /* hex encoded string 'Ieb45facd-3180-4be9-b8bc-c4b2905e022e' */
      $s9 = "004465666C61746553747265616D007365745F4974656D0047657444617461006765745F4E616D6500436F6E7461696E734B6579006765745F52657175657374" ascii /* hex encoded string 'DeflateStreamset_ItemGetDataget_NameContainsKeyget_Request' */
      $s10 = "726F6A6563746E616D650049446576696365436F6E746578740047726170686963730050656E00436F6E74726F6C004D6F7573654576656E7448616E646C6572" ascii /* hex encoded string 'rojectnameIDeviceContextGraphicsPenControlMouseEventHandler' */
      $s11 = "53797374656D2E436F6C6C656374696F6E732E47656E657269630049437573746F6D41747472696275746550726F76696465720044696374696F6E6172796032" ascii /* hex encoded string 'System.Collections.GenericICustomAttributeProviderDictionary`2' */
      $s12 = "6E00497357697468696E42616C6C004D6F75736543617074757265004973446F776E00427574746F6E004D6F757365427574746F6E73003C5072697661746549" ascii /* hex encoded string 'nIsWithinBallMouseCaptureIsDownButtonMouseButtons<PrivateI' */
      $s13 = "650049446973706F7361626C6500446973706F736500475A6970005F547970650053797374656D2E52756E74696D652E496E7465726F70536572766963657300" ascii /* hex encoded string 'eIDisposableDisposeGZip_TypeSystem.Runtime.InteropServices' */
      $s14 = "6967696E616C4269746D6170006D6F6469666965644269746D617000616464656457696474680061646465644865696768740053747265616D0053797374656D" ascii /* hex encoded string 'iginalBitmapmodifiedBitmapaddedWidthaddedHeightStreamSystem' */
      $s15 = "004765744D6574686F64004765745479706573006164645F4D6F757365446F776E0046696C6C52656374616E676C650053757370656E644C61796F7574007365" ascii /* hex encoded string 'GetMethodGetTypesadd_MouseDownFillRectangleSuspendLayoutse' */
      $s16 = "2E44726177696E670053797374656D003C4D6F64756C653E00436861720052756E74696D6548656C706572730053797374656D2E52756E74696D652E436F6D70" ascii /* hex encoded string '.DrawingSystem<Module>CharRuntimeHelpersSystem.Runtime.Comp' */
      $s17 = "6574456E747279417373656D626C790049436F6D70617261626C6500436F6E63617400546F41727261790049436C6F6E6561626C650042727573686573006765" ascii /* hex encoded string 'etEntryAssemblyIComparableConcatToArrayICloneableBrushesge' */
      $s18 = "696E67417373656D626C79004765744279746573005772697465005365637572697479436F6E74657874536F7572636500416374697661746F72004372656174" ascii /* hex encoded string 'ingAssemblyGetBytesWriteSecurityContextSourceActivatorCreat' */
      $s19 = "6973706F73696E670050696374757265426F780049537570706F7274496E697469616C697A6500426567696E496E697400506F696E740053697A650053697A65" ascii /* hex encoded string 'isposingPictureBoxISupportInitializeBeginInitPointSizeSize' */
      $s20 = "6B53697A6500457363617065644952656D6F74696E67466F726D6174746572004D656D626572496E666F005F4D6574686F64496E666F004D6574686F64496E66" ascii /* hex encoded string 'kSizeEscapedIRemotingFormatterMemberInfo_MethodInfoMethodInf' */
   condition:
      uint16(0) == 0x5a4d and filesize < 2000KB and
      8 of them
}

rule sig_052d222b441b1fd17f08ca9831c1c92099ffc3a1187ee6266b9d8d1ed9ebeae8 {
   meta:
      description = "samples - file 052d222b441b1fd17f08ca9831c1c92099ffc3a1187ee6266b9d8d1ed9ebeae8.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "052d222b441b1fd17f08ca9831c1c92099ffc3a1187ee6266b9d8d1ed9ebeae8"
   strings:
      $x1 = "<assembly xmlns=\"urn:schemas-microsoft-com:asm.v1\" manifestVersion=\"1.0\"><dependency><dependentAssembly><assemblyIdentity ty" ascii
      $x2 = "win32\" name=\"Microsoft.Windows.Common-Controls\" version=\"6.0.0.0\" processorArchitecture=\"X86\" publicKeyToken=\"6595b64144" ascii
      $x3 = "\\downloader.exe" fullword wide
      $s4 = "schannel: Failed to import cert file %s, password is bad" fullword ascii
      $s5 = "SEC_E_ILLEGAL_MESSAGE (0x%08X) - This error usually occurs when a fatal SSL/TLS alert is received (e.g. handshake failed). More " ascii
      $s6 = "requestedPrivileges><requestedExecutionLevel level=\"asInvoker\" uiAccess=\"false\"></requestedExecutionLevel></requestedPrivile" ascii
      $s7 = "vksaver3.dll" fullword wide
      $s8 = "msedge.exe" fullword wide
      $s9 = "vksaver.exe" fullword wide
      $s10 = "vktray.exe" fullword wide
      $s11 = "cmd64.exe" fullword wide
      $s12 = "VKSaver.exe" fullword wide
      $s13 = "http://www.audiovk.com" fullword wide
      $s14 = "AudioVK.com" fullword wide
      $s15 = "AudioVK.Com" fullword wide
      $s16 = "%s%08x%08x.exe" fullword wide
      $s17 = "Fapi-ms-win-core-synch-l1-2-0.dll" fullword wide
      $s18 = "schannel: CertGetNameString() failed to match connection hostname (%s) against server certificate names" fullword ascii
      $s19 = "web-vksaver-install.exe" fullword wide
      $s20 = "far.exe" fullword wide
   condition:
      uint16(0) == 0x5a4d and filesize < 9000KB and
      1 of ($x*) and 4 of them
}

rule sig_188206f6dabcf77e5a3ac75e74661ba868dd95122fa3328abf023541d4ffdec9 {
   meta:
      description = "samples - file 188206f6dabcf77e5a3ac75e74661ba868dd95122fa3328abf023541d4ffdec9.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "188206f6dabcf77e5a3ac75e74661ba868dd95122fa3328abf023541d4ffdec9"
   strings:
      $s1 = "hSystem.Drawing.Bitmap, System.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3aPADPADM" fullword ascii
      $s2 = "ngZo.exe" fullword wide
      $s3 = "TVqQ:M::E::__8:Lg::::AQ:::::::::::::::::::::::Ag::A4fug4AtAnNIbg_TM0hVGhpcy_wcm9ncmFtIGNhbm5vdC_iZS_ydW4gaW4gRE9TIG1vZGUuDQ0KJ::" ascii
      $s4 = "http://tempuri.org/DataSetAAAAAAAAA.xsd" fullword wide
      $s5 = "ngZo.pdb" fullword ascii
      $s6 = "Geciktirmeyenler" fullword wide
      $s7 = "Text Files (*.txt)|*.txt|All Files (*.*)|*.*" fullword wide
      $s8 = "tir!!!" fullword wide
      $s9 = ":q:EAFgAq:EA3gAu:EAFgEb:EAGAET:EAGgET:EAHAET:EAHgEy:EAIAEy:EAIgE2:EAJAE6:EAJgE-:EAKAE-:YALwAX:YAF:bAFaANgIbAFaARAIbAFaAUQIbAFaAW" ascii
      $s10 = "U3Agb_mb4K_17-_YbZfP_11wGxgmN_4N6ZWv-ZvAv74DX4D4qvfDFxGPfxOeO13Ovv1P_6NzfMb_Aa_xW_0a_0G-O83-LX4-S3-oD_71_q1ftPf-Df9jU8NXPvLj_0YP" ascii
      $s11 = "contentsToolStripMenuItem" fullword wide
      $s12 = "INSERT INTO ogrenciler (numara,adsoyad,kullaniciadi,sifre,bolum,eposta,cezadurumu) values('" fullword wide
      $s13 = "45705451+677573" fullword wide /* hex encoded string 'EpTQgus' */
      $s14 = "insert into ogrenciler (numara,adsoyad,kullaniciadi,sifre,bolum,eposta) values('" fullword wide
      $s15 = ",sifre AS Sifre,bolum AS Bolum,eposta AS Eposta,kitaplar AS Kitaplar from ogrenciler" fullword wide
      $s16 = "kitaplar" fullword ascii
      $s17 = "ogrenciadi" fullword ascii
      $s18 = "cezadurumu" fullword ascii
      $s19 = "kitaplistele" fullword ascii
      $s20 = "barkodno" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 2000KB and
      8 of them
}

rule sig_6f2b0a1890381cd7f98f920e2ecca11d2cc54f0e50c85da93f65fa8abc0c5b09 {
   meta:
      description = "samples - file 6f2b0a1890381cd7f98f920e2ecca11d2cc54f0e50c85da93f65fa8abc0c5b09.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "6f2b0a1890381cd7f98f920e2ecca11d2cc54f0e50c85da93f65fa8abc0c5b09"
   strings:
      $s1 = "Picasa.exe" fullword wide
      $s2 = "T)4ZQEo]G4dc50<pcFy{LSa>n3TE}T1a=)w4@iwDx4B.nHr-SU003vk|86c7>&<aeeI+NROfD25=[f!(ML{C$wK11p,t-RGG7D:vilbo>Dfq0TtX.DiJ]DIwX&zHORWo" ascii
      $s3 = "http://www.videolan.org/0" fullword ascii
      $s4 = "9F;=+Fy7W0WnwXDNDm((h0*>MUZ8p6NaM.uq7.a:X-,|@4,%i:DQoG2p5:nG:IB5wj8tFD{Hh=nR4]b,S%0hznesT.T#85/dnQ{C,{Q4r<scjmH&7Rrj&OS$gB!Jig*Z" ascii
      $s5 = "1%|5Uy(VELk:ZZFr+A<9,D5nC^P8^b+v{2lm/1^3y@!0M9@:RmY7xCEgo3a15a*t6:t}Qftx5T4z@t8+rHYH|geTmtkYKg<,:6:55_3hcsw{}pDt:nBj%WdK|91v.8#K" ascii
      $s6 = "HI;k|UOI+,:|!FlPbn6AlgY8nK_p-:=|qFkaf0rD-O1Yyz_@Bg@c2NfQec;ACnX}iw}vvoc7xzN_B/2t6pC8z1QDm{o|63{B=!brWNHG|rwO/R$e2]%D#+7J@H<UqRq1" ascii
      $s7 = "{zye2hOg$|<e]RlIs:lCW!Cw&WMVc;^%XiU;]wF0=mt;L+A+F>g__#gj7tvQM-|_flL*<nLaK27e52L,}%ob%:;(|hc+%dwwUx^QE2[gHtRltdXtCQP+$4ylm9]*r6YT" ascii
      $s8 = "+eB%UYP%]s%#kSt8%Zn_a{W/s&tmM,RF!)z{pj$U]sT{@ZBGbf=;aG%:!B20Qpg;(WwOlgMN^}:/VSn2l0eSoAEvtmjCBfy&.SiAKhvoNmglX^OmnqI!i$_O>^R;>rq1" ascii
      $s9 = "iU(^(*u@tqb]|=7)Oncb.v>>flF]FD;%L+%AZZ<$/rrjbyd6Jd|#+fY+O_20Tkn1uZUiovQ[QKn;l*@iy&OQXk;TH;e8{IP(%Sa%8yBz-rSR]D20pXXB(>u]Me1gx1>;" ascii
      $s10 = "bs8NGTtV6BgCQl8iUaCO7Uj8v.resources" fullword ascii
      $s11 = "lZOuApLKHBaS46EoSX5gBSvls.resources" fullword ascii
      $s12 = "iTm%S4w)5@cLPMk|}qCWT}z4}1X%D2/4i#FU_vZ<BOCyO3Q7/pKxRkBja4=_abUr@0A7s+i5JB$,YgvbQ-%Ra^Q{hvcjO9=QeKR(l2Cgw-$&F1_,OMXbLr|.mXL]M}v*" ascii
      $s13 = "2Ywz7waBLbJyFFwLt77QTcfVV.resources" fullword ascii
      $s14 = "Bf3z=w8{iu[Bxp%O*;#41Jp2;(T%)pDKbt&7qPy*nBYjE|2}-zIVqm9urwQy7:i<4IQjEuIO[,Urs;QwhF|0#]J<T93/p/aRJIV,1SN&+/7t|6:a@m]zeJc^{E-2DOn[" ascii
      $s15 = "]^)Im_,2iSUlnifA3k@H,]PkE#Zu6Nr:IB<YaOz8|@0t5S/s+$8G52//U2tBW].ZID+!p*Qx<eBxmYC}#Ic|]Mn%N</LT5Ur%u6z0mwrFFJ2t^!wuf+;3t3(fuds(({W" ascii
      $s16 = ",;[4#zOWC&wq@|K5N-m]A.j{Bl$vBTI#sK{$N7Rgm$IpVbIo_tD86S+>$<iXJd%jPm]xe%i{La06MuTm_5DZ|9y95}/00)8d/j!bOdyy.VhC+hO73*9+!cn!zhMa%Km9" ascii
      $s17 = "ncmA3P1Pkcfh54gwd5xt34vCy.resources" fullword ascii
      $s18 = "GVqYvWvAzXxYwAmKJWnEMrHoK.resources" fullword ascii
      $s19 = "o,C-aT2>]BJ4=f)-Y}Wr|EdE#-5(vEJ}+7G!L3{HL1bBaSS[E7{mo&(&(zab8)@BiM)h9oT#w+XWtNkWA&HMSj)t]7}mZ2*8]!JC1vhzEgnvcK#xw)=|Tds{^%QwkyzO" ascii
      $s20 = "jSdFUr21nGk7ebJbHMB7bxscV.resources" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 400KB and
      8 of them
}

rule de8c7c543f438af1e7e78096f6873268e9b1a12745edf9c88db07e136163399e {
   meta:
      description = "samples - file de8c7c543f438af1e7e78096f6873268e9b1a12745edf9c88db07e136163399e.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "de8c7c543f438af1e7e78096f6873268e9b1a12745edf9c88db07e136163399e"
   strings:
      $s1 = "fSystem.Drawing.Icon, System.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3ahSystem.Drawing.Bitmap, S" ascii
      $s2 = "ystem.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3aPADPADPBj" fullword ascii
      $s3 = "QPVC.exe" fullword wide
      $s4 = "getForwardPower" fullword ascii
      $s5 = "getForwardSensor" fullword ascii
      $s6 = "QPVC.pdb" fullword ascii
      $s7 = "get_isRunning" fullword ascii
      $s8 = "forwardPower" fullword ascii
      $s9 = "getRightSensor" fullword ascii
      $s10 = "getTurnPower" fullword ascii
      $s11 = "getLeftSensor" fullword ascii
      $s12 = "k}BqNFtPz" fullword ascii
      $s13 = "getMillis" fullword ascii
      $s14 = "getVertex" fullword ascii
      $s15 = "~>?!\"2(4" fullword ascii /* hex encoded string '$' */
      $s16 = "Forward: " fullword wide
      $s17 = "Power Forward: " fullword wide
      $s18 = "gameThread" fullword ascii
      $s19 = "MouseTester.Properties" fullword ascii
      $s20 = "MouseTester.MouseAI.update" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 3000KB and
      8 of them
}

rule sig_76eee256f1223082e8396611baca498542c656edd0fac5fe903e06e6cb5677e2 {
   meta:
      description = "samples - file 76eee256f1223082e8396611baca498542c656edd0fac5fe903e06e6cb5677e2.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "76eee256f1223082e8396611baca498542c656edd0fac5fe903e06e6cb5677e2"
   strings:
      $x1 = "<?xml version=\"1.0\" encoding=\"utf-8\"?><assembly manifestVersion=\"1.0\" xmlns=\"urn:schemas-microsoft-com:asm.v1\"><assembly" ascii
      $x2 = " unzip 1.01 Copyright 1998-2004 Gilles Vollant - http://www.winimage.com/zLibDll" fullword ascii
      $s3 = "api-ms-win-core-synch-l1-2-0.dll" fullword wide /* reversed goodware string 'lld.0-2-1l-hcnys-eroc-niw-sm-ipa' */
      $s4 = "<assembly xmlns=\"urn:schemas-microsoft-com:asm.v1\" manifestVersion=\"1.0\"><trustInfo xmlns=\"urn:schemas-microsoft-com:asm.v3" ascii
      $s5 = " xmlns=\"urn:schemas-microsoft-com:asm.v3\"><requestedExecutionLevel level=\"asInvoker\" uiAccess=\"false\" /></requestedPrivile" ascii
      $s6 = "'%s' - incompatible operands %V and %V" fullword ascii
      $s7 = "EPowrProf.dll" fullword wide
      $s8 = "ruiautomationcore.dll" fullword wide
      $s9 = "attempt to png_read_frame_head() but no acTL present" fullword ascii
      $s10 = "GenericSetup.exe" fullword wide
      $s11 = "destination.video.sciter.com" fullword ascii
      $s12 = "fragmented.destination.video.sciter.com" fullword ascii
      $s13 = "COMMAND_EXEC" fullword ascii
      $s14 = "AppPolicyGetProcessTerminationMethod" fullword ascii
      $s15 = "sciter %s; %s; www.sciter.com)" fullword ascii
      $s16 = "curity><requestedPrivileges><requestedExecutionLevel level=\"requireAdministrator\" uiAccess=\"false\"></requestedExecutionLevel" ascii
      $s17 = "attempt to get property '%s' of NULL" fullword ascii
      $s18 = "attempt to get/set property '%S' on null" fullword ascii
      $s19 = "\\\\.\\pipe\\sciter-" fullword ascii
      $s20 = "attempt to get/set state '%S' on null" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 29000KB and
      1 of ($x*) and 4 of them
}

rule sig_071b6c448d2546dea8caed872fca0d002f59a6b9849f0de2a565fc74b487fa37 {
   meta:
      description = "samples - file 071b6c448d2546dea8caed872fca0d002f59a6b9849f0de2a565fc74b487fa37.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "071b6c448d2546dea8caed872fca0d002f59a6b9849f0de2a565fc74b487fa37"
   strings:
      $s1 = "output.exe" fullword ascii
      $s2 = "AppPolicyGetProcessTerminationMethod" fullword ascii
      $s3 = "GetTempPath2W" fullword ascii
      $s4 = "AppPolicyGetThreadInitializationType" fullword ascii
      $s5 = "<#<L<[<" fullword ascii /* reversed goodware string '<[<L<#<' */
      $s6 = "operator<=>" fullword ascii
      $s7 = "operator co_await" fullword ascii
      $s8 = "4$4+424?4" fullword ascii /* hex encoded string 'DBD' */
      $s9 = ".data$rs" fullword ascii
      $s10 = "SELECT * FROM Customers" fullword ascii
      $s11 = "api-ms-win-appmodel-runtime-l1-1-2" fullword wide
      $s12 = ":(:-:2:B:G:L:\\:a:f:" fullword ascii
      $s13 = "PVSRSQV" fullword ascii
      $s14 = "vector too long" fullword ascii
      $s15 = "Own head" fullword ascii
      $s16 = "+ $y#{" fullword ascii
      $s17 = "CjU- g" fullword ascii
      $s18 = "s3 -`@+" fullword ascii
      $s19 = "- |H?6)a" fullword ascii
      $s20 = "vvgjgO5" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 2000KB and
      8 of them
}

rule sig_1669d57e8c83d0666c86fafcd484a5fd158c995a58ad9a6855c56d849c00b40b {
   meta:
      description = "samples - file 1669d57e8c83d0666c86fafcd484a5fd158c995a58ad9a6855c56d849c00b40b.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "1669d57e8c83d0666c86fafcd484a5fd158c995a58ad9a6855c56d849c00b40b"
   strings:
      $x1 = "JSystem.Private.StackTraceMetadata.dll2System.Private.TypeLoader" fullword ascii
      $x2 = "System.Linq.dllFSystem.Private.Reflection.Execution" fullword ascii
      $x3 = "NSystem.Private.Reflection.Execution.dllBSystem.Private.StackTraceMetadata" fullword ascii
      $s4 = "4System.Private.CoreLib.dll" fullword ascii
      $s5 = "PublicKeyUnspecifiedTypeSize.dll" fullword wide
      $s6 = ":System.Private.TypeLoader.dll8System.Security.Cryptography" fullword ascii
      $s7 = "Could not get process token. Win32 Error Code:" fullword wide
      $s8 = "System.Core, Version=3.5.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089gc" fullword ascii
      $s9 = "System.Runtime, Version=4.2.1.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a,DeserializationTracker,SerializationException*" ascii
      $s10 = "System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" fullword ascii
      $s11 = "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" ascii /* base64 encoded string '                                            ' */
      $s12 = "BSystem.Security.AccessControl.dll" fullword ascii
      $s13 = "JSystem.Security.Principal.Windows.dll" fullword ascii
      $s14 = "TargetvM:System.Security.Cryptography.CryptoConfigForwarder.#cctor" fullword ascii
      $s15 = "The current thread attempted to reacquire a mutex that has reached its maximum acquire count" fullword wide
      $s16 = "System.Collections.Generic.IEnumerator<Internal.Runtime.TypeLoader.TypeLoaderEnvironment.GenericMethodEntry>.get_Current@" fullword ascii
      $s17 = "System.Collections.Generic.IEnumerator<Internal.Runtime.TypeLoader.TypeLoaderEnvironment.GenericTypeEntry>.get_Current@" fullword ascii
      $s18 = "System.Collections.Generic.IEnumerable<Internal.Runtime.TypeLoader.TypeLoaderEnvironment.GenericMethodEntry>.GetEnumerator@" fullword ascii
      $s19 = "System.Collections.Generic.IEnumerable<System.Runtime.Loader.LibraryNameVariation>.GetEnumerator@" fullword ascii
      $s20 = "System.Collections.Generic.IEnumerable<Internal.Runtime.TypeLoader.TypeLoaderEnvironment.GenericTypeEntry>.GetEnumerator@" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 7000KB and
      1 of ($x*) and 4 of them
}

rule sig_542ddd41bf8603c95458d6c2c15e1a0cff107fbabac55b69b92bd40fd8bf1696 {
   meta:
      description = "samples - file 542ddd41bf8603c95458d6c2c15e1a0cff107fbabac55b69b92bd40fd8bf1696.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "542ddd41bf8603c95458d6c2c15e1a0cff107fbabac55b69b92bd40fd8bf1696"
   strings:
      $x1 = "JSystem.Private.StackTraceMetadata.dll2System.Private.TypeLoader" fullword ascii
      $x2 = "System.Linq.dllFSystem.Private.Reflection.Execution" fullword ascii
      $x3 = "NSystem.Private.Reflection.Execution.dllBSystem.Private.StackTraceMetadata" fullword ascii
      $s4 = "4System.Private.CoreLib.dll" fullword ascii
      $s5 = ":System.Private.TypeLoader.dll8System.Security.Cryptography" fullword ascii
      $s6 = "Could not get process token. Win32 Error Code:" fullword wide
      $s7 = "System.Core, Version=3.5.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089gc" fullword ascii
      $s8 = "System.Runtime, Version=4.2.1.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a,DeserializationTracker,SerializationException*" ascii
      $s9 = "System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" fullword ascii
      $s10 = "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" ascii /* base64 encoded string '                                            ' */
      $s11 = "BSystem.Security.AccessControl.dll" fullword ascii
      $s12 = "JSystem.Security.Principal.Windows.dll" fullword ascii
      $s13 = "TargetvM:System.Security.Cryptography.CryptoConfigForwarder.#cctor" fullword ascii
      $s14 = "The current thread attempted to reacquire a mutex that has reached its maximum acquire count" fullword wide
      $s15 = "System.Collections.Generic.IEnumerator<Internal.Runtime.TypeLoader.TypeLoaderEnvironment.GenericMethodEntry>.get_Current@" fullword ascii
      $s16 = "System.Collections.Generic.IEnumerator<Internal.Runtime.TypeLoader.TypeLoaderEnvironment.GenericTypeEntry>.get_Current@" fullword ascii
      $s17 = "System.Collections.Generic.IEnumerable<Internal.Runtime.TypeLoader.TypeLoaderEnvironment.GenericMethodEntry>.GetEnumerator@" fullword ascii
      $s18 = "System.Collections.Generic.IEnumerable<System.Runtime.Loader.LibraryNameVariation>.GetEnumerator@" fullword ascii
      $s19 = "System.Collections.Generic.IEnumerable<Internal.Runtime.TypeLoader.TypeLoaderEnvironment.GenericTypeEntry>.GetEnumerator@" fullword ascii
      $s20 = "System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 6000KB and
      1 of ($x*) and 4 of them
}

rule acad873da34aab461e8a7b87dd2c6d98c3b2b187f5ca868415bac26af1516da5 {
   meta:
      description = "samples - file acad873da34aab461e8a7b87dd2c6d98c3b2b187f5ca868415bac26af1516da5.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "acad873da34aab461e8a7b87dd2c6d98c3b2b187f5ca868415bac26af1516da5"
   strings:
      $x1 = "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?><assembly xmlns=\"urn:schemas-microsoft-com:asm.v1\" manifestVersio" ascii
      $x2 = "<assemblyIdentity version=\"1.0.0.0\" processorArchitecture=\"X86\" name=\"Nullsoft.NSIS.exehead\" type=\"win32\"/><description>" ascii
      $s3 = "<requestedExecutionLevel level=\"asInvoker\" uiAccess=\"false\"/></requestedPrivileges></security></trustInfo><compatibility xml" ascii
      $s4 = "http://www.digicert.com/CPS0" fullword ascii
      $s5 = "5http://cacerts.digicert.com/DigiCertTrustedRootG4.crt0C" fullword ascii
      $s6 = "4http://crl3.digicert.com/DigiCertAssuredIDRootCA.crl0" fullword ascii
      $s7 = "2http://crl3.digicert.com/DigiCertTrustedRootG4.crl0 " fullword ascii
      $s8 = "7http://cacerts.digicert.com/DigiCertAssuredIDRootCA.crt0E" fullword ascii
      $s9 = "2http://crl3.digicert.com/DigiCertTrustedRootG4.crl0" fullword ascii
      $s10 = " Install System v2.46.5-Unicode</description><trustInfo xmlns=\"urn:schemas-microsoft-com:asm.v3\"><security><requestedPrivilege" ascii
      $s11 = "http://ocsp.digicert.com0X" fullword ascii
      $s12 = "http://ocsp.digicert.com0\\" fullword ascii
      $s13 = "Lhttp://cacerts.digicert.com/DigiCertTrustedG4RSA4096SHA256TimeStampingCA.crt0" fullword ascii
      $s14 = "Ihttp://crl3.digicert.com/DigiCertTrustedG4RSA4096SHA256TimeStampingCA.crl0" fullword ascii
      $s15 = "Mhttp://crl3.digicert.com/DigiCertTrustedG4CodeSigningRSA4096SHA3842021CA1.crl0S" fullword ascii
      $s16 = "Phttp://cacerts.digicert.com/DigiCertTrustedG4CodeSigningRSA4096SHA3842021CA1.crt0" fullword ascii
      $s17 = "Mhttp://crl4.digicert.com/DigiCertTrustedG4CodeSigningRSA4096SHA3842021CA1.crl0>" fullword ascii
      $s18 = ")RY* /F" fullword ascii
      $s19 = "ssssgggg" fullword ascii
      $s20 = "[os:\\>T" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 7000KB and
      1 of ($x*) and 4 of them
}

rule sig_7001acf354484cbbb58bbf0bfbfc0644bd629ca6b02c10f8b4e7fd4371c89a99 {
   meta:
      description = "samples - file 7001acf354484cbbb58bbf0bfbfc0644bd629ca6b02c10f8b4e7fd4371c89a99.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "7001acf354484cbbb58bbf0bfbfc0644bd629ca6b02c10f8b4e7fd4371c89a99"
   strings:
      $x1 = "blyIdentity type=\"win32\" name=\"Microsoft.Windows.Common-Controls\" version=\"6.0.0.0\" processorArchitecture=\"x86\" publicKe" ascii
      $x2 = "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?><assembly xmlns=\"urn:schemas-microsoft-com:asm.v1\" manifestVersio" ascii
      $x3 = "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?><assembly xmlns=\"urn:schemas-microsoft-com:asm.v1\" manifestVersio" ascii
      $s4 = "<assemblyIdentity name=\"E.App\" processorArchitecture=\"x86\" version=\"5.2.0.0\" type=\"win32\"/><dependency><dependentAssembl" ascii
      $s5 = "csrss4.exe" fullword ascii
      $s6 = "csrss2.exe" fullword ascii
      $s7 = "e@/Windows Session Manager.exe" fullword ascii
      $s8 = "csrss3.exe" fullword ascii
      $s9 = "csrss5.exe" fullword ascii
      $s10 = "csrss1.exe" fullword ascii
      $s11 = "User-Agent: Mozilla/4.0 (compatible; MSIE 9.0; Windows NT 6.1)" fullword ascii
      $s12 = "(http://www.eyuyan.com)" fullword wide
      $s13 = "http://38.147.172.248:8080/apii.php" fullword ascii
      $s14 = "\\TemporaryFile" fullword ascii
      $s15 = "|xxxx|ey.txt|xxxx|" fullword ascii
      $s16 = "GetTabList" fullword ascii
      $s17 = " but running with " fullword ascii
      $s18 = "GetConnectString" fullword ascii
      $s19 = "#if !defined(AFX_RESOURCE_DLL) || defined(AFX_TARG_CHS)" fullword ascii
      $s20 = "GetAllResponseHeaders" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 5000KB and
      1 of ($x*) and 4 of them
}

rule a228df5184a2c1a2864e8e7872c2ab98718a287ffea2d6c2c4dd65ba85752692 {
   meta:
      description = "samples - file a228df5184a2c1a2864e8e7872c2ab98718a287ffea2d6c2c4dd65ba85752692.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "a228df5184a2c1a2864e8e7872c2ab98718a287ffea2d6c2c4dd65ba85752692"
   strings:
      $x1 = "https://xui.ptlogin2.qq.com/cgi-bin/xlogin?target=self&appid=522005705&daid=4&s_url=https://wx.mail.qq.com/list/readtemplate?nam" ascii
      $x2 = "https://xui.ptlogin2.qq.com/cgi-bin/xlogin?target=self&appid=522005705&daid=4&s_url=https://wx.mail.qq.com/list/readtemplate?nam" ascii
      $x3 = "e=login_jump.html&target=&style=25&low_login=1&proxy_url=https://mail.qq.com/proxy.html&need_qr=0&hide_border=1&border_radius=0&" ascii
      $x4 = "blyIdentity type=\"win32\" name=\"Microsoft.Windows.Common-Controls\" version=\"6.0.0.0\" processorArchitecture=\"x86\" publicKe" ascii
      $x5 = "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?><assembly xmlns=\"urn:schemas-microsoft-com:asm.v1\" manifestVersio" ascii
      $x6 = "https://localhost.ptlogin2.qq.com:" fullword ascii
      $s7 = "cmd.exe /C " fullword ascii
      $s8 = "Referer: https://xui.ptlogin2.qq.com/" fullword ascii
      $s9 = "https://docs.google.com/uc?id=0BxsMXGfPIZfSVzUyaHFYVkQxeFk&export=download" fullword ascii
      $s10 = "smtp.gmail.com" fullword ascii
      $s11 = "https://docs.google.com/uc?id=0BxsMXGfPIZfSTmlVYkxhSDg5TzQ&export=download" fullword ascii
      $s12 = "https://docs.google.com/uc?id=0BxsMXGfPIZfSVlVsOGlEVGxuZVk&export=download" fullword ascii
      $s13 = "/res.mail.qq.com/zh_CN/htmledition/style/ptlogin_input_for_xmail.css&enable_qlogin=0" fullword ascii
      $s14 = "https://www.dropbox.com/s/fzj752whr3ontsm/SSLLibrary.dll?dl=1" fullword ascii
      $s15 = "smtp.163.com" fullword ascii
      $s16 = "http://xred.site50.net/syn/SSLLibrary.dll" fullword ascii
      $s17 = "Synaptics.dll" fullword ascii
      $s18 = "KBHks.dll" fullword ascii
      $s19 = "Injecting -> " fullword ascii
      $s20 = "Synaptics.exe" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 5000KB and
      1 of ($x*) and 4 of them
}

rule sig_623a60c7f9ddbd0f05e1a2c8b82c78240ef5fa4f1bde4504889e6c6817e264dc {
   meta:
      description = "samples - file 623a60c7f9ddbd0f05e1a2c8b82c78240ef5fa4f1bde4504889e6c6817e264dc.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "623a60c7f9ddbd0f05e1a2c8b82c78240ef5fa4f1bde4504889e6c6817e264dc"
   strings:
      $s1 = "http://www.kuma.cz/download/iTV.exe" fullword ascii
      $s2 = " verzi z http://www.kuma.cz/download/iTV.exe" fullword ascii
      $s3 = "        <assemblyIdentity type=\"win32\" name=\"Microsoft.Windows.Common-Controls\" version=\"6.0.0.0\" processorArchitecture=\"" ascii
      $s4 = "<assemblyIdentity name=\"iTV - televizni program\" processorArchitecture=\"x86\" version=\"1.4.0.0\" type=\"win32\"></assemblyId" ascii
      $s5 = "http://www.eurosport.com" fullword ascii
      $s6 = "http://www.extreme.com/" fullword ascii
      $s7 = "http://get.adobe.com/cz/flashplayer" fullword ascii
      $s8 = "http://playlist.yahoo.com/makeplaylist.dll?id=1369080&segment=149773" fullword ascii
      $s9 = "https://play.google.com/store/apps/details?id=com.kuma.gallerywidget" fullword ascii
      $s10 = "http://www.yourdiscovery.com" fullword ascii
      $s11 = "http://www.vh1.com" fullword ascii
      $s12 = "        <assemblyIdentity type=\"win32\" name=\"Microsoft.Windows.Common-Controls\" version=\"6.0.0.0\" processorArchitecture=\"" ascii
      $s13 = "http://www.ta3.com" fullword ascii
      $s14 = "http://www.kuma.cz/download/streams.txt" fullword ascii
      $s15 = "t knihovnu gdiplus.dll do C:/windows/system), Vista, Windows 7" fullword ascii
      $s16 = "SELECT * FROM Win32_Processor" fullword ascii
      $s17 = "http://www.kuma.cz/download/version.bin" fullword ascii
      $s18 = "iTV.exe" fullword ascii
      $s19 = "itv.exe" fullword wide
      $s20 = "debug_orig_%d_%d.txt" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 3000KB and
      8 of them
}

rule sig_5d1c2ac36ca274835d9025eb9e3f7a113cf57509898e02cb9add7a97824cea59 {
   meta:
      description = "samples - file 5d1c2ac36ca274835d9025eb9e3f7a113cf57509898e02cb9add7a97824cea59.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "5d1c2ac36ca274835d9025eb9e3f7a113cf57509898e02cb9add7a97824cea59"
   strings:
      $s1 = "<assemblyIdentity type=\"win32\" name=\"Microsoft.Windows.Common-Controls\" version=\"6.0.0.0\" language=\"*\" processorArchitec" ascii
      $s2 = "/AutoIt3ExecuteScript" fullword wide
      $s3 = "/AutoIt3ExecuteLine" fullword wide
      $s4 = "PROCESSGETSTATS" fullword wide
      $s5 = "WINGETPROCESS" fullword wide
      $s6 = "SCRIPTNAME" fullword wide /* base64 encoded string 'H$H=3@0' */
      $s7 = "SHELLEXECUTE" fullword wide
      $s8 = "SHELLEXECUTEWAIT" fullword wide
      $s9 = "*Unable to get a list of running processes." fullword wide
      $s10 = "HTTPSETUSERAGENT" fullword wide
      $s11 = "PROCESSCLOSE" fullword wide
      $s12 = "PROCESSEXISTS" fullword wide
      $s13 = "PROCESSLIST" fullword wide
      $s14 = "PROCESSSETPRIORITY" fullword wide
      $s15 = "PROCESSWAIT" fullword wide
      $s16 = "PROCESSWAITCLOSE" fullword wide
      $s17 = "PROCESSORARCH" fullword wide
      $s18 = "STRINGREVERSE" fullword wide /* base64 encoded string 'I4H4dDTDR' */
      $s19 = "Error parsing function call.0Incorrect number of parameters in function call.'\"ReDim\" used without an array variable.>Illegal " wide
      $s20 = "CMDLINERAW" fullword wide
   condition:
      uint16(0) == 0x5a4d and filesize < 3000KB and
      8 of them
}

rule sig_788bf2c07ca9619f9e388dc1a068aa4d6c3eb804ea375fb6b575ebe3154e6c54 {
   meta:
      description = "samples - file 788bf2c07ca9619f9e388dc1a068aa4d6c3eb804ea375fb6b575ebe3154e6c54.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "788bf2c07ca9619f9e388dc1a068aa4d6c3eb804ea375fb6b575ebe3154e6c54"
   strings:
      $s1 = "<assemblyIdentity type=\"win32\" name=\"Microsoft.Windows.Common-Controls\" version=\"6.0.0.0\" language=\"*\" processorArchitec" ascii
      $s2 = "/AutoIt3ExecuteScript" fullword wide
      $s3 = "/AutoIt3ExecuteLine" fullword wide
      $s4 = "PROCESSGETSTATS" fullword wide
      $s5 = "WINGETPROCESS" fullword wide
      $s6 = "SCRIPTNAME" fullword wide /* base64 encoded string 'H$H=3@0' */
      $s7 = "SHELLEXECUTE" fullword wide
      $s8 = "SHELLEXECUTEWAIT" fullword wide
      $s9 = "*Unable to get a list of running processes." fullword wide
      $s10 = "HTTPSETUSERAGENT" fullword wide
      $s11 = "PROCESSCLOSE" fullword wide
      $s12 = "PROCESSEXISTS" fullword wide
      $s13 = "PROCESSLIST" fullword wide
      $s14 = "PROCESSSETPRIORITY" fullword wide
      $s15 = "PROCESSWAIT" fullword wide
      $s16 = "PROCESSWAITCLOSE" fullword wide
      $s17 = "PROCESSORARCH" fullword wide
      $s18 = "STRINGREVERSE" fullword wide /* base64 encoded string 'I4H4dDTDR' */
      $s19 = "Error parsing function call.0Incorrect number of parameters in function call.'\"ReDim\" used without an array variable.>Illegal " wide
      $s20 = "CMDLINERAW" fullword wide
   condition:
      uint16(0) == 0x5a4d and filesize < 3000KB and
      8 of them
}

rule f9ae0d40d4f2b88956a1ccfe6cff9aae6a36508574a56595c331d7ca207e5f03 {
   meta:
      description = "samples - file f9ae0d40d4f2b88956a1ccfe6cff9aae6a36508574a56595c331d7ca207e5f03.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "f9ae0d40d4f2b88956a1ccfe6cff9aae6a36508574a56595c331d7ca207e5f03"
   strings:
      $s1 = "<assemblyIdentity type=\"win32\" name=\"Microsoft.Windows.Common-Controls\" version=\"6.0.0.0\" language=\"*\" processorArchitec" ascii
      $s2 = "/AutoIt3ExecuteScript" fullword wide
      $s3 = "/AutoIt3ExecuteLine" fullword wide
      $s4 = "PROCESSGETSTATS" fullword wide
      $s5 = "WINGETPROCESS" fullword wide
      $s6 = "SCRIPTNAME" fullword wide /* base64 encoded string 'H$H=3@0' */
      $s7 = "SHELLEXECUTE" fullword wide
      $s8 = "SHELLEXECUTEWAIT" fullword wide
      $s9 = "*Unable to get a list of running processes." fullword wide
      $s10 = "HTTPSETUSERAGENT" fullword wide
      $s11 = "PROCESSCLOSE" fullword wide
      $s12 = "PROCESSEXISTS" fullword wide
      $s13 = "PROCESSLIST" fullword wide
      $s14 = "PROCESSSETPRIORITY" fullword wide
      $s15 = "PROCESSWAIT" fullword wide
      $s16 = "PROCESSWAITCLOSE" fullword wide
      $s17 = "PROCESSORARCH" fullword wide
      $s18 = "STRINGREVERSE" fullword wide /* base64 encoded string 'I4H4dDTDR' */
      $s19 = "Error parsing function call.0Incorrect number of parameters in function call.'\"ReDim\" used without an array variable.>Illegal " wide
      $s20 = "CMDLINERAW" fullword wide
   condition:
      uint16(0) == 0x5a4d and filesize < 3000KB and
      8 of them
}

rule sig_2c38956763bb9c8df8d9eb32a8f30252e3e4ac0249f650f609d0036a16e01b9e {
   meta:
      description = "samples - file 2c38956763bb9c8df8d9eb32a8f30252e3e4ac0249f650f609d0036a16e01b9e.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "2c38956763bb9c8df8d9eb32a8f30252e3e4ac0249f650f609d0036a16e01b9e"
   strings:
      $s1 = "<assemblyIdentity type=\"win32\" name=\"Microsoft.Windows.Common-Controls\" version=\"6.0.0.0\" language=\"*\" processorArchitec" ascii
      $s2 = "/AutoIt3ExecuteScript" fullword wide
      $s3 = "/AutoIt3ExecuteLine" fullword wide
      $s4 = "PROCESSGETSTATS" fullword wide
      $s5 = "WINGETPROCESS" fullword wide
      $s6 = "SCRIPTNAME" fullword wide /* base64 encoded string 'H$H=3@0' */
      $s7 = "SHELLEXECUTE" fullword wide
      $s8 = "SHELLEXECUTEWAIT" fullword wide
      $s9 = "*Unable to get a list of running processes." fullword wide
      $s10 = "HTTPSETUSERAGENT" fullword wide
      $s11 = "PROCESSCLOSE" fullword wide
      $s12 = "PROCESSEXISTS" fullword wide
      $s13 = "PROCESSLIST" fullword wide
      $s14 = "PROCESSSETPRIORITY" fullword wide
      $s15 = "PROCESSWAIT" fullword wide
      $s16 = "PROCESSWAITCLOSE" fullword wide
      $s17 = "PROCESSORARCH" fullword wide
      $s18 = "STRINGREVERSE" fullword wide /* base64 encoded string 'I4H4dDTDR' */
      $s19 = "Error parsing function call.0Incorrect number of parameters in function call.'\"ReDim\" used without an array variable.>Illegal " wide
      $s20 = "CMDLINERAW" fullword wide
   condition:
      uint16(0) == 0x5a4d and filesize < 3000KB and
      8 of them
}

rule sig_172f9d447a5f9c686cb8a5322558e39c07fb960631c08c2e0d15cd14f12e1e63 {
   meta:
      description = "samples - file 172f9d447a5f9c686cb8a5322558e39c07fb960631c08c2e0d15cd14f12e1e63.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "172f9d447a5f9c686cb8a5322558e39c07fb960631c08c2e0d15cd14f12e1e63"
   strings:
      $x1 = "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?><assembly xmlns=\"urn:schemas-microsoft-com:asm.v1\" manifestVersio" ascii
      $x2 = "s.Common-Controls\" version=\"6.0.0.0\" processorArchitecture=\"*\" publicKeyToken=\"6595b64144ccf1df\" language=\"*\" /></depen" ascii
      $x3 = "<assemblyIdentity version=\"1.0.0.0\" processorArchitecture=\"*\" name=\"Nullsoft.NSIS.exehead\" type=\"win32\"/><description>Nu" ascii
      $s4 = "bly></dependency><trustInfo xmlns=\"urn:schemas-microsoft-com:asm.v3\"><security><requestedPrivileges><requestedExecutionLevel l" ascii
      $s5 = "%s%S.dll" fullword wide
      $s6 = "(Symantec SHA256 TimeStamping Signer - G3" fullword ascii
      $s7 = "(Symantec SHA256 TimeStamping Signer - G30" fullword ascii
      $s8 = "cancerigenic startles.exe" fullword wide
      $s9 = "el=\"asInvoker\" uiAccess=\"false\"/></requestedPrivileges></security></trustInfo><compatibility xmlns=\"urn:schemas-microsoft-c" ascii
      $s10 = "nstall System v20-Jun-2022.cvs</description><dependency><dependentAssembly><assemblyIdentity type=\"win32\" name=\"Microsoft.Win" ascii
      $s11 = "'mandater Hestehandlernes Onomatologist 1" fullword ascii
      $s12 = "CRYPTBASE" fullword ascii
      $s13 = "%Regionplanretningslinjen@Shareable.Af0" fullword ascii
      $s14 = "-83d0f6d0da78}\"/><supportedOS Id=\"{4a2f28e3-53b9-4441-ba9c-d69d4a4a6e38}\"/><supportedOS Id=\"{35138b9a-5d96-4fbd-8e2d-a244022" ascii
      $s15 = "%Regionplanretningslinjen@Shareable.Af" fullword ascii
      $s16 = "PROPSYS" fullword ascii
      $s17 = "UXTHEME" fullword ascii
      $s18 = "NTMARTA" fullword ascii
      $s19 = "APPHELP" fullword ascii
      $s20 = "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?><assembly xmlns=\"urn:schemas-microsoft-com:asm.v1\" manifestVersio" ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 1000KB and
      1 of ($x*) and 4 of them
}

rule sig_76c26de3a458e5cc615fb37d0b6481a1260e6b62cc7e801a45210693f381ece7 {
   meta:
      description = "samples - file 76c26de3a458e5cc615fb37d0b6481a1260e6b62cc7e801a45210693f381ece7.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "76c26de3a458e5cc615fb37d0b6481a1260e6b62cc7e801a45210693f381ece7"
   strings:
      $x1 = "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?><assembly xmlns=\"urn:schemas-microsoft-com:asm.v1\" manifestVersio" ascii
      $x2 = "<assemblyIdentity version=\"1.0.0.0\" processorArchitecture=\"*\" name=\"Nullsoft.NSIS.exehead\" type=\"win32\"/><description>Nu" ascii
      $s3 = "requestedExecutionLevel level=\"asInvoker\" uiAccess=\"false\"/></requestedPrivileges></security></trustInfo><compatibility xmln" ascii
      $s4 = "%s%S.dll" fullword wide
      $s5 = "nstall System v22-May-2024.cvs</description><trustInfo xmlns=\"urn:schemas-microsoft-com:asm.v3\"><security><requestedPrivileges" ascii
      $s6 = "http://www.digicert.com/CPS0" fullword ascii
      $s7 = "5http://cacerts.digicert.com/DigiCertTrustedRootG4.crt0C" fullword ascii
      $s8 = "4http://crl3.digicert.com/DigiCertAssuredIDRootCA.crl0" fullword ascii
      $s9 = "2http://crl3.digicert.com/DigiCertTrustedRootG4.crl0 " fullword ascii
      $s10 = "7http://cacerts.digicert.com/DigiCertAssuredIDRootCA.crt0E" fullword ascii
      $s11 = "2http://crl3.digicert.com/DigiCertTrustedRootG4.crl0" fullword ascii
      $s12 = "http://ocsp.digicert.com0X" fullword ascii
      $s13 = "http://ocsp.digicert.com0\\" fullword ascii
      $s14 = "Lhttp://cacerts.digicert.com/DigiCertTrustedG4RSA4096SHA256TimeStampingCA.crt0" fullword ascii
      $s15 = "Ihttp://crl3.digicert.com/DigiCertTrustedG4RSA4096SHA256TimeStampingCA.crl0" fullword ascii
      $s16 = "Mhttp://crl3.digicert.com/DigiCertTrustedG4CodeSigningRSA4096SHA3842021CA1.crl0S" fullword ascii
      $s17 = "Phttp://cacerts.digicert.com/DigiCertTrustedG4CodeSigningRSA4096SHA3842021CA1.crt0" fullword ascii
      $s18 = "Mhttp://crl4.digicert.com/DigiCertTrustedG4CodeSigningRSA4096SHA3842021CA1.crl0>" fullword ascii
      $s19 = "~nsu%X.tmp" fullword wide
      $s20 = "https://notepad-plus-plus.org/0" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 3000KB and
      1 of ($x*) and 4 of them
}

rule sig_5d87bd723f8267c3c0bef75f2b502321c518ac6a09696f3971ace53d0ba505cd {
   meta:
      description = "samples - file 5d87bd723f8267c3c0bef75f2b502321c518ac6a09696f3971ace53d0ba505cd.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "5d87bd723f8267c3c0bef75f2b502321c518ac6a09696f3971ace53d0ba505cd"
   strings:
      $s1 = "585B55494F65" ascii /* hex encoded string 'X[UIOe' */
      $s2 = "Microsoft Windows Run DLL" fullword wide
      $s3 = "Microsoft Windows Run DLL 2020" fullword wide
      $s4 = "?TempGdi" fullword ascii
      $s5 = " HKEY_CLARES_ROOT#$" fullword ascii
      $s6 = "euoGetM it" fullword ascii
      $s7 = "* Me`t#8UP+" fullword ascii
      $s8 = "0 VisUC++ RALi" fullword ascii
      $s9 = "xXNTLMo" fullword ascii
      $s10 = "WCmdTar*t" fullword ascii
      $s11 = "cCMDsh6?b" fullword ascii
      $s12 = "2WINSPOOL.DRVB" fullword ascii
      $s13 = "Z?UserExcep" fullword ascii
      $s14 = "3695E:\"v9" fullword ascii
      $s15 = ":\\Dll1\\x64\\" fullword ascii
      $s16 = "5.2.0.0" fullword wide
      $s17 = "NotSuppor1" fullword ascii
      $s18 = "CWinApp6" fullword ascii
      $s19 = "lowiqa" fullword ascii
      $s20 = "bypzcqu6" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 800KB and
      8 of them
}

rule sig_5c483ed90d904d0d81967c91ac431a2c27228fd9562dd2f2e3f003644c59076e {
   meta:
      description = "samples - file 5c483ed90d904d0d81967c91ac431a2c27228fd9562dd2f2e3f003644c59076e.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "5c483ed90d904d0d81967c91ac431a2c27228fd9562dd2f2e3f003644c59076e"
   strings:
      $x1 = "Invalid SQL date/time values=Error decoding URL style (%%XX) encoded string at position %d1Invalid URL encoded character (%s) at" wide
      $s2 = "Component %s not foundDGetting the Count of a TComponentsEnumerator object is not supportedWComponent was expected to implement " wide
      $s3 = "xercesxmldom.dll" fullword ascii
      $s4 = "Variable not found: %s=Component does not support scripting. Class: %0:s, Name: %1:s.Object does not support scripting. Class: %" wide
      $s5 = "TXmlStandardProcessorAgent" fullword ascii
      $s6 = "TXmlCustomProcessorAgent" fullword ascii
      $s7 = "TXmlCustomProcessorAgent@wG" fullword ascii
      $s8 = "processorAgent" fullword ascii
      $s9 = "Invalid processing instruction error." fullword ascii
      $s10 = "TXmlProcessorErrorEvent" fullword ascii
      $s11 = "http://www.borland.com/namespaces/Types" fullword wide
      $s12 = "TXmlProcessorEvent4" fullword ascii
      $s13 = "TXmlProcessorEvent3" fullword ascii
      $s14 = "TXmlProcessorEvent1" fullword ascii
      $s15 = "TXmlProcessorEvent16" fullword ascii
      $s16 = "TXmlProcessorEvent15" fullword ascii
      $s17 = "TXmlProcessorEvent12" fullword ascii
      $s18 = "TXmlProcessorEvent5" fullword ascii
      $s19 = "TXmlProcessorEvent6" fullword ascii
      $s20 = "TXmlProcessorEvent11" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 7000KB and
      1 of ($x*) and 4 of them
}

rule sig_159e547225b9f035bf95279055d66810149fa93debea660766552008271e3e5c {
   meta:
      description = "samples - file 159e547225b9f035bf95279055d66810149fa93debea660766552008271e3e5c.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "159e547225b9f035bf95279055d66810149fa93debea660766552008271e3e5c"
   strings:
      $x1 = "Invalid SQL date/time values=Error decoding URL style (%%XX) encoded string at position %d1Invalid URL encoded character (%s) at" wide
      $s2 = "Component %s not foundDGetting the Count of a TComponentsEnumerator object is not supportedWComponent was expected to implement " wide
      $s3 = "xercesxmldom.dll" fullword ascii
      $s4 = "Variable not found: %s=Component does not support scripting. Class: %0:s, Name: %1:s.Object does not support scripting. Class: %" wide
      $s5 = "TXmlStandardProcessorAgent" fullword ascii
      $s6 = "TXmlCustomProcessorAgent" fullword ascii
      $s7 = "TXmlCustomProcessorAgent@wG" fullword ascii
      $s8 = "processorAgent" fullword ascii
      $s9 = "Invalid processing instruction error." fullword ascii
      $s10 = "TXmlProcessorErrorEvent" fullword ascii
      $s11 = "http://www.borland.com/namespaces/Types" fullword wide
      $s12 = "TXmlProcessorEvent4" fullword ascii
      $s13 = "TXmlProcessorEvent3" fullword ascii
      $s14 = "TXmlProcessorEvent1" fullword ascii
      $s15 = "TXmlProcessorEvent16" fullword ascii
      $s16 = "TXmlProcessorEvent15" fullword ascii
      $s17 = "TXmlProcessorEvent12" fullword ascii
      $s18 = "TXmlProcessorEvent5" fullword ascii
      $s19 = "TXmlProcessorEvent6" fullword ascii
      $s20 = "TXmlProcessorEvent11" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 7000KB and
      1 of ($x*) and 4 of them
}

rule sig_07be352dde09851de71ce7c763537e2b5c567e52fd161304cbaa54895dcd5c8f {
   meta:
      description = "samples - file 07be352dde09851de71ce7c763537e2b5c567e52fd161304cbaa54895dcd5c8f.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "07be352dde09851de71ce7c763537e2b5c567e52fd161304cbaa54895dcd5c8f"
   strings:
      $x1 = "Invalid SQL date/time values=Error decoding URL style (%%XX) encoded string at position %d1Invalid URL encoded character (%s) at" wide
      $s2 = "Component %s not foundDGetting the Count of a TComponentsEnumerator object is not supportedWComponent was expected to implement " wide
      $s3 = "xercesxmldom.dll" fullword ascii
      $s4 = "Variable not found: %s=Component does not support scripting. Class: %0:s, Name: %1:s.Object does not support scripting. Class: %" wide
      $s5 = "TXmlStandardProcessorAgent" fullword ascii
      $s6 = "TXmlCustomProcessorAgent" fullword ascii
      $s7 = "TXmlCustomProcessorAgent@wG" fullword ascii
      $s8 = "processorAgent" fullword ascii
      $s9 = "Invalid processing instruction error." fullword ascii
      $s10 = "TXmlProcessorErrorEvent" fullword ascii
      $s11 = "http://www.borland.com/namespaces/Types" fullword wide
      $s12 = "TXmlProcessorEvent4" fullword ascii
      $s13 = "TXmlProcessorEvent3" fullword ascii
      $s14 = "TXmlProcessorEvent1" fullword ascii
      $s15 = "TXmlProcessorEvent16" fullword ascii
      $s16 = "TXmlProcessorEvent15" fullword ascii
      $s17 = "TXmlProcessorEvent12" fullword ascii
      $s18 = "TXmlProcessorEvent5" fullword ascii
      $s19 = "TXmlProcessorEvent6" fullword ascii
      $s20 = "TXmlProcessorEvent11" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 7000KB and
      1 of ($x*) and 4 of them
}

rule sig_4ce01fbc21be01f22310224cf6651b1d3aeee5e4569be63d8e8c78e785fcf119 {
   meta:
      description = "samples - file 4ce01fbc21be01f22310224cf6651b1d3aeee5e4569be63d8e8c78e785fcf119.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "4ce01fbc21be01f22310224cf6651b1d3aeee5e4569be63d8e8c78e785fcf119"
   strings:
      $x1 = "C:\\Windows\\System32\\cmd.exe" fullword ascii
      $x2 = "C:\\Users\\Administrator\\Desktop\\packed_remcos.exe" fullword ascii
      $x3 = "/k %windir%\\System32\\reg.exe ADD HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System /v EnableLUA /t REG_DWOR" ascii
      $x4 = "/k %windir%\\System32\\reg.exe ADD HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System /v EnableLUA /t REG_DWOR" ascii
      $x5 = "C:\\WINDOWS\\system32\\userinit.exe" fullword ascii
      $s6 = "C:\\WINDOWS\\system32\\userinit.exe, " fullword ascii
      $s7 = "\\AppData\\Roaming\\Mozilla\\Firefox\\Profiles\\" fullword ascii
      $s8 = "\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\Login Data" fullword ascii
      $s9 = "eventvwr.exe" fullword ascii
      $s10 = "PING 127.0.0.1 -n 2 " fullword ascii
      $s11 = "remscriptexecd" fullword ascii
      $s12 = "execcom" fullword ascii
      $s13 = "clearlogins" fullword ascii
      $s14 = "getofflinelogs" fullword ascii
      $s15 = "autogetofflinelogs" fullword ascii
      $s16 = "update.bat" fullword ascii
      $s17 = "mscfile\\shell\\open\\command" fullword ascii
      $s18 = "deletekeylog" fullword ascii
      $s19 = "\\logins.json" fullword ascii
      $s20 = "[Chrome StoredLogins not found]" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 300KB and
      1 of ($x*) and 4 of them
}

rule sig_41d652145e82ff966b3a820b490f0fe7d3850c2916c5f4d3522536fec53017e5 {
   meta:
      description = "samples - file 41d652145e82ff966b3a820b490f0fe7d3850c2916c5f4d3522536fec53017e5.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "41d652145e82ff966b3a820b490f0fe7d3850c2916c5f4d3522536fec53017e5"
   strings:
      $s1 = "/c powershell -inputformat none -outputformat none -NonInteractive -Command Add-MpPreference -ExclusionPath $ENV:userprofile" fullword wide
      $s2 = "      <assemblyIdentity type=\"win32\" name=\"Microsoft.VC90.CRT\" version=\"9.0.21022.8\" processorArchitecture=\"x86\" publicK" ascii
      $s3 = "      <assemblyIdentity type=\"win32\" name=\"Microsoft.VC90.CRT\" version=\"9.0.21022.8\" processorArchitecture=\"x86\" publicK" ascii
      $s4 = "AntiSpywareOverride" fullword ascii
      $s5 = "SYSTEM\\CurrentControlSet\\Services\\wuauserv" fullword wide
      $s6 = "        <requestedExecutionLevel level=\"requireAdministrator\"></requestedExecutionLevel>" fullword ascii
      $s7 = "SYSTEM\\CurrentControlSet\\Services\\UsoSvc" fullword wide
      $s8 = "SYSTEM\\CurrentControlSet\\Services\\WaaSMedicSvc" fullword wide
      $s9 = "SYSTEM\\CurrentControlSet\\Services\\DoSvc" fullword wide
      $s10 = "SYSTEM\\CurrentControlSet\\Services\\BITS" fullword wide
      $s11 = "FirewallOverride" fullword ascii
      $s12 = "UpdatesOverride" fullword ascii
      $s13 = "AntiVirusOverride" fullword ascii
      $s14 = "  <trustInfo xmlns=\"urn:schemas-microsoft-com:asm.v3\">" fullword ascii
      $s15 = "/c sc stop UsoSvc & sc stop WaaSMedicSvc & sc stop wuauserv & sc stop DoSvc & sc stop BITS" fullword wide
      $s16 = "NGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGX" fullword ascii
      $s17 = "NGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDI" ascii
      $s18 = "AntiVirusDisableNotify" fullword ascii /* Goodware String - occured 6 times */
      $s19 = "WindowsUpdate" fullword wide /* Goodware String - occured 19 times */
      $s20 = "_invoke_watson" fullword ascii /* Goodware String - occured 329 times */
   condition:
      uint16(0) == 0x5a4d and filesize < 30KB and
      8 of them
}

rule sig_16335a1172a838611368645dab4446c79b750e3159a6d9f95556d420c559f469 {
   meta:
      description = "samples - file 16335a1172a838611368645dab4446c79b750e3159a6d9f95556d420c559f469.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "16335a1172a838611368645dab4446c79b750e3159a6d9f95556d420c559f469"
   strings:
      $x1 = "{System.ComponentModel.Design.BinaryEditor, System.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3auSys" ascii
      $x2 = "System.Diagnostics.EventLog.Messages.dll" fullword wide
      $s3 = "ControlledExecution.Run method may corrupt the process and should not be used in production code." fullword wide
      $s4 = "tem.Drawing.Design.UITypeEditor, System.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a" fullword ascii
      $s5 = "System.Runtime.InteropServices.StringMarshalling, System.Runtime.InteropServices, Version=8.0.0.0, Culture=neutral, PublicKeyTok" ascii
      $s6 = "System.Runtime.InteropServices.StringMarshalling, System.Runtime.InteropServices, Version=8.0.0.0, Culture=neutral, PublicKeyTok" ascii
      $s7 = "BCrypt.dll" fullword wide
      $s8 = "msquic.dll" fullword wide
      $s9 = "avtry.exe" fullword wide
      $s10 = "The Constrained Execution Region (CER) feature is not supported." fullword wide
      $s11 = "PublicKey.Key is obsolete. Use the appropriate method to get the public key, such as GetRSAPublicKey." fullword wide
      $s12 = "<EvtGetLogInfo>g____PInvoke|52_0" fullword ascii
      $s13 = "AssemblyName members HashAlgorithm, ProcessorArchitecture, and VersionCompatibility are obsolete and not supported." fullword wide
      $s14 = "FxResources.System.Diagnostics.EventLog.SR.resources" fullword ascii
      $s15 = "FxResources.System.Diagnostics.EventLog" fullword ascii
      $s16 = "    <!-- System.Resources.UseSystemResourceKeys removes resource strings and instead uses the resource key as the exception mess" ascii
      $s17 = "JMicrosoft.Win32.UnsafeNativeMethods+EvtRpcLogin+Marshaller+ValueMarshaller" fullword ascii
      $s18 = "RuntimeEnvironment members SystemConfigurationFile, GetRuntimeInterfaceAsIntPtr, and GetRuntimeInterfaceAsObject are not support" wide
      $s19 = "Rfc2898DeriveBytes.CryptDeriveKey is obsolete and is not supported. Use PasswordDeriveBytes.CryptDeriveKey instead." fullword wide
      $s20 = "ECDiffieHellmanPublicKey.ToByteArray() and the associated constructor do not have a consistent and interoperable implementation " wide
   condition:
      uint16(0) == 0x5a4d and filesize < 1000KB and
      1 of ($x*) and 4 of them
}

rule da6b0f4662ab7c277189dafa7f323551c54982b2d54466feefc27d83a3c90e3c {
   meta:
      description = "samples - file da6b0f4662ab7c277189dafa7f323551c54982b2d54466feefc27d83a3c90e3c.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "da6b0f4662ab7c277189dafa7f323551c54982b2d54466feefc27d83a3c90e3c"
   strings:
      $x1 = "{System.ComponentModel.Design.BinaryEditor, System.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3auSys" ascii
      $x2 = "System.Diagnostics.EventLog.Messages.dll" fullword wide
      $s3 = "ControlledExecution.Run method may corrupt the process and should not be used in production code." fullword wide
      $s4 = "tem.Drawing.Design.UITypeEditor, System.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a" fullword ascii
      $s5 = "System.Runtime.InteropServices.StringMarshalling, System.Runtime.InteropServices, Version=8.0.0.0, Culture=neutral, PublicKeyTok" ascii
      $s6 = "System.Runtime.InteropServices.StringMarshalling, System.Runtime.InteropServices, Version=8.0.0.0, Culture=neutral, PublicKeyTok" ascii
      $s7 = "BCrypt.dll" fullword wide
      $s8 = "msquic.dll" fullword wide
      $s9 = "avtry.exe" fullword wide
      $s10 = "The Constrained Execution Region (CER) feature is not supported." fullword wide
      $s11 = "PublicKey.Key is obsolete. Use the appropriate method to get the public key, such as GetRSAPublicKey." fullword wide
      $s12 = "<EvtGetLogInfo>g____PInvoke|52_0" fullword ascii
      $s13 = "AssemblyName members HashAlgorithm, ProcessorArchitecture, and VersionCompatibility are obsolete and not supported." fullword wide
      $s14 = "FxResources.System.Diagnostics.EventLog.SR.resources" fullword ascii
      $s15 = "FxResources.System.Diagnostics.EventLog" fullword ascii
      $s16 = "    <!-- System.Resources.UseSystemResourceKeys removes resource strings and instead uses the resource key as the exception mess" ascii
      $s17 = "JMicrosoft.Win32.UnsafeNativeMethods+EvtRpcLogin+Marshaller+ValueMarshaller" fullword ascii
      $s18 = "RuntimeEnvironment members SystemConfigurationFile, GetRuntimeInterfaceAsIntPtr, and GetRuntimeInterfaceAsObject are not support" wide
      $s19 = "Rfc2898DeriveBytes.CryptDeriveKey is obsolete and is not supported. Use PasswordDeriveBytes.CryptDeriveKey instead." fullword wide
      $s20 = "ECDiffieHellmanPublicKey.ToByteArray() and the associated constructor do not have a consistent and interoperable implementation " wide
   condition:
      uint16(0) == 0x5a4d and filesize < 1000KB and
      1 of ($x*) and 4 of them
}

rule c5c9fb0b1e4ba8aed4f8cefb1d77931dd2d5137d6396b7c30630b2864303ee52 {
   meta:
      description = "samples - file c5c9fb0b1e4ba8aed4f8cefb1d77931dd2d5137d6396b7c30630b2864303ee52.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "c5c9fb0b1e4ba8aed4f8cefb1d77931dd2d5137d6396b7c30630b2864303ee52"
   strings:
      $x1 = "{System.ComponentModel.Design.BinaryEditor, System.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3auSys" ascii
      $x2 = "System.Diagnostics.EventLog.Messages.dll" fullword wide
      $s3 = "ControlledExecution.Run method may corrupt the process and should not be used in production code." fullword wide
      $s4 = "tem.Drawing.Design.UITypeEditor, System.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a" fullword ascii
      $s5 = "System.Runtime.InteropServices.StringMarshalling, System.Runtime.InteropServices, Version=8.0.0.0, Culture=neutral, PublicKeyTok" ascii
      $s6 = "System.Runtime.InteropServices.StringMarshalling, System.Runtime.InteropServices, Version=8.0.0.0, Culture=neutral, PublicKeyTok" ascii
      $s7 = "BCrypt.dll" fullword wide
      $s8 = "msquic.dll" fullword wide
      $s9 = "avtry.exe" fullword wide
      $s10 = "The Constrained Execution Region (CER) feature is not supported." fullword wide
      $s11 = "PublicKey.Key is obsolete. Use the appropriate method to get the public key, such as GetRSAPublicKey." fullword wide
      $s12 = "<EvtGetLogInfo>g____PInvoke|52_0" fullword ascii
      $s13 = "AssemblyName members HashAlgorithm, ProcessorArchitecture, and VersionCompatibility are obsolete and not supported." fullword wide
      $s14 = "FxResources.System.Diagnostics.EventLog.SR.resources" fullword ascii
      $s15 = "FxResources.System.Diagnostics.EventLog" fullword ascii
      $s16 = "    <!-- System.Resources.UseSystemResourceKeys removes resource strings and instead uses the resource key as the exception mess" ascii
      $s17 = "JMicrosoft.Win32.UnsafeNativeMethods+EvtRpcLogin+Marshaller+ValueMarshaller" fullword ascii
      $s18 = "RuntimeEnvironment members SystemConfigurationFile, GetRuntimeInterfaceAsIntPtr, and GetRuntimeInterfaceAsObject are not support" wide
      $s19 = "Rfc2898DeriveBytes.CryptDeriveKey is obsolete and is not supported. Use PasswordDeriveBytes.CryptDeriveKey instead." fullword wide
      $s20 = "ECDiffieHellmanPublicKey.ToByteArray() and the associated constructor do not have a consistent and interoperable implementation " wide
   condition:
      uint16(0) == 0x5a4d and filesize < 1000KB and
      1 of ($x*) and 4 of them
}

rule a163d18a93ea4bee62762da2d1dfc7d0a2644428fc868fabcb4347cbcf17cc62 {
   meta:
      description = "samples - file a163d18a93ea4bee62762da2d1dfc7d0a2644428fc868fabcb4347cbcf17cc62.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "a163d18a93ea4bee62762da2d1dfc7d0a2644428fc868fabcb4347cbcf17cc62"
   strings:
      $x1 = "{System.ComponentModel.Design.BinaryEditor, System.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3auSys" ascii
      $x2 = "System.Diagnostics.EventLog.Messages.dll" fullword wide
      $s3 = "ControlledExecution.Run method may corrupt the process and should not be used in production code." fullword wide
      $s4 = "tem.Drawing.Design.UITypeEditor, System.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a" fullword ascii
      $s5 = "System.Runtime.InteropServices.StringMarshalling, System.Runtime.InteropServices, Version=8.0.0.0, Culture=neutral, PublicKeyTok" ascii
      $s6 = "System.Runtime.InteropServices.StringMarshalling, System.Runtime.InteropServices, Version=8.0.0.0, Culture=neutral, PublicKeyTok" ascii
      $s7 = "BCrypt.dll" fullword wide
      $s8 = "msquic.dll" fullword wide
      $s9 = "avtry.exe" fullword wide
      $s10 = "The Constrained Execution Region (CER) feature is not supported." fullword wide
      $s11 = "PublicKey.Key is obsolete. Use the appropriate method to get the public key, such as GetRSAPublicKey." fullword wide
      $s12 = "<EvtGetLogInfo>g____PInvoke|52_0" fullword ascii
      $s13 = "AssemblyName members HashAlgorithm, ProcessorArchitecture, and VersionCompatibility are obsolete and not supported." fullword wide
      $s14 = "FxResources.System.Diagnostics.EventLog.SR.resources" fullword ascii
      $s15 = "FxResources.System.Diagnostics.EventLog" fullword ascii
      $s16 = "    <!-- System.Resources.UseSystemResourceKeys removes resource strings and instead uses the resource key as the exception mess" ascii
      $s17 = "JMicrosoft.Win32.UnsafeNativeMethods+EvtRpcLogin+Marshaller+ValueMarshaller" fullword ascii
      $s18 = "RuntimeEnvironment members SystemConfigurationFile, GetRuntimeInterfaceAsIntPtr, and GetRuntimeInterfaceAsObject are not support" wide
      $s19 = "Rfc2898DeriveBytes.CryptDeriveKey is obsolete and is not supported. Use PasswordDeriveBytes.CryptDeriveKey instead." fullword wide
      $s20 = "ECDiffieHellmanPublicKey.ToByteArray() and the associated constructor do not have a consistent and interoperable implementation " wide
   condition:
      uint16(0) == 0x5a4d and filesize < 1000KB and
      1 of ($x*) and 4 of them
}

rule sig_438c9ce6e0b21ec7623f86a2f3e7f1810df1afce1515a5f24d1453a5cacdd74d {
   meta:
      description = "samples - file 438c9ce6e0b21ec7623f86a2f3e7f1810df1afce1515a5f24d1453a5cacdd74d.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "438c9ce6e0b21ec7623f86a2f3e7f1810df1afce1515a5f24d1453a5cacdd74d"
   strings:
      $x1 = "{System.ComponentModel.Design.BinaryEditor, System.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3auSys" ascii
      $x2 = "System.Diagnostics.EventLog.Messages.dll" fullword wide
      $s3 = "ControlledExecution.Run method may corrupt the process and should not be used in production code." fullword wide
      $s4 = "tem.Drawing.Design.UITypeEditor, System.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a" fullword ascii
      $s5 = "System.Runtime.InteropServices.StringMarshalling, System.Runtime.InteropServices, Version=8.0.0.0, Culture=neutral, PublicKeyTok" ascii
      $s6 = "System.Runtime.InteropServices.StringMarshalling, System.Runtime.InteropServices, Version=8.0.0.0, Culture=neutral, PublicKeyTok" ascii
      $s7 = "BCrypt.dll" fullword wide
      $s8 = "msquic.dll" fullword wide
      $s9 = "avtry.exe" fullword wide
      $s10 = "The Constrained Execution Region (CER) feature is not supported." fullword wide
      $s11 = "PublicKey.Key is obsolete. Use the appropriate method to get the public key, such as GetRSAPublicKey." fullword wide
      $s12 = "<EvtGetLogInfo>g____PInvoke|52_0" fullword ascii
      $s13 = "AssemblyName members HashAlgorithm, ProcessorArchitecture, and VersionCompatibility are obsolete and not supported." fullword wide
      $s14 = "FxResources.System.Diagnostics.EventLog.SR.resources" fullword ascii
      $s15 = "FxResources.System.Diagnostics.EventLog" fullword ascii
      $s16 = "    <!-- System.Resources.UseSystemResourceKeys removes resource strings and instead uses the resource key as the exception mess" ascii
      $s17 = "JMicrosoft.Win32.UnsafeNativeMethods+EvtRpcLogin+Marshaller+ValueMarshaller" fullword ascii
      $s18 = "RuntimeEnvironment members SystemConfigurationFile, GetRuntimeInterfaceAsIntPtr, and GetRuntimeInterfaceAsObject are not support" wide
      $s19 = "Rfc2898DeriveBytes.CryptDeriveKey is obsolete and is not supported. Use PasswordDeriveBytes.CryptDeriveKey instead." fullword wide
      $s20 = "ECDiffieHellmanPublicKey.ToByteArray() and the associated constructor do not have a consistent and interoperable implementation " wide
   condition:
      uint16(0) == 0x5a4d and filesize < 1000KB and
      1 of ($x*) and 4 of them
}

rule f96b03987d5a39f6d1172f022a2e3bf15a31c18f5b38a5ce77c682c36dd791c9 {
   meta:
      description = "samples - file f96b03987d5a39f6d1172f022a2e3bf15a31c18f5b38a5ce77c682c36dd791c9.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "f96b03987d5a39f6d1172f022a2e3bf15a31c18f5b38a5ce77c682c36dd791c9"
   strings:
      $x1 = "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?><assembly xmlns=\"urn:schemas-microsoft-com:asm.v1\" manifestVersio" ascii
      $x2 = "<assemblyIdentity version=\"1.0.0.0\" processorArchitecture=\"*\" name=\"Nullsoft.NSIS.exehead\" type=\"win32\"/><description>Nu" ascii
      $s3 = "knaphedssamfundet.exe" fullword wide
      $s4 = "nstall System v3.01</description><trustInfo xmlns=\"urn:schemas-microsoft-com:asm.v3\"><security><requestedPrivileges><requested" ascii
      $s5 = "(Symantec SHA256 TimeStamping Signer - G3" fullword ascii
      $s6 = "(Symantec SHA256 TimeStamping Signer - G30" fullword ascii
      $s7 = "ecutionLevel level=\"asInvoker\" uiAccess=\"false\"/></requestedPrivileges></security></trustInfo><compatibility xmlns=\"urn:sch" ascii
      $s8 = "CRYPTBASE" fullword ascii
      $s9 = "O:\\')d" fullword ascii
      $s10 = "Bourgogne-Franche-Comt" fullword ascii
      $s11 = "Terrestrially@Smidiges.Sto" fullword ascii
      $s12 = "6-80e1-4239-95bb-83d0f6d0da78}\"/><supportedOS Id=\"{4a2f28e3-53b9-4441-ba9c-d69d4a4a6e38}\"/><supportedOS Id=\"{35138b9a-5d96-4" ascii
      $s13 = "PROPSYS" fullword ascii
      $s14 = "UXTHEME" fullword ascii
      $s15 = "APPHELP" fullword ascii
      $s16 = "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?><assembly xmlns=\"urn:schemas-microsoft-com:asm.v1\" manifestVersio" ascii
      $s17 = "microsoft-com:compatibility.v1\"><application><supportedOS Id=\"{8e0f7a12-bfb3-4fe8-b9a5-48fd50a15a9a}\"/><supportedOS Id=\"{1f6" ascii
      $s18 = "antisemittens perditionable prevenant" fullword wide
      $s19 = "# `53Ph" fullword ascii
      $s20 = "5W+q!." fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 900KB and
      1 of ($x*) and 4 of them
}

rule sig_05b1be412276f70e579862cef3cc0181785ca3c7d6bd398ec2919d50bb4f5630 {
   meta:
      description = "samples - file 05b1be412276f70e579862cef3cc0181785ca3c7d6bd398ec2919d50bb4f5630.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "05b1be412276f70e579862cef3cc0181785ca3c7d6bd398ec2919d50bb4f5630"
   strings:
      $x1 = "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?><assembly xmlns=\"urn:schemas-microsoft-com:asm.v1\" manifestVersio" ascii
      $x2 = "<assemblyIdentity version=\"1.0.0.0\" processorArchitecture=\"*\" name=\"Nullsoft.NSIS.exehead\" type=\"win32\"/><description>Nu" ascii
      $s3 = "ontrols\" version=\"6.0.0.0\" processorArchitecture=\"*\" publicKeyToken=\"6595b64144ccf1df\" language=\"*\" /></dependentAssemb" ascii
      $s4 = "ndency><trustInfo xmlns=\"urn:schemas-microsoft-com:asm.v3\"><security><requestedPrivileges><requestedExecutionLevel level=\"asI" ascii
      $s5 = "nonproblematic.exe" fullword wide
      $s6 = "(Symantec SHA256 TimeStamping Signer - G3" fullword ascii
      $s7 = "(Symantec SHA256 TimeStamping Signer - G30" fullword ascii
      $s8 = "nstall System v3.0b0</description><dependency><dependentAssembly><assemblyIdentity type=\"win32\" name=\"Microsoft.Windows.Commo" ascii
      $s9 = "ker\" uiAccess=\"false\"/></requestedPrivileges></security></trustInfo><compatibility xmlns=\"urn:schemas-microsoft-com:compatib" ascii
      $s10 = "kombinere amaryllises papyrusser" fullword wide
      $s11 = "steroedeck modulsystem psykofarmakum" fullword wide
      $s12 = "bES.oPm" fullword ascii
      $s13 = "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?><assembly xmlns=\"urn:schemas-microsoft-com:asm.v1\" manifestVersio" ascii
      $s14 = "e38}\"/><supportedOS Id=\"{35138b9a-5d96-4fbd-8e2d-a2440225f93a}\"/></application></compatibility></assembly>" fullword ascii
      $s15 = "faniente arkivfiler ataraxics" fullword wide
      $s16 = "hT- ]e" fullword ascii
      $s17 = "5+ /!9" fullword ascii
      $s18 = "<y* D." fullword ascii
      $s19 = "bwFBzb5" fullword ascii
      $s20 = ";@- cO" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 3000KB and
      1 of ($x*) and 4 of them
}

rule e4d52884a348b211ebaab9018b286c9f7023abc349f229cc63fea89b5341341e {
   meta:
      description = "samples - file e4d52884a348b211ebaab9018b286c9f7023abc349f229cc63fea89b5341341e.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "e4d52884a348b211ebaab9018b286c9f7023abc349f229cc63fea89b5341341e"
   strings:
      $x1 = "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?><assembly xmlns=\"urn:schemas-microsoft-com:asm.v1\" manifestVersio" ascii
      $x2 = "<assemblyIdentity version=\"1.0.0.0\" processorArchitecture=\"*\" name=\"Nullsoft.NSIS.exehead\" type=\"win32\"/><description>Nu" ascii
      $s3 = "ontrols\" version=\"6.0.0.0\" processorArchitecture=\"*\" publicKeyToken=\"6595b64144ccf1df\" language=\"*\" /></dependentAssemb" ascii
      $s4 = "ndency><trustInfo xmlns=\"urn:schemas-microsoft-com:asm.v3\"><security><requestedPrivileges><requestedExecutionLevel level=\"asI" ascii
      $s5 = "nonproblematic.exe" fullword wide
      $s6 = "(Symantec SHA256 TimeStamping Signer - G3" fullword ascii
      $s7 = "(Symantec SHA256 TimeStamping Signer - G30" fullword ascii
      $s8 = "nstall System v3.0b0</description><dependency><dependentAssembly><assemblyIdentity type=\"win32\" name=\"Microsoft.Windows.Commo" ascii
      $s9 = "ker\" uiAccess=\"false\"/></requestedPrivileges></security></trustInfo><compatibility xmlns=\"urn:schemas-microsoft-com:compatib" ascii
      $s10 = "kombinere amaryllises papyrusser" fullword wide
      $s11 = "steroedeck modulsystem psykofarmakum" fullword wide
      $s12 = "bES.oPm" fullword ascii
      $s13 = "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?><assembly xmlns=\"urn:schemas-microsoft-com:asm.v1\" manifestVersio" ascii
      $s14 = "e38}\"/><supportedOS Id=\"{35138b9a-5d96-4fbd-8e2d-a2440225f93a}\"/></application></compatibility></assembly>" fullword ascii
      $s15 = "faniente arkivfiler ataraxics" fullword wide
      $s16 = "hT- ]e" fullword ascii
      $s17 = "5+ /!9" fullword ascii
      $s18 = "<y* D." fullword ascii
      $s19 = "bwFBzb5" fullword ascii
      $s20 = ";@- cO" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 3000KB and
      1 of ($x*) and 4 of them
}

rule f90014dc43ee89a2e8d146bc83cf462e50ef4de5cd17fda886f42c9631b9aee3 {
   meta:
      description = "samples - file f90014dc43ee89a2e8d146bc83cf462e50ef4de5cd17fda886f42c9631b9aee3.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "f90014dc43ee89a2e8d146bc83cf462e50ef4de5cd17fda886f42c9631b9aee3"
   strings:
      $s1 = "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" ascii /* base64 encoded string '                                                                                   ' */
      $s2 = "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAp" fullword ascii /* base64 encoded string '                                                                                    ' */
      $s3 = "%c%c%c%c%c%c%c%c%cMSSE-%d-server" fullword ascii
      $s4 = "  VirtualQuery failed for %d bytes at address %p" fullword ascii
      $s5 = "  VirtualProtect failed with code 0x%x" fullword ascii
      $s6 = "  Unknown pseudo relocation protocol version %d." fullword ascii
      $s7 = "  Unknown pseudo relocation bit size %d." fullword ascii
      $s8 = " [^_]A\\" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 50KB and
      all of them
}

rule sig_93255a8d0cd55878926f556e68a34cdc802c5316bd469f035a1a3481299ac133 {
   meta:
      description = "samples - file 93255a8d0cd55878926f556e68a34cdc802c5316bd469f035a1a3481299ac133.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "93255a8d0cd55878926f556e68a34cdc802c5316bd469f035a1a3481299ac133"
   strings:
      $s1 = "TLOGINDIALOG" fullword wide
      $s2 = "D:\\Work\\Shared\\Resource\\Scroller\\TIBSScroller_RIGHT_D.ico" fullword ascii
      $s3 = "D:\\Work\\Shared\\Resource\\Scroller\\TIBSScroller_LEFT.ico" fullword ascii
      $s4 = "D:\\Work\\Shared\\Resource\\Scroller\\TIBSScroller_UP.ico" fullword ascii
      $s5 = "D:\\Work\\Shared\\Resource\\Scroller\\TIBSScroller_DOWN.ico" fullword ascii
      $s6 = "D:\\Work\\Shared\\Resource\\Scroller\\TIBSScroller_LEFT_D.ico" fullword ascii
      $s7 = "D:\\Work\\Shared\\Resource\\Scroller\\TIBSScroller_DOWN_D.ico" fullword ascii
      $s8 = "D:\\Work\\Shared\\Resource\\Scroller\\TIBSScroller_RIGHT.ico" fullword ascii
      $s9 = "D:\\Work\\Shared\\Resource\\Scroller\\TIBSScroller_UP_D.ico" fullword ascii
      $s10 = "TPASSWORDDIALOG" fullword wide
      $s11 = "YXYXYX" fullword ascii /* reversed goodware string 'XYXYXY' */
      $s12 = "TFRMCOMMDEVHTTP" fullword wide
      $s13 = "TFTMIBSCHEQUESIGNGETPOSDATA" fullword wide
      $s14 = "        <requestedExecutionLevel" fullword ascii
      $s15 = "oPPn:\"cQ" fullword ascii
      $s16 = "        processorArchitecture=\"*\"/>" fullword ascii
      $s17 = "ZZXYYYY" fullword ascii
      $s18 = "DBINSERT" fullword wide
      $s19 = "DBINSERTEH" fullword wide
      $s20 = "TFRMCOMMDEV" fullword wide
   condition:
      uint16(0) == 0x5a4d and filesize < 18000KB and
      8 of them
}

rule sig_434fc1fcde79cced66c7784f22b1703b41dd77f1800edd7bebe4343f479080d8 {
   meta:
      description = "samples - file 434fc1fcde79cced66c7784f22b1703b41dd77f1800edd7bebe4343f479080d8.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "434fc1fcde79cced66c7784f22b1703b41dd77f1800edd7bebe4343f479080d8"
   strings:
      $x1 = "ProcessHacker.exe" fullword wide
      $x2 = "C:\\Temp\\client.log" fullword wide
      $x3 = "C:\\Temp\\client_ex.log" fullword wide
      $s4 = "MpCmdRun.exe" fullword wide
      $s5 = "  <!-- Enable themes for Windows common controls and dialogs (Windows XP and later) -->" fullword ascii
      $s6 = "ConfigSecurityPolicy.exe" fullword wide
      $s7 = "MSConfig.exe" fullword wide
      $s8 = "/c schtasks /create /f /sc onlogon /rl highest /tn \"" fullword wide
      $s9 = "GetUserProcessList" fullword ascii
      $s10 = "C://Temp//1.log" fullword wide
      $s11 = "procexp.exe" fullword wide
      $s12 = "MSASCui.exe" fullword wide
      $s13 = "MsMpEng.exe" fullword wide
      $s14 = "MpUXSrv.exe" fullword wide
      $s15 = "NisSrv.exe" fullword wide
      $s16 = "Regedit.exe" fullword wide
      $s17 = "Analyzer.exe" fullword ascii
      $s18 = "keyLogger" fullword wide
      $s19 = "ClientAny.exe" fullword wide
      $s20 = "GetActiveProcessName" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule a55c7ed8b626f509f1db86fb6be1823a6bdf54b47c73a348cfe70c36e8b45d82 {
   meta:
      description = "samples - file a55c7ed8b626f509f1db86fb6be1823a6bdf54b47c73a348cfe70c36e8b45d82.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "a55c7ed8b626f509f1db86fb6be1823a6bdf54b47c73a348cfe70c36e8b45d82"
   strings:
      $x1 = "ProcessHacker.exe" fullword wide
      $s2 = "MpCmdRun.exe" fullword wide
      $s3 = "Infected.exe" fullword ascii
      $s4 = "  <!-- Enable themes for Windows common controls and dialogs (Windows XP and later) -->" fullword ascii
      $s5 = "ConfigSecurityPolicy.exe" fullword wide
      $s6 = "MSConfig.exe" fullword wide
      $s7 = "/c schtasks /create /f /sc onlogon /rl highest /tn \"" fullword wide
      $s8 = "procexp.exe" fullword wide
      $s9 = "MSASCui.exe" fullword wide
      $s10 = "MsMpEng.exe" fullword wide
      $s11 = "MpUXSrv.exe" fullword wide
      $s12 = "NisSrv.exe" fullword wide
      $s13 = "Regedit.exe" fullword wide
      $s14 = "Client.exe" fullword wide
      $s15 = "<dpiAwareness xmlns=\"http://schemas.microsoft.com/SMI/2016/WindowsSettings\">PerMonitorV2, PerMonitor</dpiAwareness>" fullword ascii
      $s16 = "<longPathAware xmlns=\"http://schemas.microsoft.com/SMI/2016/WindowsSettings\">true</longPathAware>" fullword ascii
      $s17 = "Anti_Process" fullword ascii
      $s18 = "MutexControl" fullword ascii
      $s19 = "ProcessIsTerminating" fullword ascii
      $s20 = "dwProcessHandle" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule sig_1673828a6bb871f75162500cdffd2e86113da89049fff26117e78be6ea681e69 {
   meta:
      description = "samples - file 1673828a6bb871f75162500cdffd2e86113da89049fff26117e78be6ea681e69.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "1673828a6bb871f75162500cdffd2e86113da89049fff26117e78be6ea681e69"
   strings:
      $x1 = "ProcessHacker.exe" fullword wide
      $s2 = "MpCmdRun.exe" fullword wide
      $s3 = "  <!-- Enable themes for Windows common controls and dialogs (Windows XP and later) -->" fullword ascii
      $s4 = "ConfigSecurityPolicy.exe" fullword wide
      $s5 = "MSConfig.exe" fullword wide
      $s6 = "/c schtasks /create /f /sc onlogon /rl highest /tn \"" fullword wide
      $s7 = "procexp.exe" fullword wide
      $s8 = "MSASCui.exe" fullword wide
      $s9 = "MsMpEng.exe" fullword wide
      $s10 = "MpUXSrv.exe" fullword wide
      $s11 = "NisSrv.exe" fullword wide
      $s12 = "Regedit.exe" fullword wide
      $s13 = "nigger.exe" fullword ascii
      $s14 = "Microsoft Helper Tools.exe" fullword wide
      $s15 = "<dpiAwareness xmlns=\"http://schemas.microsoft.com/SMI/2016/WindowsSettings\">PerMonitorV2, PerMonitor</dpiAwareness>" fullword ascii
      $s16 = "<longPathAware xmlns=\"http://schemas.microsoft.com/SMI/2016/WindowsSettings\">true</longPathAware>" fullword ascii
      $s17 = "Anti_Process" fullword ascii
      $s18 = "MutexControl" fullword ascii
      $s19 = "ProcessIsTerminating" fullword ascii
      $s20 = "dwProcessHandle" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule sig_141be7789497012b7911cabb1307e25e19f747e2e8fb5375f9cddff7e5f28265 {
   meta:
      description = "samples - file 141be7789497012b7911cabb1307e25e19f747e2e8fb5375f9cddff7e5f28265.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "141be7789497012b7911cabb1307e25e19f747e2e8fb5375f9cddff7e5f28265"
   strings:
      $s1 = "dotnet.exe" fullword wide
      $s2 = "        <requestedExecutionLevel level='asInvoker' uiAccess='false' />" fullword ascii
      $s3 = "* D-P=" fullword ascii
      $s4 = ":5/\\A\\," fullword ascii /* hex encoded string 'Z' */
      $s5 = "u /y +" fullword ascii
      $s6 = ".NET Host" fullword wide
      $s7 = "iolmakfn" fullword ascii
      $s8 = "rrgdmorv" fullword ascii
      $s9 = "wUP.XUQ.8UL." fullword ascii
      $s10 = "0RO.sZX" fullword ascii
      $s11 = "  <trustInfo xmlns=\"urn:schemas-microsoft-com:asm.v3\">" fullword ascii
      $s12 = "Microsoft Corporation.  All rights reserved." fullword wide
      $s13 = "mDAqbW7" fullword ascii
      $s14 = "qMbhvm9" fullword ascii
      $s15 = "V -L#b" fullword ascii
      $s16 = "\\-|.aDj" fullword ascii
      $s17 = " -Ur2Q^L" fullword ascii
      $s18 = "EI* k)" fullword ascii
      $s19 = "NB- Qj" fullword ascii
      $s20 = ":iT%b%" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 7000KB and
      8 of them
}

rule sig_68c00e3bb99dd666c421c6fd6b384ff5641ead666c44936d8e84a9075ff79819 {
   meta:
      description = "samples - file 68c00e3bb99dd666c421c6fd6b384ff5641ead666c44936d8e84a9075ff79819.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "68c00e3bb99dd666c421c6fd6b384ff5641ead666c44936d8e84a9075ff79819"
   strings:
      $s1 = "        <requestedExecutionLevel level='asInvoker' uiAccess='false' />" fullword ascii
      $s2 = "RWF4N0dpa" fullword ascii /* base64 encoded string 'Eax7Gi' */
      $s3 = "*  1`%" fullword ascii
      $s4 = "# -+0@LAq" fullword ascii
      $s5 = "* Q/ @4 " fullword ascii
      $s6 = "bxjwqywv" fullword ascii
      $s7 = "vmjyxrbh" fullword ascii
      $s8 = "  <trustInfo xmlns=\"urn:schemas-microsoft-com:asm.v3\">" fullword ascii
      $s9 = "f:\\J8U@" fullword ascii
      $s10 = "D6w.FNV" fullword ascii
      $s11 = "$?(?,?0?<?xml version='1.0' encoding='UTF-8' standalone='yes'?>" fullword ascii
      $s12 = ">((D:\\" fullword ascii
      $s13 = "e:\\gkR" fullword ascii
      $s14 = "8HgeTr-" fullword ascii
      $s15 = "ef9* [" fullword ascii
      $s16 = "tuvkah" fullword ascii
      $s17 = "7IwJ)!." fullword ascii
      $s18 = "A\"y}+ " fullword ascii
      $s19 = " q+ (m" fullword ascii
      $s20 = "\"4h+ x?L?" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 6000KB and
      8 of them
}

rule sig_1676f89a9e958079df53c985b55673571919e572e311202b8415fe0417e534ad {
   meta:
      description = "samples - file 1676f89a9e958079df53c985b55673571919e572e311202b8415fe0417e534ad.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "1676f89a9e958079df53c985b55673571919e572e311202b8415fe0417e534ad"
   strings:
      $s1 = "+yUSER32.dll" fullword ascii
      $s2 = "NADVAPI32.dll" fullword ascii
      $s3 = "dFFtISNOz" fullword ascii /* base64 encoded string 'tQm!#N' */
      $s4 = "        <dpiAware xmlns=\"http://schemas.microsoft.com/SMI/2005/WindowsSettings\">true</dpiAware>" fullword ascii
      $s5 = "            <requestedExecutionLevel level=\"requireAdministrator\"            uiAccess=\"false\"/>" fullword ascii
      $s6 = "            processorArchitecture=\"x86\"" fullword ascii
      $s7 = "x ixlW:\"" fullword ascii
      $s8 = "    processorArchitecture=\"x86\"" fullword ascii
      $s9 = "3\"'A\"\"" fullword ascii /* hex encoded string ':' */
      $s10 = "gg.cmd" fullword ascii
      $s11 = "'|`]5b3.d" fullword ascii /* hex encoded string '[=' */
      $s12 = "(2[8'5\"E:" fullword ascii /* hex encoded string '(^' */
      $s13 = "?;- ]XV.WYK.?L+(;E&$D<!$J8" fullword ascii
      $s14 = "            publicKeyToken=\"6595b64144ccf1df\"" fullword ascii
      $s15 = "<J:\\Dv" fullword ascii
      $s16 = "    version=\"1.0.0.0\"" fullword ascii
      $s17 = " VCOM-F8<" fullword ascii
      $s18 = "            version=\"6.0.0.0\"" fullword ascii
      $s19 = "U:\">J+" fullword ascii
      $s20 = "`D:\\@k&" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 13000KB and
      8 of them
}

rule sig_68930f6edf4c46201668adc5b0f91008e1914b6fdb60742c0d60c9b5162a3acf {
   meta:
      description = "samples - file 68930f6edf4c46201668adc5b0f91008e1914b6fdb60742c0d60c9b5162a3acf.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "68930f6edf4c46201668adc5b0f91008e1914b6fdb60742c0d60c9b5162a3acf"
   strings:
      $s1 = "Jctxnzfmnle.exe" fullword wide
      $s2 = "https://cdn.discordapp.com/attachments/1255470901886062606/1255814375890092032/Vwjyrro.wav?ex=667e7fc7&is=667d2e47&hm=6682a51433" wide
      $s3 = "LoginInfo" fullword ascii
      $s4 = "LoginProduct" fullword ascii
      $s5 = "SequentialGuid.Listeners" fullword ascii
      $s6 = "ReaderStrategyListener" fullword ascii
      $s7 = ".NET Framework 4.6" fullword ascii
      $s8 = "NAudio.Exceptions.ListProxyException" fullword wide
      $s9 = "DateTimeKind.Unspecified not supported" fullword wide
      $s10 = "PostProduct" fullword ascii
      $s11 = "PostInfo" fullword ascii
      $s12 = "LogoutInfo" fullword ascii
      $s13 = "defcounter" fullword ascii
      $s14 = "InvokeInfo" fullword ascii
      $s15 = "SequentialGuid.Writers" fullword ascii
      $s16 = "ReadProduct" fullword ascii
      $s17 = "Jctxnzfmnle.Polices" fullword ascii
      $s18 = "SequentialGuid.Mappers" fullword ascii
      $s19 = "ItemListenerMapper" fullword ascii
      $s20 = "Jctxnzfmnle.Records" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 80KB and
      8 of them
}

rule sig_7c76c1df37c2b02853976195b4d9f5d5d419685cb980984f69c62736350a001a {
   meta:
      description = "samples - file 7c76c1df37c2b02853976195b4d9f5d5d419685cb980984f69c62736350a001a.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "7c76c1df37c2b02853976195b4d9f5d5d419685cb980984f69c62736350a001a"
   strings:
      $x1 = "<?xml version=\"1.0\" encoding=\"utf-8\" standalone=\"yes\"?><assembly xmlns=\"urn:schemas-microsoft-com:asm.v1\" manifestVersio" ascii
      $s2 = "questedPrivileges xmlns=\"urn:schemas-microsoft-com:asm.v3\"><requestedExecutionLevel level=\"asInvoker\" uiAccess=\"false\" /><" ascii
      $s3 = "JmR.exe" fullword wide
      $s4 = "<assemblyIdentity version=\"1.0.0.0\" name=\"MyApplication.app\" /><trustInfo xmlns=\"urn:schemas-microsoft-com:asm.v2\"><securi" ascii
      $s5 = "1Microsoft Malware Protection Command Line Utility" fullword ascii
      $s6 = "Microsoft Malware Protection Command Line Utility" fullword wide
      $s7 = ".NET Framework 4.6l" fullword ascii
      $s8 = "ffeeffefeef" ascii
      $s9 = "afeffeefef" ascii
      $s10 = "feffefefea" ascii
      $s11 = "fffeeffeefef" ascii
      $s12 = "affefeeffe" ascii
      $s13 = "affeefeffefea" ascii
      $s14 = "fefeffefefe" ascii
      $s15 = "ffefeeffea" ascii
      $s16 = "ffeefeffefea" ascii
      $s17 = "ffeeffefefea" ascii
      $s18 = "ffefeffeefef" ascii
      $s19 = "afefeffeef" ascii
      $s20 = "feffefefe" ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 90KB and
      1 of ($x*) and 4 of them
}

rule sig_26321ed18abb4d44668e157dcb9a123debe3b7477d95055d20e5f5d997bf60d7 {
   meta:
      description = "samples - file 26321ed18abb4d44668e157dcb9a123debe3b7477d95055d20e5f5d997bf60d7.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "26321ed18abb4d44668e157dcb9a123debe3b7477d95055d20e5f5d997bf60d7"
   strings:
      $s1 = "dElaL25RWkllOG8rNENma0p3PT0=" fullword ascii /* base64 encoded string 'tIZ/nQZIe8o+4CfkJw==' */
      $s2 = "ell.exe" fullword ascii
      $s3 = "U3ViIGRpcmVjdG9yaWVzIGFyZTo=" fullword ascii /* base64 encoded string 'Sub directories are:' */
      $s4 = "VGhyZWFkMiBpcyBleGVjdGluZw==" fullword ascii /* base64 encoded string 'Thread2 is execting' */
      $s5 = "bXBPQ2ZTSnh0dz09" fullword ascii /* base64 encoded string 'mpOCfSJxtw==' */
      $s6 = "YzlaR3MrYnEzUT09" fullword ascii /* base64 encoded string 'c9ZGs+bq3Q==' */
      $s7 = "XEREZmlsZXM=" fullword ascii /* base64 encoded string '\DDfiles' */
      $s8 = "RERmaWxlcw==" fullword ascii /* base64 encoded string 'DDfiles' */
      $s9 = "bWtkaXIgIg==" fullword ascii /* base64 encoded string 'mkdir "' */
      $s10 = "RERmaWxlc1xERGZpbGVzLmV4ZSI=" fullword ascii /* base64 encoded string 'DDfiles\DDfiles.exe"' */
      $s11 = "TG9va3VwQWNjb3VudFNpZDogezB9" fullword ascii /* base64 encoded string 'LookupAccountSid: {0}' */
      $s12 = "VGhyZWFkMSBpcyBleGVjdGluZw==" fullword ascii /* base64 encoded string 'Thread1 is execting' */
      $s13 = "RHluYW1pY0RsbEludm9rZVR5cGU=" fullword ascii /* base64 encoded string 'DynamicDllInvokeType' */
      $s14 = "RDovU2FtcGxl" fullword ascii /* base64 encoded string 'D:/Sample' */
      $s15 = "ZGRkZGRkZGRkZA==" fullword ascii /* base64 encoded string 'dddddddddd' */
      $s16 = "WDw8MiA9IA==" fullword ascii /* base64 encoded string 'X<<2 = ' */
      $s17 = "WTw8MyA9IA==" fullword ascii /* base64 encoded string 'Y<<3 = ' */
      $s18 = "$44444%%$444" fullword ascii /* hex encoded string 'DDDD' */
      $s19 = "CreateGetStringDelegate" fullword ascii
      $s20 = "jfjjjfg" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 900KB and
      8 of them
}

rule c0e6cea1456ebc9c970e4cfc70ad112501a744373e25c74ae318e9654f852da5 {
   meta:
      description = "samples - file c0e6cea1456ebc9c970e4cfc70ad112501a744373e25c74ae318e9654f852da5.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "c0e6cea1456ebc9c970e4cfc70ad112501a744373e25c74ae318e9654f852da5"
   strings:
      $s1 = "ZNvv.exe" fullword wide
      $s2 = "SELECT * FROM [CollegeDB].[dbo].[user_login] WHERE username = '" fullword wide
      $s3 = "LoginForm" fullword wide
      $s4 = "ValidateUserLogin" fullword ascii
      $s5 = "loginInvalid" fullword wide
      $s6 = "PasswordBox_KeyPress" fullword ascii
      $s7 = "Login required" fullword wide
      $s8 = "Test login Username: John12 Password:1234" fullword wide
      $s9 = "INSERT INTO dbo.student (first_name, last_name, date_of_birth, Address, Country, PostCode, email, phone)VALUES('" fullword wide
      $s10 = "postcode" fullword wide
      $s11 = "Incorrect username or password." fullword wide
      $s12 = "Designed and implemented by Michail Panagopoulos - 2022" fullword wide
      $s13 = "' AND password = '" fullword wide
      $s14 = "Login details are required in order to proceed. This application will now close." fullword wide
      $s15 = "Postcode" fullword wide
      $s16 = "Data Source = USERONE; Initial Catalog = CollegeDB; Integrated Security = True" fullword wide
      $s17 = "Connection Error: " fullword wide
      $s18 = " Please try again. If the error persists, contact your system administrator." fullword wide
      $s19 = "Something went wrong. Please try again, and if the errorpersists, contact the system administrator." fullword wide
      $s20 = "' from the system.Are you sure you want to proceed?" fullword wide
   condition:
      uint16(0) == 0x5a4d and filesize < 2000KB and
      8 of them
}

rule sig_20e3320ed125693938485c94c8ebf1a981ed2d717bba86f137a4b327757946fe {
   meta:
      description = "samples - file 20e3320ed125693938485c94c8ebf1a981ed2d717bba86f137a4b327757946fe.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "20e3320ed125693938485c94c8ebf1a981ed2d717bba86f137a4b327757946fe"
   strings:
      $s1 = "NETA GAME.exe" fullword wide
      $s2 = "RjSi.hTW" fullword ascii
      $s3 = "ULs.tnh" fullword ascii
      $s4 = "UCYVTUE" fullword ascii
      $s5 = "XXAVCPWBW" fullword ascii
      $s6 = "3iRc=g!Z" fullword ascii
      $s7 = "&T9)+ _'N" fullword ascii
      $s8 = "}Cq+ 2*J" fullword ascii
      $s9 = "\\1HnbLkNU92" fullword ascii
      $s10 = "Z;11!." fullword ascii
      $s11 = "+ +|30" fullword ascii
      $s12 = "ScKsJs5" fullword ascii
      $s13 = "Youe4oi[0ogY0oi[0ok[-o|i;o" fullword ascii
      $s14 = "NETA GAME" fullword wide
      $s15 = "wVyIg8$" fullword ascii
      $s16 = "wNBZFeGz" fullword ascii
      $s17 = "QUza_pv" fullword ascii
      $s18 = "l63(lKMDlDD3l" fullword ascii
      $s19 = "=&nitP1kOV^" fullword ascii
      $s20 = "LMHLAF6m" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 3000KB and
      8 of them
}

rule de8636c5d87d276a4971eab3cbe5d3d3bb18618e8a24ae27b154e1548bd438a4 {
   meta:
      description = "samples - file de8636c5d87d276a4971eab3cbe5d3d3bb18618e8a24ae27b154e1548bd438a4.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "de8636c5d87d276a4971eab3cbe5d3d3bb18618e8a24ae27b154e1548bd438a4"
   strings:
      $s1 = "http://www.digicert.com/CPS0" fullword ascii
      $s2 = "GetDomain" fullword ascii /* Goodware String - occured 126 times */
      $s3 = "DigiCert Timestamp 20210" fullword ascii
      $s4 = "DigiCert, Inc.1 0" fullword ascii
      $s5 = "QJxy6z'" fullword ascii
      $s6 = "Vrfq~LjP/J" fullword wide
      $s7 = "PPxJVxr~~xVxqxVxVxVx~xVxVxVxfLLxfLLxVxVxr/~xVxVxVxVxVxVxVxj~xVxVxVxVxVxVxVxVxVxVxVxVxVxVxVxVxVxVxVxVxVxVxVxVxVxVxVxVxVxVxVxVxVxV" wide
      $s8 = "E'tryPoi't" fullword wide
      $s9 = "310106000000Z0H1" fullword ascii
      $s10 = "210101000000Z" fullword ascii
      $s11 = "??????????????????????????0" fullword ascii
      $s12 = "210215175348Z0+" fullword ascii
      $s13 = "220215175347Z0" fullword ascii
      $s14 = "??????????????????????????" fullword ascii /* Goodware String - occured 4 times */
      $s15 = "dwc_#Ri" fullword ascii
      $s16 = "210215175347Z" fullword ascii
      $s17 = "20210215175348" ascii
      $s18 = "210215175348" ascii
      $s19 = "220215175347" ascii
      $s20 = "20210215175348Z" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 3000KB and
      8 of them
}

rule sig_07ecf0ee68a52e1783da654389f5adaa861b5e7cfff04cbec504e721cc3a11ad {
   meta:
      description = "samples - file 07ecf0ee68a52e1783da654389f5adaa861b5e7cfff04cbec504e721cc3a11ad.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "07ecf0ee68a52e1783da654389f5adaa861b5e7cfff04cbec504e721cc3a11ad"
   strings:
      $x1 = "-ExecutionPolicy Bypass Add-MpPreference -ExclusionProcess '" fullword wide
      $x2 = "-ExecutionPolicy Bypass Add-MpPreference -ExclusionPath '" fullword wide
      $x3 = "-ExecutionPolicy Bypass -File \"" fullword wide
      $s4 = "NTdll.dll" fullword ascii
      $s5 = "SHCore.dll" fullword ascii
      $s6 = "XClient.exe" fullword wide
      $s7 = "http://ip-api.com/line/?fields=hosting" fullword wide
      $s8 = "shutdown.exe /f /s /t 0" fullword wide
      $s9 = "shutdown.exe /f /r /t 0" fullword wide
      $s10 = "WScript.Shell" fullword wide
      $s11 = "shutdown.exe -L" fullword wide
      $s12 = "\\Log.tmp" fullword wide
      $s13 = "CloseMutex" fullword ascii
      $s14 = "ProcessDpi" fullword ascii
      $s15 = "_appMutex" fullword ascii
      $s16 = "Win32_Processor.deviceid=\"CPU0\"" fullword wide
      $s17 = "WHKEYBOARDLL" fullword ascii
      $s18 = "Select * from Win32_ComputerSystem" fullword wide
      $s19 = "XLogger" fullword ascii
      $s20 = "AES_Encryptor" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 100KB and
      1 of ($x*) and 4 of them
}

rule ded5515158d7b1ed9520713645bc63d7bb872f0a212c77ebb1afce0d16fad0ce {
   meta:
      description = "samples - file ded5515158d7b1ed9520713645bc63d7bb872f0a212c77ebb1afce0d16fad0ce.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "ded5515158d7b1ed9520713645bc63d7bb872f0a212c77ebb1afce0d16fad0ce"
   strings:
      $x1 = "-ExecutionPolicy Bypass Add-MpPreference -ExclusionProcess '" fullword wide
      $x2 = "-ExecutionPolicy Bypass Add-MpPreference -ExclusionPath '" fullword wide
      $x3 = "-ExecutionPolicy Bypass -File \"" fullword wide
      $s4 = "NTdll.dll" fullword ascii
      $s5 = "SHCore.dll" fullword ascii
      $s6 = "http://ip-api.com/line/?fields=hosting" fullword wide
      $s7 = "shutdown.exe /f /s /t 0" fullword wide
      $s8 = "shutdown.exe /f /r /t 0" fullword wide
      $s9 = "XClientx3.exe" fullword wide
      $s10 = "WScript.Shell" fullword wide
      $s11 = "shutdown.exe -L" fullword wide
      $s12 = "\\Log.tmp" fullword wide
      $s13 = "Win32_Processor.deviceid=\"CPU0\"" fullword wide
      $s14 = "XClientx3" fullword ascii /* base64 encoded string '\)bz{q' */
      $s15 = "Select * from Win32_ComputerSystem" fullword wide
      $s16 = "\\drivers\\etc\\hosts" fullword wide
      $s17 = "/create /f /RL HIGHEST /sc minute /mo 1 /tn \"" fullword wide
      $s18 = "/create /f /sc minute /mo 1 /tn \"" fullword wide
      $s19 = "POST / HTTP/1.1" fullword wide
      $s20 = "/delete /f  /tn \"" fullword wide
   condition:
      uint16(0) == 0x5a4d and filesize < 800KB and
      1 of ($x*) and 4 of them
}

rule e2a569f0f5168d11500b6e5f5c0ad0c900c45be7cbab68f0c354318123bf942f {
   meta:
      description = "samples - file e2a569f0f5168d11500b6e5f5c0ad0c900c45be7cbab68f0c354318123bf942f.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "e2a569f0f5168d11500b6e5f5c0ad0c900c45be7cbab68f0c354318123bf942f"
   strings:
      $x1 = "-ExecutionPolicy Bypass Add-MpPreference -ExclusionProcess '" fullword wide
      $x2 = "-ExecutionPolicy Bypass Add-MpPreference -ExclusionPath '" fullword wide
      $x3 = "-ExecutionPolicy Bypass -File \"" fullword wide
      $s4 = "NTdll.dll" fullword ascii
      $s5 = "SHCore.dll" fullword ascii
      $s6 = "http://ip-api.com/line/?fields=hosting" fullword wide
      $s7 = "shutdown.exe /f /s /t 0" fullword wide
      $s8 = "shutdown.exe /f /r /t 0" fullword wide
      $s9 = "loaded28062024.exe" fullword wide
      $s10 = "WScript.Shell" fullword wide
      $s11 = "shutdown.exe -L" fullword wide
      $s12 = "\\Log.tmp" fullword wide
      $s13 = "Win32_Processor.deviceid=\"CPU0\"" fullword wide
      $s14 = "Select * from Win32_ComputerSystem" fullword wide
      $s15 = "dXduJVB2XGr" fullword ascii /* base64 encoded string 'uwn%Pv\j' */
      $s16 = "\\drivers\\etc\\hosts" fullword wide
      $s17 = "/create /f /RL HIGHEST /sc minute /mo 1 /tn \"" fullword wide
      $s18 = "/create /f /sc minute /mo 1 /tn \"" fullword wide
      $s19 = "POST / HTTP/1.1" fullword wide
      $s20 = "/delete /f  /tn \"" fullword wide
   condition:
      uint16(0) == 0x5a4d and filesize < 700KB and
      1 of ($x*) and 4 of them
}

rule sig_0a785a353308e02dfe2b5b3318d6a2a90d7a918dd200d70109fe3eedc3ce69d1 {
   meta:
      description = "samples - file 0a785a353308e02dfe2b5b3318d6a2a90d7a918dd200d70109fe3eedc3ce69d1.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "0a785a353308e02dfe2b5b3318d6a2a90d7a918dd200d70109fe3eedc3ce69d1"
   strings:
      $x1 = "-ExecutionPolicy Bypass Add-MpPreference -ExclusionProcess '" fullword wide
      $x2 = "-ExecutionPolicy Bypass Add-MpPreference -ExclusionPath '" fullword wide
      $x3 = "-ExecutionPolicy Bypass -File \"" fullword wide
      $s4 = "NTdll.dll" fullword ascii
      $s5 = "SHCore.dll" fullword ascii
      $s6 = "http://ip-api.com/line/?fields=hosting" fullword wide
      $s7 = "shutdown.exe /f /s /t 0" fullword wide
      $s8 = "shutdown.exe /f /r /t 0" fullword wide
      $s9 = "XClient2.exe" fullword wide
      $s10 = "WScript.Shell" fullword wide
      $s11 = "shutdown.exe -L" fullword wide
      $s12 = "\\Log.tmp" fullword wide
      $s13 = "Win32_Processor.deviceid=\"CPU0\"" fullword wide
      $s14 = "Select * from Win32_ComputerSystem" fullword wide
      $s15 = "\\drivers\\etc\\hosts" fullword wide
      $s16 = "/create /f /RL HIGHEST /sc minute /mo 1 /tn \"" fullword wide
      $s17 = "/create /f /sc minute /mo 1 /tn \"" fullword wide
      $s18 = "POST / HTTP/1.1" fullword wide
      $s19 = "/delete /f  /tn \"" fullword wide
      $s20 = "Mozilla/5.0 (iPhone; CPU iPhone OS 11_4_1 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/11.0 Mobile/15E148 Saf" wide
   condition:
      uint16(0) == 0x5a4d and filesize < 700KB and
      1 of ($x*) and 4 of them
}

rule sig_5ad6806628708095957c45a7f728f941d9b436a25f3f0d2147274403fffd1045 {
   meta:
      description = "samples - file 5ad6806628708095957c45a7f728f941d9b436a25f3f0d2147274403fffd1045.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "5ad6806628708095957c45a7f728f941d9b436a25f3f0d2147274403fffd1045"
   strings:
      $x1 = "-ExecutionPolicy Bypass Add-MpPreference -ExclusionProcess '" fullword wide
      $x2 = "-ExecutionPolicy Bypass Add-MpPreference -ExclusionPath '" fullword wide
      $x3 = "-ExecutionPolicy Bypass -File \"" fullword wide
      $s4 = "NTdll.dll" fullword ascii
      $s5 = "SHCore.dll" fullword ascii
      $s6 = "http://ip-api.com/line/?fields=hosting" fullword wide
      $s7 = "shutdown.exe /f /s /t 0" fullword wide
      $s8 = "shutdown.exe /f /r /t 0" fullword wide
      $s9 = "Slovakia.exe" fullword wide
      $s10 = "WScript.Shell" fullword wide
      $s11 = "shutdown.exe -L" fullword wide
      $s12 = "\\Log.tmp" fullword wide
      $s13 = "Win32_Processor.deviceid=\"CPU0\"" fullword wide
      $s14 = "Select * from Win32_ComputerSystem" fullword wide
      $s15 = "\\drivers\\etc\\hosts" fullword wide
      $s16 = "/create /f /RL HIGHEST /sc minute /mo 1 /tn \"" fullword wide
      $s17 = "/create /f /sc minute /mo 1 /tn \"" fullword wide
      $s18 = "POST / HTTP/1.1" fullword wide
      $s19 = "/delete /f  /tn \"" fullword wide
      $s20 = "Mozilla/5.0 (iPhone; CPU iPhone OS 11_4_1 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/11.0 Mobile/15E148 Saf" wide
   condition:
      uint16(0) == 0x5a4d and filesize < 700KB and
      1 of ($x*) and 4 of them
}

rule sig_04f28f4975a7ff3cb3439b65b8d2fad8e99e3431b65be0e065c194908459790e {
   meta:
      description = "samples - file 04f28f4975a7ff3cb3439b65b8d2fad8e99e3431b65be0e065c194908459790e.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "04f28f4975a7ff3cb3439b65b8d2fad8e99e3431b65be0e065c194908459790e"
   strings:
      $x1 = "-ExecutionPolicy Bypass -File \"" fullword wide
      $s2 = "Image logger beta.exe" fullword wide
      $s3 = "NTdll.dll" fullword ascii
      $s4 = "http://ip-api.com/line/?fields=hosting" fullword wide
      $s5 = "shutdown.exe /f /s /t 0" fullword wide
      $s6 = "shutdown.exe /f /r /t 0" fullword wide
      $s7 = "WScript.Shell" fullword wide
      $s8 = "shutdown.exe -L" fullword wide
      $s9 = "OfflineKeylogger Not Enabled" fullword wide
      $s10 = "CloseMutex" fullword ascii
      $s11 = "_appMutex" fullword ascii
      $s12 = "Win32_Processor.deviceid=\"CPU0\"" fullword wide
      $s13 = "Select * from Win32_ComputerSystem" fullword wide
      $s14 = "AES_Encryptor" fullword ascii
      $s15 = "Image logger beta" fullword ascii
      $s16 = "\\drivers\\etc\\hosts" fullword wide
      $s17 = "userAgents" fullword ascii
      $s18 = "GetHashT" fullword ascii
      $s19 = "POST / HTTP/1.1" fullword wide
      $s20 = "Mozilla/5.0 (iPhone; CPU iPhone OS 11_4_1 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/11.0 Mobile/15E148 Saf" wide
   condition:
      uint16(0) == 0x5a4d and filesize < 900KB and
      1 of ($x*) and 4 of them
}

rule sig_7289da5a1cc6d7149e862660a7f3f48db0ef1f6f8e5de991501e72bde1192be9 {
   meta:
      description = "samples - file 7289da5a1cc6d7149e862660a7f3f48db0ef1f6f8e5de991501e72bde1192be9.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "7289da5a1cc6d7149e862660a7f3f48db0ef1f6f8e5de991501e72bde1192be9"
   strings:
      $s1 = "TVqQ:M::E::__8:Lg::::AQ:::::::::::::::::::::::Ag::A4fug4AtAnNIbg?TM0hVGhpcy?wcm9ncmFtIGNhbm5vdC?iZS?ydW4gaW4gRE9TIG1vZGUuDQ0KJ::" ascii
      $s2 = "CollegeInformationSystem.LoginForm.resources" fullword ascii
      $s3 = "ULLQ.exe" fullword wide
      $s4 = "SELECT * FROM [CollegeDB].[dbo].[user_login] WHERE username = '" fullword wide
      $s5 = "LoginForm" fullword wide
      $s6 = "ValidateUserLogin" fullword ascii
      $s7 = "loginInvalid" fullword wide
      $s8 = "PasswordBox_KeyPress" fullword ascii
      $s9 = "Login required" fullword wide
      $s10 = "Test login Username: John12 Password:1234" fullword wide
      $s11 = "INSERT INTO dbo.student (first_name, last_name, date_of_birth, Address, Country, PostCode, email, phone)VALUES('" fullword wide
      $s12 = "postcode" fullword wide
      $s13 = "Incorrect username or password." fullword wide
      $s14 = "Designed and implemented by Michail Panagopoulos - 2022" fullword wide
      $s15 = "' AND password = '" fullword wide
      $s16 = "Login details are required in order to proceed. This application will now close." fullword wide
      $s17 = "Postcode" fullword wide
      $s18 = "CollegeInformationSystem.MainForm.resources" fullword ascii
      $s19 = "CollegeInformationSystem.ResultsForm.resources" fullword ascii
      $s20 = "Data Source = USERONE; Initial Catalog = CollegeDB; Integrated Security = True" fullword wide
   condition:
      uint16(0) == 0x5a4d and filesize < 2000KB and
      8 of them
}

rule cb22cebed97d6363239f63cf28816b8a8c06977c6d8625a43a61f0afa8823b26 {
   meta:
      description = "samples - file cb22cebed97d6363239f63cf28816b8a8c06977c6d8625a43a61f0afa8823b26.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "cb22cebed97d6363239f63cf28816b8a8c06977c6d8625a43a61f0afa8823b26"
   strings:
      $s1 = "Output.exe" fullword wide
      $s2 = "Part1.exe" fullword wide
      $s3 = "Part2.exe" fullword wide
      $s4 = "Part1.exe-=>True-=>False" fullword wide
      $s5 = "Part2.exe-=>True-=>False" fullword wide
      $s6 = "CqSEDLogYcxdZDQvaatj0eCoZ6ynSRYRiC" fullword wide
      $s7 = "RB1XsorYmS27M4DaLgqBNrNcwqArFNTK3Z" fullword ascii
      $s8 = "%Current%" fullword wide
      $s9 = "gpfuwrlcs" fullword wide
      $s10 = "gpfuwrlcs.Resources" fullword ascii
      $s11 = "YSoSEVgBB8ycOMEQgq0HYJEQgyUFa6MGJw" fullword ascii
      $s12 = "?GetlB" fullword ascii
      $s13 = "+ #'Zx" fullword ascii
      $s14 = "^!+ \\O" fullword ascii
      $s15 = "2K -!^" fullword ascii
      $s16 = "`I* XlI" fullword ascii
      $s17 = "uY< /M" fullword ascii
      $s18 = "CompareString" fullword ascii /* Goodware String - occured 28 times */
      $s19 = "mYFtF7gbC9qKNw7wltmuqRiYpDv1TdxtRU" fullword ascii
      $s20 = "LTtZSg2NFrWUwjkxXyg5muF8qWNdW21YSJ" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 2000KB and
      8 of them
}

rule c826d38990051067a23d7ced76e20925ec47749e562ef718029ff06555680b5b {
   meta:
      description = "samples - file c826d38990051067a23d7ced76e20925ec47749e562ef718029ff06555680b5b.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "c826d38990051067a23d7ced76e20925ec47749e562ef718029ff06555680b5b"
   strings:
      $x1 = "-ExecutionPolicy Bypass Add-MpPreference -ExclusionProcess '" fullword wide
      $x2 = "-ExecutionPolicy Bypass Add-MpPreference -ExclusionPath '" fullword wide
      $x3 = "-ExecutionPolicy Bypass -File \"" fullword wide
      $s4 = "NTdll.dll" fullword ascii
      $s5 = "SHCore.dll" fullword ascii
      $s6 = "shutdown.exe /f /s /t 0" fullword wide
      $s7 = "shutdown.exe /f /r /t 0" fullword wide
      $s8 = "WScript.Shell" fullword wide
      $s9 = "shutdown.exe -L" fullword wide
      $s10 = "\\Log.tmp" fullword wide
      $s11 = "CloseMutex" fullword ascii
      $s12 = "ProcessDpi" fullword ascii
      $s13 = "_appMutex" fullword ascii
      $s14 = "Win32_Processor.deviceid=\"CPU0\"" fullword wide
      $s15 = "WHKEYBOARDLL" fullword ascii
      $s16 = "XLogger" fullword ascii
      $s17 = "AES_Encryptor" fullword ascii
      $s18 = "LoggerPath" fullword ascii
      $s19 = "\\drivers\\etc\\hosts" fullword wide
      $s20 = "userAgents" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 100KB and
      1 of ($x*) and 4 of them
}

rule sig_71c91905a377be84dca1c0965d8ef92d7c4cd53c137205699f26582cf8107476 {
   meta:
      description = "samples - file 71c91905a377be84dca1c0965d8ef92d7c4cd53c137205699f26582cf8107476.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "71c91905a377be84dca1c0965d8ef92d7c4cd53c137205699f26582cf8107476"
   strings:
      $s1 = "jaUy.exe" fullword wide
      $s2 = "TVqQ:M::E::__8:Lg::::AQ:::::::::::::::::::::::Ag::A4fug4AtAnNIbg?TM0hVGhpcy?wcm9ncmFtIGNhbm5vdC?iZS?ydW4gaW4gRE9TIG1vZGUuDQ0KJ::" ascii
      $s3 = "CollegeInformationSystem.LoginForm.resources" fullword ascii
      $s4 = "SELECT * FROM [CollegeDB].[dbo].[user_login] WHERE username = '" fullword wide
      $s5 = "LoginForm" fullword wide
      $s6 = "ValidateUserLogin" fullword ascii
      $s7 = "loginInvalid" fullword wide
      $s8 = "PasswordBox_KeyPress" fullword ascii
      $s9 = "Login required" fullword wide
      $s10 = "Test login Username: John12 Password:1234" fullword wide
      $s11 = "jaUy.pdb" fullword ascii
      $s12 = "INSERT INTO dbo.student (first_name, last_name, date_of_birth, Address, Country, PostCode, email, phone)VALUES('" fullword wide
      $s13 = "postcode" fullword wide
      $s14 = "Incorrect username or password." fullword wide
      $s15 = "Designed and implemented by Michail Panagopoulos - 2022" fullword wide
      $s16 = "' AND password = '" fullword wide
      $s17 = "Login details are required in order to proceed. This application will now close." fullword wide
      $s18 = "Postcode" fullword wide
      $s19 = "CollegeInformationSystem.MainForm.resources" fullword ascii
      $s20 = "CollegeInformationSystem.ResultsForm.resources" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 2000KB and
      8 of them
}

rule dc74ae7a70778659ee1f27f8e772ab2513299da34c7b2eabb866152e5588720b {
   meta:
      description = "samples - file dc74ae7a70778659ee1f27f8e772ab2513299da34c7b2eabb866152e5588720b.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "dc74ae7a70778659ee1f27f8e772ab2513299da34c7b2eabb866152e5588720b"
   strings:
      $s1 = "TVqQ:M::E::__8:Lg::::AQ:::::::::::::::::::::::Ag::A4fug4AtAnNIbg?TM0hVGhpcy?wcm9ncmFtIGNhbm5vdC?iZS?ydW4gaW4gRE9TIG1vZGUuDQ0KJ::" ascii
      $s2 = "CollegeInformationSystem.LoginForm.resources" fullword ascii
      $s3 = "mRdm.exe" fullword wide
      $s4 = "SELECT * FROM [CollegeDB].[dbo].[user_login] WHERE username = '" fullword wide
      $s5 = "LoginForm" fullword wide
      $s6 = "ValidateUserLogin" fullword ascii
      $s7 = "loginInvalid" fullword wide
      $s8 = "PasswordBox_KeyPress" fullword ascii
      $s9 = "Login required" fullword wide
      $s10 = "Test login Username: John12 Password:1234" fullword wide
      $s11 = "INSERT INTO dbo.student (first_name, last_name, date_of_birth, Address, Country, PostCode, email, phone)VALUES('" fullword wide
      $s12 = "mRdm.pdb" fullword ascii
      $s13 = "postcode" fullword wide
      $s14 = "Incorrect username or password." fullword wide
      $s15 = "Designed and implemented by Michail Panagopoulos - 2022" fullword wide
      $s16 = "' AND password = '" fullword wide
      $s17 = "Login details are required in order to proceed. This application will now close." fullword wide
      $s18 = "Postcode" fullword wide
      $s19 = "CollegeInformationSystem.MainForm.resources" fullword ascii
      $s20 = "CollegeInformationSystem.ResultsForm.resources" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 2000KB and
      8 of them
}

rule e9d082e59f131a020a870a416b1fbd2aa978f0706fa690080a268a5295bd8bb2 {
   meta:
      description = "samples - file e9d082e59f131a020a870a416b1fbd2aa978f0706fa690080a268a5295bd8bb2.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "e9d082e59f131a020a870a416b1fbd2aa978f0706fa690080a268a5295bd8bb2"
   strings:
      $s1 = "TVqQ:M::E::__8:Lg::::AQ:::::::::::::::::::::::Ag::A4fug4AtAnNIbg?TM0hVGhpcy?wcm9ncmFtIGNhbm5vdC?iZS?ydW4gaW4gRE9TIG1vZGUuDQ0KJ::" ascii
      $s2 = "CollegeInformationSystem.LoginForm.resources" fullword ascii
      $s3 = "mgHY.exe" fullword wide
      $s4 = "SELECT * FROM [CollegeDB].[dbo].[user_login] WHERE username = '" fullword wide
      $s5 = "LoginForm" fullword wide
      $s6 = "ValidateUserLogin" fullword ascii
      $s7 = "loginInvalid" fullword wide
      $s8 = "PasswordBox_KeyPress" fullword ascii
      $s9 = "Login required" fullword wide
      $s10 = "Test login Username: John12 Password:1234" fullword wide
      $s11 = "INSERT INTO dbo.student (first_name, last_name, date_of_birth, Address, Country, PostCode, email, phone)VALUES('" fullword wide
      $s12 = "mgHY.pdb" fullword ascii
      $s13 = "postcode" fullword wide
      $s14 = "Incorrect username or password." fullword wide
      $s15 = "Designed and implemented by Michail Panagopoulos - 2022" fullword wide
      $s16 = "' AND password = '" fullword wide
      $s17 = "Login details are required in order to proceed. This application will now close." fullword wide
      $s18 = "Postcode" fullword wide
      $s19 = "CollegeInformationSystem.MainForm.resources" fullword ascii
      $s20 = "CollegeInformationSystem.ResultsForm.resources" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 2000KB and
      8 of them
}

rule d2b5d02ad0207f69484b73eae658c2c08b747b4b3125e8856c5f0df261217f1e {
   meta:
      description = "samples - file d2b5d02ad0207f69484b73eae658c2c08b747b4b3125e8856c5f0df261217f1e.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "d2b5d02ad0207f69484b73eae658c2c08b747b4b3125e8856c5f0df261217f1e"
   strings:
      $s1 = "TVqQ:M::E::__8:Lg::::AQ:::::::::::::::::::::::Ag::A4fug4AtAnNIbg?TM0hVGhpcy?wcm9ncmFtIGNhbm5vdC?iZS?ydW4gaW4gRE9TIG1vZGUuDQ0KJ::" ascii
      $s2 = "CollegeInformationSystem.LoginForm.resources" fullword ascii
      $s3 = "kJRf.exe" fullword wide
      $s4 = "SELECT * FROM [CollegeDB].[dbo].[user_login] WHERE username = '" fullword wide
      $s5 = "LoginForm" fullword wide
      $s6 = "ValidateUserLogin" fullword ascii
      $s7 = "loginInvalid" fullword wide
      $s8 = "PasswordBox_KeyPress" fullword ascii
      $s9 = "Login required" fullword wide
      $s10 = "Test login Username: John12 Password:1234" fullword wide
      $s11 = "INSERT INTO dbo.student (first_name, last_name, date_of_birth, Address, Country, PostCode, email, phone)VALUES('" fullword wide
      $s12 = "kJRf.pdb" fullword ascii
      $s13 = "postcode" fullword wide
      $s14 = "Incorrect username or password." fullword wide
      $s15 = "Designed and implemented by Michail Panagopoulos - 2022" fullword wide
      $s16 = "' AND password = '" fullword wide
      $s17 = "Login details are required in order to proceed. This application will now close." fullword wide
      $s18 = "Postcode" fullword wide
      $s19 = "CollegeInformationSystem.MainForm.resources" fullword ascii
      $s20 = "CollegeInformationSystem.ResultsForm.resources" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 2000KB and
      8 of them
}

rule sig_9c1c20db1d73c66795b9b49f39aff02d621dd06c05d7d3ea1007ac7bcbf3f3cd {
   meta:
      description = "samples - file 9c1c20db1d73c66795b9b49f39aff02d621dd06c05d7d3ea1007ac7bcbf3f3cd.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "9c1c20db1d73c66795b9b49f39aff02d621dd06c05d7d3ea1007ac7bcbf3f3cd"
   strings:
      $s1 = "ehttp://pki-crl.symauth.com/offlineca/TheInstituteofElectricalandElectronicsEngineersIncIEEERootCA.crl0" fullword ascii
      $s2 = "Lhttp://pki-crl.symauth.com/ca_732b6ec148d290c0a071efd1dac8e288/LatestCRL.crl07" fullword ascii
      $s3 = "http://pki-ocsp.symauth.com0" fullword ascii
      $s4 = "MgEye7" fullword ascii
      $s5 = "efF.enF&evG>I" fullword ascii
      $s6 = "\\#7Xp0cW>" fullword ascii
      $s7 = "L+ xB;" fullword ascii
      $s8 = "l+ plB\"TKJ6" fullword ascii
      $s9 = ":* 0c7" fullword ascii
      $s10 = "cwoeft" fullword ascii
      $s11 = "J /bqk" fullword ascii
      $s12 = "- {lM#_G" fullword ascii
      $s13 = "wm_- %" fullword ascii
      $s14 = "# ;LZI*jb#U" fullword ascii
      $s15 = "iOpxha7" fullword ascii
      $s16 = "YVdLGE7" fullword ascii
      $s17 = "l* qlZ alJ Qlz Alj&" fullword ascii
      $s18 = "l* ulR\"}kp" fullword ascii
      $s19 = "%k3%T%" fullword ascii
      $s20 = "pIb0:!." fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 7000KB and
      8 of them
}

rule sig_11f5b01983cd221e28aa672906d313ca45dc0ed41f351602779590576104c52e {
   meta:
      description = "samples - file 11f5b01983cd221e28aa672906d313ca45dc0ed41f351602779590576104c52e.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "11f5b01983cd221e28aa672906d313ca45dc0ed41f351602779590576104c52e"
   strings:
      $s1 = "ehttp://pki-crl.symauth.com/offlineca/TheInstituteofElectricalandElectronicsEngineersIncIEEERootCA.crl0" fullword ascii
      $s2 = "Lhttp://pki-crl.symauth.com/ca_732b6ec148d290c0a071efd1dac8e288/LatestCRL.crl07" fullword ascii
      $s3 = "http://pki-ocsp.symauth.com0" fullword ascii
      $s4 = "esdexdn" fullword ascii
      $s5 = "CxDD -)q" fullword ascii
      $s6 = "pD:\\Ae#S" fullword ascii
      $s7 = "]hYC:\\" fullword ascii
      $s8 = "3HN:\">" fullword ascii
      $s9 = "- ^VKl" fullword ascii
      $s10 = "TLTUbt2" fullword ascii
      $s11 = "$b=<* " fullword ascii
      $s12 = "lCYbM63" fullword ascii
      $s13 = " -8dVL" fullword ascii
      $s14 = "KEglBb1" fullword ascii
      $s15 = "pnnpDkz7" fullword ascii
      $s16 = "+ ;(?C" fullword ascii
      $s17 = "njqqre" fullword ascii
      $s18 = "mY -`1" fullword ascii
      $s19 = "*sCX+ " fullword ascii
      $s20 = "DyjpKk8" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 7000KB and
      8 of them
}

rule sig_10b3c6068f0a789fb58f35230fdf9ab01f54aba30cf50fb06566f09568df7d1e {
   meta:
      description = "samples - file 10b3c6068f0a789fb58f35230fdf9ab01f54aba30cf50fb06566f09568df7d1e.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "10b3c6068f0a789fb58f35230fdf9ab01f54aba30cf50fb06566f09568df7d1e"
   strings:
      $s1 = "                <requestedExecutionLevel level=\"asInvoker\" uiAccess=\"false\" />" fullword ascii
      $s2 = "lns:asmv2=\"urn:schemas-microsoft-com:asm.v2\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\">" fullword ascii
      $s3 = "\\}- -x@H" fullword ascii
      $s4 = "foWD.yGc" fullword ascii
      $s5 = "bob0{f<%n:\"}dA" fullword ascii
      $s6 = "sZ -s " fullword ascii
      $s7 = "PosT\\:Zd" fullword ascii
      $s8 = "* I3V~" fullword ascii
      $s9 = "wviRc#uY" fullword ascii
      $s10 = "* %W7z_" fullword ascii
      $s11 = "SZFN$Ftp" fullword ascii
      $s12 = " -%%f33mu!ivMY}FL" fullword ascii
      $s13 = "odjtiah" fullword ascii
      $s14 = "+ `zFmRXjT.>6" fullword ascii
      $s15 = "doostzs" fullword ascii
      $s16 = "^8 -%i=" fullword ascii
      $s17 = "kq\"nYBoQX* u." fullword ascii
      $s18 = "*`y,R\\DoSY/$n -HQ" fullword ascii
      $s19 = "z+QSGhP&+ r," fullword ascii
      $s20 = "UQZd+ \"<w))M_" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 26000KB and
      8 of them
}

rule sig_902f94aa7222739a873f8f2805428e89822fc34842a0d731828ca0d6fce69dd6 {
   meta:
      description = "samples - file 902f94aa7222739a873f8f2805428e89822fc34842a0d731828ca0d6fce69dd6.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "902f94aa7222739a873f8f2805428e89822fc34842a0d731828ca0d6fce69dd6"
   strings:
      $s1 = "SolaraBootstrapper.exe" fullword wide
      $s2 = "5Qz.eCv" fullword ascii
      $s3 = "}#{e+ " fullword ascii
      $s4 = "`.idata" fullword ascii /* Goodware String - occured 1 times */
      $s5 = "GCVj64D" fullword ascii
      $s6 = "RQYZRZh" fullword ascii
      $s7 = "SolaraBootstrapper" fullword wide
      $s8 = "EDrse9" fullword ascii
      $s9 = "\\`{c`Y" fullword ascii
      $s10 = "  2024" fullword wide
      $s11 = "Shlwapi.dll" fullword ascii /* Goodware String - occured 4 times */
      $s12 = "O%p#JP" fullword ascii
      $s13 = "XP|l5/" fullword ascii
      $s14 = "%i\\9oMP" fullword ascii
      $s15 = "oqk@H]" fullword ascii
      $s16 = "U).iF2" fullword ascii
      $s17 = "\";mnZs" fullword ascii
      $s18 = "S$'Sd0" fullword ascii
      $s19 = "R6. tc" fullword ascii
      $s20 = ";}9.=2" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 7000KB and
      8 of them
}

rule fa72acb53d44a992bf54c08f17c98efcae130abe7024ef9b59935d5bbba9f1a1 {
   meta:
      description = "samples - file fa72acb53d44a992bf54c08f17c98efcae130abe7024ef9b59935d5bbba9f1a1.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "fa72acb53d44a992bf54c08f17c98efcae130abe7024ef9b59935d5bbba9f1a1"
   strings:
      $s1 = "frmpee" fullword ascii
      $s2 = "vJZH/vi" fullword ascii
      $s3 = "LPADGG=x" fullword ascii
      $s4 = "@PZDGG=x" fullword ascii
      $s5 = "cqqqFqCq0qAq_q" fullword ascii
      $s6 = "AmIyOMS" fullword ascii
      $s7 = "vxKDTL|" fullword ascii
      $s8 = "\\a94X}" fullword ascii
      $s9 = "ZYT*q1" fullword ascii
      $s10 = "9u*)Y." fullword ascii
      $s11 = "KQK *@Q" fullword ascii
      $s12 = "tOQt 2" fullword ascii
      $s13 = "uB_^[%" fullword ascii
      $s14 = "jxSWBP" fullword ascii
      $s15 = "fr(seeq" fullword ascii
      $s16 = "c91R^8$'@0" fullword ascii
      $s17 = "%///X/B/F/L///w" fullword ascii
      $s18 = "P8^OQ}" fullword ascii
      $s19 = "?gce26" fullword ascii
      $s20 = ")yJ3K-0" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 100KB and
      8 of them
}

/* Super Rules ------------------------------------------------------------- */

rule _f9dc41ab7a043cf887b9737060be951dd11571c5774a8b6ca004b503c1995c72_8fc9056ebee5adcd70c3d96e53885fcb355030869137a6f1977a463759_0 {
   meta:
      description = "samples - from files f9dc41ab7a043cf887b9737060be951dd11571c5774a8b6ca004b503c1995c72.exe, 8fc9056ebee5adcd70c3d96e53885fcb355030869137a6f1977a463759f15d86.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "f9dc41ab7a043cf887b9737060be951dd11571c5774a8b6ca004b503c1995c72"
      hash2 = "8fc9056ebee5adcd70c3d96e53885fcb355030869137a6f1977a463759f15d86"
   strings:
      $s1 = "DN7D24oTIvLvelUFhJ8.Cnh9yaoRbBCwNtcZdmq+zpW820ott9J04VZfkPl+Bxcj9SofNG7H015mapn`1[[System.Object, mscorlib, Version=4.0.0.0, Cul" ascii
      $s2 = "DN7D24oTIvLvelUFhJ8.Cnh9yaoRbBCwNtcZdmq+zpW820ott9J04VZfkPl+Bxcj9SofNG7H015mapn`1[[System.Object, mscorlib, Version=4.0.0.0, Cul" ascii
      $s3 = "fEMhMnFYSZ" fullword ascii /* base64 encoded string '|C!2qXI' */
      $s4 = "fntnPUpKNZ" fullword ascii /* base64 encoded string '~{g=JJ5' */
      $s5 = "ITQ8aUR2cR" fullword ascii /* base64 encoded string '!4<iDvq' */
      $s6 = "fT9iM1wvXC" fullword ascii /* base64 encoded string '}?b3\/\' */
      $s7 = "NC9UUHUw6" fullword ascii /* base64 encoded string '4/TPu0' */
      $s8 = "nc6usNGgv0NOP0CXIJ5" fullword ascii
      $s9 = "wymMoJbUWNFvSMfwspy" fullword ascii
      $s10 = "khDsPyQ4lJyapySttKV" fullword ascii
      $s11 = "mBufynsQHGet99tbGUL" fullword ascii
      $s12 = "lOgH8G8Tos" fullword ascii
      $s13 = "ircN3i4sRf" fullword ascii
      $s14 = "kNPK30dLlHpLr6aW377" fullword ascii
      $s15 = "qasgq0EyeuyMiAVWumZ" fullword ascii
      $s16 = "jp0cHRvWV3djGo7GmDQ" fullword ascii
      $s17 = "FnA5QWST77DLl5JflSr" fullword ascii
      $s18 = "irCNHLorpNdHWCfufGW" fullword ascii
      $s19 = "JcMKY0T7EYeurHYJg30" fullword ascii
      $s20 = "JWLOGHwNkHCuLha8ACQ" fullword ascii
   condition:
      ( uint16(0) == 0x5a4d and filesize < 5000KB and ( 8 of them )
      ) or ( all of them )
}

rule _5c483ed90d904d0d81967c91ac431a2c27228fd9562dd2f2e3f003644c59076e_159e547225b9f035bf95279055d66810149fa93debea66076655200827_1 {
   meta:
      description = "samples - from files 5c483ed90d904d0d81967c91ac431a2c27228fd9562dd2f2e3f003644c59076e.exe, 159e547225b9f035bf95279055d66810149fa93debea660766552008271e3e5c.exe, 07be352dde09851de71ce7c763537e2b5c567e52fd161304cbaa54895dcd5c8f.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "5c483ed90d904d0d81967c91ac431a2c27228fd9562dd2f2e3f003644c59076e"
      hash2 = "159e547225b9f035bf95279055d66810149fa93debea660766552008271e3e5c"
      hash3 = "07be352dde09851de71ce7c763537e2b5c567e52fd161304cbaa54895dcd5c8f"
   strings:
      $x1 = "Invalid SQL date/time values=Error decoding URL style (%%XX) encoded string at position %d1Invalid URL encoded character (%s) at" wide
      $s2 = "Component %s not foundDGetting the Count of a TComponentsEnumerator object is not supportedWComponent was expected to implement " wide
      $s3 = "xercesxmldom.dll" fullword ascii
      $s4 = "Variable not found: %s=Component does not support scripting. Class: %0:s, Name: %1:s.Object does not support scripting. Class: %" wide
      $s5 = "TXmlStandardProcessorAgent" fullword ascii
      $s6 = "TXmlCustomProcessorAgent" fullword ascii
      $s7 = "TXmlCustomProcessorAgent@wG" fullword ascii
      $s8 = "processorAgent" fullword ascii
      $s9 = "Invalid processing instruction error." fullword ascii
      $s10 = "TXmlProcessorErrorEvent" fullword ascii
      $s11 = "http://www.borland.com/namespaces/Types" fullword wide
      $s12 = "TXmlProcessorEvent4" fullword ascii
      $s13 = "TXmlProcessorEvent3" fullword ascii
      $s14 = "TXmlProcessorEvent1" fullword ascii
      $s15 = "TXmlProcessorEvent16" fullword ascii
      $s16 = "TXmlProcessorEvent15" fullword ascii
      $s17 = "TXmlProcessorEvent12" fullword ascii
      $s18 = "TXmlProcessorEvent5" fullword ascii
      $s19 = "TXmlProcessorEvent6" fullword ascii
      $s20 = "TXmlProcessorEvent11" fullword ascii
   condition:
      ( uint16(0) == 0x5a4d and filesize < 7000KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _1669d57e8c83d0666c86fafcd484a5fd158c995a58ad9a6855c56d849c00b40b_542ddd41bf8603c95458d6c2c15e1a0cff107fbabac55b69b92bd40fd8_2 {
   meta:
      description = "samples - from files 1669d57e8c83d0666c86fafcd484a5fd158c995a58ad9a6855c56d849c00b40b.exe, 542ddd41bf8603c95458d6c2c15e1a0cff107fbabac55b69b92bd40fd8bf1696.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "1669d57e8c83d0666c86fafcd484a5fd158c995a58ad9a6855c56d849c00b40b"
      hash2 = "542ddd41bf8603c95458d6c2c15e1a0cff107fbabac55b69b92bd40fd8bf1696"
   strings:
      $x1 = "JSystem.Private.StackTraceMetadata.dll2System.Private.TypeLoader" fullword ascii
      $x2 = "System.Linq.dllFSystem.Private.Reflection.Execution" fullword ascii
      $x3 = "NSystem.Private.Reflection.Execution.dllBSystem.Private.StackTraceMetadata" fullword ascii
      $s4 = "4System.Private.CoreLib.dll" fullword ascii
      $s5 = ":System.Private.TypeLoader.dll8System.Security.Cryptography" fullword ascii
      $s6 = "Could not get process token. Win32 Error Code:" fullword wide
      $s7 = "System.Core, Version=3.5.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089gc" fullword ascii
      $s8 = "System.Runtime, Version=4.2.1.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a,DeserializationTracker,SerializationException*" ascii
      $s9 = "System.Core, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" fullword ascii
      $s10 = "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" ascii /* base64 encoded string '                                            ' */
      $s11 = "BSystem.Security.AccessControl.dll" fullword ascii
      $s12 = "JSystem.Security.Principal.Windows.dll" fullword ascii
      $s13 = "TargetvM:System.Security.Cryptography.CryptoConfigForwarder.#cctor" fullword ascii
      $s14 = "The current thread attempted to reacquire a mutex that has reached its maximum acquire count" fullword wide
      $s15 = "System.Collections.Generic.IEnumerator<Internal.Runtime.TypeLoader.TypeLoaderEnvironment.GenericMethodEntry>.get_Current@" fullword ascii
      $s16 = "System.Collections.Generic.IEnumerator<Internal.Runtime.TypeLoader.TypeLoaderEnvironment.GenericTypeEntry>.get_Current@" fullword ascii
      $s17 = "System.Collections.Generic.IEnumerable<Internal.Runtime.TypeLoader.TypeLoaderEnvironment.GenericMethodEntry>.GetEnumerator@" fullword ascii
      $s18 = "System.Collections.Generic.IEnumerable<System.Runtime.Loader.LibraryNameVariation>.GetEnumerator@" fullword ascii
      $s19 = "System.Collections.Generic.IEnumerable<Internal.Runtime.TypeLoader.TypeLoaderEnvironment.GenericTypeEntry>.GetEnumerator@" fullword ascii
      $s20 = "System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" fullword ascii
   condition:
      ( uint16(0) == 0x5a4d and filesize < 7000KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _2f175dac5c8571e586722f6927b0112af22637a17efb3acfd78e813a804a38f8_fdc933b64df0832a1f88f0e19a4cab67fb110d54c4913367a7215d7890_3 {
   meta:
      description = "samples - from files 2f175dac5c8571e586722f6927b0112af22637a17efb3acfd78e813a804a38f8.exe, fdc933b64df0832a1f88f0e19a4cab67fb110d54c4913367a7215d7890f8a5b7.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "2f175dac5c8571e586722f6927b0112af22637a17efb3acfd78e813a804a38f8"
      hash2 = "fdc933b64df0832a1f88f0e19a4cab67fb110d54c4913367a7215d7890f8a5b7"
   strings:
      $s1 = "gSystem.Net.Mail.MailPriority, System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" fullword ascii
      $s2 = "rSystem.Diagnostics.ProcessPriorityClass, System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" fullword ascii
      $s3 = "XSystem.Guid, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089$00000000-0000-0000-0000-000000000000" fullword ascii
      $s4 = "FileZSystem.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" fullword ascii
      $s5 = "-NoLogo -NonInteractive -WindowStyle Hidden -Command \"& {{<# {0}:{1} #> {2}}}\"" fullword wide
      $s6 = "]System.Attribute, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" fullword ascii
      $s7 = "[System.Version, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" fullword ascii
      $s8 = "get_ActionTypeExecute" fullword ascii
      $s9 = "get_ProcessTokenSidType" fullword ascii
      $s10 = "Microsoft.Win32.TaskSchedulerEditor.dll" fullword wide
      $s11 = "TimeSpan2.dll" fullword wide
      $s12 = "may only contain ExecAction and ComHanlderAction types unless Actions.PowerShellConversion includes Version2." fullword wide
      $s13 = "SessionProcessLaunchFailed" fullword ascii
      $s14 = "TokenExecute" fullword ascii
      $s15 = "SessionFailedToProcessMessage" fullword ascii
      $s16 = "5Microsoft.Win32.TaskScheduler.TaskProcessTokenSidType" fullword ascii
      $s17 = "get_ExecutionTimeLimit" fullword ascii
      $s18 = "SessionProcessConnectFailed" fullword ascii
      $s19 = "Principal.ProcessTokenSidType" fullword wide
      $s20 = "Only a single ExecAction is supported unless the PowerShellConversion property includes the Version1 value." fullword wide
   condition:
      ( uint16(0) == 0x5a4d and filesize < 1000KB and ( 8 of them )
      ) or ( all of them )
}

rule _5d1c2ac36ca274835d9025eb9e3f7a113cf57509898e02cb9add7a97824cea59_788bf2c07ca9619f9e388dc1a068aa4d6c3eb804ea375fb6b575ebe315_4 {
   meta:
      description = "samples - from files 5d1c2ac36ca274835d9025eb9e3f7a113cf57509898e02cb9add7a97824cea59.exe, 788bf2c07ca9619f9e388dc1a068aa4d6c3eb804ea375fb6b575ebe3154e6c54.exe, f9ae0d40d4f2b88956a1ccfe6cff9aae6a36508574a56595c331d7ca207e5f03.exe, 2c38956763bb9c8df8d9eb32a8f30252e3e4ac0249f650f609d0036a16e01b9e.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "5d1c2ac36ca274835d9025eb9e3f7a113cf57509898e02cb9add7a97824cea59"
      hash2 = "788bf2c07ca9619f9e388dc1a068aa4d6c3eb804ea375fb6b575ebe3154e6c54"
      hash3 = "f9ae0d40d4f2b88956a1ccfe6cff9aae6a36508574a56595c331d7ca207e5f03"
      hash4 = "2c38956763bb9c8df8d9eb32a8f30252e3e4ac0249f650f609d0036a16e01b9e"
   strings:
      $s1 = "<assemblyIdentity type=\"win32\" name=\"Microsoft.Windows.Common-Controls\" version=\"6.0.0.0\" language=\"*\" processorArchitec" ascii
      $s2 = "/AutoIt3ExecuteScript" fullword wide
      $s3 = "/AutoIt3ExecuteLine" fullword wide
      $s4 = "PROCESSGETSTATS" fullword wide
      $s5 = "WINGETPROCESS" fullword wide
      $s6 = "SCRIPTNAME" fullword wide /* base64 encoded string 'H$H=3@0' */
      $s7 = "SHELLEXECUTE" fullword wide
      $s8 = "SHELLEXECUTEWAIT" fullword wide
      $s9 = "*Unable to get a list of running processes." fullword wide
      $s10 = "HTTPSETUSERAGENT" fullword wide
      $s11 = "PROCESSCLOSE" fullword wide
      $s12 = "PROCESSEXISTS" fullword wide
      $s13 = "PROCESSLIST" fullword wide
      $s14 = "PROCESSSETPRIORITY" fullword wide
      $s15 = "PROCESSWAIT" fullword wide
      $s16 = "PROCESSWAITCLOSE" fullword wide
      $s17 = "PROCESSORARCH" fullword wide
      $s18 = "STRINGREVERSE" fullword wide /* base64 encoded string 'I4H4dDTDR' */
      $s19 = "Error parsing function call.0Incorrect number of parameters in function call.'\"ReDim\" used without an array variable.>Illegal " wide
      $s20 = "CMDLINERAW" fullword wide
   condition:
      ( uint16(0) == 0x5a4d and filesize < 3000KB and ( 8 of them )
      ) or ( all of them )
}

rule _16335a1172a838611368645dab4446c79b750e3159a6d9f95556d420c559f469_da6b0f4662ab7c277189dafa7f323551c54982b2d54466feefc27d83a3_5 {
   meta:
      description = "samples - from files 16335a1172a838611368645dab4446c79b750e3159a6d9f95556d420c559f469.exe, da6b0f4662ab7c277189dafa7f323551c54982b2d54466feefc27d83a3c90e3c.exe, c5c9fb0b1e4ba8aed4f8cefb1d77931dd2d5137d6396b7c30630b2864303ee52.exe, a163d18a93ea4bee62762da2d1dfc7d0a2644428fc868fabcb4347cbcf17cc62.exe, 438c9ce6e0b21ec7623f86a2f3e7f1810df1afce1515a5f24d1453a5cacdd74d.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "16335a1172a838611368645dab4446c79b750e3159a6d9f95556d420c559f469"
      hash2 = "da6b0f4662ab7c277189dafa7f323551c54982b2d54466feefc27d83a3c90e3c"
      hash3 = "c5c9fb0b1e4ba8aed4f8cefb1d77931dd2d5137d6396b7c30630b2864303ee52"
      hash4 = "a163d18a93ea4bee62762da2d1dfc7d0a2644428fc868fabcb4347cbcf17cc62"
      hash5 = "438c9ce6e0b21ec7623f86a2f3e7f1810df1afce1515a5f24d1453a5cacdd74d"
   strings:
      $x1 = "{System.ComponentModel.Design.BinaryEditor, System.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3auSys" ascii
      $x2 = "System.Diagnostics.EventLog.Messages.dll" fullword wide
      $s3 = "ControlledExecution.Run method may corrupt the process and should not be used in production code." fullword wide
      $s4 = "tem.Drawing.Design.UITypeEditor, System.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a" fullword ascii
      $s5 = "System.Runtime.InteropServices.StringMarshalling, System.Runtime.InteropServices, Version=8.0.0.0, Culture=neutral, PublicKeyTok" ascii
      $s6 = "System.Runtime.InteropServices.StringMarshalling, System.Runtime.InteropServices, Version=8.0.0.0, Culture=neutral, PublicKeyTok" ascii
      $s7 = "msquic.dll" fullword wide
      $s8 = "avtry.exe" fullword wide
      $s9 = "The Constrained Execution Region (CER) feature is not supported." fullword wide
      $s10 = "PublicKey.Key is obsolete. Use the appropriate method to get the public key, such as GetRSAPublicKey." fullword wide
      $s11 = "<EvtGetLogInfo>g____PInvoke|52_0" fullword ascii
      $s12 = "AssemblyName members HashAlgorithm, ProcessorArchitecture, and VersionCompatibility are obsolete and not supported." fullword wide
      $s13 = "FxResources.System.Diagnostics.EventLog.SR.resources" fullword ascii
      $s14 = "FxResources.System.Diagnostics.EventLog" fullword ascii
      $s15 = "    <!-- System.Resources.UseSystemResourceKeys removes resource strings and instead uses the resource key as the exception mess" ascii
      $s16 = "JMicrosoft.Win32.UnsafeNativeMethods+EvtRpcLogin+Marshaller+ValueMarshaller" fullword ascii
      $s17 = "RuntimeEnvironment members SystemConfigurationFile, GetRuntimeInterfaceAsIntPtr, and GetRuntimeInterfaceAsObject are not support" wide
      $s18 = "Rfc2898DeriveBytes.CryptDeriveKey is obsolete and is not supported. Use PasswordDeriveBytes.CryptDeriveKey instead." fullword wide
      $s19 = "ECDiffieHellmanPublicKey.ToByteArray() and the associated constructor do not have a consistent and interoperable implementation " wide
      $s20 = "System.ComponentModel.Primitives" fullword ascii
   condition:
      ( uint16(0) == 0x5a4d and filesize < 1000KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _05b1be412276f70e579862cef3cc0181785ca3c7d6bd398ec2919d50bb4f5630_e4d52884a348b211ebaab9018b286c9f7023abc349f229cc63fea89b53_6 {
   meta:
      description = "samples - from files 05b1be412276f70e579862cef3cc0181785ca3c7d6bd398ec2919d50bb4f5630.exe, e4d52884a348b211ebaab9018b286c9f7023abc349f229cc63fea89b5341341e.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "05b1be412276f70e579862cef3cc0181785ca3c7d6bd398ec2919d50bb4f5630"
      hash2 = "e4d52884a348b211ebaab9018b286c9f7023abc349f229cc63fea89b5341341e"
   strings:
      $x1 = "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?><assembly xmlns=\"urn:schemas-microsoft-com:asm.v1\" manifestVersio" ascii
      $s2 = "ontrols\" version=\"6.0.0.0\" processorArchitecture=\"*\" publicKeyToken=\"6595b64144ccf1df\" language=\"*\" /></dependentAssemb" ascii
      $s3 = "ndency><trustInfo xmlns=\"urn:schemas-microsoft-com:asm.v3\"><security><requestedPrivileges><requestedExecutionLevel level=\"asI" ascii
      $s4 = "nonproblematic.exe" fullword wide
      $s5 = "nstall System v3.0b0</description><dependency><dependentAssembly><assemblyIdentity type=\"win32\" name=\"Microsoft.Windows.Commo" ascii
      $s6 = "ker\" uiAccess=\"false\"/></requestedPrivileges></security></trustInfo><compatibility xmlns=\"urn:schemas-microsoft-com:compatib" ascii
      $s7 = "kombinere amaryllises papyrusser" fullword wide
      $s8 = "steroedeck modulsystem psykofarmakum" fullword wide
      $s9 = "bES.oPm" fullword ascii
      $s10 = "e38}\"/><supportedOS Id=\"{35138b9a-5d96-4fbd-8e2d-a2440225f93a}\"/></application></compatibility></assembly>" fullword ascii
      $s11 = "faniente arkivfiler ataraxics" fullword wide
      $s12 = "hT- ]e" fullword ascii
      $s13 = "5+ /!9" fullword ascii
      $s14 = "<y* D." fullword ascii
      $s15 = "bwFBzb5" fullword ascii
      $s16 = ";@- cO" fullword ascii
      $s17 = "l:U9!." fullword ascii
      $s18 = "p?%pz* =" fullword ascii
      $s19 = "_VFlm\"X" fullword ascii
      $s20 = "bAwv!p " fullword ascii
   condition:
      ( uint16(0) == 0x5a4d and filesize < 3000KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _5251011e8feda9381a5a1b119b36c8bd4bbd3de97044743d8cea2d2f69ee0b4d_af2f05611639653b5c588b25b9e42d57f53fd0262681f89f6acdc24b58_7 {
   meta:
      description = "samples - from files 5251011e8feda9381a5a1b119b36c8bd4bbd3de97044743d8cea2d2f69ee0b4d.exe, af2f05611639653b5c588b25b9e42d57f53fd0262681f89f6acdc24b58887214.exe, 0ff8f9853b1951fcefad14ec98e7c21d098fa87d5e3af0cb0d1f2962315a483f.exe, 7e93b3a5bed3d2ab87eac6f297e6bbc63c7cc27e8da00b1ad4f6275c428a130f.exe, 518ee9f74a609d856403d4a94c650e62aba87c9dd17e6e885fe4e0adc4113e9a.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "5251011e8feda9381a5a1b119b36c8bd4bbd3de97044743d8cea2d2f69ee0b4d"
      hash2 = "af2f05611639653b5c588b25b9e42d57f53fd0262681f89f6acdc24b58887214"
      hash3 = "0ff8f9853b1951fcefad14ec98e7c21d098fa87d5e3af0cb0d1f2962315a483f"
      hash4 = "7e93b3a5bed3d2ab87eac6f297e6bbc63c7cc27e8da00b1ad4f6275c428a130f"
      hash5 = "518ee9f74a609d856403d4a94c650e62aba87c9dd17e6e885fe4e0adc4113e9a"
   strings:
      $s1 = "System.Security.Permissions.SecurityPermissionAttribute, mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934" ascii
      $s2 = "lSystem.Resources.ResourceReader, mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089#System.Resources.R" ascii
      $s3 = "H7rrlW34uZ4g7TG29m695QHDWNDM6maH760RUMe2fvs6fBSV9ArU3xwZc58t79bYW92J4Kch8bJvQTXR7ZSLOpr16aCx9Y9b8sq08YK78X7af00cL6y1OAAaRhD2nS88" wide
      $s4 = "GetMusic" fullword ascii
      $s5 = "_getPath" fullword ascii
      $s6 = "approximation" fullword wide
      $s7 = "chieftain" fullword wide
      $s8 = "26fc2.resources" fullword ascii
      $s9 = "MusicReader" fullword ascii
      $s10 = "1973c.png" fullword wide
      $s11 = "1.28.14.52" fullword wide
      $s12 = " gluttonous" fullword wide
      $s13 = "aluminium " fullword wide
      $s14 = "button26" fullword wide
      $s15 = "button14" fullword wide
      $s16 = "button73" fullword wide
      $s17 = "button25" fullword wide
      $s18 = "button80" fullword wide
      $s19 = "button17" fullword wide
      $s20 = "textBox11" fullword wide
   condition:
      ( uint16(0) == 0x5a4d and filesize < 400KB and ( 8 of them )
      ) or ( all of them )
}

rule _a228df5184a2c1a2864e8e7872c2ab98718a287ffea2d6c2c4dd65ba85752692_5c483ed90d904d0d81967c91ac431a2c27228fd9562dd2f2e3f003644c_8 {
   meta:
      description = "samples - from files a228df5184a2c1a2864e8e7872c2ab98718a287ffea2d6c2c4dd65ba85752692.exe, 5c483ed90d904d0d81967c91ac431a2c27228fd9562dd2f2e3f003644c59076e.exe, 159e547225b9f035bf95279055d66810149fa93debea660766552008271e3e5c.exe, 07be352dde09851de71ce7c763537e2b5c567e52fd161304cbaa54895dcd5c8f.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "a228df5184a2c1a2864e8e7872c2ab98718a287ffea2d6c2c4dd65ba85752692"
      hash2 = "5c483ed90d904d0d81967c91ac431a2c27228fd9562dd2f2e3f003644c59076e"
      hash3 = "159e547225b9f035bf95279055d66810149fa93debea660766552008271e3e5c"
      hash4 = "07be352dde09851de71ce7c763537e2b5c567e52fd161304cbaa54895dcd5c8f"
   strings:
      $s1 = "FPUMaskValue" fullword ascii /* Goodware String - occured 23 times */
      $s2 = "UrlMon" fullword ascii /* Goodware String - occured 30 times */
      $s3 = "WinSock" fullword ascii /* Goodware String - occured 31 times */
      $s4 = "SysUtils" fullword ascii /* Goodware String - occured 34 times */
      $s5 = "TFiler" fullword ascii /* Goodware String - occured 48 times */
      $s6 = "TFileStream" fullword ascii /* Goodware String - occured 50 times */
      $s7 = "TPersistent" fullword ascii /* Goodware String - occured 55 times */
      $s8 = "Background" fullword wide /* Goodware String - occured 153 times */
      $s9 = "3333f3333333" ascii /* Goodware String - occured 1 times */
      $s10 = "OnTimerSV" fullword ascii /* Goodware String - occured 1 times */
      $s11 = " 2001, 2002 Mike Lischke" fullword ascii
      $s12 = "Menusx" fullword ascii /* Goodware String - occured 1 times */
      $s13 = "1234567890ABCDEF" ascii /* Goodware String - occured 2 times */
      $s14 = "~D_^[Y]" fullword ascii /* Goodware String - occured 2 times */
      $s15 = "Alt+ Clipboard does not support Icons" fullword wide /* Goodware String - occured 2 times */
      $s16 = "OnShowSV" fullword ascii /* Goodware String - occured 3 times */
      $s17 = "StdCtrls8" fullword ascii /* Goodware String - occured 3 times */
      $s18 = " - Dock zone has no control\"Unable to find a Table of Contents" fullword wide /* Goodware String - occured 3 times */
      $s19 = ":GauOFKu" fullword ascii /* Goodware String - occured 4 times */
      $s20 = "5 5$5(5,5054585H5h5p5t5x5|5" fullword ascii
   condition:
      ( uint16(0) == 0x5a4d and filesize < 7000KB and ( 8 of them )
      ) or ( all of them )
}

rule _a228df5184a2c1a2864e8e7872c2ab98718a287ffea2d6c2c4dd65ba85752692_7001acf354484cbbb58bbf0bfbfc0644bd629ca6b02c10f8b4e7fd4371_9 {
   meta:
      description = "samples - from files a228df5184a2c1a2864e8e7872c2ab98718a287ffea2d6c2c4dd65ba85752692.exe, 7001acf354484cbbb58bbf0bfbfc0644bd629ca6b02c10f8b4e7fd4371c89a99.exe, f181b5a4e2f0dc0cdf70e16c18e3466e436aae0bb96ef9b7dc24c7f219167115.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "a228df5184a2c1a2864e8e7872c2ab98718a287ffea2d6c2c4dd65ba85752692"
      hash2 = "7001acf354484cbbb58bbf0bfbfc0644bd629ca6b02c10f8b4e7fd4371c89a99"
      hash3 = "f181b5a4e2f0dc0cdf70e16c18e3466e436aae0bb96ef9b7dc24c7f219167115"
   strings:
      $x1 = "blyIdentity type=\"win32\" name=\"Microsoft.Windows.Common-Controls\" version=\"6.0.0.0\" processorArchitecture=\"x86\" publicKe" ascii
      $s2 = "<assemblyIdentity name=\"E.App\" processorArchitecture=\"x86\" version=\"5.2.0.0\" type=\"win32\"/><dependency><dependentAssembl" ascii
      $s3 = "(http://www.eyuyan.com)" fullword wide
      $s4 = "GetTabList" fullword ascii
      $s5 = "GetConnectString" fullword ascii
      $s6 = "#if !defined(AFX_RESOURCE_DLL) || defined(AFX_TARG_CHS)" fullword ascii
      $s7 = "hgjlkbrfzaoe" fullword ascii
      $s8 = "bcdfghijklmnpqrstuvwxyz" fullword ascii
      $s9 = "nzzpenc" fullword ascii
      $s10 = " (*.txt)|*.txt|" fullword ascii
      $s11 = "out.prn" fullword ascii
      $s12 = "#####" fullword wide /* reversed goodware string '#####' */
      $s13 = "(%d-%d):" fullword ascii
      $s14 = "SWVVVRPV" fullword ascii
      $s15 = " inflate 1.1.3 Copyright 1995-1998 Mark Adler " fullword ascii
      $s16 = " deflate 1.1.3 Copyright 1995-1998 Jean-loup Gailly " fullword ascii
      $s17 = "#include \"l.chs\\afxres.rc\"          // Standard components" fullword ascii
      $s18 = "Referer:" fullword ascii /* Goodware String - occured 41 times */
      $s19 = "Ctrl+Shift+F11" fullword ascii
      $s20 = "HtHHuz" fullword ascii /* Goodware String - occured 1 times */
   condition:
      ( uint16(0) == 0x5a4d and filesize < 15000KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _90a58064c6df293fc564fa5b616c737f6fd31f6288433da2030ec56d6dc46962_f181b5a4e2f0dc0cdf70e16c18e3466e436aae0bb96ef9b7dc24c7f219_10 {
   meta:
      description = "samples - from files 90a58064c6df293fc564fa5b616c737f6fd31f6288433da2030ec56d6dc46962.exe, f181b5a4e2f0dc0cdf70e16c18e3466e436aae0bb96ef9b7dc24c7f219167115.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "90a58064c6df293fc564fa5b616c737f6fd31f6288433da2030ec56d6dc46962"
      hash2 = "f181b5a4e2f0dc0cdf70e16c18e3466e436aae0bb96ef9b7dc24c7f219167115"
   strings:
      $s1 = "Process already elevated." fullword wide
      $s2 = "GetProcessesResponse" fullword ascii
      $s3 = "ping -n 10 localhost > nul" fullword wide
      $s4 = "User refused the elevation request." fullword wide
      $s5 = "DoShellExecute" fullword ascii
      $s6 = "DoShellExecuteResponse" fullword ascii
      $s7 = "GetPasswords" fullword ascii
      $s8 = "GetPasswordsResponse" fullword ascii
      $s9 = "<meta http-equiv='Content-Type' content='text/html; charset=utf-8' />Log created on " fullword wide
      $s10 = "\" /sc ONLOGON /tr \"" fullword wide
      $s11 = "SELECT * FROM Win32_OperatingSystem WHERE Primary='true'" fullword wide
      $s12 = "ProcessDown" fullword ascii
      $s13 = "ProcessUp" fullword ascii
      $s14 = "ProcessMove" fullword ascii
      $s15 = "ProcessWheel" fullword ascii
      $s16 = "DoProcessStart" fullword ascii
      $s17 = "set_Processes" fullword ascii
      $s18 = "get_RootKeyName" fullword ascii
      $s19 = "<Processes>k__BackingField" fullword ascii
      $s20 = "Processor (CPU)" fullword wide
   condition:
      ( uint16(0) == 0x5a4d and filesize < 15000KB and ( 8 of them )
      ) or ( all of them )
}

rule _71c91905a377be84dca1c0965d8ef92d7c4cd53c137205699f26582cf8107476_dc74ae7a70778659ee1f27f8e772ab2513299da34c7b2eabb866152e55_11 {
   meta:
      description = "samples - from files 71c91905a377be84dca1c0965d8ef92d7c4cd53c137205699f26582cf8107476.exe, dc74ae7a70778659ee1f27f8e772ab2513299da34c7b2eabb866152e5588720b.exe, c0e6cea1456ebc9c970e4cfc70ad112501a744373e25c74ae318e9654f852da5.exe, e9d082e59f131a020a870a416b1fbd2aa978f0706fa690080a268a5295bd8bb2.exe, d2b5d02ad0207f69484b73eae658c2c08b747b4b3125e8856c5f0df261217f1e.exe, 7289da5a1cc6d7149e862660a7f3f48db0ef1f6f8e5de991501e72bde1192be9.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "71c91905a377be84dca1c0965d8ef92d7c4cd53c137205699f26582cf8107476"
      hash2 = "dc74ae7a70778659ee1f27f8e772ab2513299da34c7b2eabb866152e5588720b"
      hash3 = "c0e6cea1456ebc9c970e4cfc70ad112501a744373e25c74ae318e9654f852da5"
      hash4 = "e9d082e59f131a020a870a416b1fbd2aa978f0706fa690080a268a5295bd8bb2"
      hash5 = "d2b5d02ad0207f69484b73eae658c2c08b747b4b3125e8856c5f0df261217f1e"
      hash6 = "7289da5a1cc6d7149e862660a7f3f48db0ef1f6f8e5de991501e72bde1192be9"
   strings:
      $s1 = "SELECT * FROM [CollegeDB].[dbo].[user_login] WHERE username = '" fullword wide
      $s2 = "ValidateUserLogin" fullword ascii
      $s3 = "loginInvalid" fullword wide
      $s4 = "PasswordBox_KeyPress" fullword ascii
      $s5 = "Login required" fullword wide
      $s6 = "Test login Username: John12 Password:1234" fullword wide
      $s7 = "LoginForm" fullword wide
      $s8 = "INSERT INTO dbo.student (first_name, last_name, date_of_birth, Address, Country, PostCode, email, phone)VALUES('" fullword wide
      $s9 = "postcode" fullword wide
      $s10 = "Incorrect username or password." fullword wide
      $s11 = "Designed and implemented by Michail Panagopoulos - 2022" fullword wide
      $s12 = "' AND password = '" fullword wide
      $s13 = "Login details are required in order to proceed. This application will now close." fullword wide
      $s14 = "Postcode" fullword wide
      $s15 = "Data Source = USERONE; Initial Catalog = CollegeDB; Integrated Security = True" fullword wide
      $s16 = "Connection Error: " fullword wide
      $s17 = " Please try again. If the error persists, contact your system administrator." fullword wide
      $s18 = "Something went wrong. Please try again, and if the errorpersists, contact the system administrator." fullword wide
      $s19 = "' from the system.Are you sure you want to proceed?" fullword wide
      $s20 = "headLabel" fullword wide
   condition:
      ( uint16(0) == 0x5a4d and filesize < 2000KB and ( 8 of them )
      ) or ( all of them )
}

rule _a55c7ed8b626f509f1db86fb6be1823a6bdf54b47c73a348cfe70c36e8b45d82_434fc1fcde79cced66c7784f22b1703b41dd77f1800edd7bebe4343f47_12 {
   meta:
      description = "samples - from files a55c7ed8b626f509f1db86fb6be1823a6bdf54b47c73a348cfe70c36e8b45d82.exe, 434fc1fcde79cced66c7784f22b1703b41dd77f1800edd7bebe4343f479080d8.exe, 1673828a6bb871f75162500cdffd2e86113da89049fff26117e78be6ea681e69.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "a55c7ed8b626f509f1db86fb6be1823a6bdf54b47c73a348cfe70c36e8b45d82"
      hash2 = "434fc1fcde79cced66c7784f22b1703b41dd77f1800edd7bebe4343f479080d8"
      hash3 = "1673828a6bb871f75162500cdffd2e86113da89049fff26117e78be6ea681e69"
   strings:
      $s1 = "/c schtasks /create /f /sc onlogon /rl highest /tn \"" fullword wide
      $s2 = "Anti_Process" fullword ascii
      $s3 = "MutexControl" fullword ascii
      $s4 = "ProcessIsTerminating" fullword ascii
      $s5 = "GetExportAddress" fullword ascii
      $s6 = "GetLibraryAddress" fullword ascii
      $s7 = "GetLoadedModuleAddress" fullword ascii
      $s8 = "Client.Connection" fullword ascii
      $s9 = "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\" fullword wide
      $s10 = "Failed to parse module exports." fullword wide
      $s11 = "b64encoded" fullword ascii
      $s12 = ", Dll was not found or not loaded." fullword wide
      $s13 = "Could not get the handle for the function." fullword wide
      $s14 = "DInvokeCore" fullword ascii
      $s15 = "ReadServertData" fullword ascii
      $s16 = "Client.Install" fullword ascii
      $s17 = "Client.Algorithm" fullword ascii
      $s18 = "Client.Helper" fullword ascii
      $s19 = "Paste_bin" fullword ascii
      $s20 = "MessagePackLib.<PrivateImplementationDetails>" fullword ascii
   condition:
      ( uint16(0) == 0x5a4d and filesize < 200KB and ( 8 of them )
      ) or ( all of them )
}

rule _71c91905a377be84dca1c0965d8ef92d7c4cd53c137205699f26582cf8107476_dc74ae7a70778659ee1f27f8e772ab2513299da34c7b2eabb866152e55_13 {
   meta:
      description = "samples - from files 71c91905a377be84dca1c0965d8ef92d7c4cd53c137205699f26582cf8107476.exe, dc74ae7a70778659ee1f27f8e772ab2513299da34c7b2eabb866152e5588720b.exe, e9d082e59f131a020a870a416b1fbd2aa978f0706fa690080a268a5295bd8bb2.exe, d2b5d02ad0207f69484b73eae658c2c08b747b4b3125e8856c5f0df261217f1e.exe, 7289da5a1cc6d7149e862660a7f3f48db0ef1f6f8e5de991501e72bde1192be9.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "71c91905a377be84dca1c0965d8ef92d7c4cd53c137205699f26582cf8107476"
      hash2 = "dc74ae7a70778659ee1f27f8e772ab2513299da34c7b2eabb866152e5588720b"
      hash3 = "e9d082e59f131a020a870a416b1fbd2aa978f0706fa690080a268a5295bd8bb2"
      hash4 = "d2b5d02ad0207f69484b73eae658c2c08b747b4b3125e8856c5f0df261217f1e"
      hash5 = "7289da5a1cc6d7149e862660a7f3f48db0ef1f6f8e5de991501e72bde1192be9"
   strings:
      $s1 = "TVqQ:M::E::__8:Lg::::AQ:::::::::::::::::::::::Ag::A4fug4AtAnNIbg?TM0hVGhpcy?wcm9ncmFtIGNhbm5vdC?iZS?ydW4gaW4gRE9TIG1vZGUuDQ0KJ::" ascii
      $s2 = "CollegeInformationSystem.LoginForm.resources" fullword ascii
      $s3 = "CollegeInformationSystem.MainForm.resources" fullword ascii
      $s4 = "CollegeInformationSystem.ResultsForm.resources" fullword ascii
      $s5 = "U3Agb_mb4K_17-?YbZfP_11wGxgmN_4N6ZWv-ZvAv74DX4D4qvfDFxGPfxOeO13Ovv1P_6NzfMb_Aa_xW_0a_0G-O83-LX4-S3-oD_71_q1ftPf-Df9jU8NXPvLj_0YP" ascii
      $s6 = "GRhcmdfMQ?MZGFyZ18yAExkYXJnXzMATGRhcmdfUw?UYWlsY2FsbA?DYWxsAENhbGx2aXJ0AFJldA?TZXRWYWx1ZQ?HZXRGaWVsZHMAQmluZGluZ0ZsYWdzAEV4Y2Vwd" ascii
      $s7 = "v38txbInU9_G0WyA8R83Gn9W4UEEER-8xl-8OpZ0a7?QonHwT0e_a1JCxYzYi9ag27y40bY7bftfGom7Nf_9X_9jlUCK3vPb-A_-P7HsO7xY78?_sFvvx4U5a_5ya-HT" ascii
      $s8 = "FoXs_bXqH6N3xsfLCOmy330a3y1vMzr4rzIJmV-QlPrqU-Zwdf5dF1j6o0mfUP6LyfV-tY1NV-?0WoMqf_Vy5rke?r54llREiPUMNHuy8_XxayHyav1si0W-Zgnp1q9z" ascii
      $s9 = "?EoFREkUFIAI?H?wJIAEdEoFNEYFpIgcMDwESRR0SgU0SgU0OEoClEoFRAx0SgVUdEkUSgVkSgV0J:I?EoCNEYF5?i:HRK?fQQgA?E9?S:EoF9DSAFAQ4SRR0SRRK?fQ" ascii
      $s10 = "CollegeInformationSystem.StudentRecordCard.resources" fullword ascii
      $s11 = "1_ROzVrmV_jeDajMTWMz2vo4qqithXpjcppvXmdZ4z1KXiVoJ?WceNm?i6r6dscaNCs1zl9Oc-WF5gC9R_piwn7E6yrfg3yLX6N40nza5Aen-T12fK8Ygy-IC9plrXZG" ascii
      $s12 = "MzI5Ng:?SACAQ4OQQEAM1N5c3RlbS5SZXNvdXJjZXMuVG9vbHMuU3Ryb25nbHlUeX?lZFJlc291cmNlQnVpbGRlcggxNi4wLjAuM:A?AE::GIAE?EYEVCAEAb:::ACAE" ascii
      $s13 = "ED?hIlAwYSCAMGEhQD?hIpAwYRLQMGEjED?hI1AwYSOQSKAg:??Q::EMg::Qo::?AM::ECg::MGET0D?h0DAwYRRAIGDgMGHQUH?hUSQQIIDgIGHAIGAgY:RJFEUkD?h" ascii
      $s14 = "A_x8::ACAEAHAQ::ACAEAR:::ACAEAQ:::A?iA?ARG?HQUgAgEICAYgAgEOEk0CHQUGIAE?EYEh?iA?ARK?JQQHAREtAy:DgUgAQIRWQQHARFZ?QcCC?EtCAcECAgRLR" ascii
      $s15 = "Og:?jhk____Czhj____KGI:Ao4YP___wI4ZP___yh::GOGn___8KOHH___8COHX___8DMAQA_Q::::A4uQ:AHsI:AEexY:AQZMzk4rQ:AHsJ:AEexY:AQZMyc4oQ:AHs" ascii
      $s16 = "O9v8Rsl6a_zW_yu9PO3-N1_p1-XGvwWv-tv8Gv82r_?b_pr_qa_5o_9-r_Gr_U7_7q_86_7m_w6v8av-Zv8JvTpb3Hnt7jzmwDAr5mkv_6v-Rv8?r8xniT9NQwaAPsb_" ascii
      $s17 = "73_-bfp30L7-DV-7QmlEX4vyl79Gr_ud_nf3-vX2OPf9zja-d7v-Ld__o__b__1l3_k49_iv_6n_-5f9kf9Gr_?3_mD3_cnf_v9_-iP_rV-vd_g1_71fvPfgFOFvw4Co" ascii
      $s18 = "AQ:DQ?uAH4:AE:EQ?:ANAG8AgQ:AQ:RwE:A0AcQCE:A?:?KAQ:DQ?zAIc:AE:E0?:ANAHUAig:AQ:UAE:A0AdwCN:A?:?TAQ:DQ?4AJ::E:FY?:ANAHkAkw:AQ:WQE:A" ascii
      $s19 = "C5kbGwAUlQAPE1vZHVsZT4:gADAG1zY29ybGliAE9iamVjdA?TeXN0ZW0:Q?QaW5nUG9uZw?QaW5ncG9uZzMAU3lzdGVtLldpbmRvd3MuRm9ybXMARm9ybQ?TaXplUGF" ascii
      $s20 = "4Mdv90t-W_nwt8ePrd-ZOf3XqqjJr_drfOvX-?13fuzX-Pt_DfxuZOH_Ffj9Gr_Wr_3r_Lq_ya_zm_y6v8mv95v8-mA8wu8_-?2TX6O-SzIpM7_1C_DP78LN_wMaCcnL" ascii
   condition:
      ( uint16(0) == 0x5a4d and filesize < 2000KB and ( 8 of them )
      ) or ( all of them )
}

rule _a228df5184a2c1a2864e8e7872c2ab98718a287ffea2d6c2c4dd65ba85752692_7001acf354484cbbb58bbf0bfbfc0644bd629ca6b02c10f8b4e7fd4371_14 {
   meta:
      description = "samples - from files a228df5184a2c1a2864e8e7872c2ab98718a287ffea2d6c2c4dd65ba85752692.exe, 7001acf354484cbbb58bbf0bfbfc0644bd629ca6b02c10f8b4e7fd4371c89a99.exe, 76eee256f1223082e8396611baca498542c656edd0fac5fe903e06e6cb5677e2.exe, f181b5a4e2f0dc0cdf70e16c18e3466e436aae0bb96ef9b7dc24c7f219167115.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "a228df5184a2c1a2864e8e7872c2ab98718a287ffea2d6c2c4dd65ba85752692"
      hash2 = "7001acf354484cbbb58bbf0bfbfc0644bd629ca6b02c10f8b4e7fd4371c89a99"
      hash3 = "76eee256f1223082e8396611baca498542c656edd0fac5fe903e06e6cb5677e2"
      hash4 = "f181b5a4e2f0dc0cdf70e16c18e3466e436aae0bb96ef9b7dc24c7f219167115"
   strings:
      $s1 = " but running with " fullword ascii
      $s2 = " using zstream" fullword ascii
      $s3 = "DELETE" fullword ascii /* Goodware String - occured 355 times */
      $s4 = "unknown compression method" fullword ascii /* Goodware String - occured 498 times */
      $s5 = "F<_^][" fullword ascii /* Goodware String - occured 3 times */
      $s6 = " 0@P`p" fullword ascii
      $s7 = "hTADIV" fullword ascii /* Goodware String - occured 5 times */
   condition:
      ( uint16(0) == 0x5a4d and filesize < 29000KB and ( all of them )
      ) or ( all of them )
}

rule _052d222b441b1fd17f08ca9831c1c92099ffc3a1187ee6266b9d8d1ed9ebeae8_76eee256f1223082e8396611baca498542c656edd0fac5fe903e06e6cb_15 {
   meta:
      description = "samples - from files 052d222b441b1fd17f08ca9831c1c92099ffc3a1187ee6266b9d8d1ed9ebeae8.exe, 76eee256f1223082e8396611baca498542c656edd0fac5fe903e06e6cb5677e2.exe, 071b6c448d2546dea8caed872fca0d002f59a6b9849f0de2a565fc74b487fa37.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "052d222b441b1fd17f08ca9831c1c92099ffc3a1187ee6266b9d8d1ed9ebeae8"
      hash2 = "76eee256f1223082e8396611baca498542c656edd0fac5fe903e06e6cb5677e2"
      hash3 = "071b6c448d2546dea8caed872fca0d002f59a6b9849f0de2a565fc74b487fa37"
   strings:
      $s1 = "network reset" fullword ascii /* Goodware String - occured 567 times */
      $s2 = "wrong protocol type" fullword ascii /* Goodware String - occured 567 times */
      $s3 = "owner dead" fullword ascii /* Goodware String - occured 567 times */
      $s4 = "connection already in progress" fullword ascii /* Goodware String - occured 567 times */
      $s5 = "network down" fullword ascii /* Goodware String - occured 567 times */
      $s6 = "protocol not supported" fullword ascii /* Goodware String - occured 568 times */
      $s7 = "connection aborted" fullword ascii /* Goodware String - occured 568 times */
      $s8 = "network unreachable" fullword ascii /* Goodware String - occured 569 times */
      $s9 = "host unreachable" fullword ascii /* Goodware String - occured 571 times */
      $s10 = "protocol error" fullword ascii /* Goodware String - occured 588 times */
      $s11 = "permission denied" fullword ascii /* Goodware String - occured 592 times */
      $s12 = "connection refused" fullword ascii /* Goodware String - occured 597 times */
      $s13 = "broken pipe" fullword ascii /* Goodware String - occured 635 times */
      $s14 = "9C`u99C\\t4" fullword ascii
      $s15 = ".?AV?$codecvt@DDU_Mbstatet@@@std@@" fullword ascii /* Goodware String - occured 5 times */
   condition:
      ( uint16(0) == 0x5a4d and filesize < 29000KB and ( 8 of them )
      ) or ( all of them )
}

rule _a55c7ed8b626f509f1db86fb6be1823a6bdf54b47c73a348cfe70c36e8b45d82_434fc1fcde79cced66c7784f22b1703b41dd77f1800edd7bebe4343f47_16 {
   meta:
      description = "samples - from files a55c7ed8b626f509f1db86fb6be1823a6bdf54b47c73a348cfe70c36e8b45d82.exe, 434fc1fcde79cced66c7784f22b1703b41dd77f1800edd7bebe4343f479080d8.exe, 1673828a6bb871f75162500cdffd2e86113da89049fff26117e78be6ea681e69.exe, fdc933b64df0832a1f88f0e19a4cab67fb110d54c4913367a7215d7890f8a5b7.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "a55c7ed8b626f509f1db86fb6be1823a6bdf54b47c73a348cfe70c36e8b45d82"
      hash2 = "434fc1fcde79cced66c7784f22b1703b41dd77f1800edd7bebe4343f479080d8"
      hash3 = "1673828a6bb871f75162500cdffd2e86113da89049fff26117e78be6ea681e69"
      hash4 = "fdc933b64df0832a1f88f0e19a4cab67fb110d54c4913367a7215d7890f8a5b7"
   strings:
      $x1 = "ProcessHacker.exe" fullword wide
      $s2 = "MpCmdRun.exe" fullword wide
      $s3 = "  <!-- Enable themes for Windows common controls and dialogs (Windows XP and later) -->" fullword ascii
      $s4 = "ConfigSecurityPolicy.exe" fullword wide
      $s5 = "MSConfig.exe" fullword wide
      $s6 = "procexp.exe" fullword wide
      $s7 = "MSASCui.exe" fullword wide
      $s8 = "MsMpEng.exe" fullword wide
      $s9 = "MpUXSrv.exe" fullword wide
      $s10 = "NisSrv.exe" fullword wide
      $s11 = "Regedit.exe" fullword wide
      $s12 = "<dpiAwareness xmlns=\"http://schemas.microsoft.com/SMI/2016/WindowsSettings\">PerMonitorV2, PerMonitor</dpiAwareness>" fullword ascii
      $s13 = "<longPathAware xmlns=\"http://schemas.microsoft.com/SMI/2016/WindowsSettings\">true</longPathAware>" fullword ascii
      $s14 = "dwProcessHandle" fullword ascii
      $s15 = "UmVjZWl2ZWQ=" fullword wide /* base64 encoded string 'Received' */
      $s16 = "      <dpiAware xmlns=\"http://schemas.microsoft.com/SMI/2005/WindowsSettings\">true</dpiAware>" fullword ascii
      $s17 = "       to opt in. Windows Forms applications targeting .NET Framework 4.6 that opt into this setting, should " fullword ascii
      $s18 = "       also set the 'EnableWindowsFormsHighDpiAutoResizing' setting to 'true' in their app.config. -->" fullword ascii
      $s19 = "  <assemblyIdentity version=\"1.0.7.0\" name=\"MyApplication.app\"/>" fullword ascii
      $s20 = "YW1zaS5kbGw=" fullword wide /* base64 encoded string 'amsi.dll' */
   condition:
      ( uint16(0) == 0x5a4d and filesize < 1000KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _825196f7ae2364e7712c9893e97c50fa639a3ecb747e7b431d6fa47110724eca_d4b22461e379bba07e2e2f6cf1833884c0ff656b84afdd3b2284be856f_17 {
   meta:
      description = "samples - from files 825196f7ae2364e7712c9893e97c50fa639a3ecb747e7b431d6fa47110724eca.exe, d4b22461e379bba07e2e2f6cf1833884c0ff656b84afdd3b2284be856f598ae0.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "825196f7ae2364e7712c9893e97c50fa639a3ecb747e7b431d6fa47110724eca"
      hash2 = "d4b22461e379bba07e2e2f6cf1833884c0ff656b84afdd3b2284be856f598ae0"
   strings:
      $x1 = "fSystem.Drawing.Icon, System.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3ajSystem.CodeDom.MemberAtt" ascii
      $x2 = "fSystem.Drawing.Icon, System.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3ajSystem.CodeDom.MemberAtt" ascii
      $s3 = "ersion=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089fSystem.Drawing.Size, System.Drawing, Version=4.0.0.0, Culture=n" ascii
      $s4 = "ributes, System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089mSystem.Globalization.CultureInfo, mscorlib, V" ascii
      $s5 = "Process " fullword wide
      $s6 = "GQitAJFJE" fullword ascii /* base64 encoded string 'B+@$RD' */
      $s7 = " System.Globalization.CompareInfo" fullword ascii
      $s8 = "System.Globalization.TextInfo%System.Globalization.NumberFormatInfo'System.Globalization.DateTimeFormatInfo&System.Globalization" ascii
      $s9 = "eutral, PublicKeyToken=b03f5f7f11d50a3a" fullword ascii
      $s10 = "(System.Globalization.DateTimeFormatFlags" fullword ascii
      $s11 = "'System.Globalization.DateTimeFormatInfo+" fullword ascii
      $s12 = "firstrundone" fullword ascii
      $s13 = "kernel " fullword wide
      $s14 = "System.Globalization.TextInfo%System.Globalization.NumberFormatInfo'System.Globalization.DateTimeFormatInfo&System.Globalization" ascii
      $s15 = " System.Globalization.SortVersion" fullword ascii
      $s16 = " System.Globalization.CultureInfo" fullword ascii
      $s17 = "yyyy MMMM" fullword ascii
      $s18 = "dddd, dd MMMM yyyy" fullword ascii
      $s19 = "aR3nbf8dQp2feLmk31.lSfgApatkdxsVcGcrktoFd.resources" fullword ascii
      $s20 = "progressBar1.Modifiers" fullword wide
   condition:
      ( uint16(0) == 0x5a4d and filesize < 15000KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _249009648a4e88d2cd0fb5e595c911e5dca3ec1d70252981554ab0331800cb92_f9dc41ab7a043cf887b9737060be951dd11571c5774a8b6ca004b503c1_18 {
   meta:
      description = "samples - from files 249009648a4e88d2cd0fb5e595c911e5dca3ec1d70252981554ab0331800cb92.exe, f9dc41ab7a043cf887b9737060be951dd11571c5774a8b6ca004b503c1995c72.exe, 00db2c26608e0e750b9262587d68d19dfd37e45b185a22b9438fb309ceb15cd9.exe, fe20286db492e192672c31c79ef6808d9e33601b4fbf4c61ad1aeab5ba3b6b93.exe, 2891ed67cda3644765fd94fce012ff41aa4e32fc4c2857e63648803884d76c6f.exe, 258424cd8a701639a5ba89800e9e425463ab6219ce8435a37ea3c28b9b181ffa.exe, ea6e4e54c6aa6df24c7a386a5ac3bd9a224d69ecd629a555744e72cde043cadd.exe, 8fc9056ebee5adcd70c3d96e53885fcb355030869137a6f1977a463759f15d86.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "249009648a4e88d2cd0fb5e595c911e5dca3ec1d70252981554ab0331800cb92"
      hash2 = "f9dc41ab7a043cf887b9737060be951dd11571c5774a8b6ca004b503c1995c72"
      hash3 = "00db2c26608e0e750b9262587d68d19dfd37e45b185a22b9438fb309ceb15cd9"
      hash4 = "fe20286db492e192672c31c79ef6808d9e33601b4fbf4c61ad1aeab5ba3b6b93"
      hash5 = "2891ed67cda3644765fd94fce012ff41aa4e32fc4c2857e63648803884d76c6f"
      hash6 = "258424cd8a701639a5ba89800e9e425463ab6219ce8435a37ea3c28b9b181ffa"
      hash7 = "ea6e4e54c6aa6df24c7a386a5ac3bd9a224d69ecd629a555744e72cde043cadd"
      hash8 = "8fc9056ebee5adcd70c3d96e53885fcb355030869137a6f1977a463759f15d86"
   strings:
      $s1 = "ture=neutral, PublicKeyToken=b77a5c561934e089]][]" fullword ascii
      $s2 = "TcpClient" fullword ascii /* Goodware String - occured 30 times */
      $s3 = "SendKeys" fullword ascii /* Goodware String - occured 46 times */
      $s4 = "$ebc25cf6-9120-4283-b972-0e5520d00009" fullword ascii /* Goodware String - occured 1 times */
      $s5 = "$ebc25cf6-9120-4283-b972-0e5520d00005" fullword ascii /* Goodware String - occured 1 times */
      $s6 = "_b_9" fullword ascii /* Goodware String - occured 1 times */
      $s7 = "$$method0x600002a-1" fullword ascii /* Goodware String - occured 1 times */
      $s8 = "$ebc25cf6-9120-4283-b972-0e5520d00004" fullword ascii /* Goodware String - occured 1 times */
      $s9 = "$$method0x600002a-2" fullword ascii
      $s10 = "kLjw4iIsCLsZtxc4lksN0j" fullword ascii
      $s11 = "$ebc25cf6-9120-4283-b972-0e5520d0000C" fullword ascii /* Goodware String - occured 1 times */
      $s12 = "$ebc25cf6-9120-4283-b972-0e5520d00007" fullword ascii /* Goodware String - occured 1 times */
      $s13 = "$ebc25cf6-9120-4283-b972-0e5520d0000A" fullword ascii /* Goodware String - occured 1 times */
      $s14 = "$$method0x6000007-1" fullword ascii
      $s15 = "$ebc25cf6-9120-4283-b972-0e5520d00008" fullword ascii /* Goodware String - occured 1 times */
      $s16 = "$ebc25cf6-9120-4283-b972-0e5520d00006" fullword ascii /* Goodware String - occured 1 times */
      $s17 = "$ebc25cf6-9120-4283-b972-0e5520d0000B" fullword ascii /* Goodware String - occured 1 times */
      $s18 = "$$method0x6000039-1" fullword ascii
      $s19 = "Y_dh}" fullword ascii /* Goodware String - occured 1 times */
      $s20 = "$$method0x6000020-2" fullword ascii
   condition:
      ( uint16(0) == 0x5a4d and filesize < 8000KB and ( 8 of them )
      ) or ( all of them )
}

rule _825196f7ae2364e7712c9893e97c50fa639a3ecb747e7b431d6fa47110724eca_f181b5a4e2f0dc0cdf70e16c18e3466e436aae0bb96ef9b7dc24c7f219_19 {
   meta:
      description = "samples - from files 825196f7ae2364e7712c9893e97c50fa639a3ecb747e7b431d6fa47110724eca.exe, f181b5a4e2f0dc0cdf70e16c18e3466e436aae0bb96ef9b7dc24c7f219167115.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "825196f7ae2364e7712c9893e97c50fa639a3ecb747e7b431d6fa47110724eca"
      hash2 = "f181b5a4e2f0dc0cdf70e16c18e3466e436aae0bb96ef9b7dc24c7f219167115"
   strings:
      $s1 = "ProcessBytes" fullword ascii
      $s2 = "ProcessByte" fullword ascii
      $s3 = "get_MacSize" fullword ascii
      $s4 = "HaveSameContents" fullword ascii
      $s5 = "get_IsPartialBlockOkay" fullword ascii
      $s6 = "GetUpdateOutputSize" fullword ascii
      $s7 = "GetAssociatedText" fullword ascii
      $s8 = "keyParam" fullword ascii
      $s9 = "GenerateWorkingKey" fullword ascii
      $s10 = "GetMac" fullword ascii
      $s11 = "MultiplyP8" fullword ascii
      $s12 = "Tables8kGcmMultiplier" fullword ascii
      $s13 = "UInt64_To_BE" fullword ascii
      $s14 = "ConstantTimeAreEqual" fullword ascii
      $s15 = "OneAsBytes" fullword ascii
      $s16 = "AesFastEngine" fullword ascii
      $s17 = "MultiplyP" fullword ascii
      $s18 = "ParametersWithIV" fullword ascii
      $s19 = "InvalidCipherTextException" fullword ascii
      $s20 = "bufBlock" fullword ascii
   condition:
      ( uint16(0) == 0x5a4d and filesize < 15000KB and ( 8 of them )
      ) or ( all of them )
}

rule _ded5515158d7b1ed9520713645bc63d7bb872f0a212c77ebb1afce0d16fad0ce_e2a569f0f5168d11500b6e5f5c0ad0c900c45be7cbab68f0c354318123_20 {
   meta:
      description = "samples - from files ded5515158d7b1ed9520713645bc63d7bb872f0a212c77ebb1afce0d16fad0ce.exe, e2a569f0f5168d11500b6e5f5c0ad0c900c45be7cbab68f0c354318123bf942f.exe, 0a785a353308e02dfe2b5b3318d6a2a90d7a918dd200d70109fe3eedc3ce69d1.exe, 5ad6806628708095957c45a7f728f941d9b436a25f3f0d2147274403fffd1045.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "ded5515158d7b1ed9520713645bc63d7bb872f0a212c77ebb1afce0d16fad0ce"
      hash2 = "e2a569f0f5168d11500b6e5f5c0ad0c900c45be7cbab68f0c354318123bf942f"
      hash3 = "0a785a353308e02dfe2b5b3318d6a2a90d7a918dd200d70109fe3eedc3ce69d1"
      hash4 = "5ad6806628708095957c45a7f728f941d9b436a25f3f0d2147274403fffd1045"
   strings:
      $s1 = "LoG7d_)`" fullword ascii
      $s2 = "bpLHQLr" fullword ascii
      $s3 = "VWWWUVefee" fullword ascii
      $s4 = "CHBTK4BT" fullword ascii
      $s5 = "4VDqrrTZd" fullword ascii
      $s6 = "hIjTfmb}" fullword ascii
      $s7 = "Tvtk0M6" fullword ascii
      $s8 = "DVfAij-" fullword ascii
      $s9 = "IsaQg8" fullword ascii
      $s10 = "\\PP\"Bj-)A" fullword ascii
      $s11 = "\\.ftSe" fullword ascii
      $s12 = "8x)'OG" fullword ascii
      $s13 = "j#*=R9b" fullword ascii
      $s14 = "p)'Vz-," fullword ascii
      $s15 = "9}pL<z" fullword ascii
      $s16 = "Sj7)2\"" fullword ascii
      $s17 = "}.*:;L" fullword ascii
      $s18 = "r*(%|-+7" fullword ascii
      $s19 = ";N=*V,w" fullword ascii
      $s20 = "a# 4a%#" fullword ascii
   condition:
      ( uint16(0) == 0x5a4d and filesize < 800KB and ( 8 of them )
      ) or ( all of them )
}

rule _f181b5a4e2f0dc0cdf70e16c18e3466e436aae0bb96ef9b7dc24c7f219167115_d4b22461e379bba07e2e2f6cf1833884c0ff656b84afdd3b2284be856f_21 {
   meta:
      description = "samples - from files f181b5a4e2f0dc0cdf70e16c18e3466e436aae0bb96ef9b7dc24c7f219167115.exe, d4b22461e379bba07e2e2f6cf1833884c0ff656b84afdd3b2284be856f598ae0.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "f181b5a4e2f0dc0cdf70e16c18e3466e436aae0bb96ef9b7dc24c7f219167115"
      hash2 = "d4b22461e379bba07e2e2f6cf1833884c0ff656b84afdd3b2284be856f598ae0"
   strings:
      $s1 = "get_IsMap" fullword ascii
      $s2 = "WriteDuration" fullword ascii
      $s3 = "LimitedInputStream" fullword ascii
      $s4 = "NanosecondsPerTick" fullword ascii
      $s5 = "TypeRegistry" fullword ascii
      $s6 = "<>9__3_1" fullword ascii /* Goodware String - occured 1 times */
      $s7 = "get_IsPacked" fullword ascii /* Goodware String - occured 2 times */
      $s8 = "Fixed32" fullword ascii /* Goodware String - occured 2 times */
      $s9 = "wireType" fullword ascii /* Goodware String - occured 2 times */
      $s10 = "get_FieldNumber" fullword ascii /* Goodware String - occured 2 times */
      $s11 = "<>9__16_0" fullword ascii /* Goodware String - occured 2 times */
      $s12 = "Fixed64" fullword ascii /* Goodware String - occured 2 times */
      $s13 = "PushBack" fullword ascii /* Goodware String - occured 3 times */
      $s14 = "WriteLength" fullword ascii /* Goodware String - occured 3 times */
      $s15 = "fieldNumbers" fullword ascii /* Goodware String - occured 3 times */
      $s16 = "Proto2" fullword ascii
      $s17 = "Proto3" fullword ascii
      $s18 = "<.ctor>b__3_0" fullword ascii /* Goodware String - occured 4 times */
      $s19 = "<>c__DisplayClass4_0" fullword ascii /* Goodware String - occured 5 times */
   condition:
      ( uint16(0) == 0x5a4d and filesize < 15000KB and ( 8 of them )
      ) or ( all of them )
}

rule _07ecf0ee68a52e1783da654389f5adaa861b5e7cfff04cbec504e721cc3a11ad_ded5515158d7b1ed9520713645bc63d7bb872f0a212c77ebb1afce0d16_22 {
   meta:
      description = "samples - from files 07ecf0ee68a52e1783da654389f5adaa861b5e7cfff04cbec504e721cc3a11ad.exe, ded5515158d7b1ed9520713645bc63d7bb872f0a212c77ebb1afce0d16fad0ce.exe, e2a569f0f5168d11500b6e5f5c0ad0c900c45be7cbab68f0c354318123bf942f.exe, 0a785a353308e02dfe2b5b3318d6a2a90d7a918dd200d70109fe3eedc3ce69d1.exe, 5ad6806628708095957c45a7f728f941d9b436a25f3f0d2147274403fffd1045.exe, 04f28f4975a7ff3cb3439b65b8d2fad8e99e3431b65be0e065c194908459790e.exe, c826d38990051067a23d7ced76e20925ec47749e562ef718029ff06555680b5b.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "07ecf0ee68a52e1783da654389f5adaa861b5e7cfff04cbec504e721cc3a11ad"
      hash2 = "ded5515158d7b1ed9520713645bc63d7bb872f0a212c77ebb1afce0d16fad0ce"
      hash3 = "e2a569f0f5168d11500b6e5f5c0ad0c900c45be7cbab68f0c354318123bf942f"
      hash4 = "0a785a353308e02dfe2b5b3318d6a2a90d7a918dd200d70109fe3eedc3ce69d1"
      hash5 = "5ad6806628708095957c45a7f728f941d9b436a25f3f0d2147274403fffd1045"
      hash6 = "04f28f4975a7ff3cb3439b65b8d2fad8e99e3431b65be0e065c194908459790e"
      hash7 = "c826d38990051067a23d7ced76e20925ec47749e562ef718029ff06555680b5b"
   strings:
      $x1 = "-ExecutionPolicy Bypass -File \"" fullword wide
      $s2 = "NTdll.dll" fullword ascii
      $s3 = "shutdown.exe /f /s /t 0" fullword wide
      $s4 = "shutdown.exe /f /r /t 0" fullword wide
      $s5 = "WScript.Shell" fullword wide
      $s6 = "shutdown.exe -L" fullword wide
      $s7 = "Win32_Processor.deviceid=\"CPU0\"" fullword wide
      $s8 = "\\drivers\\etc\\hosts" fullword wide
      $s9 = "POST / HTTP/1.1" fullword wide
      $s10 = "Mozilla/5.0 (iPhone; CPU iPhone OS 11_4_1 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/11.0 Mobile/15E148 Saf" wide
      $s11 = "PCLogoff" fullword wide
      $s12 = "RunShell" fullword wide
      $s13 = "HostsMSG" fullword wide
      $s14 = "HostsErr" fullword wide
      $s15 = "OfflineGet" fullword wide
      $s16 = "Content-length: 5235" fullword wide
      $s17 = "Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:66.0) Gecko/20100101 Firefox/66.0" fullword wide
      $s18 = "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/60.0.3112.113 Safari/537.36" fullword wide
      $s19 = "$VB$Local_Host" fullword ascii
      $s20 = "Shosts" fullword wide
   condition:
      ( uint16(0) == 0x5a4d and filesize < 900KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _af2f05611639653b5c588b25b9e42d57f53fd0262681f89f6acdc24b58887214_0ff8f9853b1951fcefad14ec98e7c21d098fa87d5e3af0cb0d1f296231_23 {
   meta:
      description = "samples - from files af2f05611639653b5c588b25b9e42d57f53fd0262681f89f6acdc24b58887214.exe, 0ff8f9853b1951fcefad14ec98e7c21d098fa87d5e3af0cb0d1f2962315a483f.exe, 7e93b3a5bed3d2ab87eac6f297e6bbc63c7cc27e8da00b1ad4f6275c428a130f.exe, 518ee9f74a609d856403d4a94c650e62aba87c9dd17e6e885fe4e0adc4113e9a.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "af2f05611639653b5c588b25b9e42d57f53fd0262681f89f6acdc24b58887214"
      hash2 = "0ff8f9853b1951fcefad14ec98e7c21d098fa87d5e3af0cb0d1f2962315a483f"
      hash3 = "7e93b3a5bed3d2ab87eac6f297e6bbc63c7cc27e8da00b1ad4f6275c428a130f"
      hash4 = "518ee9f74a609d856403d4a94c650e62aba87c9dd17e6e885fe4e0adc4113e9a"
   strings:
      $s1 = "https://www.sysinternals.com0" fullword ascii
      $s2 = "Phttp://www.microsoft.com/pkiops/certs/Microsoft%20Time-Stamp%20PCA%202010(1).crt0" fullword ascii
      $s3 = "Nhttp://www.microsoft.com/pkiops/crl/Microsoft%20Time-Stamp%20PCA%202010(1).crl0l" fullword ascii
      $s4 = " Microsoft Operations Puerto Rico1" fullword ascii
      $s5 = " Microsoft Operations Puerto Rico1&0$" fullword ascii
      $s6 = "Sigchec" fullword wide
      $s7 = "3http://www.microsoft.com/pkiops/Docs/Repository.htm0" fullword ascii /* Goodware String - occured 1 times */
      $s8 = "Thales TSS ESN:32BD-E3D5-3B1D1%0#" fullword ascii
      $s9 = "lnPF;7V" fullword ascii
      $s10 = "x6X()ov5Q" fullword ascii
      $s11 = ",%EQm+" fullword ascii
      $s12 = "210902183259Z" fullword ascii
      $s13 = "82Z#:|" fullword ascii
      $s14 = "]R+aNn\\;F" fullword ascii
      $s15 = "110708205909" ascii
      $s16 = "}>n,^s" fullword ascii
      $s17 = "260708210909" ascii
      $s18 = "&}_V8d" fullword ascii
      $s19 = "E0C1)0'" fullword ascii
      $s20 = "220901183259Z0t1" fullword ascii
   condition:
      ( uint16(0) == 0x5a4d and filesize < 400KB and ( 8 of them )
      ) or ( all of them )
}

rule _a228df5184a2c1a2864e8e7872c2ab98718a287ffea2d6c2c4dd65ba85752692_f181b5a4e2f0dc0cdf70e16c18e3466e436aae0bb96ef9b7dc24c7f219_24 {
   meta:
      description = "samples - from files a228df5184a2c1a2864e8e7872c2ab98718a287ffea2d6c2c4dd65ba85752692.exe, f181b5a4e2f0dc0cdf70e16c18e3466e436aae0bb96ef9b7dc24c7f219167115.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "a228df5184a2c1a2864e8e7872c2ab98718a287ffea2d6c2c4dd65ba85752692"
      hash2 = "f181b5a4e2f0dc0cdf70e16c18e3466e436aae0bb96ef9b7dc24c7f219167115"
   strings:
      $s1 = "function get__nodeValue(str_json,recursion){for(var i in str_json){var a=Object.prototype.toString.call(str_json[i]);if(a==\"[ob" ascii
      $s2 = "){for(var i=0;i<source.length;i++){target.push(source[i])}return target}else{var str_obj;for(var obj in source){str_obj=typeof t" ascii
      $s3 = "arget[obj];if(str_obj=='string'||str_obj=='boolean'||str_obj=='undefined'){target[obj]=source[obj]}else if(str_obj=='number'){ta" ascii
      $s4 = "'){Date.prototype.toJSON=function(key){return isFinite(this.valueOf())?this.getUTCFullYear()+'-'+f(this.getUTCMonth()+1)+'-'+f(t" ascii
      $s5 = "his.getUTCDate())+'T'+f(this.getUTCHours())+':'+f(this.getUTCMinutes())+':'+f(this.getUTCSeconds())+'Z':null};String.prototype.t" ascii
      $s6 = "t Number]\"||a==\"[object Boolean]\"){str_all.push(str_json[i])}}return str_all}function get__count(c){var obj=Object.prototype." ascii
      $s7 = " ary.join('\\r\\n')}else{return''}}function get__extend(target,source){if(Object.prototype.toString.call(target)=='[object Array" ascii
      $s8 = "rget=target.concat(source)}else if(str_obj=='object'){target[obj]=get__extend(target[obj],source[obj])}}return target}}if(typeof" ascii
      $s9 = " = get__extend(" fullword ascii
      $s10 = "get__name_All(" fullword ascii
      $s11 = "get__nodeValue(" fullword ascii
      $s12 = "ect Object]\"||a==\"[object Array]\"){if(recursion){get__nodeValue(str_json[i],recursion)}}else if(a==\"[object String]\"||a==\"" ascii
      $s13 = "tring.call(c);if(obj=='[object Array]'){return c.length}else{return 0}}function get__name_All(a){var obj=Object.prototype.toStri" ascii
      $s14 = ".slice(-4)})+'\"':'\"'+string+'\"'}function str(key,holder){var i,k,v,length,mind=gap,partial,value=holder[key];if(value&&typeof" ascii
      $s15 = "({'':j},''):j}throw new SyntaxError('JSON.parse');}}if(!Object.prototype.toJSONString){Object.prototype.toJSONString=function(fi" ascii
      $s16 = "JSON.stringify(" fullword ascii
      $s17 = "&typeof replacer!=='function'&&(typeof replacer!=='object'||typeof replacer.length!=='number')){throw new Error('JSON.stringify'" ascii
      $s18 = "oJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(key){return this.valueOf()}}var cx=/[\\u0000\\u00ad\\u0600-\\u06" ascii
      $s19 = "set-cookie:" fullword ascii
      $s20 = "get__count(" fullword ascii
   condition:
      ( uint16(0) == 0x5a4d and filesize < 15000KB and ( 8 of them )
      ) or ( all of them )
}

rule _2f175dac5c8571e586722f6927b0112af22637a17efb3acfd78e813a804a38f8_f181b5a4e2f0dc0cdf70e16c18e3466e436aae0bb96ef9b7dc24c7f219_25 {
   meta:
      description = "samples - from files 2f175dac5c8571e586722f6927b0112af22637a17efb3acfd78e813a804a38f8.exe, f181b5a4e2f0dc0cdf70e16c18e3466e436aae0bb96ef9b7dc24c7f219167115.exe, fdc933b64df0832a1f88f0e19a4cab67fb110d54c4913367a7215d7890f8a5b7.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "2f175dac5c8571e586722f6927b0112af22637a17efb3acfd78e813a804a38f8"
      hash2 = "f181b5a4e2f0dc0cdf70e16c18e3466e436aae0bb96ef9b7dc24c7f219167115"
      hash3 = "fdc933b64df0832a1f88f0e19a4cab67fb110d54c4913367a7215d7890f8a5b7"
   strings:
      $s1 = "server" fullword wide /* Goodware String - occured 260 times */
      $s2 = "password" fullword wide /* Goodware String - occured 347 times */
      $s3 = "UserName" fullword wide /* Goodware String - occured 438 times */
      $s4 = "<TimeCreated>k__BackingField" fullword ascii
      $s5 = "set_TimeCreated" fullword ascii /* Goodware String - occured 2 times */
      $s6 = "Novell" fullword ascii /* Goodware String - occured 2 times */
      $s7 = "regInfo" fullword ascii /* Goodware String - occured 2 times */
      $s8 = "<>9__7_0" fullword ascii /* Goodware String - occured 3 times */
      $s9 = "statusMessage" fullword ascii /* Goodware String - occured 3 times */
      $s10 = "<>9__5_0" fullword ascii /* Goodware String - occured 5 times */
   condition:
      ( uint16(0) == 0x5a4d and filesize < 15000KB and ( all of them )
      ) or ( all of them )
}

rule _188206f6dabcf77e5a3ac75e74661ba868dd95122fa3328abf023541d4ffdec9_71c91905a377be84dca1c0965d8ef92d7c4cd53c137205699f26582cf8_26 {
   meta:
      description = "samples - from files 188206f6dabcf77e5a3ac75e74661ba868dd95122fa3328abf023541d4ffdec9.exe, 71c91905a377be84dca1c0965d8ef92d7c4cd53c137205699f26582cf8107476.exe, dc74ae7a70778659ee1f27f8e772ab2513299da34c7b2eabb866152e5588720b.exe, e9d082e59f131a020a870a416b1fbd2aa978f0706fa690080a268a5295bd8bb2.exe, d2b5d02ad0207f69484b73eae658c2c08b747b4b3125e8856c5f0df261217f1e.exe, 7289da5a1cc6d7149e862660a7f3f48db0ef1f6f8e5de991501e72bde1192be9.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "188206f6dabcf77e5a3ac75e74661ba868dd95122fa3328abf023541d4ffdec9"
      hash2 = "71c91905a377be84dca1c0965d8ef92d7c4cd53c137205699f26582cf8107476"
      hash3 = "dc74ae7a70778659ee1f27f8e772ab2513299da34c7b2eabb866152e5588720b"
      hash4 = "e9d082e59f131a020a870a416b1fbd2aa978f0706fa690080a268a5295bd8bb2"
      hash5 = "d2b5d02ad0207f69484b73eae658c2c08b747b4b3125e8856c5f0df261217f1e"
      hash6 = "7289da5a1cc6d7149e862660a7f3f48db0ef1f6f8e5de991501e72bde1192be9"
   strings:
      $s1 = ":q:EAFgAq:EA3gAu:EAFgEb:EAGAET:EAGgET:EAHAET:EAHgEy:EAIAEy:EAIgE2:EAJAE6:EAJgE-:EAKAE-:YALwAX:YAF:bAFaANgIbAFaARAIbAFaAUQIbAFaAW" ascii
      $s2 = "MAQAEcARMA0AQcARMAQgEpARMA6QQpARMARAE0ARMARwFGARMASgFSARMATQFgARMAHgVgARMAUAFqARMAUwFqARMAVgF3ARMAZwV3ARMAWQGEARMAcQWEARMAXAGOAR" ascii
      $s3 = "MAfQH-ARMANwb-ARMAgAEJAhMAgwEJAhMAhgEVAhMAYAYVAhMAiQEhAhMAcgYhAhMAjAEsAhMAhgYsAhMAjwEsAhMAmgYsAhMAkgEsAhMApwYsAhMAlQEsAhMAugYsAh" ascii
      $s4 = "4WMz6_DLX_NX2Pv18W_T39dfPudXxfffsmfrPiTP4x__3P537-bP_m7uc3fzZ_8fb8WPvmnfi188h_-WoCJdeRfl_TGr8F6A9bvv2Gs_i1-9z_gt_47_v1_Zjj_K2Pyq" ascii
      $s5 = "IIC::::::::::::AO::w::::::::::::::::::::::::::::::::::AI:AC:::::::ACC:AEg:::::::C50ZXh0::wok::g::ig::I:::::::::C:AGAucnNyYw:AIIC" ascii
      $s6 = "cSLhb_tb_uYH_yxI-Nv-lr_FwV-KX4iMEMj819IZ-c1_899ii_r89b63RWJJJuPX-sW_hX792_hf_5R8_Rv8Wr-YJfsXQ5J_6jf_9X_qN_8NfurHfw1-_qffQ76jD3_v" ascii
      $s7 = "J5khX_TX1__-A2gM37T38D_6zf_7egfjOHX--3x8c6v9zvgx-6v9zvix96v9zvhx71fD4naX3P_1_sF-HH_1_td8ONTyvPSjwe_HuT31zz49T7Cj4e_4cnPaUZjY_rhN" ascii
      $s8 = "_3P_ojP_4H_8Z_48__h3_Sf-4t_o9-tGv3X23_NH9Z-59_7q_-m3_ff-aN-1eWrnzj6sxb_xO5f9U99_Gv_Tf_kH_j7_IO_7Df8j_6Jz__kv_Jf_4npP_PrXdy581v94" ascii
      $s9 = "A0weRAhMA1geeAhMA2QeeAhMA9gepAhM:AizAhMADwi-AhMAEgjIAhMALwjUAhMAMgjUAhMAQQjdAhMARAjdAhMASAjnAlAg::AIYYSwjq:EAyC:::gxhLCOo:QDQI::" ascii
      $s10 = "t_xNfvPf5NE_-3_93__3b_Nb_qYH0D6_xu_w8G_okPC3-c1_U38M9Gccea-d_hlH12unf8ZJKDj-tr9P2L37NI5F_63w0zhO_bfCT30S_qZEwt8UDUFdIuFv9pv_Zo_-" ascii
      $s11 = "3Knfo3LvfHO-P7Og70H-OTX_TVK-vcv-w1JNZPE_2bU4F_C76_bulheNGjxH5Ej-R_Rzx__6vWv8Q_9dpKz__HPvzp7Sj__Jfr7Z2jKfvxJWU3cjPya3_33_47Pfozg_" ascii
      $s12 = "Nf4M9KHv-6fRtz4NzHMP4NWFP98yib9Xb-r_PXH_rp_OXHe7CP89ScTb_41NIq_j_9Cf38r6RxJhOOvv5P-Ovjd-K9f4-_9df-RX-N3_DX-sG_JX__sr_vP01-_zify1" ascii
      $s13 = "XmdzQpCS_78fcI_f-_XhXnr93G__t6vssVKP-VfL5kLvlvM2rn-_u28uJi3v0Zh-OrXmPwav9fur_Hd3V_j99r7Nb6792ucff5rvPm9fo3m7Nd48tWv8Xstfo26_DWuX" ascii
      $s14 = "37Nzc-v8Wv-WpsefP9r_tqDz4--_9H3N38__PD3N_Hfr9N_HHfHv_-1aLGd__c1v7fPLfDb_GyQzNs98JtubPSz8Pzf-vyGRKdf8zjuwp19Y5EOu26_yw2RFdr8-mbNW" ascii
      $s15 = "zD8jX59Eo7fXISCWvza1OOvR2T5g_7q38D08Df_Fn_QX8-S_DvxF3_zb_Drpb_G7_xb_EF_-29GdMWXfzt9j79_g9_g18DXv_kf9Hf_uinNyN9Pcvlb_M7U799G__8X_" ascii
      $s16 = "uXfb3Pm5xVner7iT77L_34P-Z6D31_yU78j6bJfRj9_Ex77P2lH8o9i5P8U_vmn8c8_A3L8Gr_NJ3_gJzu_xsEvwSe_FH_zv8j9kMdqsf215QMM4XccHWIUwPj_ogkd0" ascii
      $s17 = "JytP4DCv1-L_M8uepzWM7HLYPhEHvGv8WNT_fvpb7T4_YsGceyXy_L6N5xKZhjNfoOWltHwy6-_XC_w8zeinG_-hiJR_pZW_nKsf_16i99_SQtQyeL3R0qY1ngWv_ni9" ascii
      $s18 = "r978uv-2r_5r_kg-Q3p398z-c1_7Z_4NT5Pfptf-3dlOL_q13iR_K6_9m__a34_-fjX_o1-jYvkvyff623y6Nf-XX_NNnnCn3_-a_-av-a75Av6F339Rr_GH5G8ot__h" ascii
      $s19 = "MAigWOARMAXwGZARMAlgWZARMAYgGkARMAZQGwARMAyAWwARMAaAG8ARMA3gW8ARMAawHHARMA6wXHARMAbgHTARMA-gXTARMAcQHfARMAdAHqARMAdwH0ARMAegH0AR" ascii
      $s20 = "_-P__e__P0_7A__8pf-VdV_9F-M_q_f6uTX_Ev_4t_8N3jxh_zS17_y_v_y6O__e_-Vf_Nbf_K_-kf8t9_-u34Nfc4e_p6_Qfsbub__7__I__2rP_a_-2NPf7M_-N2v8" ascii
   condition:
      ( uint16(0) == 0x5a4d and filesize < 2000KB and ( 8 of them )
      ) or ( all of them )
}

rule _9c1c20db1d73c66795b9b49f39aff02d621dd06c05d7d3ea1007ac7bcbf3f3cd_11f5b01983cd221e28aa672906d313ca45dc0ed41f3516027795905761_27 {
   meta:
      description = "samples - from files 9c1c20db1d73c66795b9b49f39aff02d621dd06c05d7d3ea1007ac7bcbf3f3cd.exe, 11f5b01983cd221e28aa672906d313ca45dc0ed41f351602779590576104c52e.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "9c1c20db1d73c66795b9b49f39aff02d621dd06c05d7d3ea1007ac7bcbf3f3cd"
      hash2 = "11f5b01983cd221e28aa672906d313ca45dc0ed41f351602779590576104c52e"
   strings:
      $s1 = "ehttp://pki-crl.symauth.com/offlineca/TheInstituteofElectricalandElectronicsEngineersIncIEEERootCA.crl0" fullword ascii
      $s2 = "Lhttp://pki-crl.symauth.com/ca_732b6ec148d290c0a071efd1dac8e288/LatestCRL.crl07" fullword ascii
      $s3 = "http://pki-ocsp.symauth.com0" fullword ascii
      $s4 = "Enigma Protector0" fullword ascii
      $s5 = "Enigma Protector1" fullword ascii
      $s6 = "1r.tWv" fullword ascii
      $s7 = "VeriSignMPKI-2-3990" fullword ascii
      $s8 = "732b6ec148d290c0a071efd1dac8e288" ascii
      $s9 = "IEEE Root CA0" fullword ascii
      $s10 = "tg211741371" fullword ascii
      $s11 = "~@~F~M~R~X~_Jf" fullword ascii
      $s12 = "pN9E`h&M" fullword ascii
      $s13 = "<rOtVv" fullword ascii
      $s14 = "h?Q?V?[?b'g" fullword ascii
      $s15 = "*>(?/&4" fullword ascii
      $s16 = ",xz\"J'" fullword ascii
      $s17 = "x z-o4z" fullword ascii
      $s18 = "160204000000Z" fullword ascii
      $s19 = "x#z0|7~<~I~P~U~b~i~n~{~" fullword ascii
      $s20 = "260201235959Z001" fullword ascii
   condition:
      ( uint16(0) == 0x5a4d and filesize < 7000KB and ( 8 of them )
      ) or ( all of them )
}

rule _16335a1172a838611368645dab4446c79b750e3159a6d9f95556d420c559f469_da6b0f4662ab7c277189dafa7f323551c54982b2d54466feefc27d83a3_28 {
   meta:
      description = "samples - from files 16335a1172a838611368645dab4446c79b750e3159a6d9f95556d420c559f469.exe, da6b0f4662ab7c277189dafa7f323551c54982b2d54466feefc27d83a3c90e3c.exe, 2f175dac5c8571e586722f6927b0112af22637a17efb3acfd78e813a804a38f8.exe, c5c9fb0b1e4ba8aed4f8cefb1d77931dd2d5137d6396b7c30630b2864303ee52.exe, a163d18a93ea4bee62762da2d1dfc7d0a2644428fc868fabcb4347cbcf17cc62.exe, 438c9ce6e0b21ec7623f86a2f3e7f1810df1afce1515a5f24d1453a5cacdd74d.exe, fdc933b64df0832a1f88f0e19a4cab67fb110d54c4913367a7215d7890f8a5b7.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "16335a1172a838611368645dab4446c79b750e3159a6d9f95556d420c559f469"
      hash2 = "da6b0f4662ab7c277189dafa7f323551c54982b2d54466feefc27d83a3c90e3c"
      hash3 = "2f175dac5c8571e586722f6927b0112af22637a17efb3acfd78e813a804a38f8"
      hash4 = "c5c9fb0b1e4ba8aed4f8cefb1d77931dd2d5137d6396b7c30630b2864303ee52"
      hash5 = "a163d18a93ea4bee62762da2d1dfc7d0a2644428fc868fabcb4347cbcf17cc62"
      hash6 = "438c9ce6e0b21ec7623f86a2f3e7f1810df1afce1515a5f24d1453a5cacdd74d"
      hash7 = "fdc933b64df0832a1f88f0e19a4cab67fb110d54c4913367a7215d7890f8a5b7"
   strings:
      $s1 = "<EventRecord>k__BackingField" fullword ascii
      $s2 = "Netapi32" fullword ascii /* Goodware String - occured 1 times */
      $s3 = "SessionAuthentication" fullword ascii /* Goodware String - occured 3 times */
      $s4 = "get_OpcodeDisplayName" fullword ascii /* Goodware String - occured 3 times */
      $s5 = "EventBookmark" fullword ascii /* Goodware String - occured 3 times */
      $s6 = "get_ResourceFilePath" fullword ascii /* Goodware String - occured 3 times */
      $s7 = "EventRecordWrittenEventArgs" fullword ascii /* Goodware String - occured 3 times */
      $s8 = "add_EventRecordWritten" fullword ascii /* Goodware String - occured 3 times */
      $s9 = "EventLogWatcher" fullword ascii /* Goodware String - occured 3 times */
      $s10 = "remove_EventRecordWritten" fullword ascii /* Goodware String - occured 3 times */
      $s11 = "EventLogConfiguration" fullword ascii /* Goodware String - occured 3 times */
      $s12 = "get_LevelDisplayName" fullword ascii /* Goodware String - occured 3 times */
      $s13 = "set_ReverseDirection" fullword ascii /* Goodware String - occured 3 times */
      $s14 = "get_EventRecord" fullword ascii /* Goodware String - occured 3 times */
      $s15 = "EventLogPropertySelector" fullword ascii /* Goodware String - occured 3 times */
      $s16 = "CancelReading" fullword ascii /* Goodware String - occured 3 times */
      $s17 = "EventLogQuery" fullword ascii /* Goodware String - occured 4 times */
      $s18 = "EventLogReader" fullword ascii /* Goodware String - occured 4 times */
      $s19 = "EventLogSession" fullword ascii /* Goodware String - occured 4 times */
      $s20 = "System.Diagnostics.Eventing.Reader" fullword ascii /* Goodware String - occured 5 times */
   condition:
      ( uint16(0) == 0x5a4d and filesize < 1000KB and ( 8 of them )
      ) or ( all of them )
}

rule _052d222b441b1fd17f08ca9831c1c92099ffc3a1187ee6266b9d8d1ed9ebeae8_1669d57e8c83d0666c86fafcd484a5fd158c995a58ad9a6855c56d849c_29 {
   meta:
      description = "samples - from files 052d222b441b1fd17f08ca9831c1c92099ffc3a1187ee6266b9d8d1ed9ebeae8.exe, 1669d57e8c83d0666c86fafcd484a5fd158c995a58ad9a6855c56d849c00b40b.exe, 5d1c2ac36ca274835d9025eb9e3f7a113cf57509898e02cb9add7a97824cea59.exe, 542ddd41bf8603c95458d6c2c15e1a0cff107fbabac55b69b92bd40fd8bf1696.exe, 76eee256f1223082e8396611baca498542c656edd0fac5fe903e06e6cb5677e2.exe, 623a60c7f9ddbd0f05e1a2c8b82c78240ef5fa4f1bde4504889e6c6817e264dc.exe, 788bf2c07ca9619f9e388dc1a068aa4d6c3eb804ea375fb6b575ebe3154e6c54.exe, 071b6c448d2546dea8caed872fca0d002f59a6b9849f0de2a565fc74b487fa37.exe, f9ae0d40d4f2b88956a1ccfe6cff9aae6a36508574a56595c331d7ca207e5f03.exe, 2c38956763bb9c8df8d9eb32a8f30252e3e4ac0249f650f609d0036a16e01b9e.exe, 8fc9056ebee5adcd70c3d96e53885fcb355030869137a6f1977a463759f15d86.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "052d222b441b1fd17f08ca9831c1c92099ffc3a1187ee6266b9d8d1ed9ebeae8"
      hash2 = "1669d57e8c83d0666c86fafcd484a5fd158c995a58ad9a6855c56d849c00b40b"
      hash3 = "5d1c2ac36ca274835d9025eb9e3f7a113cf57509898e02cb9add7a97824cea59"
      hash4 = "542ddd41bf8603c95458d6c2c15e1a0cff107fbabac55b69b92bd40fd8bf1696"
      hash5 = "76eee256f1223082e8396611baca498542c656edd0fac5fe903e06e6cb5677e2"
      hash6 = "623a60c7f9ddbd0f05e1a2c8b82c78240ef5fa4f1bde4504889e6c6817e264dc"
      hash7 = "788bf2c07ca9619f9e388dc1a068aa4d6c3eb804ea375fb6b575ebe3154e6c54"
      hash8 = "071b6c448d2546dea8caed872fca0d002f59a6b9849f0de2a565fc74b487fa37"
      hash9 = "f9ae0d40d4f2b88956a1ccfe6cff9aae6a36508574a56595c331d7ca207e5f03"
      hash10 = "2c38956763bb9c8df8d9eb32a8f30252e3e4ac0249f650f609d0036a16e01b9e"
      hash11 = "8fc9056ebee5adcd70c3d96e53885fcb355030869137a6f1977a463759f15d86"
   strings:
      $s1 = " Type Descriptor'" fullword ascii
      $s2 = " Class Hierarchy Descriptor'" fullword ascii
      $s3 = " Base Class Descriptor at (" fullword ascii
      $s4 = " Complete Object Locator'" fullword ascii
      $s5 = " delete[]" fullword ascii
      $s6 = " delete" fullword ascii
      $s7 = " new[]" fullword ascii
      $s8 = " Base Class Array'" fullword ascii
   condition:
      ( uint16(0) == 0x5a4d and filesize < 29000KB and ( all of them )
      ) or ( all of them )
}

rule _07ecf0ee68a52e1783da654389f5adaa861b5e7cfff04cbec504e721cc3a11ad_04f28f4975a7ff3cb3439b65b8d2fad8e99e3431b65be0e065c1949084_30 {
   meta:
      description = "samples - from files 07ecf0ee68a52e1783da654389f5adaa861b5e7cfff04cbec504e721cc3a11ad.exe, 04f28f4975a7ff3cb3439b65b8d2fad8e99e3431b65be0e065c194908459790e.exe, c826d38990051067a23d7ced76e20925ec47749e562ef718029ff06555680b5b.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "07ecf0ee68a52e1783da654389f5adaa861b5e7cfff04cbec504e721cc3a11ad"
      hash2 = "04f28f4975a7ff3cb3439b65b8d2fad8e99e3431b65be0e065c194908459790e"
      hash3 = "c826d38990051067a23d7ced76e20925ec47749e562ef718029ff06555680b5b"
   strings:
      $s1 = "_appMutex" fullword ascii
      $s2 = "AES_Encryptor" fullword ascii
      $s3 = "userAgents" fullword ascii
      $s4 = "GetHashT" fullword ascii
      $s5 = "AES_Decryptor" fullword ascii
      $s6 = "CriticalProcesses_Disable" fullword ascii
      $s7 = "CriticalProcess_Enable" fullword ascii
      $s8 = "SetCurrentProcessIsCritical" fullword ascii
      $s9 = "GetRandomString" fullword ascii
      $s10 = "idletime" fullword ascii
      $s11 = "sumofidletime" fullword ascii
      $s12 = "ReportWindow" fullword ascii
      $s13 = "strToHash" fullword ascii
      $s14 = "RunDisk" fullword ascii
      $s15 = "wDriver" fullword ascii
      $s16 = "Shutdown" fullword ascii /* Goodware String - occured 369 times */
      $s17 = "LastLastIdletime" fullword ascii
      $s18 = "AlgorithmAES" fullword ascii
      $s19 = "_Lambda$__5" fullword ascii
      $s20 = "LastAct" fullword ascii
   condition:
      ( uint16(0) == 0x5a4d and filesize < 900KB and ( 8 of them )
      ) or ( all of them )
}

rule _172f9d447a5f9c686cb8a5322558e39c07fb960631c08c2e0d15cd14f12e1e63_76c26de3a458e5cc615fb37d0b6481a1260e6b62cc7e801a45210693f3_31 {
   meta:
      description = "samples - from files 172f9d447a5f9c686cb8a5322558e39c07fb960631c08c2e0d15cd14f12e1e63.exe, 76c26de3a458e5cc615fb37d0b6481a1260e6b62cc7e801a45210693f381ece7.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "172f9d447a5f9c686cb8a5322558e39c07fb960631c08c2e0d15cd14f12e1e63"
      hash2 = "76c26de3a458e5cc615fb37d0b6481a1260e6b62cc7e801a45210693f381ece7"
   strings:
      $s1 = "%s%S.dll" fullword wide
      $s2 = "NTMARTA" fullword ascii
      $s3 = "RQUSVP" fullword ascii
      $s4 = "L$PQWh" fullword ascii /* Goodware String - occured 2 times */
      $s5 = "D$LQPj" fullword ascii /* Goodware String - occured 2 times */
      $s6 = "f;D$Dt" fullword ascii /* Goodware String - occured 2 times */
      $s7 = "L$$QUPV" fullword ascii /* Goodware String - occured 3 times */
      $s8 = "Vj%UUU" fullword ascii /* Goodware String - occured 3 times */
      $s9 = "YjHjZW" fullword ascii
      $s10 = "L$`QWPV" fullword ascii
      $s11 = "j-Xf9D$" fullword ascii
      $s12 = "t\\j\"Yf;" fullword ascii
      $s13 = "|$ softuP" fullword ascii
      $s14 = "D$(PQh2" fullword ascii
      $s15 = "D$ MPUhs" fullword ascii
      $s16 = "D$DUUWP" fullword ascii
      $s17 = "j.Xf9D$Hu" fullword ascii
      $s18 = "|$4PVhs" fullword ascii
      $s19 = "D$ UUP" fullword ascii
      $s20 = "t$UUUU" fullword ascii
   condition:
      ( uint16(0) == 0x5a4d and filesize < 3000KB and ( 8 of them )
      ) or ( all of them )
}

rule _2f175dac5c8571e586722f6927b0112af22637a17efb3acfd78e813a804a38f8_fdc933b64df0832a1f88f0e19a4cab67fb110d54c4913367a7215d7890_32 {
   meta:
      description = "samples - from files 2f175dac5c8571e586722f6927b0112af22637a17efb3acfd78e813a804a38f8.exe, fdc933b64df0832a1f88f0e19a4cab67fb110d54c4913367a7215d7890f8a5b7.exe, d4b22461e379bba07e2e2f6cf1833884c0ff656b84afdd3b2284be856f598ae0.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "2f175dac5c8571e586722f6927b0112af22637a17efb3acfd78e813a804a38f8"
      hash2 = "fdc933b64df0832a1f88f0e19a4cab67fb110d54c4913367a7215d7890f8a5b7"
      hash3 = "d4b22461e379bba07e2e2f6cf1833884c0ff656b84afdd3b2284be856f598ae0"
   strings:
      $s1 = "<>9__43_0" fullword ascii /* Goodware String - occured 1 times */
      $s2 = "<>9__47_0" fullword ascii /* Goodware String - occured 1 times */
      $s3 = "<>c__DisplayClass39_0" fullword ascii /* Goodware String - occured 1 times */
      $s4 = "<>c__DisplayClass38_0" fullword ascii /* Goodware String - occured 1 times */
      $s5 = "<>9__23_0" fullword ascii /* Goodware String - occured 2 times */
      $s6 = "<>9__20_0" fullword ascii /* Goodware String - occured 2 times */
      $s7 = "get_TriggerType" fullword ascii /* Goodware String - occured 5 times */
      $s8 = "<Justification>k__BackingField" fullword ascii
      $s9 = "triggerType" fullword ascii /* Goodware String - occured 5 times */
   condition:
      ( uint16(0) == 0x5a4d and filesize < 15000KB and ( all of them )
      ) or ( all of them )
}

rule _249009648a4e88d2cd0fb5e595c911e5dca3ec1d70252981554ab0331800cb92_f9dc41ab7a043cf887b9737060be951dd11571c5774a8b6ca004b503c1_33 {
   meta:
      description = "samples - from files 249009648a4e88d2cd0fb5e595c911e5dca3ec1d70252981554ab0331800cb92.exe, f9dc41ab7a043cf887b9737060be951dd11571c5774a8b6ca004b503c1995c72.exe, 00db2c26608e0e750b9262587d68d19dfd37e45b185a22b9438fb309ceb15cd9.exe, fe20286db492e192672c31c79ef6808d9e33601b4fbf4c61ad1aeab5ba3b6b93.exe, 2891ed67cda3644765fd94fce012ff41aa4e32fc4c2857e63648803884d76c6f.exe, 258424cd8a701639a5ba89800e9e425463ab6219ce8435a37ea3c28b9b181ffa.exe, 825196f7ae2364e7712c9893e97c50fa639a3ecb747e7b431d6fa47110724eca.exe, ea6e4e54c6aa6df24c7a386a5ac3bd9a224d69ecd629a555744e72cde043cadd.exe, d4b22461e379bba07e2e2f6cf1833884c0ff656b84afdd3b2284be856f598ae0.exe, 8fc9056ebee5adcd70c3d96e53885fcb355030869137a6f1977a463759f15d86.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "249009648a4e88d2cd0fb5e595c911e5dca3ec1d70252981554ab0331800cb92"
      hash2 = "f9dc41ab7a043cf887b9737060be951dd11571c5774a8b6ca004b503c1995c72"
      hash3 = "00db2c26608e0e750b9262587d68d19dfd37e45b185a22b9438fb309ceb15cd9"
      hash4 = "fe20286db492e192672c31c79ef6808d9e33601b4fbf4c61ad1aeab5ba3b6b93"
      hash5 = "2891ed67cda3644765fd94fce012ff41aa4e32fc4c2857e63648803884d76c6f"
      hash6 = "258424cd8a701639a5ba89800e9e425463ab6219ce8435a37ea3c28b9b181ffa"
      hash7 = "825196f7ae2364e7712c9893e97c50fa639a3ecb747e7b431d6fa47110724eca"
      hash8 = "ea6e4e54c6aa6df24c7a386a5ac3bd9a224d69ecd629a555744e72cde043cadd"
      hash9 = "d4b22461e379bba07e2e2f6cf1833884c0ff656b84afdd3b2284be856f598ae0"
      hash10 = "8fc9056ebee5adcd70c3d96e53885fcb355030869137a6f1977a463759f15d86"
   strings:
      $s1 = "typemdt" fullword ascii
      $s2 = "classthis" fullword ascii
      $s3 = "nativeSizeOfCode" fullword ascii
      $s4 = "nativeEntry" fullword ascii
      $s5 = "GetDelegateForFunctionPointer" fullword wide /* Goodware String - occured 1 times */
      $s6 = "{11111-22222-10009-11112}" fullword wide
      $s7 = "{11111-22222-50001-00000}" fullword wide
      $s8 = "{11111-22222-20001-00001}" fullword wide
      $s9 = "{11111-22222-20001-00002}" fullword wide
      $s10 = "{11111-22222-30001-00001}" fullword wide
      $s11 = "{11111-22222-30001-00002}" fullword wide
      $s12 = "{11111-22222-40001-00001}" fullword wide
      $s13 = "{11111-22222-40001-00002}" fullword wide
   condition:
      ( uint16(0) == 0x5a4d and filesize < 15000KB and ( 8 of them )
      ) or ( all of them )
}

rule _172f9d447a5f9c686cb8a5322558e39c07fb960631c08c2e0d15cd14f12e1e63_f96b03987d5a39f6d1172f022a2e3bf15a31c18f5b38a5ce77c682c36d_34 {
   meta:
      description = "samples - from files 172f9d447a5f9c686cb8a5322558e39c07fb960631c08c2e0d15cd14f12e1e63.exe, f96b03987d5a39f6d1172f022a2e3bf15a31c18f5b38a5ce77c682c36dd791c9.exe, 05b1be412276f70e579862cef3cc0181785ca3c7d6bd398ec2919d50bb4f5630.exe, e4d52884a348b211ebaab9018b286c9f7023abc349f229cc63fea89b5341341e.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "172f9d447a5f9c686cb8a5322558e39c07fb960631c08c2e0d15cd14f12e1e63"
      hash2 = "f96b03987d5a39f6d1172f022a2e3bf15a31c18f5b38a5ce77c682c36dd791c9"
      hash3 = "05b1be412276f70e579862cef3cc0181785ca3c7d6bd398ec2919d50bb4f5630"
      hash4 = "e4d52884a348b211ebaab9018b286c9f7023abc349f229cc63fea89b5341341e"
   strings:
      $s1 = "(Symantec SHA256 TimeStamping Signer - G3" fullword ascii
      $s2 = "(Symantec SHA256 TimeStamping Signer - G30" fullword ascii
      $s3 = "TimeStamp-2048-60" fullword ascii
      $s4 = "171223000000Z" fullword ascii
      $s5 = "290322235959" ascii
      $s6 = "290322235959Z0" fullword ascii
      $s7 = "?'J3Nm" fullword ascii
      $s8 = "310111235959" ascii
      $s9 = "U){9FN" fullword ascii
   condition:
      ( uint16(0) == 0x5a4d and filesize < 3000KB and ( all of them )
      ) or ( all of them )
}

rule _16335a1172a838611368645dab4446c79b750e3159a6d9f95556d420c559f469_da6b0f4662ab7c277189dafa7f323551c54982b2d54466feefc27d83a3_35 {
   meta:
      description = "samples - from files 16335a1172a838611368645dab4446c79b750e3159a6d9f95556d420c559f469.exe, da6b0f4662ab7c277189dafa7f323551c54982b2d54466feefc27d83a3c90e3c.exe, c5c9fb0b1e4ba8aed4f8cefb1d77931dd2d5137d6396b7c30630b2864303ee52.exe, a163d18a93ea4bee62762da2d1dfc7d0a2644428fc868fabcb4347cbcf17cc62.exe, 438c9ce6e0b21ec7623f86a2f3e7f1810df1afce1515a5f24d1453a5cacdd74d.exe, d4b22461e379bba07e2e2f6cf1833884c0ff656b84afdd3b2284be856f598ae0.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "16335a1172a838611368645dab4446c79b750e3159a6d9f95556d420c559f469"
      hash2 = "da6b0f4662ab7c277189dafa7f323551c54982b2d54466feefc27d83a3c90e3c"
      hash3 = "c5c9fb0b1e4ba8aed4f8cefb1d77931dd2d5137d6396b7c30630b2864303ee52"
      hash4 = "a163d18a93ea4bee62762da2d1dfc7d0a2644428fc868fabcb4347cbcf17cc62"
      hash5 = "438c9ce6e0b21ec7623f86a2f3e7f1810df1afce1515a5f24d1453a5cacdd74d"
      hash6 = "d4b22461e379bba07e2e2f6cf1833884c0ff656b84afdd3b2284be856f598ae0"
   strings:
      $s1 = "BCrypt.dll" fullword wide
      $s2 = "UsingResourceKeys" fullword ascii
      $s3 = "OleAut32" fullword ascii
      $s4 = "GetResourceString" fullword ascii /* Goodware String - occured 124 times */
      $s5 = "resourceFormat" fullword ascii
      $s6 = "UnconditionalSuppressMessageAttribute" fullword ascii
      $s7 = "IpHlpApi" fullword ascii
      $s8 = "s_resourceManager" fullword ascii
      $s9 = "Ws2_32" fullword ascii /* Goodware String - occured 3 times */
      $s10 = "NCrypt" fullword ascii
      $s11 = "Unsafe" fullword ascii /* Goodware String - occured 5 times */
      $s12 = "defaultString" fullword ascii /* Goodware String - occured 5 times */
   condition:
      ( uint16(0) == 0x5a4d and filesize < 15000KB and ( 8 of them )
      ) or ( all of them )
}

rule _76eee256f1223082e8396611baca498542c656edd0fac5fe903e06e6cb5677e2_071b6c448d2546dea8caed872fca0d002f59a6b9849f0de2a565fc74b4_36 {
   meta:
      description = "samples - from files 76eee256f1223082e8396611baca498542c656edd0fac5fe903e06e6cb5677e2.exe, 071b6c448d2546dea8caed872fca0d002f59a6b9849f0de2a565fc74b487fa37.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "76eee256f1223082e8396611baca498542c656edd0fac5fe903e06e6cb5677e2"
      hash2 = "071b6c448d2546dea8caed872fca0d002f59a6b9849f0de2a565fc74b487fa37"
   strings:
      $s1 = "AppPolicyGetProcessTerminationMethod" fullword ascii
      $s2 = "AppPolicyGetThreadInitializationType" fullword ascii
      $s3 = "api-ms-win-appmodel-runtime-l1-1-2" fullword wide
      $s4 = "QQSVj8j@" fullword ascii
      $s5 = "api-ms-win-core-file-l1-2-2" fullword wide /* Goodware String - occured 1 times */
      $s6 = "_tqPVj@" fullword ascii
      $s7 = "NX9^`t1" fullword ascii
      $s8 = "A<lt'<tt" fullword ascii
      $s9 = "<ItC<Lt3<Tt#<h" fullword ascii
      $s10 = ";V\\uYW" fullword ascii
      $s11 = "D8(Ht'" fullword ascii
      $s12 = "SWt@jU" fullword ascii
      $s13 = "u29K\\t-" fullword ascii
      $s14 = "ARPRQh" fullword ascii
      $s15 = "ext-ms-" fullword wide
      $s16 = ".?AV?$codecvt@_WDU_Mbstatet@@@std@@" fullword ascii /* Goodware String - occured 5 times */
   condition:
      ( uint16(0) == 0x5a4d and filesize < 29000KB and ( 8 of them )
      ) or ( all of them )
}

rule _7001acf354484cbbb58bbf0bfbfc0644bd629ca6b02c10f8b4e7fd4371c89a99_f181b5a4e2f0dc0cdf70e16c18e3466e436aae0bb96ef9b7dc24c7f219_37 {
   meta:
      description = "samples - from files 7001acf354484cbbb58bbf0bfbfc0644bd629ca6b02c10f8b4e7fd4371c89a99.exe, f181b5a4e2f0dc0cdf70e16c18e3466e436aae0bb96ef9b7dc24c7f219167115.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "7001acf354484cbbb58bbf0bfbfc0644bd629ca6b02c10f8b4e7fd4371c89a99"
      hash2 = "f181b5a4e2f0dc0cdf70e16c18e3466e436aae0bb96ef9b7dc24c7f219167115"
   strings:
      $s1 = "User-Agent: Mozilla/4.0 (compatible; MSIE 9.0; Windows NT 6.1)" fullword ascii
      $s2 = "GetAllResponseHeaders" fullword ascii
      $s3 = "keep-alive" fullword ascii /* Goodware String - occured 85 times */
      $s4 = "@SetTimeouts" fullword ascii
      $s5 = "T$@SRh" fullword ascii /* Goodware String - occured 1 times */
      $s6 = "L$DQRf" fullword ascii /* Goodware String - occured 1 times */
      $s7 = "WinHttp.WinHttpRequest.5.1" fullword ascii /* Goodware String - occured 1 times */
      $s8 = "WWVQRWWS" fullword ascii /* Goodware String - occured 2 times */
      $s9 = "ResponseBody" fullword ascii /* Goodware String - occured 2 times */
      $s10 = "52F260023059454187AF826A3C07AF2A" ascii
      $s11 = "D$hRQP" fullword ascii
      $s12 = "9L$x~k" fullword ascii
      $s13 = "T$0VRPSQ" fullword ascii
      $s14 = "23059454187AF826A3C07AF2A" ascii
      $s15 = "L$pPQR" fullword ascii /* Goodware String - occured 5 times */
   condition:
      ( uint16(0) == 0x5a4d and filesize < 15000KB and ( 8 of them )
      ) or ( all of them )
}

rule _76eee256f1223082e8396611baca498542c656edd0fac5fe903e06e6cb5677e2_acad873da34aab461e8a7b87dd2c6d98c3b2b187f5ca868415bac26af1_38 {
   meta:
      description = "samples - from files 76eee256f1223082e8396611baca498542c656edd0fac5fe903e06e6cb5677e2.exe, acad873da34aab461e8a7b87dd2c6d98c3b2b187f5ca868415bac26af1516da5.exe, 76c26de3a458e5cc615fb37d0b6481a1260e6b62cc7e801a45210693f381ece7.exe, d4b22461e379bba07e2e2f6cf1833884c0ff656b84afdd3b2284be856f598ae0.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "76eee256f1223082e8396611baca498542c656edd0fac5fe903e06e6cb5677e2"
      hash2 = "acad873da34aab461e8a7b87dd2c6d98c3b2b187f5ca868415bac26af1516da5"
      hash3 = "76c26de3a458e5cc615fb37d0b6481a1260e6b62cc7e801a45210693f381ece7"
      hash4 = "d4b22461e379bba07e2e2f6cf1833884c0ff656b84afdd3b2284be856f598ae0"
   strings:
      $s1 = "5http://cacerts.digicert.com/DigiCertTrustedRootG4.crt0C" fullword ascii
      $s2 = "4http://crl3.digicert.com/DigiCertAssuredIDRootCA.crl0" fullword ascii
      $s3 = "2http://crl3.digicert.com/DigiCertTrustedRootG4.crl0 " fullword ascii
      $s4 = "7http://cacerts.digicert.com/DigiCertAssuredIDRootCA.crt0E" fullword ascii
      $s5 = "http://ocsp.digicert.com0X" fullword ascii
      $s6 = "Lhttp://cacerts.digicert.com/DigiCertTrustedG4RSA4096SHA256TimeStampingCA.crt0" fullword ascii
      $s7 = "Ihttp://crl3.digicert.com/DigiCertTrustedG4RSA4096SHA256TimeStampingCA.crl0" fullword ascii
      $s8 = "]J<0\"0i3" fullword ascii /* Goodware String - occured 1 times */
      $s9 = "v=Y]Bv" fullword ascii /* Goodware String - occured 1 times */
      $s10 = "DigiCert Trusted Root G40" fullword ascii /* Goodware String - occured 1 times */
      $s11 = "DigiCert Timestamp 20230" fullword ascii
      $s12 = "DigiCert, Inc.1;09" fullword ascii
      $s13 = "2DigiCert Trusted G4 RSA4096 SHA256 TimeStamping CA" fullword ascii
      $s14 = "2DigiCert Trusted G4 RSA4096 SHA256 TimeStamping CA0" fullword ascii
      $s15 = "311109235959Z0b1" fullword ascii
      $s16 = "341013235959" ascii
      $s17 = "(f*^[0" fullword ascii
      $s18 = "~qj#k\"" fullword ascii
      $s19 = "341013235959Z0H1" fullword ascii
      $s20 = "220801000000Z" fullword ascii
   condition:
      ( uint16(0) == 0x5a4d and filesize < 29000KB and ( 8 of them )
      ) or ( all of them )
}

rule _a55c7ed8b626f509f1db86fb6be1823a6bdf54b47c73a348cfe70c36e8b45d82_07ecf0ee68a52e1783da654389f5adaa861b5e7cfff04cbec504e721cc_39 {
   meta:
      description = "samples - from files a55c7ed8b626f509f1db86fb6be1823a6bdf54b47c73a348cfe70c36e8b45d82.exe, 07ecf0ee68a52e1783da654389f5adaa861b5e7cfff04cbec504e721cc3a11ad.exe, 434fc1fcde79cced66c7784f22b1703b41dd77f1800edd7bebe4343f479080d8.exe, ded5515158d7b1ed9520713645bc63d7bb872f0a212c77ebb1afce0d16fad0ce.exe, e2a569f0f5168d11500b6e5f5c0ad0c900c45be7cbab68f0c354318123bf942f.exe, 1673828a6bb871f75162500cdffd2e86113da89049fff26117e78be6ea681e69.exe, 0a785a353308e02dfe2b5b3318d6a2a90d7a918dd200d70109fe3eedc3ce69d1.exe, 5ad6806628708095957c45a7f728f941d9b436a25f3f0d2147274403fffd1045.exe, fdc933b64df0832a1f88f0e19a4cab67fb110d54c4913367a7215d7890f8a5b7.exe, 04f28f4975a7ff3cb3439b65b8d2fad8e99e3431b65be0e065c194908459790e.exe, c826d38990051067a23d7ced76e20925ec47749e562ef718029ff06555680b5b.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "a55c7ed8b626f509f1db86fb6be1823a6bdf54b47c73a348cfe70c36e8b45d82"
      hash2 = "07ecf0ee68a52e1783da654389f5adaa861b5e7cfff04cbec504e721cc3a11ad"
      hash3 = "434fc1fcde79cced66c7784f22b1703b41dd77f1800edd7bebe4343f479080d8"
      hash4 = "ded5515158d7b1ed9520713645bc63d7bb872f0a212c77ebb1afce0d16fad0ce"
      hash5 = "e2a569f0f5168d11500b6e5f5c0ad0c900c45be7cbab68f0c354318123bf942f"
      hash6 = "1673828a6bb871f75162500cdffd2e86113da89049fff26117e78be6ea681e69"
      hash7 = "0a785a353308e02dfe2b5b3318d6a2a90d7a918dd200d70109fe3eedc3ce69d1"
      hash8 = "5ad6806628708095957c45a7f728f941d9b436a25f3f0d2147274403fffd1045"
      hash9 = "fdc933b64df0832a1f88f0e19a4cab67fb110d54c4913367a7215d7890f8a5b7"
      hash10 = "04f28f4975a7ff3cb3439b65b8d2fad8e99e3431b65be0e065c194908459790e"
      hash11 = "c826d38990051067a23d7ced76e20925ec47749e562ef718029ff06555680b5b"
   strings:
      $s1 = "EXECUTION_STATE" fullword ascii
      $s2 = "\" /f /q" fullword wide
      $s3 = "Select * from AntivirusProduct" fullword wide
      $s4 = "ES_SYSTEM_REQUIRED" fullword ascii
      $s5 = "ES_DISPLAY_REQUIRED" fullword ascii
      $s6 = "ES_CONTINUOUS" fullword ascii
      $s7 = "sendPlugin" fullword wide
      $s8 = "timeout 3 > NUL" fullword wide
      $s9 = "\\root\\SecurityCenter2" fullword wide /* Goodware String - occured 1 times */
      $s10 = "Err HWID" fullword wide
   condition:
      ( uint16(0) == 0x5a4d and filesize < 1000KB and ( all of them )
      ) or ( all of them )
}

rule _052d222b441b1fd17f08ca9831c1c92099ffc3a1187ee6266b9d8d1ed9ebeae8_f181b5a4e2f0dc0cdf70e16c18e3466e436aae0bb96ef9b7dc24c7f219_40 {
   meta:
      description = "samples - from files 052d222b441b1fd17f08ca9831c1c92099ffc3a1187ee6266b9d8d1ed9ebeae8.exe, f181b5a4e2f0dc0cdf70e16c18e3466e436aae0bb96ef9b7dc24c7f219167115.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "052d222b441b1fd17f08ca9831c1c92099ffc3a1187ee6266b9d8d1ed9ebeae8"
      hash2 = "f181b5a4e2f0dc0cdf70e16c18e3466e436aae0bb96ef9b7dc24c7f219167115"
   strings:
      $s1 = "Firefox" fullword wide /* Goodware String - occured 102 times */
      $s2 = "emailAddress" fullword ascii /* Goodware String - occured 109 times */
      $s3 = "serialNumber" fullword ascii /* Goodware String - occured 147 times */
      $s4 = "TLS_CHACHA20_POLY1305_SHA256" fullword ascii
      $s5 = "Content-Type: application/json" fullword ascii /* Goodware String - occured 1 times */
      $s6 = "Yandex" fullword wide /* Goodware String - occured 3 times */
      $s7 = "TLS_AES_256_GCM_SHA384" fullword ascii
      $s8 = "TLS_AES_128_CCM_SHA256" fullword ascii
      $s9 = "TLS_AES_128_CCM_8_SHA256" fullword ascii
      $s10 = "TLS_AES_128_GCM_SHA256" fullword ascii
   condition:
      ( uint16(0) == 0x5a4d and filesize < 15000KB and ( all of them )
      ) or ( all of them )
}

rule _6f2b0a1890381cd7f98f920e2ecca11d2cc54f0e50c85da93f65fa8abc0c5b09_07ecf0ee68a52e1783da654389f5adaa861b5e7cfff04cbec504e721cc_41 {
   meta:
      description = "samples - from files 6f2b0a1890381cd7f98f920e2ecca11d2cc54f0e50c85da93f65fa8abc0c5b09.exe, 07ecf0ee68a52e1783da654389f5adaa861b5e7cfff04cbec504e721cc3a11ad.exe, ded5515158d7b1ed9520713645bc63d7bb872f0a212c77ebb1afce0d16fad0ce.exe, e2a569f0f5168d11500b6e5f5c0ad0c900c45be7cbab68f0c354318123bf942f.exe, cb22cebed97d6363239f63cf28816b8a8c06977c6d8625a43a61f0afa8823b26.exe, 0a785a353308e02dfe2b5b3318d6a2a90d7a918dd200d70109fe3eedc3ce69d1.exe, 5ad6806628708095957c45a7f728f941d9b436a25f3f0d2147274403fffd1045.exe, 04f28f4975a7ff3cb3439b65b8d2fad8e99e3431b65be0e065c194908459790e.exe, c826d38990051067a23d7ced76e20925ec47749e562ef718029ff06555680b5b.exe, d4b22461e379bba07e2e2f6cf1833884c0ff656b84afdd3b2284be856f598ae0.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "6f2b0a1890381cd7f98f920e2ecca11d2cc54f0e50c85da93f65fa8abc0c5b09"
      hash2 = "07ecf0ee68a52e1783da654389f5adaa861b5e7cfff04cbec504e721cc3a11ad"
      hash3 = "ded5515158d7b1ed9520713645bc63d7bb872f0a212c77ebb1afce0d16fad0ce"
      hash4 = "e2a569f0f5168d11500b6e5f5c0ad0c900c45be7cbab68f0c354318123bf942f"
      hash5 = "cb22cebed97d6363239f63cf28816b8a8c06977c6d8625a43a61f0afa8823b26"
      hash6 = "0a785a353308e02dfe2b5b3318d6a2a90d7a918dd200d70109fe3eedc3ce69d1"
      hash7 = "5ad6806628708095957c45a7f728f941d9b436a25f3f0d2147274403fffd1045"
      hash8 = "04f28f4975a7ff3cb3439b65b8d2fad8e99e3431b65be0e065c194908459790e"
      hash9 = "c826d38990051067a23d7ced76e20925ec47749e562ef718029ff06555680b5b"
      hash10 = "d4b22461e379bba07e2e2f6cf1833884c0ff656b84afdd3b2284be856f598ae0"
   strings:
      $s1 = "4System.Web.Services.Protocols.SoapHttpClientProtocol" fullword ascii
      $s2 = "My.Computer" fullword ascii
      $s3 = "MyTemplate" fullword ascii
      $s4 = "ThreadSafeObjectProvider`1" fullword ascii
      $s5 = "MyWebServices" fullword ascii
      $s6 = "My.WebServices" fullword ascii
      $s7 = "m_ThreadStaticValue" fullword ascii
      $s8 = "Create__Instance__" fullword ascii
      $s9 = "My.User" fullword ascii
      $s10 = "Dispose__Instance__" fullword ascii
      $s11 = "My.Application" fullword ascii
   condition:
      ( uint16(0) == 0x5a4d and filesize < 15000KB and ( 8 of them )
      ) or ( all of them )
}

rule _90a58064c6df293fc564fa5b616c737f6fd31f6288433da2030ec56d6dc46962_d4b22461e379bba07e2e2f6cf1833884c0ff656b84afdd3b2284be856f_42 {
   meta:
      description = "samples - from files 90a58064c6df293fc564fa5b616c737f6fd31f6288433da2030ec56d6dc46962.exe, d4b22461e379bba07e2e2f6cf1833884c0ff656b84afdd3b2284be856f598ae0.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "90a58064c6df293fc564fa5b616c737f6fd31f6288433da2030ec56d6dc46962"
      hash2 = "d4b22461e379bba07e2e2f6cf1833884c0ff656b84afdd3b2284be856f598ae0"
   strings:
      $s1 = "DecodeZigZag32" fullword ascii
      $s2 = "DecodeZigZag64" fullword ascii
      $s3 = "EncodeZigZag64" fullword ascii
      $s4 = "EncodeZigZag32" fullword ascii
      $s5 = "<>9__8_0" fullword ascii /* Goodware String - occured 3 times */
   condition:
      ( uint16(0) == 0x5a4d and filesize < 15000KB and ( all of them )
      ) or ( all of them )
}

rule _07ecf0ee68a52e1783da654389f5adaa861b5e7cfff04cbec504e721cc3a11ad_ded5515158d7b1ed9520713645bc63d7bb872f0a212c77ebb1afce0d16_43 {
   meta:
      description = "samples - from files 07ecf0ee68a52e1783da654389f5adaa861b5e7cfff04cbec504e721cc3a11ad.exe, ded5515158d7b1ed9520713645bc63d7bb872f0a212c77ebb1afce0d16fad0ce.exe, e2a569f0f5168d11500b6e5f5c0ad0c900c45be7cbab68f0c354318123bf942f.exe, 0a785a353308e02dfe2b5b3318d6a2a90d7a918dd200d70109fe3eedc3ce69d1.exe, 5ad6806628708095957c45a7f728f941d9b436a25f3f0d2147274403fffd1045.exe, c826d38990051067a23d7ced76e20925ec47749e562ef718029ff06555680b5b.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "07ecf0ee68a52e1783da654389f5adaa861b5e7cfff04cbec504e721cc3a11ad"
      hash2 = "ded5515158d7b1ed9520713645bc63d7bb872f0a212c77ebb1afce0d16fad0ce"
      hash3 = "e2a569f0f5168d11500b6e5f5c0ad0c900c45be7cbab68f0c354318123bf942f"
      hash4 = "0a785a353308e02dfe2b5b3318d6a2a90d7a918dd200d70109fe3eedc3ce69d1"
      hash5 = "5ad6806628708095957c45a7f728f941d9b436a25f3f0d2147274403fffd1045"
      hash6 = "c826d38990051067a23d7ced76e20925ec47749e562ef718029ff06555680b5b"
   strings:
      $x1 = "-ExecutionPolicy Bypass Add-MpPreference -ExclusionProcess '" fullword wide
      $x2 = "-ExecutionPolicy Bypass Add-MpPreference -ExclusionPath '" fullword wide
      $s3 = "SHCore.dll" fullword ascii
      $s4 = "\\Log.tmp" fullword wide
      $s5 = "/create /f /RL HIGHEST /sc minute /mo 1 /tn \"" fullword wide
      $s6 = "/create /f /sc minute /mo 1 /tn \"" fullword wide
      $s7 = "/delete /f  /tn \"" fullword wide
      $s8 = "\" /tr \"" fullword wide
      $s9 = "_Lambda$__8" fullword ascii
   condition:
      ( uint16(0) == 0x5a4d and filesize < 800KB and ( 1 of ($x*) and all of them )
      ) or ( all of them )
}

rule _6f2b0a1890381cd7f98f920e2ecca11d2cc54f0e50c85da93f65fa8abc0c5b09_d4b22461e379bba07e2e2f6cf1833884c0ff656b84afdd3b2284be856f_44 {
   meta:
      description = "samples - from files 6f2b0a1890381cd7f98f920e2ecca11d2cc54f0e50c85da93f65fa8abc0c5b09.exe, d4b22461e379bba07e2e2f6cf1833884c0ff656b84afdd3b2284be856f598ae0.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "6f2b0a1890381cd7f98f920e2ecca11d2cc54f0e50c85da93f65fa8abc0c5b09"
      hash2 = "d4b22461e379bba07e2e2f6cf1833884c0ff656b84afdd3b2284be856f598ae0"
   strings:
      $s1 = "My.Settings" fullword ascii
      $s2 = "28102212" ascii
      $s3 = "13102212" ascii
      $s4 = "(DigiCert SHA2 Assured ID Code Signing CA" fullword ascii /* Goodware String - occured 5 times */
      $s5 = "/http://crl3.digicert.com/sha2-assured-cs-g1.crl05" fullword ascii /* Goodware String - occured 5 times */
      $s6 = "4http://crl3.digicert.com/DigiCertAssuredIDRootCA.crl0O" fullword ascii /* Goodware String - occured 5 times */
      $s7 = "StrReverse" fullword ascii /* Goodware String - occured 5 times */
      $s8 = "(DigiCert SHA2 Assured ID Code Signing CA0" fullword ascii /* Goodware String - occured 5 times */
      $s9 = "131022120000Z" fullword ascii /* Goodware String - occured 5 times */
      $s10 = "Bhttp://cacerts.digicert.com/DigiCertSHA2AssuredIDCodeSigningCA.crt0" fullword ascii /* Goodware String - occured 5 times */
      $s11 = "p1f3q>" fullword ascii /* Goodware String - occured 5 times */
      $s12 = "http://ocsp.digicert.com0N" fullword ascii /* Goodware String - occured 5 times */
      $s13 = "281022120000Z0r1" fullword ascii /* Goodware String - occured 5 times */
   condition:
      ( uint16(0) == 0x5a4d and filesize < 15000KB and ( 8 of them )
      ) or ( all of them )
}

rule _a228df5184a2c1a2864e8e7872c2ab98718a287ffea2d6c2c4dd65ba85752692_7001acf354484cbbb58bbf0bfbfc0644bd629ca6b02c10f8b4e7fd4371_45 {
   meta:
      description = "samples - from files a228df5184a2c1a2864e8e7872c2ab98718a287ffea2d6c2c4dd65ba85752692.exe, 7001acf354484cbbb58bbf0bfbfc0644bd629ca6b02c10f8b4e7fd4371c89a99.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "a228df5184a2c1a2864e8e7872c2ab98718a287ffea2d6c2c4dd65ba85752692"
      hash2 = "7001acf354484cbbb58bbf0bfbfc0644bd629ca6b02c10f8b4e7fd4371c89a99"
   strings:
      $s1 = "Jjjjjjjjj" fullword wide
      $s2 = "T$LQh " fullword ascii /* Goodware String - occured 1 times */
      $s3 = "T$TQRPh" fullword ascii /* Goodware String - occured 1 times */
      $s4 = "T$,PQh@" fullword ascii
      $s5 = "D$0Qh4" fullword ascii
      $s6 = "9L$|~q" fullword ascii
      $s7 = "L$LPh " fullword ascii
      $s8 = "L$X_^][d" fullword ascii /* Goodware String - occured 4 times */
      $s9 = "O\\VRPSQ" fullword ascii
      $s10 = "D$tRQP" fullword ascii
      $s11 = "L$TQVSh" fullword ascii
   condition:
      ( uint16(0) == 0x5a4d and filesize < 5000KB and ( 8 of them )
      ) or ( all of them )
}

rule _434fc1fcde79cced66c7784f22b1703b41dd77f1800edd7bebe4343f479080d8_1673828a6bb871f75162500cdffd2e86113da89049fff26117e78be6ea_46 {
   meta:
      description = "samples - from files 434fc1fcde79cced66c7784f22b1703b41dd77f1800edd7bebe4343f479080d8.exe, 1673828a6bb871f75162500cdffd2e86113da89049fff26117e78be6ea681e69.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "434fc1fcde79cced66c7784f22b1703b41dd77f1800edd7bebe4343f479080d8"
      hash2 = "1673828a6bb871f75162500cdffd2e86113da89049fff26117e78be6ea681e69"
   strings:
      $s1 = "AntiProcess" fullword ascii
      $s2 = "isVM_by_wim_temper" fullword ascii
      $s3 = "\\\\{0}\\root\\CIMV2" fullword wide
      $s4 = "ProductType" fullword wide /* Goodware String - occured 456 times */
      $s5 = "IsServerOS" fullword ascii /* Goodware String - occured 1 times */
      $s6 = "Select * from Win32_CacheMemory" fullword wide
      $s7 = "SELECT * FROM Win32_OperatingSystem" fullword wide /* Goodware String - occured 3 times */
   condition:
      ( uint16(0) == 0x5a4d and filesize < 200KB and ( all of them )
      ) or ( all of them )
}

rule _acad873da34aab461e8a7b87dd2c6d98c3b2b187f5ca868415bac26af1516da5_76c26de3a458e5cc615fb37d0b6481a1260e6b62cc7e801a45210693f3_47 {
   meta:
      description = "samples - from files acad873da34aab461e8a7b87dd2c6d98c3b2b187f5ca868415bac26af1516da5.exe, 76c26de3a458e5cc615fb37d0b6481a1260e6b62cc7e801a45210693f381ece7.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "acad873da34aab461e8a7b87dd2c6d98c3b2b187f5ca868415bac26af1516da5"
      hash2 = "76c26de3a458e5cc615fb37d0b6481a1260e6b62cc7e801a45210693f381ece7"
   strings:
      $s1 = "2http://crl3.digicert.com/DigiCertTrustedRootG4.crl0" fullword ascii
      $s2 = "http://ocsp.digicert.com0\\" fullword ascii
      $s3 = "Mhttp://crl3.digicert.com/DigiCertTrustedG4CodeSigningRSA4096SHA3842021CA1.crl0S" fullword ascii
      $s4 = "Phttp://cacerts.digicert.com/DigiCertTrustedG4CodeSigningRSA4096SHA3842021CA1.crt0" fullword ascii
      $s5 = "Mhttp://crl4.digicert.com/DigiCertTrustedG4CodeSigningRSA4096SHA3842021CA1.crl0>" fullword ascii
      $s6 = "DigiCert, Inc.1A0?" fullword ascii
      $s7 = "8DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA10" fullword ascii
      $s8 = "8DigiCert Trusted G4 Code Signing RSA4096 SHA384 2021 CA1" fullword ascii
      $s9 = "210429000000Z" fullword ascii
      $s10 = "360428235959Z0i1" fullword ascii
      $s11 = "jj@0HK4" fullword ascii
      $s12 = "SA|X=G" fullword ascii
      $s13 = "360428235959" ascii
      $s14 = "[K]taM?" fullword ascii
   condition:
      ( uint16(0) == 0x5a4d and filesize < 7000KB and ( 8 of them )
      ) or ( all of them )
}

rule _a55c7ed8b626f509f1db86fb6be1823a6bdf54b47c73a348cfe70c36e8b45d82_434fc1fcde79cced66c7784f22b1703b41dd77f1800edd7bebe4343f47_48 {
   meta:
      description = "samples - from files a55c7ed8b626f509f1db86fb6be1823a6bdf54b47c73a348cfe70c36e8b45d82.exe, 434fc1fcde79cced66c7784f22b1703b41dd77f1800edd7bebe4343f479080d8.exe, 90a58064c6df293fc564fa5b616c737f6fd31f6288433da2030ec56d6dc46962.exe, 1673828a6bb871f75162500cdffd2e86113da89049fff26117e78be6ea681e69.exe, fdc933b64df0832a1f88f0e19a4cab67fb110d54c4913367a7215d7890f8a5b7.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "a55c7ed8b626f509f1db86fb6be1823a6bdf54b47c73a348cfe70c36e8b45d82"
      hash2 = "434fc1fcde79cced66c7784f22b1703b41dd77f1800edd7bebe4343f479080d8"
      hash3 = "90a58064c6df293fc564fa5b616c737f6fd31f6288433da2030ec56d6dc46962"
      hash4 = "1673828a6bb871f75162500cdffd2e86113da89049fff26117e78be6ea681e69"
      hash5 = "fdc933b64df0832a1f88f0e19a4cab67fb110d54c4913367a7215d7890f8a5b7"
   strings:
      $s1 = "Reconnect" fullword ascii /* Goodware String - occured 19 times */
      $s2 = "$29840822-5B84-11D0-BD3B-00A0C911CE86" fullword ascii
      $s3 = "00A0C911CE86" ascii
      $s4 = "00AA004BB851" ascii
      $s5 = "CreateClassEnumerator" fullword ascii
   condition:
      ( uint16(0) == 0x5a4d and filesize < 1000KB and ( all of them )
      ) or ( all of them )
}

rule _1669d57e8c83d0666c86fafcd484a5fd158c995a58ad9a6855c56d849c00b40b_16335a1172a838611368645dab4446c79b750e3159a6d9f95556d420c5_49 {
   meta:
      description = "samples - from files 1669d57e8c83d0666c86fafcd484a5fd158c995a58ad9a6855c56d849c00b40b.exe, 16335a1172a838611368645dab4446c79b750e3159a6d9f95556d420c559f469.exe, 542ddd41bf8603c95458d6c2c15e1a0cff107fbabac55b69b92bd40fd8bf1696.exe, da6b0f4662ab7c277189dafa7f323551c54982b2d54466feefc27d83a3c90e3c.exe, c5c9fb0b1e4ba8aed4f8cefb1d77931dd2d5137d6396b7c30630b2864303ee52.exe, a163d18a93ea4bee62762da2d1dfc7d0a2644428fc868fabcb4347cbcf17cc62.exe, 438c9ce6e0b21ec7623f86a2f3e7f1810df1afce1515a5f24d1453a5cacdd74d.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "1669d57e8c83d0666c86fafcd484a5fd158c995a58ad9a6855c56d849c00b40b"
      hash2 = "16335a1172a838611368645dab4446c79b750e3159a6d9f95556d420c559f469"
      hash3 = "542ddd41bf8603c95458d6c2c15e1a0cff107fbabac55b69b92bd40fd8bf1696"
      hash4 = "da6b0f4662ab7c277189dafa7f323551c54982b2d54466feefc27d83a3c90e3c"
      hash5 = "c5c9fb0b1e4ba8aed4f8cefb1d77931dd2d5137d6396b7c30630b2864303ee52"
      hash6 = "a163d18a93ea4bee62762da2d1dfc7d0a2644428fc868fabcb4347cbcf17cc62"
      hash7 = "438c9ce6e0b21ec7623f86a2f3e7f1810df1afce1515a5f24d1453a5cacdd74d"
   strings:
      $s1 = "TryGetSwitch" fullword ascii
      $s2 = "Ucrtbase" fullword ascii
      $s3 = "AppContext" fullword ascii
      $s4 = "DiagnosticId" fullword ascii
      $s5 = "MarshalMode" fullword ascii
   condition:
      ( uint16(0) == 0x5a4d and filesize < 7000KB and ( all of them )
      ) or ( all of them )
}

rule _a55c7ed8b626f509f1db86fb6be1823a6bdf54b47c73a348cfe70c36e8b45d82_434fc1fcde79cced66c7784f22b1703b41dd77f1800edd7bebe4343f47_50 {
   meta:
      description = "samples - from files a55c7ed8b626f509f1db86fb6be1823a6bdf54b47c73a348cfe70c36e8b45d82.exe, 434fc1fcde79cced66c7784f22b1703b41dd77f1800edd7bebe4343f479080d8.exe, 90a58064c6df293fc564fa5b616c737f6fd31f6288433da2030ec56d6dc46962.exe, 1673828a6bb871f75162500cdffd2e86113da89049fff26117e78be6ea681e69.exe, f181b5a4e2f0dc0cdf70e16c18e3466e436aae0bb96ef9b7dc24c7f219167115.exe, fdc933b64df0832a1f88f0e19a4cab67fb110d54c4913367a7215d7890f8a5b7.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "a55c7ed8b626f509f1db86fb6be1823a6bdf54b47c73a348cfe70c36e8b45d82"
      hash2 = "434fc1fcde79cced66c7784f22b1703b41dd77f1800edd7bebe4343f479080d8"
      hash3 = "90a58064c6df293fc564fa5b616c737f6fd31f6288433da2030ec56d6dc46962"
      hash4 = "1673828a6bb871f75162500cdffd2e86113da89049fff26117e78be6ea681e69"
      hash5 = "f181b5a4e2f0dc0cdf70e16c18e3466e436aae0bb96ef9b7dc24c7f219167115"
      hash6 = "fdc933b64df0832a1f88f0e19a4cab67fb110d54c4913367a7215d7890f8a5b7"
   strings:
      $s1 = "        <requestedExecutionLevel level=\"asInvoker\" uiAccess=\"false\" />" fullword ascii
      $s2 = "      <!-- Windows Vista -->" fullword ascii
      $s3 = "      <!-- Windows 8 -->" fullword ascii
      $s4 = "      <!-- Windows 8.1 -->" fullword ascii
      $s5 = "      <!-- Windows 10 -->" fullword ascii
      $s6 = "      <!-- Windows 7 -->" fullword ascii
      $s7 = "  <compatibility xmlns=\"urn:schemas-microsoft-com:compatibility.v1\">" fullword ascii
      $s8 = "  </compatibility>" fullword ascii
   condition:
      ( uint16(0) == 0x5a4d and filesize < 15000KB and ( all of them )
      ) or ( all of them )
}

rule _c0e6cea1456ebc9c970e4cfc70ad112501a744373e25c74ae318e9654f852da5_7289da5a1cc6d7149e862660a7f3f48db0ef1f6f8e5de991501e72bde1_51 {
   meta:
      description = "samples - from files c0e6cea1456ebc9c970e4cfc70ad112501a744373e25c74ae318e9654f852da5.exe, 7289da5a1cc6d7149e862660a7f3f48db0ef1f6f8e5de991501e72bde1192be9.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "c0e6cea1456ebc9c970e4cfc70ad112501a744373e25c74ae318e9654f852da5"
      hash2 = "7289da5a1cc6d7149e862660a7f3f48db0ef1f6f8e5de991501e72bde1192be9"
   strings:
      $s1 = "PostCode" fullword ascii
      $s2 = "CourseID" fullword ascii
      $s3 = "Student" fullword ascii /* Goodware String - occured 1 times */
      $s4 = "Grafik_Sistemi" fullword ascii
      $s5 = "nameBox" fullword ascii /* Goodware String - occured 1 times */
      $s6 = "CourseTitle" fullword ascii
      $s7 = "IsEnrolled" fullword ascii
      $s8 = "ChartArea" fullword ascii /* Goodware String - occured 2 times */
      $s9 = "Series" fullword ascii /* Goodware String - occured 3 times */
   condition:
      ( uint16(0) == 0x5a4d and filesize < 2000KB and ( all of them )
      ) or ( all of them )
}

rule _07ecf0ee68a52e1783da654389f5adaa861b5e7cfff04cbec504e721cc3a11ad_ded5515158d7b1ed9520713645bc63d7bb872f0a212c77ebb1afce0d16_52 {
   meta:
      description = "samples - from files 07ecf0ee68a52e1783da654389f5adaa861b5e7cfff04cbec504e721cc3a11ad.exe, ded5515158d7b1ed9520713645bc63d7bb872f0a212c77ebb1afce0d16fad0ce.exe, e2a569f0f5168d11500b6e5f5c0ad0c900c45be7cbab68f0c354318123bf942f.exe, 0a785a353308e02dfe2b5b3318d6a2a90d7a918dd200d70109fe3eedc3ce69d1.exe, 5ad6806628708095957c45a7f728f941d9b436a25f3f0d2147274403fffd1045.exe, fdc933b64df0832a1f88f0e19a4cab67fb110d54c4913367a7215d7890f8a5b7.exe, c826d38990051067a23d7ced76e20925ec47749e562ef718029ff06555680b5b.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "07ecf0ee68a52e1783da654389f5adaa861b5e7cfff04cbec504e721cc3a11ad"
      hash2 = "ded5515158d7b1ed9520713645bc63d7bb872f0a212c77ebb1afce0d16fad0ce"
      hash3 = "e2a569f0f5168d11500b6e5f5c0ad0c900c45be7cbab68f0c354318123bf942f"
      hash4 = "0a785a353308e02dfe2b5b3318d6a2a90d7a918dd200d70109fe3eedc3ce69d1"
      hash5 = "5ad6806628708095957c45a7f728f941d9b436a25f3f0d2147274403fffd1045"
      hash6 = "fdc933b64df0832a1f88f0e19a4cab67fb110d54c4913367a7215d7890f8a5b7"
      hash7 = "c826d38990051067a23d7ced76e20925ec47749e562ef718029ff06555680b5b"
   strings:
      $s1 = "LControlKey" fullword wide
      $s2 = "RControlKey" fullword wide
      $s3 = "RShiftKey" fullword wide
      $s4 = "LShiftKey" fullword wide
      $s5 = "Capital" fullword wide
      $s6 = "[SPACE]" fullword wide
      $s7 = "[ENTER]" fullword wide
      $s8 = "[CTRL]" fullword wide
      $s9 = "[Shift]" fullword wide
      $s10 = "[Back]" fullword wide
      $s11 = "[CAPSLOCK: OFF]" fullword wide
      $s12 = "[CAPSLOCK: ON]" fullword wide
   condition:
      ( uint16(0) == 0x5a4d and filesize < 1000KB and ( 8 of them )
      ) or ( all of them )
}

rule _5251011e8feda9381a5a1b119b36c8bd4bbd3de97044743d8cea2d2f69ee0b4d_188206f6dabcf77e5a3ac75e74661ba868dd95122fa3328abf023541d4_53 {
   meta:
      description = "samples - from files 5251011e8feda9381a5a1b119b36c8bd4bbd3de97044743d8cea2d2f69ee0b4d.exe, 188206f6dabcf77e5a3ac75e74661ba868dd95122fa3328abf023541d4ffdec9.exe, af2f05611639653b5c588b25b9e42d57f53fd0262681f89f6acdc24b58887214.exe, 0ff8f9853b1951fcefad14ec98e7c21d098fa87d5e3af0cb0d1f2962315a483f.exe, 7e93b3a5bed3d2ab87eac6f297e6bbc63c7cc27e8da00b1ad4f6275c428a130f.exe, 518ee9f74a609d856403d4a94c650e62aba87c9dd17e6e885fe4e0adc4113e9a.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "5251011e8feda9381a5a1b119b36c8bd4bbd3de97044743d8cea2d2f69ee0b4d"
      hash2 = "188206f6dabcf77e5a3ac75e74661ba868dd95122fa3328abf023541d4ffdec9"
      hash3 = "af2f05611639653b5c588b25b9e42d57f53fd0262681f89f6acdc24b58887214"
      hash4 = "0ff8f9853b1951fcefad14ec98e7c21d098fa87d5e3af0cb0d1f2962315a483f"
      hash5 = "7e93b3a5bed3d2ab87eac6f297e6bbc63c7cc27e8da00b1ad4f6275c428a130f"
      hash6 = "518ee9f74a609d856403d4a94c650e62aba87c9dd17e6e885fe4e0adc4113e9a"
   strings:
      $s1 = "textBox19" fullword wide
      $s2 = "textBox22" fullword wide
      $s3 = "textBox23" fullword wide
      $s4 = "textBox21" fullword wide
      $s5 = "textBox20" fullword wide
   condition:
      ( uint16(0) == 0x5a4d and filesize < 2000KB and ( all of them )
      ) or ( all of them )
}

rule _172f9d447a5f9c686cb8a5322558e39c07fb960631c08c2e0d15cd14f12e1e63_f96b03987d5a39f6d1172f022a2e3bf15a31c18f5b38a5ce77c682c36d_54 {
   meta:
      description = "samples - from files 172f9d447a5f9c686cb8a5322558e39c07fb960631c08c2e0d15cd14f12e1e63.exe, f96b03987d5a39f6d1172f022a2e3bf15a31c18f5b38a5ce77c682c36dd791c9.exe, 76c26de3a458e5cc615fb37d0b6481a1260e6b62cc7e801a45210693f381ece7.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "172f9d447a5f9c686cb8a5322558e39c07fb960631c08c2e0d15cd14f12e1e63"
      hash2 = "f96b03987d5a39f6d1172f022a2e3bf15a31c18f5b38a5ce77c682c36dd791c9"
      hash3 = "76c26de3a458e5cc615fb37d0b6481a1260e6b62cc7e801a45210693f381ece7"
   strings:
      $s1 = "CRYPTBASE" fullword ascii
      $s2 = "PROPSYS" fullword ascii
      $s3 = "UXTHEME" fullword ascii
      $s4 = "APPHELP" fullword ascii
      $s5 = "SETUPAPI" fullword ascii /* Goodware String - occured 2 times */
      $s6 = "CLBCATQ" fullword ascii
      $s7 = "USERENV" fullword ascii /* Goodware String - occured 3 times */
      $s8 = "OLEACC" fullword ascii /* Goodware String - occured 4 times */
   condition:
      ( uint16(0) == 0x5a4d and filesize < 3000KB and ( all of them )
      ) or ( all of them )
}

rule _07ecf0ee68a52e1783da654389f5adaa861b5e7cfff04cbec504e721cc3a11ad_04f28f4975a7ff3cb3439b65b8d2fad8e99e3431b65be0e065c1949084_55 {
   meta:
      description = "samples - from files 07ecf0ee68a52e1783da654389f5adaa861b5e7cfff04cbec504e721cc3a11ad.exe, 04f28f4975a7ff3cb3439b65b8d2fad8e99e3431b65be0e065c194908459790e.exe, c826d38990051067a23d7ced76e20925ec47749e562ef718029ff06555680b5b.exe, d4b22461e379bba07e2e2f6cf1833884c0ff656b84afdd3b2284be856f598ae0.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "07ecf0ee68a52e1783da654389f5adaa861b5e7cfff04cbec504e721cc3a11ad"
      hash2 = "04f28f4975a7ff3cb3439b65b8d2fad8e99e3431b65be0e065c194908459790e"
      hash3 = "c826d38990051067a23d7ced76e20925ec47749e562ef718029ff06555680b5b"
      hash4 = "d4b22461e379bba07e2e2f6cf1833884c0ff656b84afdd3b2284be856f598ae0"
   strings:
      $s1 = "m_ComputerObjectProvider" fullword ascii
      $s2 = "m_UserObjectProvider" fullword ascii
      $s3 = "m_MyWebServicesObjectProvider" fullword ascii
      $s4 = "m_AppObjectProvider" fullword ascii
      $s5 = "MyProject" fullword ascii
      $s6 = "MyApplication" fullword ascii
   condition:
      ( uint16(0) == 0x5a4d and filesize < 15000KB and ( all of them )
      ) or ( all of them )
}

rule _052d222b441b1fd17f08ca9831c1c92099ffc3a1187ee6266b9d8d1ed9ebeae8_1669d57e8c83d0666c86fafcd484a5fd158c995a58ad9a6855c56d849c_56 {
   meta:
      description = "samples - from files 052d222b441b1fd17f08ca9831c1c92099ffc3a1187ee6266b9d8d1ed9ebeae8.exe, 1669d57e8c83d0666c86fafcd484a5fd158c995a58ad9a6855c56d849c00b40b.exe, 542ddd41bf8603c95458d6c2c15e1a0cff107fbabac55b69b92bd40fd8bf1696.exe, 76eee256f1223082e8396611baca498542c656edd0fac5fe903e06e6cb5677e2.exe, 071b6c448d2546dea8caed872fca0d002f59a6b9849f0de2a565fc74b487fa37.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "052d222b441b1fd17f08ca9831c1c92099ffc3a1187ee6266b9d8d1ed9ebeae8"
      hash2 = "1669d57e8c83d0666c86fafcd484a5fd158c995a58ad9a6855c56d849c00b40b"
      hash3 = "542ddd41bf8603c95458d6c2c15e1a0cff107fbabac55b69b92bd40fd8bf1696"
      hash4 = "76eee256f1223082e8396611baca498542c656edd0fac5fe903e06e6cb5677e2"
      hash5 = "071b6c448d2546dea8caed872fca0d002f59a6b9849f0de2a565fc74b487fa37"
   strings:
      $s1 = "operator<=>" fullword ascii
      $s2 = "operator co_await" fullword ascii
      $s3 = "__swift_1" fullword ascii
      $s4 = "__swift_2" fullword ascii
      $s5 = "api-ms-" fullword wide
   condition:
      ( uint16(0) == 0x5a4d and filesize < 29000KB and ( all of them )
      ) or ( all of them )
}

rule _8c909dda150a980bd5bb6a0bdb8ca6e92847b3b2152a9c7e9168edcda0d78ae0_7c76c1df37c2b02853976195b4d9f5d5d419685cb980984f69c6273635_57 {
   meta:
      description = "samples - from files 8c909dda150a980bd5bb6a0bdb8ca6e92847b3b2152a9c7e9168edcda0d78ae0.exe, 7c76c1df37c2b02853976195b4d9f5d5d419685cb980984f69c62736350a001a.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "8c909dda150a980bd5bb6a0bdb8ca6e92847b3b2152a9c7e9168edcda0d78ae0"
      hash2 = "7c76c1df37c2b02853976195b4d9f5d5d419685cb980984f69c62736350a001a"
   strings:
      $s1 = "questedPrivileges xmlns=\"urn:schemas-microsoft-com:asm.v3\"><requestedExecutionLevel level=\"asInvoker\" uiAccess=\"false\" /><" ascii
      $s2 = "<assemblyIdentity version=\"1.0.0.0\" name=\"MyApplication.app\" /><trustInfo xmlns=\"urn:schemas-microsoft-com:asm.v2\"><securi" ascii
      $s3 = "ffeeffefeef" ascii
      $s4 = "afeffeefef" ascii
      $s5 = "feffefefea" ascii
      $s6 = "<?xml version=\"1.0\" encoding=\"utf-8\" standalone=\"yes\"?><assembly xmlns=\"urn:schemas-microsoft-com:asm.v1\" manifestVersio" ascii
      $s7 = "RFEQRB26X3PDEDFWVBNNz7Z5LqvJaYhBqzMPIQb93YplgNHPM4189lIZcVRUKIkvpDx6XyTyImBe2JWqGmPJYOGZruKd4cPHwDCng3w" fullword ascii
      $s8 = "9ffefeeffe" ascii
   condition:
      ( uint16(0) == 0x5a4d and filesize < 700KB and ( all of them )
      ) or ( all of them )
}

rule _a55c7ed8b626f509f1db86fb6be1823a6bdf54b47c73a348cfe70c36e8b45d82_07ecf0ee68a52e1783da654389f5adaa861b5e7cfff04cbec504e721cc_58 {
   meta:
      description = "samples - from files a55c7ed8b626f509f1db86fb6be1823a6bdf54b47c73a348cfe70c36e8b45d82.exe, 07ecf0ee68a52e1783da654389f5adaa861b5e7cfff04cbec504e721cc3a11ad.exe, ded5515158d7b1ed9520713645bc63d7bb872f0a212c77ebb1afce0d16fad0ce.exe, e2a569f0f5168d11500b6e5f5c0ad0c900c45be7cbab68f0c354318123bf942f.exe, 0a785a353308e02dfe2b5b3318d6a2a90d7a918dd200d70109fe3eedc3ce69d1.exe, 5ad6806628708095957c45a7f728f941d9b436a25f3f0d2147274403fffd1045.exe, 04f28f4975a7ff3cb3439b65b8d2fad8e99e3431b65be0e065c194908459790e.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "a55c7ed8b626f509f1db86fb6be1823a6bdf54b47c73a348cfe70c36e8b45d82"
      hash2 = "07ecf0ee68a52e1783da654389f5adaa861b5e7cfff04cbec504e721cc3a11ad"
      hash3 = "ded5515158d7b1ed9520713645bc63d7bb872f0a212c77ebb1afce0d16fad0ce"
      hash4 = "e2a569f0f5168d11500b6e5f5c0ad0c900c45be7cbab68f0c354318123bf942f"
      hash5 = "0a785a353308e02dfe2b5b3318d6a2a90d7a918dd200d70109fe3eedc3ce69d1"
      hash6 = "5ad6806628708095957c45a7f728f941d9b436a25f3f0d2147274403fffd1045"
      hash7 = "04f28f4975a7ff3cb3439b65b8d2fad8e99e3431b65be0e065c194908459790e"
   strings:
      $s1 = "Select * from Win32_ComputerSystem" fullword wide
      $s2 = "vmware" fullword wide
      $s3 = "microsoft corporation" fullword wide
      $s4 = "VirtualBox" fullword wide /* Goodware String - occured 5 times */
      $s5 = "SbieDll.dll" fullword wide /* Goodware String - occured 2 times */
      $s6 = "VIRTUAL" fullword wide /* Goodware String - occured 4 times */
   condition:
      ( uint16(0) == 0x5a4d and filesize < 900KB and ( all of them )
      ) or ( all of them )
}

rule _172f9d447a5f9c686cb8a5322558e39c07fb960631c08c2e0d15cd14f12e1e63_5d1c2ac36ca274835d9025eb9e3f7a113cf57509898e02cb9add7a9782_59 {
   meta:
      description = "samples - from files 172f9d447a5f9c686cb8a5322558e39c07fb960631c08c2e0d15cd14f12e1e63.exe, 5d1c2ac36ca274835d9025eb9e3f7a113cf57509898e02cb9add7a97824cea59.exe, f96b03987d5a39f6d1172f022a2e3bf15a31c18f5b38a5ce77c682c36dd791c9.exe, 05b1be412276f70e579862cef3cc0181785ca3c7d6bd398ec2919d50bb4f5630.exe, e4d52884a348b211ebaab9018b286c9f7023abc349f229cc63fea89b5341341e.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "172f9d447a5f9c686cb8a5322558e39c07fb960631c08c2e0d15cd14f12e1e63"
      hash2 = "5d1c2ac36ca274835d9025eb9e3f7a113cf57509898e02cb9add7a97824cea59"
      hash3 = "f96b03987d5a39f6d1172f022a2e3bf15a31c18f5b38a5ce77c682c36dd791c9"
      hash4 = "05b1be412276f70e579862cef3cc0181785ca3c7d6bd398ec2919d50bb4f5630"
      hash5 = "e4d52884a348b211ebaab9018b286c9f7023abc349f229cc63fea89b5341341e"
   strings:
      $s1 = "-/+U#i" fullword ascii
      $s2 = "M~c<i6" fullword ascii
      $s3 = "%A>(Kj" fullword ascii
      $s4 = "%J}uC\"@1a" fullword ascii
      $s5 = "o5<b8T>" fullword ascii
      $s6 = "-/!7[s" fullword ascii
      $s7 = "G\"&?j " fullword ascii
   condition:
      ( uint16(0) == 0x5a4d and filesize < 3000KB and ( all of them )
      ) or ( all of them )
}

rule _07ecf0ee68a52e1783da654389f5adaa861b5e7cfff04cbec504e721cc3a11ad_434fc1fcde79cced66c7784f22b1703b41dd77f1800edd7bebe4343f47_60 {
   meta:
      description = "samples - from files 07ecf0ee68a52e1783da654389f5adaa861b5e7cfff04cbec504e721cc3a11ad.exe, 434fc1fcde79cced66c7784f22b1703b41dd77f1800edd7bebe4343f479080d8.exe, fdc933b64df0832a1f88f0e19a4cab67fb110d54c4913367a7215d7890f8a5b7.exe, c826d38990051067a23d7ced76e20925ec47749e562ef718029ff06555680b5b.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "07ecf0ee68a52e1783da654389f5adaa861b5e7cfff04cbec504e721cc3a11ad"
      hash2 = "434fc1fcde79cced66c7784f22b1703b41dd77f1800edd7bebe4343f479080d8"
      hash3 = "fdc933b64df0832a1f88f0e19a4cab67fb110d54c4913367a7215d7890f8a5b7"
      hash4 = "c826d38990051067a23d7ced76e20925ec47749e562ef718029ff06555680b5b"
   strings:
      $s1 = "WHKEYBOARDLL" fullword ascii
      $s2 = "SetHook" fullword ascii /* Goodware String - occured 6 times */
      $s3 = "vkCode" fullword ascii /* Goodware String - occured 1 times */
      $s4 = "_hookID" fullword ascii
      $s5 = "HookCallback" fullword ascii
   condition:
      ( uint16(0) == 0x5a4d and filesize < 1000KB and ( all of them )
      ) or ( all of them )
}

rule _141be7789497012b7911cabb1307e25e19f747e2e8fb5375f9cddff7e5f28265_68c00e3bb99dd666c421c6fd6b384ff5641ead666c44936d8e84a9075f_61 {
   meta:
      description = "samples - from files 141be7789497012b7911cabb1307e25e19f747e2e8fb5375f9cddff7e5f28265.exe, 68c00e3bb99dd666c421c6fd6b384ff5641ead666c44936d8e84a9075ff79819.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "141be7789497012b7911cabb1307e25e19f747e2e8fb5375f9cddff7e5f28265"
      hash2 = "68c00e3bb99dd666c421c6fd6b384ff5641ead666c44936d8e84a9075ff79819"
   strings:
      $s1 = "        <requestedExecutionLevel level='asInvoker' uiAccess='false' />" fullword ascii
      $s2 = ".idata  " fullword ascii
      $s3 = ".taggant" fullword ascii
      $s4 = "{s4wi4Y" fullword ascii
      $s5 = "^][ZYX" fullword ascii
   condition:
      ( uint16(0) == 0x5a4d and filesize < 7000KB and ( all of them )
      ) or ( all of them )
}

rule _a55c7ed8b626f509f1db86fb6be1823a6bdf54b47c73a348cfe70c36e8b45d82_07ecf0ee68a52e1783da654389f5adaa861b5e7cfff04cbec504e721cc_62 {
   meta:
      description = "samples - from files a55c7ed8b626f509f1db86fb6be1823a6bdf54b47c73a348cfe70c36e8b45d82.exe, 07ecf0ee68a52e1783da654389f5adaa861b5e7cfff04cbec504e721cc3a11ad.exe, 434fc1fcde79cced66c7784f22b1703b41dd77f1800edd7bebe4343f479080d8.exe, 1673828a6bb871f75162500cdffd2e86113da89049fff26117e78be6ea681e69.exe, fdc933b64df0832a1f88f0e19a4cab67fb110d54c4913367a7215d7890f8a5b7.exe, 04f28f4975a7ff3cb3439b65b8d2fad8e99e3431b65be0e065c194908459790e.exe, c826d38990051067a23d7ced76e20925ec47749e562ef718029ff06555680b5b.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "a55c7ed8b626f509f1db86fb6be1823a6bdf54b47c73a348cfe70c36e8b45d82"
      hash2 = "07ecf0ee68a52e1783da654389f5adaa861b5e7cfff04cbec504e721cc3a11ad"
      hash3 = "434fc1fcde79cced66c7784f22b1703b41dd77f1800edd7bebe4343f479080d8"
      hash4 = "1673828a6bb871f75162500cdffd2e86113da89049fff26117e78be6ea681e69"
      hash5 = "fdc933b64df0832a1f88f0e19a4cab67fb110d54c4913367a7215d7890f8a5b7"
      hash6 = "04f28f4975a7ff3cb3439b65b8d2fad8e99e3431b65be0e065c194908459790e"
      hash7 = "c826d38990051067a23d7ced76e20925ec47749e562ef718029ff06555680b5b"
   strings:
      $s1 = "CloseMutex" fullword ascii
      $s2 = "SystemEvents_SessionEnding" fullword ascii
      $s3 = "GetActiveWindowTitle" fullword ascii
      $s4 = "Antivirus" fullword ascii /* Goodware String - occured 16 times */
      $s5 = "IsValidDomainName" fullword ascii
      $s6 = "esFlags" fullword ascii /* Goodware String - occured 2 times */
   condition:
      ( uint16(0) == 0x5a4d and filesize < 1000KB and ( all of them )
      ) or ( all of them )
}

rule _07ecf0ee68a52e1783da654389f5adaa861b5e7cfff04cbec504e721cc3a11ad_434fc1fcde79cced66c7784f22b1703b41dd77f1800edd7bebe4343f47_63 {
   meta:
      description = "samples - from files 07ecf0ee68a52e1783da654389f5adaa861b5e7cfff04cbec504e721cc3a11ad.exe, 434fc1fcde79cced66c7784f22b1703b41dd77f1800edd7bebe4343f479080d8.exe, 4fc50e04ab73013e2fe98c0bf05d5a13e7253fc15805f8b85ed256567bdfbed8.exe, 90a58064c6df293fc564fa5b616c737f6fd31f6288433da2030ec56d6dc46962.exe, f181b5a4e2f0dc0cdf70e16c18e3466e436aae0bb96ef9b7dc24c7f219167115.exe, fdc933b64df0832a1f88f0e19a4cab67fb110d54c4913367a7215d7890f8a5b7.exe, c826d38990051067a23d7ced76e20925ec47749e562ef718029ff06555680b5b.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "07ecf0ee68a52e1783da654389f5adaa861b5e7cfff04cbec504e721cc3a11ad"
      hash2 = "434fc1fcde79cced66c7784f22b1703b41dd77f1800edd7bebe4343f479080d8"
      hash3 = "4fc50e04ab73013e2fe98c0bf05d5a13e7253fc15805f8b85ed256567bdfbed8"
      hash4 = "90a58064c6df293fc564fa5b616c737f6fd31f6288433da2030ec56d6dc46962"
      hash5 = "f181b5a4e2f0dc0cdf70e16c18e3466e436aae0bb96ef9b7dc24c7f219167115"
      hash6 = "fdc933b64df0832a1f88f0e19a4cab67fb110d54c4913367a7215d7890f8a5b7"
      hash7 = "c826d38990051067a23d7ced76e20925ec47749e562ef718029ff06555680b5b"
   strings:
      $s1 = "cchBuff" fullword ascii /* Goodware String - occured 3 times */
      $s2 = "wScanCode" fullword ascii /* Goodware String - occured 3 times */
      $s3 = "wVirtKey" fullword ascii /* Goodware String - occured 3 times */
      $s4 = "pwszBuff" fullword ascii /* Goodware String - occured 3 times */
      $s5 = "lpKeyState" fullword ascii /* Goodware String - occured 5 times */
   condition:
      ( uint16(0) == 0x5a4d and filesize < 15000KB and ( all of them )
      ) or ( all of them )
}

rule _90a58064c6df293fc564fa5b616c737f6fd31f6288433da2030ec56d6dc46962_f181b5a4e2f0dc0cdf70e16c18e3466e436aae0bb96ef9b7dc24c7f219_64 {
   meta:
      description = "samples - from files 90a58064c6df293fc564fa5b616c737f6fd31f6288433da2030ec56d6dc46962.exe, f181b5a4e2f0dc0cdf70e16c18e3466e436aae0bb96ef9b7dc24c7f219167115.exe, 8fc9056ebee5adcd70c3d96e53885fcb355030869137a6f1977a463759f15d86.exe"
      author = "Grim"
      reference = "@grimbinary"
      date = "2024-06-29"
      hash1 = "90a58064c6df293fc564fa5b616c737f6fd31f6288433da2030ec56d6dc46962"
      hash2 = "f181b5a4e2f0dc0cdf70e16c18e3466e436aae0bb96ef9b7dc24c7f219167115"
      hash3 = "8fc9056ebee5adcd70c3d96e53885fcb355030869137a6f1977a463759f15d86"
   strings:
      $s1 = "      <supportedOS Id=\"{35138b9a-5d96-4fbd-8e2d-a2440225f93a}\"/>" fullword ascii
      $s2 = "      <supportedOS Id=\"{e2011457-1546-43c5-a5fe-008deee3d3f0}\"/>" fullword ascii
      $s3 = "      <supportedOS Id=\"{8e0f7a12-bfb3-4fe8-b9a5-48fd50a15a9a}\"/>" fullword ascii
      $s4 = "      <supportedOS Id=\"{1f676c76-80e1-4239-95bb-83d0f6d0da78}\"/>" fullword ascii
      $s5 = "      <supportedOS Id=\"{4a2f28e3-53b9-4441-ba9c-d69d4a4a6e38}\"/>" fullword ascii
   condition:
      ( uint16(0) == 0x5a4d and filesize < 15000KB and ( all of them )
      ) or ( all of them )
}

